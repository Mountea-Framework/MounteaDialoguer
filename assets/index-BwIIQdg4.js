import{c as Q,u as N,a as T,b as A,r as m,j as e,D as G,d as R,e as V,f as J,g as K,L as P,I,T as W,h as X,B as h,i as g,k as O,l as U,F as $,S as Y,m as Z,C as ee,n as k,M as z,o as C,p as D,q as se,s as te,t as ae}from"./index-C8QteWGv.js";import{A as re,L as ne}from"./app-header-Dpx8Rubn.js";import{u as oe,O as ie,C as ce}from"./onboarding-tour-B3Ov6KAR.js";import{E as le,C as de}from"./empty-state-CMbHq8yC.js";import{P as S}from"./plus-DA29P6Vr.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=Q("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);function xe({open:s,onOpenChange:c}){const{t}=N(),o=T(),{createProject:a}=A(),[r,l]=m.useState({name:"",description:"",version:""}),[n,d]=m.useState({}),[u,y]=m.useState(!1),j=(i,p)=>{l(b=>({...b,[i]:p})),n[i]&&d(b=>({...b,[i]:null}))},v=()=>{const i={};return r.name.trim()?/\s/.test(r.name)&&(i.name="Name cannot contain whitespace"):i.name=t("validation.required"),d(i),Object.keys(i).length===0},f=async i=>{if(i.preventDefault(),!!v()){y(!0);try{const p=await a({name:r.name.trim(),description:r.description.trim(),version:r.version.trim()||"1.0.0"});l({name:"",description:"",version:""}),d({}),c(!1),o({to:"/projects/$projectId",params:{projectId:p.id}})}catch(p){console.error("Error creating project:",p),d({submit:t("common.error")})}finally{y(!1)}}},w=()=>{l({name:"",description:"",version:""}),d({}),c(!1)};return e.jsx(G,{open:s,onOpenChange:c,children:e.jsxs(R,{className:"sm:max-w-[500px]",children:[e.jsxs(V,{children:[e.jsx(J,{children:t("projects.createNew")}),e.jsx(K,{children:t("projects.createFirst")})]}),e.jsxs("form",{onSubmit:f,children:[e.jsx("div",{className:"no-scrollbar -mx-4 max-h-[50vh] overflow-y-auto px-4 sm:-mx-6 sm:px-6",children:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"name",children:[t("projects.projectName")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(I,{id:"name",placeholder:"My Awesome Game",value:r.name,onChange:i=>j("name",i.target.value),className:n.name?"border-destructive":"",autoFocus:!0}),n.name&&e.jsx("p",{className:"text-xs text-destructive",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"description",children:t("projects.projectDescription")}),e.jsx(W,{id:"description",placeholder:"A brief description of your project...",value:r.description,onChange:i=>j("description",i.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"version",children:"Version"}),e.jsx(I,{id:"version",placeholder:"1.0.0",value:r.version,onChange:i=>j("version",i.target.value)})]}),n.submit&&e.jsx("p",{className:"text-sm text-destructive",children:n.submit})]})}),e.jsxs(X,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:w,disabled:u,children:t("common.cancel")}),e.jsx(h,{type:"submit",disabled:u,children:t(u?"common.loading":"common.create")})]})]})]})})}async function ue(){try{return"storage"in navigator&&"estimate"in navigator.storage?(await navigator.storage.estimate()).usage||0:await he()}catch(s){return console.error("Error calculating disk usage:",s),0}}async function he(){try{const[s,c,t,o,a,r,l]=await Promise.all([g.projects.count(),g.dialogues.count(),g.nodes.count(),g.edges.count(),g.participants.count(),g.categories.count(),g.decorators.count()]);return s*500+c*300+t*200+o*100+(a+r+l)*150}catch(s){return console.error("Error estimating data size:",s),0}}function pe({onNewProject:s,onSearch:c,searchQuery:t,onShowTour:o}){const{t:a}=N(),{status:r,setLoginDialogOpen:l}=U(),n=a(r==="connected"?"sync.status.connected":r==="syncing"?"sync.status.syncing":"sync.status.disconnected"),d=r==="connected"?"text-emerald-500":r==="syncing"?"text-amber-500":r==="error"?"text-red-500":"text-muted-foreground";return e.jsx(re,{containerClassName:"max-w-7xl mx-auto",leftClassName:"hidden md:flex items-center gap-3 justify-between md:justify-start min-w-0",rightClassName:`${k()?"justify-between":""}`,left:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{className:"hidden sm:block min-w-0",children:[e.jsx("h1",{className:"text-base lg:text-lg font-bold tracking-tight truncate",children:a("app.title")}),e.jsx("p",{className:"hidden xl:block text-xs text-muted-foreground",children:a("app.subtitle")})]})]}),right:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative flex-1 md:w-44 lg:w-64 md:flex-none hidden md:block","data-tour":"search","data-header-mobile-hidden":!0,children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(I,{type:"text",placeholder:a("common.search"),value:t,onChange:u=>c(u.target.value),className:"pl-9 h-9"})]}),e.jsx(ne,{}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>l(!0),className:"rounded-full","aria-label":`${a("sync.title")} - ${n}`,title:`${a("sync.title")} - ${n}`,children:e.jsx(ee,{className:`h-4 w-4 ${d}`})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:o,className:"rounded-full shrink-0 hidden lg:inline-flex","data-header-mobile-hidden":!0,children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsxs(h,{onClick:s,size:"sm",className:`gap-1 md:inline-flex whitespace-nowrap ${k()?"hidden":""}`,"data-tour":`${k()?"":"create-project"}`,"aria-label":a("projects.createNew"),"data-header-mobile-hidden":!0,children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden lg:inline",children:a("projects.createNew")})]}),e.jsxs(h,{onClick:s,size:"sm",className:`shrink-0 md:hidden ${k()?"":"hidden"}`,"data-tour":"","aria-label":a("projects.createNew"),children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden [@media(min-width:400px)]:inline",children:a("projects.createNew")})]})]})})}function ge({projectCount:s,dialogueCount:c,diskUsage:t}){const{t:o}=N();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(C,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:o("projects.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:s})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center",children:e.jsx($,{className:"h-6 w-6 text-primary"})})]})})}),e.jsx(C,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:o("dialogues.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:c})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})})}),e.jsx(C,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:o("dashboard.diskUsage")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:t})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center",children:e.jsx(me,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})})]})}function je({project:s}){const{t:c}=N(),{dialogues:t}=O(),o=t.filter(d=>d.projectId===s.id),a=["from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20","from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20","from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20","from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20"],r=["text-blue-500 dark:text-blue-400","text-purple-500 dark:text-purple-400","text-orange-500 dark:text-orange-400","text-green-500 dark:text-green-400"],l=["#3b82f6","#9333ea","#f97316","#22c55e"],n=parseInt(s.id.substring(0,8),16)%a.length;return e.jsx(te,{to:"/projects/$projectId",params:{projectId:s.id},children:e.jsxs(C,{className:"group cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all h-full min-h-[280px] flex flex-col overflow-hidden rounded-lg",children:[e.jsxs("div",{className:`h-32 bg-gradient-to-br ${a[n]} flex items-center justify-center relative overflow-hidden rounded-t-lg`,children:[e.jsx("div",{className:"absolute inset-0 opacity-30 dark:opacity-20 bg-[radial-gradient(circle,currentColor_1px,transparent_1px)] [background-size:16px_16px]",style:{color:l[n]}}),e.jsx($,{className:`h-12 w-12 ${r[n]} opacity-80 group-hover:scale-110 group-hover:rotate-6 transition-all duration-300 relative z-10`}),e.jsxs("div",{className:"absolute top-3 right-3 text-xs text-muted-foreground flex items-center gap-1 bg-background/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[e.jsx(de,{className:"h-3 w-3"}),ae(s.createdAt)]})]}),e.jsxs(D,{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-base group-hover:text-primary transition-colors line-clamp-1",children:s.name}),s.version&&e.jsxs("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded",children:["v",s.version]})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2 leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-auto pt-3 border-t flex items-center justify-center text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(z,{className:`h-3.5 w-3.5 group-hover:${r[n].replace("text-","text-")} transition-colors`}),e.jsxs("span",{className:"font-medium",children:[o.length," ",o.length===1?c("dialogues.title").slice(0,-1):c("dialogues.title")]})]})})]})]})})}function we(){const{t:s}=N(),c=T(),{projects:t,loadProjects:o,isLoading:a,createOnboardingExampleProject:r}=A(),{dialogues:l,loadDialogues:n}=O(),{lastSyncedAt:d}=U(),[u,y]=m.useState(""),[j,v]=m.useState(!1),[f,w]=m.useState(!1),[i,p]=m.useState(0),{runTour:b,finishTour:F,resetTour:H}=oe("dashboard");m.useEffect(()=>{o()},[o]),m.useEffect(()=>{d&&(o(),n())},[d,o,n]),m.useEffect(()=>{(async()=>{const _=await ue();p(_)})()},[t,l]);const E=()=>{v(!0)},M=async()=>{if(!f){w(!0);try{const x=await r();F(),await o(),await n(),c({to:"/projects/$projectId",params:{projectId:x.projectId}})}catch(x){console.error("Error creating example project:",x)}finally{w(!1)}}},L=t.filter(x=>x.name.toLowerCase().includes(u.toLowerCase())),B=l.length,q=se(i);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted/20 overflow-x-clip",children:[e.jsx(ie,{run:b,onFinish:F,tourType:"dashboard"}),e.jsx(xe,{open:j,onOpenChange:v}),e.jsx(pe,{onNewProject:E,onSearch:y,searchQuery:u,onShowTour:H}),e.jsxs("main",{className:"flex-1 p-6 md:p-12 max-w-7xl mx-auto w-full",children:[e.jsx(ge,{projectCount:t.length,dialogueCount:B,diskUsage:q}),e.jsxs("div",{className:"mt-10",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:s("projects.recentProjects")})}),a?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):L.length===0?e.jsx(le,{icon:$,title:s("projects.noProjects"),description:s("projects.createFirst"),action:e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs(h,{onClick:E,children:[e.jsx(S,{className:"h-4 w-4"}),s("projects.createNew")]}),t.length===0&&e.jsxs(h,{variant:"outline",onClick:M,disabled:f,children:[e.jsx(Y,{className:"h-4 w-4"}),s(f?"common.loading":"tour.dashboard.exampleAction")]})]}),tips:["Projects help organize your dialogues by game or story","Each project can contain multiple dialogues","Use the search bar to quickly find projects"]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6","data-tour":"projects-grid",children:[L.map(x=>e.jsx(je,{project:x},x.id)),e.jsxs("button",{onClick:E,className:"border-2 border-dashed rounded-2xl flex flex-col items-center justify-center min-h-[280px] hover:border-primary hover:bg-primary/5 transition-all group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(S,{className:"h-8 w-8 text-primary"})}),e.jsx("span",{className:"font-bold text-lg",children:s("projects.createNew")}),e.jsx("span",{className:"text-sm text-muted-foreground mt-2",children:s("projects.createNewDescription")})]})]})]})]})]})}export{we as component};
