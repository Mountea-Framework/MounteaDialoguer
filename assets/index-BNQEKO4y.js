import{_ as cw,r as E,c as Be,$ as uw,a0 as lw,j as g,a1 as An,a2 as dw,i as Pe,u as rt,M as rd,a3 as nd,a4 as Cy,a5 as sr,L as Ze,B as xe,A as Un,T as fw,I as Ur,X as jl,a6 as Kd,a7 as hw,a8 as id,a9 as dt,aa as kt,ab as ze,ac as Iy,ad as pw,ae as gw,af as Ce,ag as mw,ah as od,ai as vw,aj as yw,ak as xw,al as bw,am as ww,an as _w,ao as Nw,ap as Sw,aq as Ew,ar as Cw,as as Iw,at as Rw,D as Tw,d as Aw,e as kw,f as jw,g as Mw,V as qw,au as Pw,b as Lw,l as Ow,w as Dw,av as Fw,aw as ro,E as $w,ax as Bw,z as zw,ay as Hw,az as Vw,x as Gw,t as Uw,G as Kw,H as Ww,J as Yw,K as Xw,N as Zw,O as Qw,P as Jw,Q as e_,R as t_,Y as nr,aA as Wd}from"./index-mU7h8hRK.js";import{c as ad}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{P as Kr}from"./plus-BEmJsT-E.js";import{T as ai,C as sd,b as cd,u as r_,d as n_,e as i_,M as o_}from"./confetti-CPdCz4f7.js";import{useCategoryStore as a_}from"./categoryStore-M6OlhPSm.js";import{C as nn,u as s_,f as c_,A as u_,L as l_,e as d_,N as Yd}from"./app-header-uGGFvY-e.js";import{u as f_,O as h_,C as p_}from"./onboarding-tour-Del2Lgds.js";import{S as g_,M as m_}from"./sun-CqPQOzOE.js";function v_(e,t){if(e===void 0)return{shouldBlockFn:()=>!0,withResolver:!1};if("shouldBlockFn"in e)return e;if(typeof e=="function")return{shouldBlockFn:async()=>await e(),enableBeforeUnload:!0,withResolver:!1};const r=!!(e.condition??!0),n=e.blockerFn;return{shouldBlockFn:async()=>r&&n!==void 0?await n():r,enableBeforeUnload:r,withResolver:n===void 0}}function y_(e,t){const{shouldBlockFn:r,enableBeforeUnload:n=!0,disabled:i=!1,withResolver:o=!1}=v_(e),a=cw(),{history:s}=a,[c,u]=E.useState({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0});return E.useEffect(()=>{const l=async d=>{function f(b){const p=a.parseLocation(b),w=a.getMatchedRoutes(p.pathname);return w.foundRoute===void 0?{routeId:"__notFound__",fullPath:p.pathname,pathname:p.pathname,params:w.routeParams,search:a.options.parseSearch(b.search)}:{routeId:w.foundRoute.id,fullPath:w.foundRoute.fullPath,pathname:p.pathname,params:w.routeParams,search:a.options.parseSearch(b.search)}}const h=f(d.currentLocation),m=f(d.nextLocation);if(h.routeId==="__notFound__"&&m.routeId!=="__notFound__")return!1;const y=await r({action:d.action,current:h,next:m});if(!o)return y;if(!y)return!1;const x=await new Promise(b=>{u({status:"blocked",current:h,next:m,action:d.action,proceed:()=>b(!1),reset:()=>b(!0)})});return u({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0}),x};return i?void 0:s.block({blockerFn:l,enableBeforeUnload:n})},[r,n,i,o,s,a]),c}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=Be("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=Be("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=Be("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=Be("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Be("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=Be("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=Be("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=Be("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=Be("PanelRightOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=Be("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=Be("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=Be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=Be("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);function be(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=be(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var I_={value:()=>{}};function ci(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new $n(r)}function $n(e){this._=e}function R_(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}$n.prototype=ci.prototype={constructor:$n,on:function(e,t){var r=this._,n=R_(e+"",r),i,o=-1,a=n.length;if(arguments.length<2){for(;++o<a;)if((i=(e=n[o]).type)&&(i=T_(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=n[o]).type)r[i]=Xd(r[i],e.name,t);else if(t==null)for(i in r)r[i]=Xd(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new $n(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,i=o.length;n<i;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,o=n.length;i<o;++i)n[i].value.apply(t,r)}};function T_(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function Xd(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=I_,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var Ml="http://www.w3.org/1999/xhtml";const Zd={svg:"http://www.w3.org/2000/svg",xhtml:Ml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ui(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Zd.hasOwnProperty(t)?{space:Zd[t],local:e}:e}function A_(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===Ml&&t.documentElement.namespaceURI===Ml?t.createElement(e):t.createElementNS(r,e)}}function k_(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ay(e){var t=ui(e);return(t.local?k_:A_)(t)}function j_(){}function ld(e){return e==null?j_:function(){return this.querySelector(e)}}function M_(e){typeof e!="function"&&(e=ld(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],a=o.length,s=n[i]=new Array(a),c,u,l=0;l<a;++l)(c=o[l])&&(u=e.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),s[l]=u);return new $e(n,this._parents)}function q_(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function P_(){return[]}function ky(e){return e==null?P_:function(){return this.querySelectorAll(e)}}function L_(e){return function(){return q_(e.apply(this,arguments))}}function O_(e){typeof e=="function"?e=L_(e):e=ky(e);for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var a=t[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&(n.push(e.call(c,c.__data__,u,a)),i.push(c));return new $e(n,i)}function jy(e){return function(){return this.matches(e)}}function My(e){return function(t){return t.matches(e)}}var D_=Array.prototype.find;function F_(e){return function(){return D_.call(this.children,e)}}function $_(){return this.firstElementChild}function B_(e){return this.select(e==null?$_:F_(typeof e=="function"?e:My(e)))}var z_=Array.prototype.filter;function H_(){return Array.from(this.children)}function V_(e){return function(){return z_.call(this.children,e)}}function G_(e){return this.selectAll(e==null?H_:V_(typeof e=="function"?e:My(e)))}function U_(e){typeof e!="function"&&(e=jy(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],a=o.length,s=n[i]=[],c,u=0;u<a;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&s.push(c);return new $e(n,this._parents)}function qy(e){return new Array(e.length)}function K_(){return new $e(this._enter||this._groups.map(qy),this._parents)}function Kn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kn.prototype={constructor:Kn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function W_(e){return function(){return e}}function Y_(e,t,r,n,i,o){for(var a=0,s,c=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],n[a]=s):r[a]=new Kn(e,o[a]);for(;a<c;++a)(s=t[a])&&(i[a]=s)}function X_(e,t,r,n,i,o,a){var s,c,u=new Map,l=t.length,d=o.length,f=new Array(l),h;for(s=0;s<l;++s)(c=t[s])&&(f[s]=h=a.call(c,c.__data__,s,t)+"",u.has(h)?i[s]=c:u.set(h,c));for(s=0;s<d;++s)h=a.call(e,o[s],s,o)+"",(c=u.get(h))?(n[s]=c,c.__data__=o[s],u.delete(h)):r[s]=new Kn(e,o[s]);for(s=0;s<l;++s)(c=t[s])&&u.get(f[s])===c&&(i[s]=c)}function Z_(e){return e.__data__}function Q_(e,t){if(!arguments.length)return Array.from(this,Z_);var r=t?X_:Y_,n=this._parents,i=this._groups;typeof e!="function"&&(e=W_(e));for(var o=i.length,a=new Array(o),s=new Array(o),c=new Array(o),u=0;u<o;++u){var l=n[u],d=i[u],f=d.length,h=J_(e.call(l,l&&l.__data__,u,n)),m=h.length,y=s[u]=new Array(m),v=a[u]=new Array(m),x=c[u]=new Array(f);r(l,d,y,v,x,h,t);for(var b=0,p=0,w,S;b<m;++b)if(w=y[b]){for(b>=p&&(p=b+1);!(S=v[p])&&++p<m;);w._next=S||null}}return a=new $e(a,n),a._enter=s,a._exit=c,a}function J_(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function e1(){return new $e(this._exit||this._groups.map(qy),this._parents)}function t1(e,t,r){var n=this.enter(),i=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function r1(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,o=n.length,a=Math.min(i,o),s=new Array(i),c=0;c<a;++c)for(var u=r[c],l=n[c],d=u.length,f=s[c]=new Array(d),h,m=0;m<d;++m)(h=u[m]||l[m])&&(f[m]=h);for(;c<i;++c)s[c]=r[c];return new $e(s,this._parents)}function n1(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,o=n[i],a;--i>=0;)(a=n[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function i1(e){e||(e=o1);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var a=r[o],s=a.length,c=i[o]=new Array(s),u,l=0;l<s;++l)(u=a[l])&&(c[l]=u);c.sort(t)}return new $e(i,this._parents).order()}function o1(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a1(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function s1(){return Array.from(this)}function c1(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var a=n[i];if(a)return a}return null}function u1(){let e=0;for(const t of this)++e;return e}function l1(){return!this.node()}function d1(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function f1(e){return function(){this.removeAttribute(e)}}function h1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function p1(e,t){return function(){this.setAttribute(e,t)}}function g1(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function m1(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function v1(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function y1(e,t){var r=ui(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?h1:f1:typeof t=="function"?r.local?v1:m1:r.local?g1:p1)(r,t))}function Py(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function x1(e){return function(){this.style.removeProperty(e)}}function b1(e,t,r){return function(){this.style.setProperty(e,t,r)}}function w1(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function _1(e,t,r){return arguments.length>1?this.each((t==null?x1:typeof t=="function"?w1:b1)(e,t,r??"")):hr(this.node(),e)}function hr(e,t){return e.style.getPropertyValue(t)||Py(e).getComputedStyle(e,null).getPropertyValue(t)}function N1(e){return function(){delete this[e]}}function S1(e,t){return function(){this[e]=t}}function E1(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function C1(e,t){return arguments.length>1?this.each((t==null?N1:typeof t=="function"?E1:S1)(e,t)):this.node()[e]}function Ly(e){return e.trim().split(/^|\s+/)}function dd(e){return e.classList||new Oy(e)}function Oy(e){this._node=e,this._names=Ly(e.getAttribute("class")||"")}Oy.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Dy(e,t){for(var r=dd(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function Fy(e,t){for(var r=dd(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function I1(e){return function(){Dy(this,e)}}function R1(e){return function(){Fy(this,e)}}function T1(e,t){return function(){(t.apply(this,arguments)?Dy:Fy)(this,e)}}function A1(e,t){var r=Ly(e+"");if(arguments.length<2){for(var n=dd(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?T1:t?I1:R1)(r,t))}function k1(){this.textContent=""}function j1(e){return function(){this.textContent=e}}function M1(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function q1(e){return arguments.length?this.each(e==null?k1:(typeof e=="function"?M1:j1)(e)):this.node().textContent}function P1(){this.innerHTML=""}function L1(e){return function(){this.innerHTML=e}}function O1(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function D1(e){return arguments.length?this.each(e==null?P1:(typeof e=="function"?O1:L1)(e)):this.node().innerHTML}function F1(){this.nextSibling&&this.parentNode.appendChild(this)}function $1(){return this.each(F1)}function B1(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function z1(){return this.each(B1)}function H1(e){var t=typeof e=="function"?e:Ay(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function V1(){return null}function G1(e,t){var r=typeof e=="function"?e:Ay(e),n=t==null?V1:typeof t=="function"?t:ld(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function U1(){var e=this.parentNode;e&&e.removeChild(this)}function K1(){return this.each(U1)}function W1(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Y1(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function X1(e){return this.select(e?Y1:W1)}function Z1(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Q1(e){return function(t){e.call(this,t,this.__data__)}}function J1(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function eN(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,o;r<i;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function tN(e,t,r){return function(){var n=this.__on,i,o=Q1(t);if(n){for(var a=0,s=n.length;a<s;++a)if((i=n[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=t;return}}this.addEventListener(e.type,o,r),i={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(i):this.__on=[i]}}function rN(e,t,r){var n=J1(e+""),i,o=n.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,u=s.length,l;c<u;++c)for(i=0,l=s[c];i<o;++i)if((a=n[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=t?tN:eN,i=0;i<o;++i)this.each(s(n[i],t,r));return this}function $y(e,t,r){var n=Py(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function nN(e,t){return function(){return $y(this,e,t)}}function iN(e,t){return function(){return $y(this,e,t.apply(this,arguments))}}function oN(e,t){return this.each((typeof t=="function"?iN:nN)(e,t))}function*aN(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length,a;i<o;++i)(a=n[i])&&(yield a)}var By=[null];function $e(e,t){this._groups=e,this._parents=t}function on(){return new $e([[document.documentElement]],By)}function sN(){return this}$e.prototype=on.prototype={constructor:$e,select:M_,selectAll:O_,selectChild:B_,selectChildren:G_,filter:U_,data:Q_,enter:K_,exit:e1,join:t1,merge:r1,selection:sN,order:n1,sort:i1,call:a1,nodes:s1,node:c1,size:u1,empty:l1,each:d1,attr:y1,style:_1,property:C1,classed:A1,text:q1,html:D1,raise:$1,lower:z1,append:H1,insert:G1,remove:K1,clone:X1,datum:Z1,on:rN,dispatch:oN,[Symbol.iterator]:aN};function Fe(e){return typeof e=="string"?new $e([[document.querySelector(e)]],[document.documentElement]):new $e([[e]],By)}function cN(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Xe(e,t){if(e=cN(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const uN={passive:!1},Wr={capture:!0,passive:!1};function no(e){e.stopImmediatePropagation()}function lr(e){e.preventDefault(),e.stopImmediatePropagation()}function zy(e){var t=e.document.documentElement,r=Fe(e).on("dragstart.drag",lr,Wr);"onselectstart"in t?r.on("selectstart.drag",lr,Wr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Hy(e,t){var r=e.document.documentElement,n=Fe(e).on("dragstart.drag",null);t&&(n.on("click.drag",lr,Wr),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const kn=e=>()=>e;function ql(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:o,x:a,y:s,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}ql.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function lN(e){return!e.ctrlKey&&!e.button}function dN(){return this.parentNode}function fN(e,t){return t??{x:e.x,y:e.y}}function hN(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vy(){var e=lN,t=dN,r=fN,n=hN,i={},o=ci("start","drag","end"),a=0,s,c,u,l,d=0;function f(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",v).on("touchmove.drag",x,uN).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,S){if(!(l||!e.call(this,w,S))){var _=p(this,t.call(this,w,S),w,S,"mouse");_&&(Fe(w.view).on("mousemove.drag",m,Wr).on("mouseup.drag",y,Wr),zy(w.view),no(w),u=!1,s=w.clientX,c=w.clientY,_("start",w))}}function m(w){if(lr(w),!u){var S=w.clientX-s,_=w.clientY-c;u=S*S+_*_>d}i.mouse("drag",w)}function y(w){Fe(w.view).on("mousemove.drag mouseup.drag",null),Hy(w.view,u),lr(w),i.mouse("end",w)}function v(w,S){if(e.call(this,w,S)){var _=w.changedTouches,N=t.call(this,w,S),j=_.length,A,k;for(A=0;A<j;++A)(k=p(this,N,w,S,_[A].identifier,_[A]))&&(no(w),k("start",w,_[A]))}}function x(w){var S=w.changedTouches,_=S.length,N,j;for(N=0;N<_;++N)(j=i[S[N].identifier])&&(lr(w),j("drag",w,S[N]))}function b(w){var S=w.changedTouches,_=S.length,N,j;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),N=0;N<_;++N)(j=i[S[N].identifier])&&(no(w),j("end",w,S[N]))}function p(w,S,_,N,j,A){var k=o.copy(),R=Xe(A||_,S),M,F,C;if((C=r.call(w,new ql("beforestart",{sourceEvent:_,target:f,identifier:j,active:a,x:R[0],y:R[1],dx:0,dy:0,dispatch:k}),N))!=null)return M=C.x-R[0]||0,F=C.y-R[1]||0,function D(O,q,I){var T=R,V;switch(O){case"start":i[j]=D,V=a++;break;case"end":delete i[j],--a;case"drag":R=Xe(I||q,S),V=a;break}k.call(O,w,new ql(O,{sourceEvent:q,subject:C,target:f,identifier:j,active:V,x:R[0]+M,y:R[1]+F,dx:R[0]-T[0],dy:R[1]-T[1],dispatch:k}),N)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:kn(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:kn(w),f):t},f.subject=function(w){return arguments.length?(r=typeof w=="function"?w:kn(w),f):r},f.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:kn(!!w),f):n},f.on=function(){var w=o.on.apply(o,arguments);return w===o?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function fd(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Gy(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function an(){}var Yr=.7,Wn=1/Yr,dr="\\s*([+-]?\\d+)\\s*",Xr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ut="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pN=/^#([0-9a-f]{3,8})$/,gN=new RegExp(`^rgb\\(${dr},${dr},${dr}\\)$`),mN=new RegExp(`^rgb\\(${ut},${ut},${ut}\\)$`),vN=new RegExp(`^rgba\\(${dr},${dr},${dr},${Xr}\\)$`),yN=new RegExp(`^rgba\\(${ut},${ut},${ut},${Xr}\\)$`),xN=new RegExp(`^hsl\\(${Xr},${ut},${ut}\\)$`),bN=new RegExp(`^hsla\\(${Xr},${ut},${ut},${Xr}\\)$`),Qd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fd(an,Vt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Jd,formatHex:Jd,formatHex8:wN,formatHsl:_N,formatRgb:ef,toString:ef});function Jd(){return this.rgb().formatHex()}function wN(){return this.rgb().formatHex8()}function _N(){return Uy(this).formatHsl()}function ef(){return this.rgb().formatRgb()}function Vt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pN.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?tf(t):r===3?new Me(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?jn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?jn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=gN.exec(e))?new Me(t[1],t[2],t[3],1):(t=mN.exec(e))?new Me(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vN.exec(e))?jn(t[1],t[2],t[3],t[4]):(t=yN.exec(e))?jn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xN.exec(e))?of(t[1],t[2]/100,t[3]/100,1):(t=bN.exec(e))?of(t[1],t[2]/100,t[3]/100,t[4]):Qd.hasOwnProperty(e)?tf(Qd[e]):e==="transparent"?new Me(NaN,NaN,NaN,0):null}function tf(e){return new Me(e>>16&255,e>>8&255,e&255,1)}function jn(e,t,r,n){return n<=0&&(e=t=r=NaN),new Me(e,t,r,n)}function NN(e){return e instanceof an||(e=Vt(e)),e?(e=e.rgb(),new Me(e.r,e.g,e.b,e.opacity)):new Me}function Pl(e,t,r,n){return arguments.length===1?NN(e):new Me(e,t,r,n??1)}function Me(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}fd(Me,Pl,Gy(an,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new Me(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yr:Math.pow(Yr,e),new Me(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Me(zt(this.r),zt(this.g),zt(this.b),Yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rf,formatHex:rf,formatHex8:SN,formatRgb:nf,toString:nf}));function rf(){return`#${Bt(this.r)}${Bt(this.g)}${Bt(this.b)}`}function SN(){return`#${Bt(this.r)}${Bt(this.g)}${Bt(this.b)}${Bt((isNaN(this.opacity)?1:this.opacity)*255)}`}function nf(){const e=Yn(this.opacity);return`${e===1?"rgb(":"rgba("}${zt(this.r)}, ${zt(this.g)}, ${zt(this.b)}${e===1?")":`, ${e})`}`}function Yn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function zt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Bt(e){return e=zt(e),(e<16?"0":"")+e.toString(16)}function of(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Qe(e,t,r,n)}function Uy(e){if(e instanceof Qe)return new Qe(e.h,e.s,e.l,e.opacity);if(e instanceof an||(e=Vt(e)),!e)return new Qe;if(e instanceof Qe)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,c=(o+i)/2;return s?(t===o?a=(r-n)/s+(r<n)*6:r===o?a=(n-t)/s+2:a=(t-r)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new Qe(a,s,c,e.opacity)}function EN(e,t,r,n){return arguments.length===1?Uy(e):new Qe(e,t,r,n??1)}function Qe(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}fd(Qe,EN,Gy(an,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new Qe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yr:Math.pow(Yr,e),new Qe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Me(io(e>=240?e-240:e+120,i,n),io(e,i,n),io(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Qe(af(this.h),Mn(this.s),Mn(this.l),Yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yn(this.opacity);return`${e===1?"hsl(":"hsla("}${af(this.h)}, ${Mn(this.s)*100}%, ${Mn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function af(e){return e=(e||0)%360,e<0?e+360:e}function Mn(e){return Math.max(0,Math.min(1,e||0))}function io(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const hd=e=>()=>e;function CN(e,t){return function(r){return e+r*t}}function IN(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function RN(e){return(e=+e)==1?Ky:function(t,r){return r-t?IN(t,r,e):hd(isNaN(t)?r:t)}}function Ky(e,t){var r=t-e;return r?CN(e,r):hd(isNaN(e)?t:e)}const Xn=(function e(t){var r=RN(t);function n(i,o){var a=r((i=Pl(i)).r,(o=Pl(o)).r),s=r(i.g,o.g),c=r(i.b,o.b),u=Ky(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=c(l),i.opacity=u(l),i+""}}return n.gamma=e,n})(1);function TN(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function AN(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function kN(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),a;for(a=0;a<n;++a)i[a]=Vr(e[a],t[a]);for(;a<r;++a)o[a]=t[a];return function(s){for(a=0;a<n;++a)o[a]=i[a](s);return o}}function jN(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function ct(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function MN(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Vr(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var Ll=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oo=new RegExp(Ll.source,"g");function qN(e){return function(){return e}}function PN(e){return function(t){return e(t)+""}}function Wy(e,t){var r=Ll.lastIndex=oo.lastIndex=0,n,i,o,a=-1,s=[],c=[];for(e=e+"",t=t+"";(n=Ll.exec(e))&&(i=oo.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:ct(n,i)})),r=oo.lastIndex;return r<t.length&&(o=t.slice(r),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?PN(c[0].x):qN(t):(t=c.length,function(u){for(var l=0,d;l<t;++l)s[(d=c[l]).i]=d.x(u);return s.join("")})}function Vr(e,t){var r=typeof t,n;return t==null||r==="boolean"?hd(t):(r==="number"?ct:r==="string"?(n=Vt(t))?(t=n,Xn):Wy:t instanceof Vt?Xn:t instanceof Date?jN:AN(t)?TN:Array.isArray(t)?kN:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?MN:ct)(e,t)}var sf=180/Math.PI,Ol={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Yy(e,t,r,n,i,o){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,c/=s),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*sf,skewX:Math.atan(c)*sf,scaleX:a,scaleY:s}}var qn;function LN(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ol:Yy(t.a,t.b,t.c,t.d,t.e,t.f)}function ON(e){return e==null||(qn||(qn=document.createElementNS("http://www.w3.org/2000/svg","g")),qn.setAttribute("transform",e),!(e=qn.transform.baseVal.consolidate()))?Ol:(e=e.matrix,Yy(e.a,e.b,e.c,e.d,e.e,e.f))}function Xy(e,t,r,n){function i(u){return u.length?u.pop()+" ":""}function o(u,l,d,f,h,m){if(u!==d||l!==f){var y=h.push("translate(",null,t,null,r);m.push({i:y-4,x:ct(u,d)},{i:y-2,x:ct(l,f)})}else(d||f)&&h.push("translate("+d+t+f+r)}function a(u,l,d,f){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),f.push({i:d.push(i(d)+"rotate(",null,n)-2,x:ct(u,l)})):l&&d.push(i(d)+"rotate("+l+n)}function s(u,l,d,f){u!==l?f.push({i:d.push(i(d)+"skewX(",null,n)-2,x:ct(u,l)}):l&&d.push(i(d)+"skewX("+l+n)}function c(u,l,d,f,h,m){if(u!==d||l!==f){var y=h.push(i(h)+"scale(",null,",",null,")");m.push({i:y-4,x:ct(u,d)},{i:y-2,x:ct(l,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(u,l){var d=[],f=[];return u=e(u),l=e(l),o(u.translateX,u.translateY,l.translateX,l.translateY,d,f),a(u.rotate,l.rotate,d,f),s(u.skewX,l.skewX,d,f),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,d,f),u=l=null,function(h){for(var m=-1,y=f.length,v;++m<y;)d[(v=f[m]).i]=v.x(h);return d.join("")}}}var DN=Xy(LN,"px, ","px)","deg)"),FN=Xy(ON,", ",")",")"),$N=1e-12;function cf(e){return((e=Math.exp(e))+1/e)/2}function BN(e){return((e=Math.exp(e))-1/e)/2}function zN(e){return((e=Math.exp(2*e))-1)/(e+1)}const Bn=(function e(t,r,n){function i(o,a){var s=o[0],c=o[1],u=o[2],l=a[0],d=a[1],f=a[2],h=l-s,m=d-c,y=h*h+m*m,v,x;if(y<$N)x=Math.log(f/u)/t,v=function(N){return[s+N*h,c+N*m,u*Math.exp(t*N*x)]};else{var b=Math.sqrt(y),p=(f*f-u*u+n*y)/(2*u*r*b),w=(f*f-u*u-n*y)/(2*f*r*b),S=Math.log(Math.sqrt(p*p+1)-p),_=Math.log(Math.sqrt(w*w+1)-w);x=(_-S)/t,v=function(N){var j=N*x,A=cf(S),k=u/(r*b)*(A*zN(t*j+S)-BN(S));return[s+k*h,c+k*m,u*A/cf(t*j+S)]}}return v.duration=x*1e3*t/Math.SQRT2,v}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,c=s*s;return e(a,s,c)},i})(Math.SQRT2,2,4);var pr=0,Dr=0,Lr=0,Zy=1e3,Zn,Fr,Qn=0,Gt=0,li=0,Zr=typeof performance=="object"&&performance.now?performance:Date,Qy=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function pd(){return Gt||(Qy(HN),Gt=Zr.now()+li)}function HN(){Gt=0}function Jn(){this._call=this._time=this._next=null}Jn.prototype=Jy.prototype={constructor:Jn,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?pd():+r)+(t==null?0:+t),!this._next&&Fr!==this&&(Fr?Fr._next=this:Zn=this,Fr=this),this._call=e,this._time=r,Dl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Dl())}};function Jy(e,t,r){var n=new Jn;return n.restart(e,t,r),n}function VN(){pd(),++pr;for(var e=Zn,t;e;)(t=Gt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pr}function uf(){Gt=(Qn=Zr.now())+li,pr=Dr=0;try{VN()}finally{pr=0,UN(),Gt=0}}function GN(){var e=Zr.now(),t=e-Qn;t>Zy&&(li-=t,Qn=e)}function UN(){for(var e,t=Zn,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Zn=r);Fr=e,Dl(n)}function Dl(e){if(!pr){Dr&&(Dr=clearTimeout(Dr));var t=e-Gt;t>24?(e<1/0&&(Dr=setTimeout(uf,e-Zr.now()-li)),Lr&&(Lr=clearInterval(Lr))):(Lr||(Qn=Zr.now(),Lr=setInterval(GN,Zy)),pr=1,Qy(uf))}}function lf(e,t,r){var n=new Jn;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var KN=ci("start","end","cancel","interrupt"),WN=[],e0=0,df=1,Fl=2,zn=3,ff=4,$l=5,Hn=6;function di(e,t,r,n,i,o){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;YN(e,r,{name:t,index:n,group:i,on:KN,tween:WN,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:e0})}function gd(e,t){var r=nt(e,t);if(r.state>e0)throw new Error("too late; already scheduled");return r}function ft(e,t){var r=nt(e,t);if(r.state>zn)throw new Error("too late; already running");return r}function nt(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function YN(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=Jy(o,0,r.time);function o(u){r.state=df,r.timer.restart(a,r.delay,r.time),r.delay<=u&&a(u-r.delay)}function a(u){var l,d,f,h;if(r.state!==df)return c();for(l in n)if(h=n[l],h.name===r.name){if(h.state===zn)return lf(a);h.state===ff?(h.state=Hn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[l]):+l<t&&(h.state=Hn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[l])}if(lf(function(){r.state===zn&&(r.state=ff,r.timer.restart(s,r.delay,r.time),s(u))}),r.state=Fl,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Fl){for(r.state=zn,i=new Array(f=r.tween.length),l=0,d=-1;l<f;++l)(h=r.tween[l].value.call(e,e.__data__,r.index,r.group))&&(i[++d]=h);i.length=d+1}}function s(u){for(var l=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=$l,1),d=-1,f=i.length;++d<f;)i[d].call(e,l);r.state===$l&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Hn,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function Vn(e,t){var r=e.__transition,n,i,o=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){o=!1;continue}i=n.state>Fl&&n.state<$l,n.state=Hn,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}o&&delete e.__transition}}function XN(e){return this.each(function(){Vn(this,e)})}function ZN(e,t){var r,n;return function(){var i=ft(this,e),o=i.tween;if(o!==r){n=r=o;for(var a=0,s=n.length;a<s;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}i.tween=n}}function QN(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=ft(this,e),a=o.tween;if(a!==n){i=(n=a).slice();for(var s={name:t,value:r},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=s;break}c===u&&i.push(s)}o.tween=i}}function JN(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=nt(this.node(),r).tween,i=0,o=n.length,a;i<o;++i)if((a=n[i]).name===e)return a.value;return null}return this.each((t==null?ZN:QN)(r,e,t))}function md(e,t,r){var n=e._id;return e.each(function(){var i=ft(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return nt(i,n).value[t]}}function t0(e,t){var r;return(typeof t=="number"?ct:t instanceof Vt?Xn:(r=Vt(t))?(t=r,Xn):Wy)(e,t)}function eS(e){return function(){this.removeAttribute(e)}}function tS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function rS(e,t,r){var n,i=r+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===n?o:o=t(n=a,r)}}function nS(e,t,r){var n,i=r+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===n?o:o=t(n=a,r)}}function iS(e,t,r){var n,i,o;return function(){var a,s=r(this),c;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=s+"",a===c?null:a===n&&c===i?o:(i=c,o=t(n=a,s)))}}function oS(e,t,r){var n,i,o;return function(){var a,s=r(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=s+"",a===c?null:a===n&&c===i?o:(i=c,o=t(n=a,s)))}}function aS(e,t){var r=ui(e),n=r==="transform"?FN:t0;return this.attrTween(e,typeof t=="function"?(r.local?oS:iS)(r,n,md(this,"attr."+e,t)):t==null?(r.local?tS:eS)(r):(r.local?nS:rS)(r,n,t))}function sS(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function cS(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function uS(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&cS(e,o)),r}return i._value=t,i}function lS(e,t){var r,n;function i(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&sS(e,o)),r}return i._value=t,i}function dS(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=ui(e);return this.tween(r,(n.local?uS:lS)(n,t))}function fS(e,t){return function(){gd(this,e).delay=+t.apply(this,arguments)}}function hS(e,t){return t=+t,function(){gd(this,e).delay=t}}function pS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fS:hS)(t,e)):nt(this.node(),t).delay}function gS(e,t){return function(){ft(this,e).duration=+t.apply(this,arguments)}}function mS(e,t){return t=+t,function(){ft(this,e).duration=t}}function vS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gS:mS)(t,e)):nt(this.node(),t).duration}function yS(e,t){if(typeof t!="function")throw new Error;return function(){ft(this,e).ease=t}}function xS(e){var t=this._id;return arguments.length?this.each(yS(t,e)):nt(this.node(),t).ease}function bS(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;ft(this,e).ease=r}}function wS(e){if(typeof e!="function")throw new Error;return this.each(bS(this._id,e))}function _S(e){typeof e!="function"&&(e=jy(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o=t[i],a=o.length,s=n[i]=[],c,u=0;u<a;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&s.push(c);return new yt(n,this._parents,this._name,this._id)}function NS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),a=new Array(n),s=0;s<o;++s)for(var c=t[s],u=r[s],l=c.length,d=a[s]=new Array(l),f,h=0;h<l;++h)(f=c[h]||u[h])&&(d[h]=f);for(;s<n;++s)a[s]=t[s];return new yt(a,this._parents,this._name,this._id)}function SS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function ES(e,t,r){var n,i,o=SS(t)?gd:ft;return function(){var a=o(this,e),s=a.on;s!==n&&(i=(n=s).copy()).on(t,r),a.on=i}}function CS(e,t){var r=this._id;return arguments.length<2?nt(this.node(),r).on.on(e):this.each(ES(r,e,t))}function IS(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function RS(){return this.on("end.remove",IS(this._id))}function TS(e){var t=this._name,r=this._id;typeof e!="function"&&(e=ld(e));for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a)for(var s=n[a],c=s.length,u=o[a]=new Array(c),l,d,f=0;f<c;++f)(l=s[f])&&(d=e.call(l,l.__data__,f,s))&&("__data__"in l&&(d.__data__=l.__data__),u[f]=d,di(u[f],t,r,f,u,nt(l,r)));return new yt(o,this._parents,t,r)}function AS(e){var t=this._name,r=this._id;typeof e!="function"&&(e=ky(e));for(var n=this._groups,i=n.length,o=[],a=[],s=0;s<i;++s)for(var c=n[s],u=c.length,l,d=0;d<u;++d)if(l=c[d]){for(var f=e.call(l,l.__data__,d,c),h,m=nt(l,r),y=0,v=f.length;y<v;++y)(h=f[y])&&di(h,t,r,y,f,m);o.push(f),a.push(l)}return new yt(o,a,t,r)}var kS=on.prototype.constructor;function jS(){return new kS(this._groups,this._parents)}function MS(e,t){var r,n,i;return function(){var o=hr(this,e),a=(this.style.removeProperty(e),hr(this,e));return o===a?null:o===r&&a===n?i:i=t(r=o,n=a)}}function r0(e){return function(){this.style.removeProperty(e)}}function qS(e,t,r){var n,i=r+"",o;return function(){var a=hr(this,e);return a===i?null:a===n?o:o=t(n=a,r)}}function PS(e,t,r){var n,i,o;return function(){var a=hr(this,e),s=r(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),hr(this,e))),a===c?null:a===n&&c===i?o:(i=c,o=t(n=a,s))}}function LS(e,t){var r,n,i,o="style."+t,a="end."+o,s;return function(){var c=ft(this,e),u=c.on,l=c.value[o]==null?s||(s=r0(t)):void 0;(u!==r||i!==l)&&(n=(r=u).copy()).on(a,i=l),c.on=n}}function OS(e,t,r){var n=(e+="")=="transform"?DN:t0;return t==null?this.styleTween(e,MS(e,n)).on("end.style."+e,r0(e)):typeof t=="function"?this.styleTween(e,PS(e,n,md(this,"style."+e,t))).each(LS(this._id,e)):this.styleTween(e,qS(e,n,t),r).on("end.style."+e,null)}function DS(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function FS(e,t,r){var n,i;function o(){var a=t.apply(this,arguments);return a!==i&&(n=(i=a)&&DS(e,a,r)),n}return o._value=t,o}function $S(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,FS(e,t,r??""))}function BS(e){return function(){this.textContent=e}}function zS(e){return function(){var t=e(this);this.textContent=t??""}}function HS(e){return this.tween("text",typeof e=="function"?zS(md(this,"text",e)):BS(e==null?"":e+""))}function VS(e){return function(t){this.textContent=e.call(this,t)}}function GS(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&VS(i)),t}return n._value=e,n}function US(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,GS(e))}function KS(){for(var e=this._name,t=this._id,r=n0(),n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],s=a.length,c,u=0;u<s;++u)if(c=a[u]){var l=nt(c,t);di(c,e,r,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new yt(n,this._parents,e,r)}function WS(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(o,a){var s={value:a},c={value:function(){--i===0&&o()}};r.each(function(){var u=ft(this,n),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),u.on=t}),i===0&&o()})}var YS=0;function yt(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function n0(){return++YS}var mt=on.prototype;yt.prototype={constructor:yt,select:TS,selectAll:AS,selectChild:mt.selectChild,selectChildren:mt.selectChildren,filter:_S,merge:NS,selection:jS,transition:KS,call:mt.call,nodes:mt.nodes,node:mt.node,size:mt.size,empty:mt.empty,each:mt.each,on:CS,attr:aS,attrTween:dS,style:OS,styleTween:$S,text:HS,textTween:US,remove:RS,tween:JN,delay:pS,duration:vS,ease:xS,easeVarying:wS,end:WS,[Symbol.iterator]:mt[Symbol.iterator]};function XS(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ZS={time:null,delay:0,duration:250,ease:XS};function QS(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function JS(e){var t,r;e instanceof yt?(t=e._id,e=e._name):(t=n0(),(r=ZS).time=pd(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var a=n[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&di(c,e,t,u,a,r||QS(c,t));return new yt(n,this._parents,e,t)}on.prototype.interrupt=XN;on.prototype.transition=JS;const Pn=e=>()=>e;function eE(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function vt(e,t,r){this.k=e,this.x=t,this.y=r}vt.prototype={constructor:vt,scale:function(e){return e===1?this:new vt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fi=new vt(1,0,0);i0.prototype=vt.prototype;function i0(e){for(;!e.__zoom;)if(!(e=e.parentNode))return fi;return e.__zoom}function ao(e){e.stopImmediatePropagation()}function Or(e){e.preventDefault(),e.stopImmediatePropagation()}function tE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function rE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function hf(){return this.__zoom||fi}function nE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function iE(){return navigator.maxTouchPoints||"ontouchstart"in this}function oE(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function o0(){var e=tE,t=rE,r=oE,n=nE,i=iE,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Bn,u=ci("start","zoom","end"),l,d,f,h=500,m=150,y=0,v=10;function x(C){C.property("__zoom",hf).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",k).filter(i).on("touchstart.zoom",R).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(C,D,O,q){var I=C.selection?C.selection():C;I.property("__zoom",hf),C!==I?S(C,D,O,q):I.interrupt().each(function(){_(this,arguments).event(q).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},x.scaleBy=function(C,D,O,q){x.scaleTo(C,function(){var I=this.__zoom.k,T=typeof D=="function"?D.apply(this,arguments):D;return I*T},O,q)},x.scaleTo=function(C,D,O,q){x.transform(C,function(){var I=t.apply(this,arguments),T=this.__zoom,V=O==null?w(I):typeof O=="function"?O.apply(this,arguments):O,G=T.invert(V),K=typeof D=="function"?D.apply(this,arguments):D;return r(p(b(T,K),V,G),I,a)},O,q)},x.translateBy=function(C,D,O,q){x.transform(C,function(){return r(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof O=="function"?O.apply(this,arguments):O),t.apply(this,arguments),a)},null,q)},x.translateTo=function(C,D,O,q,I){x.transform(C,function(){var T=t.apply(this,arguments),V=this.__zoom,G=q==null?w(T):typeof q=="function"?q.apply(this,arguments):q;return r(fi.translate(G[0],G[1]).scale(V.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof O=="function"?-O.apply(this,arguments):-O),T,a)},q,I)};function b(C,D){return D=Math.max(o[0],Math.min(o[1],D)),D===C.k?C:new vt(D,C.x,C.y)}function p(C,D,O){var q=D[0]-O[0]*C.k,I=D[1]-O[1]*C.k;return q===C.x&&I===C.y?C:new vt(C.k,q,I)}function w(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function S(C,D,O,q){C.on("start.zoom",function(){_(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event(q).end()}).tween("zoom",function(){var I=this,T=arguments,V=_(I,T).event(q),G=t.apply(I,T),K=O==null?w(G):typeof O=="function"?O.apply(I,T):O,Q=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),P=I.__zoom,$=typeof D=="function"?D.apply(I,T):D,H=c(P.invert(K).concat(Q/P.k),$.invert(K).concat(Q/$.k));return function(B){if(B===1)B=$;else{var z=H(B),X=Q/z[2];B=new vt(X,K[0]-z[0]*X,K[1]-z[1]*X)}V.zoom(null,B)}})}function _(C,D,O){return!O&&C.__zooming||new N(C,D)}function N(C,D){this.that=C,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,D),this.taps=0}N.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,D){return this.mouse&&C!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var D=Fe(this.that).datum();u.call(C,this.that,new eE(C,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:u}),D)}};function j(C,...D){if(!e.apply(this,arguments))return;var O=_(this,D).event(C),q=this.__zoom,I=Math.max(o[0],Math.min(o[1],q.k*Math.pow(2,n.apply(this,arguments)))),T=Xe(C);if(O.wheel)(O.mouse[0][0]!==T[0]||O.mouse[0][1]!==T[1])&&(O.mouse[1]=q.invert(O.mouse[0]=T)),clearTimeout(O.wheel);else{if(q.k===I)return;O.mouse=[T,q.invert(T)],Vn(this),O.start()}Or(C),O.wheel=setTimeout(V,m),O.zoom("mouse",r(p(b(q,I),O.mouse[0],O.mouse[1]),O.extent,a));function V(){O.wheel=null,O.end()}}function A(C,...D){if(f||!e.apply(this,arguments))return;var O=C.currentTarget,q=_(this,D,!0).event(C),I=Fe(C.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",Q,!0),T=Xe(C,O),V=C.clientX,G=C.clientY;zy(C.view),ao(C),q.mouse=[T,this.__zoom.invert(T)],Vn(this),q.start();function K(P){if(Or(P),!q.moved){var $=P.clientX-V,H=P.clientY-G;q.moved=$*$+H*H>y}q.event(P).zoom("mouse",r(p(q.that.__zoom,q.mouse[0]=Xe(P,O),q.mouse[1]),q.extent,a))}function Q(P){I.on("mousemove.zoom mouseup.zoom",null),Hy(P.view,q.moved),Or(P),q.event(P).end()}}function k(C,...D){if(e.apply(this,arguments)){var O=this.__zoom,q=Xe(C.changedTouches?C.changedTouches[0]:C,this),I=O.invert(q),T=O.k*(C.shiftKey?.5:2),V=r(p(b(O,T),q,I),t.apply(this,D),a);Or(C),s>0?Fe(this).transition().duration(s).call(S,V,q,C):Fe(this).call(x.transform,V,q,C)}}function R(C,...D){if(e.apply(this,arguments)){var O=C.touches,q=O.length,I=_(this,D,C.changedTouches.length===q).event(C),T,V,G,K;for(ao(C),V=0;V<q;++V)G=O[V],K=Xe(G,this),K=[K,this.__zoom.invert(K),G.identifier],I.touch0?!I.touch1&&I.touch0[2]!==K[2]&&(I.touch1=K,I.taps=0):(I.touch0=K,T=!0,I.taps=1+!!l);l&&(l=clearTimeout(l)),T&&(I.taps<2&&(d=K[0],l=setTimeout(function(){l=null},h)),Vn(this),I.start())}}function M(C,...D){if(this.__zooming){var O=_(this,D).event(C),q=C.changedTouches,I=q.length,T,V,G,K;for(Or(C),T=0;T<I;++T)V=q[T],G=Xe(V,this),O.touch0&&O.touch0[2]===V.identifier?O.touch0[0]=G:O.touch1&&O.touch1[2]===V.identifier&&(O.touch1[0]=G);if(V=O.that.__zoom,O.touch1){var Q=O.touch0[0],P=O.touch0[1],$=O.touch1[0],H=O.touch1[1],B=(B=$[0]-Q[0])*B+(B=$[1]-Q[1])*B,z=(z=H[0]-P[0])*z+(z=H[1]-P[1])*z;V=b(V,Math.sqrt(B/z)),G=[(Q[0]+$[0])/2,(Q[1]+$[1])/2],K=[(P[0]+H[0])/2,(P[1]+H[1])/2]}else if(O.touch0)G=O.touch0[0],K=O.touch0[1];else return;O.zoom("touch",r(p(V,G,K),O.extent,a))}}function F(C,...D){if(this.__zooming){var O=_(this,D).event(C),q=C.changedTouches,I=q.length,T,V;for(ao(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),T=0;T<I;++T)V=q[T],O.touch0&&O.touch0[2]===V.identifier?delete O.touch0:O.touch1&&O.touch1[2]===V.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(V=Xe(V,this),Math.hypot(d[0]-V[0],d[1]-V[1])<v)){var G=Fe(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return x.wheelDelta=function(C){return arguments.length?(n=typeof C=="function"?C:Pn(+C),x):n},x.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Pn(!!C),x):e},x.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Pn(!!C),x):i},x.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Pn([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),x):t},x.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],x):[o[0],o[1]]},x.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(C){return arguments.length?(r=C,x):r},x.duration=function(C){return arguments.length?(s=+C,x):s},x.interpolate=function(C){return arguments.length?(c=C,x):c},x.on=function(){var C=u.on.apply(u,arguments);return C===u?x:C},x.clickDistance=function(C){return arguments.length?(y=(C=+C)*C,x):Math.sqrt(y)},x.tapDistance=function(C){return arguments.length?(v=+C,x):v},x}const lt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:n}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Qr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],a0=["Enter"," ","Escape"],s0={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var gr;(function(e){e.Strict="strict",e.Loose="loose"})(gr||(gr={}));var Ht;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ht||(Ht={}));var Jr;(function(e){e.Partial="partial",e.Full="full"})(Jr||(Jr={}));const c0={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Tt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Tt||(Tt={}));var mr;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(mr||(mr={}));var ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ae||(ae={}));const pf={[ae.Left]:ae.Right,[ae.Right]:ae.Left,[ae.Top]:ae.Bottom,[ae.Bottom]:ae.Top};function u0(e){return e===null?null:e?"valid":"invalid"}const l0=e=>"id"in e&&"source"in e&&"target"in e,aE=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),vd=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),sn=(e,t=[0,0])=>{const{width:r,height:n}=xt(e),i=e.origin??t,o=r*i[0],a=n*i[1];return{x:e.position.x-o,y:e.position.y-a}},sE=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const o=typeof i=="string";let a=!t.nodeLookup&&!o?i:void 0;t.nodeLookup&&(a=o?t.nodeLookup.get(i):vd(i)?i:t.nodeLookup.get(i.id));const s=a?ei(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return hi(n,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return pi(r)},cn=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return e.forEach(i=>{(t.filter===void 0||t.filter(i))&&(r=hi(r,ei(i)),n=!0)}),n?pi(r):{x:0,y:0,width:0,height:0}},yd=(e,t,[r,n,i]=[0,0,1],o=!1,a=!1)=>{const s={...ln(t,[r,n,i]),width:t.width/i,height:t.height/i},c=[];for(const u of e.values()){const{measured:l,selectable:d=!0,hidden:f=!1}=u;if(a&&!d||f)continue;const h=l.width??u.width??u.initialWidth??null,m=l.height??u.height??u.initialHeight??null,y=en(s,yr(u)),v=(h??0)*(m??0),x=o&&y>0;(!u.internals.handleBounds||x||y>=v||u.dragging)&&c.push(u)}return c},cE=(e,t)=>{const r=new Set;return e.forEach(n=>{r.add(n.id)}),t.filter(n=>r.has(n.source)||r.has(n.target))};function uE(e,t){const r=new Map,n=t!=null&&t.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!i.hidden)&&(!n||n.has(i.id))&&r.set(i.id,i)}),r}async function lE({nodes:e,width:t,height:r,panZoom:n,minZoom:i,maxZoom:o},a){if(e.size===0)return Promise.resolve(!0);const s=uE(e,a),c=cn(s),u=xd(c,t,r,(a==null?void 0:a.minZoom)??i,(a==null?void 0:a.maxZoom)??o,(a==null?void 0:a.padding)??.1);return await n.setViewport(u,{duration:a==null?void 0:a.duration,ease:a==null?void 0:a.ease,interpolate:a==null?void 0:a.interpolate}),Promise.resolve(!0)}function d0({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:i,onError:o}){const a=r.get(e),s=a.parentId?r.get(a.parentId):void 0,{x:c,y:u}=s?s.internals.positionAbsolute:{x:0,y:0},l=a.origin??n;let d=a.extent||i;if(a.extent==="parent"&&!a.expandParent)if(!s)o==null||o("005",lt.error005());else{const h=s.measured.width,m=s.measured.height;h&&m&&(d=[[c,u],[c+h,u+m]])}else s&&xr(a.extent)&&(d=[[a.extent[0][0]+c,a.extent[0][1]+u],[a.extent[1][0]+c,a.extent[1][1]+u]]);const f=xr(d)?Ut(t,d,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&(o==null||o("015",lt.error015())),{position:{x:f.x-c+(a.measured.width??0)*l[0],y:f.y-u+(a.measured.height??0)*l[1]},positionAbsolute:f}}async function dE({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:n,onBeforeDelete:i}){const o=new Set(e.map(f=>f.id)),a=[];for(const f of r){if(f.deletable===!1)continue;const h=o.has(f.id),m=!h&&f.parentId&&a.find(y=>y.id===f.parentId);(h||m)&&a.push(f)}const s=new Set(t.map(f=>f.id)),c=n.filter(f=>f.deletable!==!1),l=cE(a,c);for(const f of c)s.has(f.id)&&!l.find(m=>m.id===f.id)&&l.push(f);if(!i)return{edges:l,nodes:a};const d=await i({nodes:a,edges:l});return typeof d=="boolean"?d?{edges:l,nodes:a}:{edges:[],nodes:[]}:d}const vr=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Ut=(e={x:0,y:0},t,r)=>({x:vr(e.x,t[0][0],t[1][0]-((r==null?void 0:r.width)??0)),y:vr(e.y,t[0][1],t[1][1]-((r==null?void 0:r.height)??0))});function f0(e,t,r){const{width:n,height:i}=xt(r),{x:o,y:a}=r.internals.positionAbsolute;return Ut(e,[[o,a],[o+n,a+i]],t)}const gf=(e,t,r)=>e<t?vr(Math.abs(e-t),1,t)/t:e>r?-vr(Math.abs(e-r),1,t)/t:0,h0=(e,t,r=15,n=40)=>{const i=gf(e.x,n,t.width-n)*r,o=gf(e.y,n,t.height-n)*r;return[i,o]},hi=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Bl=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),pi=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),yr=(e,t=[0,0])=>{var i,o;const{x:r,y:n}=vd(e)?e.internals.positionAbsolute:sn(e,t);return{x:r,y:n,width:((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0,height:((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0}},ei=(e,t=[0,0])=>{var i,o;const{x:r,y:n}=vd(e)?e.internals.positionAbsolute:sn(e,t);return{x:r,y:n,x2:r+(((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0),y2:n+(((o=e.measured)==null?void 0:o.height)??e.height??e.initialHeight??0)}},p0=(e,t)=>pi(hi(Bl(e),Bl(t))),en=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},mf=e=>Je(e.width)&&Je(e.height)&&Je(e.x)&&Je(e.y),Je=e=>!isNaN(e)&&isFinite(e),fE=(e,t)=>{},un=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),ln=({x:e,y:t},[r,n,i],o=!1,a=[1,1])=>{const s={x:(e-r)/i,y:(t-n)/i};return o?un(s,a):s},ti=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n});function ir(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function hE(e,t,r){if(typeof e=="string"||typeof e=="number"){const n=ir(e,r),i=ir(e,t);return{top:n,right:i,bottom:n,left:i,x:i*2,y:n*2}}if(typeof e=="object"){const n=ir(e.top??e.y??0,r),i=ir(e.bottom??e.y??0,r),o=ir(e.left??e.x??0,t),a=ir(e.right??e.x??0,t);return{top:n,right:a,bottom:i,left:o,x:o+a,y:n+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function pE(e,t,r,n,i,o){const{x:a,y:s}=ti(e,[t,r,n]),{x:c,y:u}=ti({x:e.x+e.width,y:e.y+e.height},[t,r,n]),l=i-c,d=o-u;return{left:Math.floor(a),top:Math.floor(s),right:Math.floor(l),bottom:Math.floor(d)}}const xd=(e,t,r,n,i,o)=>{const a=hE(o,t,r),s=(t-a.x)/e.width,c=(r-a.y)/e.height,u=Math.min(s,c),l=vr(u,n,i),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*l,m=r/2-f*l,y=pE(e,h,m,l,t,r),v={left:Math.min(y.left-a.left,0),top:Math.min(y.top-a.top,0),right:Math.min(y.right-a.right,0),bottom:Math.min(y.bottom-a.bottom,0)};return{x:h-v.left+v.right,y:m-v.top+v.bottom,zoom:l}},tn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function xr(e){return e!=null&&e!=="parent"}function xt(e){var t,r;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}}function g0(e){var t,r;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight)!==void 0}function m0(e,t={width:0,height:0},r,n,i){const o={...e},a=n.get(r);if(a){const s=a.origin||i;o.x+=a.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=a.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function vf(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function gE(){let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}}function mE(e){return{...s0,...e||{}}}function Gr(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:n,containerBounds:i}){const{x:o,y:a}=et(e),s=ln({x:o-((i==null?void 0:i.left)??0),y:a-((i==null?void 0:i.top)??0)},n),{x:c,y:u}=r?un(s,t):s;return{xSnapped:c,ySnapped:u,...s}}const bd=e=>({width:e.offsetWidth,height:e.offsetHeight}),v0=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},vE=["INPUT","SELECT","TEXTAREA"];function y0(e){var n,i;const t=((i=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:i[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:vE.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const x0=e=>"clientX"in e,et=(e,t)=>{var o,a;const r=x0(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,i=r?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},yf=(e,t,r,n,i)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(a=>{const s=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:i,position:a.getAttribute("data-handlepos"),x:(s.left-r.left)/n,y:(s.top-r.top)/n,...bd(a)}})};function b0({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:o,targetControlX:a,targetControlY:s}){const c=e*.125+i*.375+a*.375+r*.125,u=t*.125+o*.375+s*.375+n*.125,l=Math.abs(c-e),d=Math.abs(u-t);return[c,u,l,d]}function Ln(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function xf({pos:e,x1:t,y1:r,x2:n,y2:i,c:o}){switch(e){case ae.Left:return[t-Ln(t-n,o),r];case ae.Right:return[t+Ln(n-t,o),r];case ae.Top:return[t,r-Ln(r-i,o)];case ae.Bottom:return[t,r+Ln(i-r,o)]}}function w0({sourceX:e,sourceY:t,sourcePosition:r=ae.Bottom,targetX:n,targetY:i,targetPosition:o=ae.Top,curvature:a=.25}){const[s,c]=xf({pos:r,x1:e,y1:t,x2:n,y2:i,c:a}),[u,l]=xf({pos:o,x1:n,y1:i,x2:e,y2:t,c:a}),[d,f,h,m]=b0({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${s},${c} ${u},${l} ${n},${i}`,d,f,h,m]}function _0({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,o=r<e?r+i:r-i,a=Math.abs(n-t)/2,s=n<t?n+a:n-a;return[o,s,i,a]}function yE({sourceNode:e,targetNode:t,selected:r=!1,zIndex:n=0,elevateOnSelect:i=!1,zIndexMode:o="basic"}){if(o==="manual")return n;const a=i&&r?n+1e3:n,s=Math.max(e.parentId||i&&e.selected?e.internals.z:0,t.parentId||i&&t.selected?t.internals.z:0);return a+s}function xE({sourceNode:e,targetNode:t,width:r,height:n,transform:i}){const o=hi(ei(e),ei(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const a={x:-i[0]/i[2],y:-i[1]/i[2],width:r/i[2],height:n/i[2]};return en(a,pi(o))>0}const bE=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`xy-edge__${e}${t||""}-${r}${n||""}`,wE=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),zl=(e,t,r={})=>{if(!e.source||!e.target)return t;const n=r.getEdgeId||bE;let i;return l0(e)?i={...e}:i={...e,id:n(e)},wE(i,t)?t:(i.sourceHandle===null&&delete i.sourceHandle,i.targetHandle===null&&delete i.targetHandle,t.concat(i))};function N0({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,o,a,s]=_0({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,o,a,s]}const bf={[ae.Left]:{x:-1,y:0},[ae.Right]:{x:1,y:0},[ae.Top]:{x:0,y:-1},[ae.Bottom]:{x:0,y:1}},_E=({source:e,sourcePosition:t=ae.Bottom,target:r})=>t===ae.Left||t===ae.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},wf=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function NE({source:e,sourcePosition:t=ae.Bottom,target:r,targetPosition:n=ae.Top,center:i,offset:o,stepPosition:a}){const s=bf[t],c=bf[n],u={x:e.x+s.x*o,y:e.y+s.y*o},l={x:r.x+c.x*o,y:r.y+c.y*o},d=_E({source:u,sourcePosition:t,target:l}),f=d.x!==0?"x":"y",h=d[f];let m=[],y,v;const x={x:0,y:0},b={x:0,y:0},[,,p,w]=_0({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(s[f]*c[f]===-1){f==="x"?(y=i.x??u.x+(l.x-u.x)*a,v=i.y??(u.y+l.y)/2):(y=i.x??(u.x+l.x)/2,v=i.y??u.y+(l.y-u.y)*a);const _=[{x:y,y:u.y},{x:y,y:l.y}],N=[{x:u.x,y:v},{x:l.x,y:v}];s[f]===h?m=f==="x"?_:N:m=f==="x"?N:_}else{const _=[{x:u.x,y:l.y}],N=[{x:l.x,y:u.y}];if(f==="x"?m=s.x===h?N:_:m=s.y===h?_:N,t===n){const M=Math.abs(e[f]-r[f]);if(M<=o){const F=Math.min(o-1,o-M);s[f]===h?x[f]=(u[f]>e[f]?-1:1)*F:b[f]=(l[f]>r[f]?-1:1)*F}}if(t!==n){const M=f==="x"?"y":"x",F=s[f]===c[M],C=u[M]>l[M],D=u[M]<l[M];(s[f]===1&&(!F&&C||F&&D)||s[f]!==1&&(!F&&D||F&&C))&&(m=f==="x"?_:N)}const j={x:u.x+x.x,y:u.y+x.y},A={x:l.x+b.x,y:l.y+b.y},k=Math.max(Math.abs(j.x-m[0].x),Math.abs(A.x-m[0].x)),R=Math.max(Math.abs(j.y-m[0].y),Math.abs(A.y-m[0].y));k>=R?(y=(j.x+A.x)/2,v=m[0].y):(y=m[0].x,v=(j.y+A.y)/2)}return[[e,{x:u.x+x.x,y:u.y+x.y},...m,{x:l.x+b.x,y:l.y+b.y},r],y,v,p,w]}function SE(e,t,r,n){const i=Math.min(wf(e,t)/2,wf(t,r)/2,n),{x:o,y:a}=t;if(e.x===o&&o===r.x||e.y===a&&a===r.y)return`L${o} ${a}`;if(e.y===a){const u=e.x<r.x?-1:1,l=e.y<r.y?1:-1;return`L ${o+i*u},${a}Q ${o},${a} ${o},${a+i*l}`}const s=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${a+i*c}Q ${o},${a} ${o+i*s},${a}`}function Hl({sourceX:e,sourceY:t,sourcePosition:r=ae.Bottom,targetX:n,targetY:i,targetPosition:o=ae.Top,borderRadius:a=5,centerX:s,centerY:c,offset:u=20,stepPosition:l=.5}){const[d,f,h,m,y]=NE({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:o,center:{x:s,y:c},offset:u,stepPosition:l});return[d.reduce((x,b,p)=>{let w="";return p>0&&p<d.length-1?w=SE(d[p-1],b,d[p+1],a):w=`${p===0?"M":"L"}${b.x} ${b.y}`,x+=w,x},""),f,h,m,y]}function _f(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function EE(e){var d;const{sourceNode:t,targetNode:r}=e;if(!_f(t)||!_f(r))return null;const n=t.internals.handleBounds||Nf(t.handles),i=r.internals.handleBounds||Nf(r.handles),o=Sf((n==null?void 0:n.source)??[],e.sourceHandle),a=Sf(e.connectionMode===gr.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),e.targetHandle);if(!o||!a)return(d=e.onError)==null||d.call(e,"008",lt.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=(o==null?void 0:o.position)||ae.Bottom,c=(a==null?void 0:a.position)||ae.Top,u=Kt(t,o,s),l=Kt(r,a,c);return{sourceX:u.x,sourceY:u.y,targetX:l.x,targetY:l.y,sourcePosition:s,targetPosition:c}}function Nf(e){if(!e)return null;const t=[],r=[];for(const n of e)n.width=n.width??1,n.height=n.height??1,n.type==="source"?t.push(n):n.type==="target"&&r.push(n);return{source:t,target:r}}function Kt(e,t,r=ae.Left,n=!1){const i=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,o=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:a,height:s}=t??xt(e);if(n)return{x:i+a/2,y:o+s/2};switch((t==null?void 0:t.position)??r){case ae.Top:return{x:i+a/2,y:o};case ae.Right:return{x:i+a,y:o+s/2};case ae.Bottom:return{x:i+a/2,y:o+s};case ae.Left:return{x:i,y:o+s/2}}}function Sf(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function Vl(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function CE(e,{id:t,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:i}){const o=new Set;return e.reduce((a,s)=>([s.markerStart||n,s.markerEnd||i].forEach(c=>{if(c&&typeof c=="object"){const u=Vl(c,t);o.has(u)||(a.push({id:u,color:c.color||r,...c}),o.add(u))}}),a),[]).sort((a,s)=>a.id.localeCompare(s.id))}const S0=1e3,IE=10,wd={nodeOrigin:[0,0],nodeExtent:Qr,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},RE={...wd,checkEquality:!0};function _d(e,t){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}function TE(e,t,r){const n=_d(wd,r);for(const i of e.values())if(i.parentId)Sd(i,e,t,n);else{const o=sn(i,n.nodeOrigin),a=xr(i.extent)?i.extent:n.nodeExtent,s=Ut(o,a,xt(i));i.internals.positionAbsolute=s}}function AE(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const r=[],n=[];for(const i of e.handles){const o={id:i.id,width:i.width??1,height:i.height??1,nodeId:e.id,x:i.x,y:i.y,position:i.position,type:i.type};i.type==="source"?r.push(o):i.type==="target"&&n.push(o)}return{source:r,target:n}}function Nd(e){return e==="manual"}function Gl(e,t,r,n={}){var u,l;const i=_d(RE,n),o={i:0},a=new Map(t),s=i!=null&&i.elevateNodesOnSelect&&!Nd(i.zIndexMode)?S0:0;let c=e.length>0;t.clear(),r.clear();for(const d of e){let f=a.get(d.id);if(i.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const h=sn(d,i.nodeOrigin),m=xr(d.extent)?d.extent:i.nodeExtent,y=Ut(h,m,xt(d));f={...i.defaults,...d,measured:{width:(u=d.measured)==null?void 0:u.width,height:(l=d.measured)==null?void 0:l.height},internals:{positionAbsolute:y,handleBounds:AE(d,f),z:E0(d,s,i.zIndexMode),userNode:d}},t.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(c=!1),d.parentId&&Sd(f,t,r,n,o)}return c}function kE(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Sd(e,t,r,n,i){const{elevateNodesOnSelect:o,nodeOrigin:a,nodeExtent:s,zIndexMode:c}=_d(wd,n),u=e.parentId,l=t.get(u);if(!l){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}kE(e,r),i&&!l.parentId&&l.internals.rootParentIndex===void 0&&c==="auto"&&(l.internals.rootParentIndex=++i.i,l.internals.z=l.internals.z+i.i*IE),i&&l.internals.rootParentIndex!==void 0&&(i.i=l.internals.rootParentIndex);const d=o&&!Nd(c)?S0:0,{x:f,y:h,z:m}=jE(e,l,a,s,d,c),{positionAbsolute:y}=e.internals,v=f!==y.x||h!==y.y;(v||m!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:v?{x:f,y:h}:y,z:m}})}function E0(e,t,r){const n=Je(e.zIndex)?e.zIndex:0;return Nd(r)?n:n+(e.selected?t:0)}function jE(e,t,r,n,i,o){const{x:a,y:s}=t.internals.positionAbsolute,c=xt(e),u=sn(e,r),l=xr(e.extent)?Ut(u,e.extent,c):u;let d=Ut({x:a+l.x,y:s+l.y},n,c);e.extent==="parent"&&(d=f0(d,c,t));const f=E0(e,i,o),h=t.internals.z??0;return{x:d.x,y:d.y,z:h>=f?h+1:f}}function Ed(e,t,r,n=[0,0]){var a;const i=[],o=new Map;for(const s of e){const c=t.get(s.parentId);if(!c)continue;const u=((a=o.get(s.parentId))==null?void 0:a.expandedRect)??yr(c),l=p0(u,s.rect);o.set(s.parentId,{expandedRect:l,parent:c})}return o.size>0&&o.forEach(({expandedRect:s,parent:c},u)=>{var p;const l=c.internals.positionAbsolute,d=xt(c),f=c.origin??n,h=s.x<l.x?Math.round(Math.abs(l.x-s.x)):0,m=s.y<l.y?Math.round(Math.abs(l.y-s.y)):0,y=Math.max(d.width,Math.round(s.width)),v=Math.max(d.height,Math.round(s.height)),x=(y-d.width)*f[0],b=(v-d.height)*f[1];(h>0||m>0||x||b)&&(i.push({id:u,type:"position",position:{x:c.position.x-h+x,y:c.position.y-m+b}}),(p=r.get(u))==null||p.forEach(w=>{e.some(S=>S.id===w.id)||i.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+m}})})),(d.width<s.width||d.height<s.height||h||m)&&i.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:y+(h?f[0]*h-x:0),height:v+(m?f[1]*m-b:0)}})}),i}function ME(e,t,r,n,i,o,a){const s=n==null?void 0:n.querySelector(".xyflow__viewport");let c=!1;if(!s)return{changes:[],updatedInternals:c};const u=[],l=window.getComputedStyle(s),{m22:d}=new window.DOMMatrixReadOnly(l.transform),f=[];for(const h of e.values()){const m=t.get(h.id);if(!m)continue;if(m.hidden){t.set(m.id,{...m,internals:{...m.internals,handleBounds:void 0}}),c=!0;continue}const y=bd(h.nodeElement),v=m.measured.width!==y.width||m.measured.height!==y.height;if(!!(y.width&&y.height&&(v||!m.internals.handleBounds||h.force))){const b=h.nodeElement.getBoundingClientRect(),p=xr(m.extent)?m.extent:o;let{positionAbsolute:w}=m.internals;m.parentId&&m.extent==="parent"?w=f0(w,y,t.get(m.parentId)):p&&(w=Ut(w,p,y));const S={...m,measured:y,internals:{...m.internals,positionAbsolute:w,handleBounds:{source:yf("source",h.nodeElement,b,d,m.id),target:yf("target",h.nodeElement,b,d,m.id)}}};t.set(m.id,S),m.parentId&&Sd(S,t,r,{nodeOrigin:i,zIndexMode:a}),c=!0,v&&(u.push({id:m.id,type:"dimensions",dimensions:y}),m.expandParent&&m.parentId&&f.push({id:m.id,parentId:m.parentId,rect:yr(S,i)}))}}if(f.length>0){const h=Ed(f,t,r,i);u.push(...h)}return{changes:u,updatedInternals:c}}async function qE({delta:e,panZoom:t,transform:r,translateExtent:n,width:i,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[i,o]],n),s=!!a&&(a.x!==r[0]||a.y!==r[1]||a.k!==r[2]);return Promise.resolve(s)}function Ef(e,t,r,n,i,o){let a=i;const s=n.get(a)||new Map;n.set(a,s.set(r,t)),a=`${i}-${e}`;const c=n.get(a)||new Map;if(n.set(a,c.set(r,t)),o){a=`${i}-${e}-${o}`;const u=n.get(a)||new Map;n.set(a,u.set(r,t))}}function C0(e,t,r){e.clear(),t.clear();for(const n of r){const{source:i,target:o,sourceHandle:a=null,targetHandle:s=null}=n,c={edgeId:n.id,source:i,target:o,sourceHandle:a,targetHandle:s},u=`${i}-${a}--${o}-${s}`,l=`${o}-${s}--${i}-${a}`;Ef("source",c,l,e,i,a),Ef("target",c,u,e,o,s),t.set(n.id,n)}}function I0(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:I0(r,t):!1}function Cf(e,t,r){var i;let n=e;do{if((i=n==null?void 0:n.matches)!=null&&i.call(n,t))return!0;if(n===r)return!1;n=n==null?void 0:n.parentElement}while(n);return!1}function PE(e,t,r,n){const i=new Map;for(const[o,a]of e)if((a.selected||a.id===n)&&(!a.parentId||!I0(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const s=e.get(o);s&&i.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:r.x-s.internals.positionAbsolute.x,y:r.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return i}function so({nodeId:e,dragItems:t,nodeLookup:r,dragging:n=!0}){var a,s,c;const i=[];for(const[u,l]of t){const d=(a=r.get(u))==null?void 0:a.internals.userNode;d&&i.push({...d,position:l.position,dragging:n})}if(!e)return[i[0],i];const o=(s=r.get(e))==null?void 0:s.internals.userNode;return[o?{...o,position:((c=t.get(e))==null?void 0:c.position)||o.position,dragging:n}:i[0],i]}function LE({dragItems:e,snapGrid:t,x:r,y:n}){const i=e.values().next().value;if(!i)return null;const o={x:r-i.distance.x,y:n-i.distance.y},a=un(o,t);return{x:a.x-o.x,y:a.y-o.y}}function OE({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:n,onDragStop:i}){let o={x:null,y:null},a=0,s=new Map,c=!1,u={x:0,y:0},l=null,d=!1,f=null,h=!1,m=!1,y=null;function v({noDragClassName:b,handleSelector:p,domNode:w,isSelectable:S,nodeId:_,nodeClickDistance:N=0}){f=Fe(w);function j({x:M,y:F}){const{nodeLookup:C,nodeExtent:D,snapGrid:O,snapToGrid:q,nodeOrigin:I,onNodeDrag:T,onSelectionDrag:V,onError:G,updateNodePositions:K}=t();o={x:M,y:F};let Q=!1;const P=s.size>1,$=P&&D?Bl(cn(s)):null,H=P&&q?LE({dragItems:s,snapGrid:O,x:M,y:F}):null;for(const[B,z]of s){if(!C.has(B))continue;let X={x:M-z.distance.x,y:F-z.distance.y};q&&(X=H?{x:Math.round(X.x+H.x),y:Math.round(X.y+H.y)}:un(X,O));let te=null;if(P&&D&&!z.extent&&$){const{positionAbsolute:ne}=z.internals,Z=ne.x-$.x+D[0][0],se=ne.x+z.measured.width-$.x2+D[1][0],le=ne.y-$.y+D[0][1],ce=ne.y+z.measured.height-$.y2+D[1][1];te=[[Z,le],[se,ce]]}const{position:ee,positionAbsolute:re}=d0({nodeId:B,nextPosition:X,nodeLookup:C,nodeExtent:te||D,nodeOrigin:I,onError:G});Q=Q||z.position.x!==ee.x||z.position.y!==ee.y,z.position=ee,z.internals.positionAbsolute=re}if(m=m||Q,!!Q&&(K(s,!0),y&&(n||T||!_&&V))){const[B,z]=so({nodeId:_,dragItems:s,nodeLookup:C});n==null||n(y,s,B,z),T==null||T(y,B,z),_||V==null||V(y,z)}}async function A(){if(!l)return;const{transform:M,panBy:F,autoPanSpeed:C,autoPanOnNodeDrag:D}=t();if(!D){c=!1,cancelAnimationFrame(a);return}const[O,q]=h0(u,l,C);(O!==0||q!==0)&&(o.x=(o.x??0)-O/M[2],o.y=(o.y??0)-q/M[2],await F({x:O,y:q})&&j(o)),a=requestAnimationFrame(A)}function k(M){var P;const{nodeLookup:F,multiSelectionActive:C,nodesDraggable:D,transform:O,snapGrid:q,snapToGrid:I,selectNodesOnDrag:T,onNodeDragStart:V,onSelectionDragStart:G,unselectNodesAndEdges:K}=t();d=!0,(!T||!S)&&!C&&_&&((P=F.get(_))!=null&&P.selected||K()),S&&T&&_&&(e==null||e(_));const Q=Gr(M.sourceEvent,{transform:O,snapGrid:q,snapToGrid:I,containerBounds:l});if(o=Q,s=PE(F,D,Q,_),s.size>0&&(r||V||!_&&G)){const[$,H]=so({nodeId:_,dragItems:s,nodeLookup:F});r==null||r(M.sourceEvent,s,$,H),V==null||V(M.sourceEvent,$,H),_||G==null||G(M.sourceEvent,H)}}const R=Vy().clickDistance(N).on("start",M=>{const{domNode:F,nodeDragThreshold:C,transform:D,snapGrid:O,snapToGrid:q}=t();l=(F==null?void 0:F.getBoundingClientRect())||null,h=!1,m=!1,y=M.sourceEvent,C===0&&k(M),o=Gr(M.sourceEvent,{transform:D,snapGrid:O,snapToGrid:q,containerBounds:l}),u=et(M.sourceEvent,l)}).on("drag",M=>{const{autoPanOnNodeDrag:F,transform:C,snapGrid:D,snapToGrid:O,nodeDragThreshold:q,nodeLookup:I}=t(),T=Gr(M.sourceEvent,{transform:C,snapGrid:D,snapToGrid:O,containerBounds:l});if(y=M.sourceEvent,(M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1||_&&!I.has(_))&&(h=!0),!h){if(!c&&F&&d&&(c=!0,A()),!d){const V=et(M.sourceEvent,l),G=V.x-u.x,K=V.y-u.y;Math.sqrt(G*G+K*K)>q&&k(M)}(o.x!==T.xSnapped||o.y!==T.ySnapped)&&s&&d&&(u=et(M.sourceEvent,l),j(T))}}).on("end",M=>{if(!(!d||h)&&(c=!1,d=!1,cancelAnimationFrame(a),s.size>0)){const{nodeLookup:F,updateNodePositions:C,onNodeDragStop:D,onSelectionDragStop:O}=t();if(m&&(C(s,!1),m=!1),i||D||!_&&O){const[q,I]=so({nodeId:_,dragItems:s,nodeLookup:F,dragging:!1});i==null||i(M.sourceEvent,s,q,I),D==null||D(M.sourceEvent,q,I),_||O==null||O(M.sourceEvent,I)}}}).filter(M=>{const F=M.target;return!M.button&&(!b||!Cf(F,`.${b}`,w))&&(!p||Cf(F,p,w))});f.call(R)}function x(){f==null||f.on(".drag",null)}return{update:v,destroy:x}}function DE(e,t,r){const n=[],i={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const o of t.values())en(i,yr(o))>0&&n.push(o);return n}const FE=250;function $E(e,t,r,n){var s,c;let i=[],o=1/0;const a=DE(e,r,t+FE);for(const u of a){const l=[...((s=u.internals.handleBounds)==null?void 0:s.source)??[],...((c=u.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of l){if(n.nodeId===d.nodeId&&n.type===d.type&&n.id===d.id)continue;const{x:f,y:h}=Kt(u,d,d.position,!0),m=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));m>t||(m<o?(i=[{...d,x:f,y:h}],o=m):m===o&&i.push({...d,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const u=n.type==="source"?"target":"source";return i.find(l=>l.type===u)??i[0]}return i[0]}function R0(e,t,r,n,i,o=!1){var u,l,d;const a=n.get(e);if(!a)return null;const s=i==="strict"?(u=a.internals.handleBounds)==null?void 0:u[t]:[...((l=a.internals.handleBounds)==null?void 0:l.source)??[],...((d=a.internals.handleBounds)==null?void 0:d.target)??[]],c=(r?s==null?void 0:s.find(f=>f.id===r):s==null?void 0:s[0])??null;return c&&o?{...c,...Kt(a,c,c.position,!0)}:c}function T0(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function BE(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const A0=()=>!0;function zE(e,{connectionMode:t,connectionRadius:r,handleId:n,nodeId:i,edgeUpdaterType:o,isTarget:a,domNode:s,nodeLookup:c,lib:u,autoPanOnConnect:l,flowId:d,panBy:f,cancelConnection:h,onConnectStart:m,onConnect:y,onConnectEnd:v,isValidConnection:x=A0,onReconnectEnd:b,updateConnection:p,getTransform:w,getFromHandle:S,autoPanSpeed:_,dragThreshold:N=1,handleDomNode:j}){const A=v0(e.target);let k=0,R;const{x:M,y:F}=et(e),C=T0(o,j),D=s==null?void 0:s.getBoundingClientRect();let O=!1;if(!D||!C)return;const q=R0(i,C,n,c,t);if(!q)return;let I=et(e,D),T=!1,V=null,G=!1,K=null;function Q(){if(!l||!D)return;const[ee,re]=h0(I,D,_);f({x:ee,y:re}),k=requestAnimationFrame(Q)}const P={...q,nodeId:i,type:C,position:q.position},$=c.get(i);let B={inProgress:!0,isValid:null,from:Kt($,P,ae.Left,!0),fromHandle:P,fromPosition:P.position,fromNode:$,to:I,toHandle:null,toPosition:pf[P.position],toNode:null,pointer:I};function z(){O=!0,p(B),m==null||m(e,{nodeId:i,handleId:n,handleType:C})}N===0&&z();function X(ee){if(!O){const{x:ce,y:_e}=et(ee),Ne=ce-M,Le=_e-F;if(!(Ne*Ne+Le*Le>N*N))return;z()}if(!S()||!P){te(ee);return}const re=w();I=et(ee,D),R=$E(ln(I,re,!1,[1,1]),r,c,P),T||(Q(),T=!0);const ne=k0(ee,{handle:R,connectionMode:t,fromNodeId:i,fromHandleId:n,fromType:a?"target":"source",isValidConnection:x,doc:A,lib:u,flowId:d,nodeLookup:c});K=ne.handleDomNode,V=ne.connection,G=BE(!!R,ne.isValid);const Z=c.get(i),se=Z?Kt(Z,P,ae.Left,!0):B.from,le={...B,from:se,isValid:G,to:ne.toHandle&&G?ti({x:ne.toHandle.x,y:ne.toHandle.y},re):I,toHandle:ne.toHandle,toPosition:G&&ne.toHandle?ne.toHandle.position:pf[P.position],toNode:ne.toHandle?c.get(ne.toHandle.nodeId):null,pointer:I};p(le),B=le}function te(ee){if(!("touches"in ee&&ee.touches.length>0)){if(O){(R||K)&&V&&G&&(y==null||y(V));const{inProgress:re,...ne}=B,Z={...ne,toPosition:B.toHandle?B.toPosition:null};v==null||v(ee,Z),o&&(b==null||b(ee,Z))}h(),cancelAnimationFrame(k),T=!1,G=!1,V=null,K=null,A.removeEventListener("mousemove",X),A.removeEventListener("mouseup",te),A.removeEventListener("touchmove",X),A.removeEventListener("touchend",te)}}A.addEventListener("mousemove",X),A.addEventListener("mouseup",te),A.addEventListener("touchmove",X),A.addEventListener("touchend",te)}function k0(e,{handle:t,connectionMode:r,fromNodeId:n,fromHandleId:i,fromType:o,doc:a,lib:s,flowId:c,isValidConnection:u=A0,nodeLookup:l}){const d=o==="target",f=t?a.querySelector(`.${s}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:m}=et(e),y=a.elementFromPoint(h,m),v=y!=null&&y.classList.contains(`${s}-flow__handle`)?y:f,x={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const b=T0(void 0,v),p=v.getAttribute("data-nodeid"),w=v.getAttribute("data-handleid"),S=v.classList.contains("connectable"),_=v.classList.contains("connectableend");if(!p||!b)return x;const N={source:d?p:n,sourceHandle:d?w:i,target:d?n:p,targetHandle:d?i:w};x.connection=N;const A=S&&_&&(r===gr.Strict?d&&b==="source"||!d&&b==="target":p!==n||w!==i);x.isValid=A&&u(N),x.toHandle=R0(p,b,w,l,r,!0)}return x}const Ul={onPointerDown:zE,isValid:k0};function HE({domNode:e,panZoom:t,getTransform:r,getViewScale:n}){const i=Fe(e);function o({translateExtent:s,width:c,height:u,zoomStep:l=1,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const m=p=>{if(p.sourceEvent.type!=="wheel"||!t)return;const w=r(),S=p.sourceEvent.ctrlKey&&tn()?10:1,_=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*l,N=w[2]*Math.pow(2,_*S);t.scaleTo(N)};let y=[0,0];const v=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(y=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},x=p=>{const w=r();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const S=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],_=[S[0]-y[0],S[1]-y[1]];y=S;const N=n()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),j={x:w[0]-_[0]*N,y:w[1]-_[1]*N},A=[[0,0],[c,u]];t.setViewportConstrained({x:j.x,y:j.y,zoom:w[2]},A,s)},b=o0().on("start",v).on("zoom",d?x:null).on("zoom.wheel",f?m:null);i.call(b,{})}function a(){i.on("zoom",null)}return{update:o,destroy:a,pointer:Xe}}const gi=e=>({x:e.x,y:e.y,zoom:e.k}),co=({x:e,y:t,zoom:r})=>fi.translate(e,t).scale(r),cr=(e,t)=>e.target.closest(`.${t}`),j0=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),VE=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,uo=(e,t=0,r=VE,n=()=>{})=>{const i=typeof t=="number"&&t>0;return i||n(),i?e.transition().duration(t).ease(r).on("end",n):e},M0=e=>{const t=e.ctrlKey&&tn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function GE({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:n,panOnScrollMode:i,panOnScrollSpeed:o,zoomOnPinch:a,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:u}){return l=>{if(cr(l,t))return l.ctrlKey&&l.preventDefault(),!1;l.preventDefault(),l.stopImmediatePropagation();const d=r.property("__zoom").k||1;if(l.ctrlKey&&a){const v=Xe(l),x=M0(l),b=d*Math.pow(2,x);n.scaleTo(r,b,v,l);return}const f=l.deltaMode===1?20:1;let h=i===Ht.Vertical?0:l.deltaX*f,m=i===Ht.Horizontal?0:l.deltaY*f;!tn()&&l.shiftKey&&i!==Ht.Vertical&&(h=l.deltaY*f,m=0),n.translateBy(r,-(h/d)*o,-(m/d)*o,{internal:!0});const y=gi(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c==null||c(l,y),e.panScrollTimeout=setTimeout(()=>{u==null||u(l,y),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,s==null||s(l,y))}}function UE({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(n,i){const o=n.type==="wheel",a=!t&&o&&!n.ctrlKey,s=cr(n,e);if(n.ctrlKey&&o&&s&&n.preventDefault(),a||s)return null;n.preventDefault(),r.call(this,n,i)}}function KE({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return n=>{var o,a,s;if((o=n.sourceEvent)!=null&&o.internal)return;const i=gi(n.transform);e.mouseButton=((a=n.sourceEvent)==null?void 0:a.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=i,((s=n.sourceEvent)==null?void 0:s.type)==="mousedown"&&t(!0),r&&(r==null||r(n.sourceEvent,i))}}function WE({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:n,onPanZoom:i}){return o=>{var a,s;e.usedRightMouseButton=!!(r&&j0(t,e.mouseButton??0)),(a=o.sourceEvent)!=null&&a.sync||n([o.transform.x,o.transform.y,o.transform.k]),i&&!((s=o.sourceEvent)!=null&&s.internal)&&(i==null||i(o.sourceEvent,gi(o.transform)))}}function YE({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:i,onPaneContextMenu:o}){return a=>{var s;if(!((s=a.sourceEvent)!=null&&s.internal)&&(e.isZoomingOrPanning=!1,o&&j0(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&o(a.sourceEvent),e.usedRightMouseButton=!1,n(!1),i)){const c=gi(a.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i==null||i(a.sourceEvent,c)},r?150:0)}}}function XE({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:n,panOnScroll:i,zoomOnDoubleClick:o,userSelectionActive:a,noWheelClassName:s,noPanClassName:c,lib:u,connectionInProgress:l}){return d=>{var v;const f=e||t,h=r&&d.ctrlKey,m=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(cr(d,`${u}-flow__node`)||cr(d,`${u}-flow__edge`)))return!0;if(!n&&!f&&!i&&!o&&!r||a||l&&!m||cr(d,s)&&m||cr(d,c)&&(!m||i&&m&&!e)||!r&&d.ctrlKey&&m)return!1;if(!r&&d.type==="touchstart"&&((v=d.touches)==null?void 0:v.length)>1)return d.preventDefault(),!1;if(!f&&!i&&!h&&m||!n&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(n)&&!n.includes(d.button)&&d.type==="mousedown")return!1;const y=Array.isArray(n)&&n.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||m)&&y}}function ZE({domNode:e,minZoom:t,maxZoom:r,translateExtent:n,viewport:i,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:s,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},l=e.getBoundingClientRect(),d=o0().scaleExtent([t,r]).translateExtent(n),f=Fe(e).call(d);b({x:i.x,y:i.y,zoom:vr(i.zoom,t,r)},[[0,0],[l.width,l.height]],n);const h=f.on("wheel.zoom"),m=f.on("dblclick.zoom");d.wheelDelta(M0);function y(R,M){return f?new Promise(F=>{d==null||d.interpolate((M==null?void 0:M.interpolate)==="linear"?Vr:Bn).transform(uo(f,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>F(!0)),R)}):Promise.resolve(!1)}function v({noWheelClassName:R,noPanClassName:M,onPaneContextMenu:F,userSelectionActive:C,panOnScroll:D,panOnDrag:O,panOnScrollMode:q,panOnScrollSpeed:I,preventScrolling:T,zoomOnPinch:V,zoomOnScroll:G,zoomOnDoubleClick:K,zoomActivationKeyPressed:Q,lib:P,onTransformChange:$,connectionInProgress:H,paneClickDistance:B,selectionOnDrag:z}){C&&!u.isZoomingOrPanning&&x();const X=D&&!Q&&!C;d.clickDistance(z?1/0:!Je(B)||B<0?0:B);const te=X?GE({zoomPanValues:u,noWheelClassName:R,d3Selection:f,d3Zoom:d,panOnScrollMode:q,panOnScrollSpeed:I,zoomOnPinch:V,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:s}):UE({noWheelClassName:R,preventScrolling:T,d3ZoomHandler:h});if(f.on("wheel.zoom",te,{passive:!1}),!C){const re=KE({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:a});d.on("start",re);const ne=WE({zoomPanValues:u,panOnDrag:O,onPaneContextMenu:!!F,onPanZoom:o,onTransformChange:$});d.on("zoom",ne);const Z=YE({zoomPanValues:u,panOnDrag:O,panOnScroll:D,onPaneContextMenu:F,onPanZoomEnd:s,onDraggingChange:c});d.on("end",Z)}const ee=XE({zoomActivationKeyPressed:Q,panOnDrag:O,zoomOnScroll:G,panOnScroll:D,zoomOnDoubleClick:K,zoomOnPinch:V,userSelectionActive:C,noPanClassName:M,noWheelClassName:R,lib:P,connectionInProgress:H});d.filter(ee),K?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function x(){d.on("zoom",null)}async function b(R,M,F){const C=co(R),D=d==null?void 0:d.constrain()(C,M,F);return D&&await y(D),new Promise(O=>O(D))}async function p(R,M){const F=co(R);return await y(F,M),new Promise(C=>C(F))}function w(R){if(f){const M=co(R),F=f.property("__zoom");(F.k!==R.zoom||F.x!==R.x||F.y!==R.y)&&(d==null||d.transform(f,M,null,{sync:!0}))}}function S(){const R=f?i0(f.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function _(R,M){return f?new Promise(F=>{d==null||d.interpolate((M==null?void 0:M.interpolate)==="linear"?Vr:Bn).scaleTo(uo(f,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>F(!0)),R)}):Promise.resolve(!1)}function N(R,M){return f?new Promise(F=>{d==null||d.interpolate((M==null?void 0:M.interpolate)==="linear"?Vr:Bn).scaleBy(uo(f,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>F(!0)),R)}):Promise.resolve(!1)}function j(R){d==null||d.scaleExtent(R)}function A(R){d==null||d.translateExtent(R)}function k(R){const M=!Je(R)||R<0?0:R;d==null||d.clickDistance(M)}return{update:v,destroy:x,setViewport:p,setViewportConstrained:b,getViewport:S,scaleTo:_,scaleBy:N,setScaleExtent:j,setTranslateExtent:A,syncViewport:w,setClickDistance:k}}var br;(function(e){e.Line="line",e.Handle="handle"})(br||(br={}));function QE({width:e,prevWidth:t,height:r,prevHeight:n,affectsX:i,affectsY:o}){const a=e-t,s=r-n,c=[a>0?1:a<0?-1:0,s>0?1:s<0?-1:0];return a&&i&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function If(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),n=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:n,affectsY:i}}function It(e,t){return Math.max(0,t-e)}function Rt(e,t){return Math.max(0,e-t)}function On(e,t,r){return Math.max(0,t-e,e-r)}function Rf(e,t){return e?!t:t}function JE(e,t,r,n,i,o,a,s){let{affectsX:c,affectsY:u}=t;const{isHorizontal:l,isVertical:d}=t,f=l&&d,{xSnapped:h,ySnapped:m}=r,{minWidth:y,maxWidth:v,minHeight:x,maxHeight:b}=n,{x:p,y:w,width:S,height:_,aspectRatio:N}=e;let j=Math.floor(l?h-e.pointerX:0),A=Math.floor(d?m-e.pointerY:0);const k=S+(c?-j:j),R=_+(u?-A:A),M=-o[0]*S,F=-o[1]*_;let C=On(k,y,v),D=On(R,x,b);if(a){let I=0,T=0;c&&j<0?I=It(p+j+M,a[0][0]):!c&&j>0&&(I=Rt(p+k+M,a[1][0])),u&&A<0?T=It(w+A+F,a[0][1]):!u&&A>0&&(T=Rt(w+R+F,a[1][1])),C=Math.max(C,I),D=Math.max(D,T)}if(s){let I=0,T=0;c&&j>0?I=Rt(p+j,s[0][0]):!c&&j<0&&(I=It(p+k,s[1][0])),u&&A>0?T=Rt(w+A,s[0][1]):!u&&A<0&&(T=It(w+R,s[1][1])),C=Math.max(C,I),D=Math.max(D,T)}if(i){if(l){const I=On(k/N,x,b)*N;if(C=Math.max(C,I),a){let T=0;!c&&!u||c&&!u&&f?T=Rt(w+F+k/N,a[1][1])*N:T=It(w+F+(c?j:-j)/N,a[0][1])*N,C=Math.max(C,T)}if(s){let T=0;!c&&!u||c&&!u&&f?T=It(w+k/N,s[1][1])*N:T=Rt(w+(c?j:-j)/N,s[0][1])*N,C=Math.max(C,T)}}if(d){const I=On(R*N,y,v)/N;if(D=Math.max(D,I),a){let T=0;!c&&!u||u&&!c&&f?T=Rt(p+R*N+M,a[1][0])/N:T=It(p+(u?A:-A)*N+M,a[0][0])/N,D=Math.max(D,T)}if(s){let T=0;!c&&!u||u&&!c&&f?T=It(p+R*N,s[1][0])/N:T=Rt(p+(u?A:-A)*N,s[0][0])/N,D=Math.max(D,T)}}}A=A+(A<0?D:-D),j=j+(j<0?C:-C),i&&(f?k>R*N?A=(Rf(c,u)?-j:j)/N:j=(Rf(c,u)?-A:A)*N:l?(A=j/N,u=c):(j=A*N,c=u));const O=c?p+j:p,q=u?w+A:w;return{width:S+(c?-j:j),height:_+(u?-A:A),x:o[0]*j*(c?-1:1)+O,y:o[1]*A*(u?-1:1)+q}}const q0={width:0,height:0,x:0,y:0},eC={...q0,pointerX:0,pointerY:0,aspectRatio:1};function tC(e){return[[0,0],[e.measured.width,e.measured.height]]}function rC(e,t,r){const n=t.position.x+e.position.x,i=t.position.y+e.position.y,o=e.measured.width??0,a=e.measured.height??0,s=r[0]*o,c=r[1]*a;return[[n-s,i-c],[n+o-s,i+a-c]]}function nC({domNode:e,nodeId:t,getStoreItems:r,onChange:n,onEnd:i}){const o=Fe(e);let a={controlDirection:If("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function s({controlPosition:u,boundaries:l,keepAspectRatio:d,resizeDirection:f,onResizeStart:h,onResize:m,onResizeEnd:y,shouldResize:v}){let x={...q0},b={...eC};a={boundaries:l,resizeDirection:f,keepAspectRatio:d,controlDirection:If(u)};let p,w=null,S=[],_,N,j,A=!1;const k=Vy().on("start",R=>{const{nodeLookup:M,transform:F,snapGrid:C,snapToGrid:D,nodeOrigin:O,paneDomNode:q}=r();if(p=M.get(t),!p)return;w=(q==null?void 0:q.getBoundingClientRect())??null;const{xSnapped:I,ySnapped:T}=Gr(R.sourceEvent,{transform:F,snapGrid:C,snapToGrid:D,containerBounds:w});x={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},b={...x,pointerX:I,pointerY:T,aspectRatio:x.width/x.height},_=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(_=M.get(p.parentId),N=_&&p.extent==="parent"?tC(_):void 0),S=[],j=void 0;for(const[V,G]of M)if(G.parentId===t&&(S.push({id:V,position:{...G.position},extent:G.extent}),G.extent==="parent"||G.expandParent)){const K=rC(G,p,G.origin??O);j?j=[[Math.min(K[0][0],j[0][0]),Math.min(K[0][1],j[0][1])],[Math.max(K[1][0],j[1][0]),Math.max(K[1][1],j[1][1])]]:j=K}h==null||h(R,{...x})}).on("drag",R=>{const{transform:M,snapGrid:F,snapToGrid:C,nodeOrigin:D}=r(),O=Gr(R.sourceEvent,{transform:M,snapGrid:F,snapToGrid:C,containerBounds:w}),q=[];if(!p)return;const{x:I,y:T,width:V,height:G}=x,K={},Q=p.origin??D,{width:P,height:$,x:H,y:B}=JE(b,a.controlDirection,O,a.boundaries,a.keepAspectRatio,Q,N,j),z=P!==V,X=$!==G,te=H!==I&&z,ee=B!==T&&X;if(!te&&!ee&&!z&&!X)return;if((te||ee||Q[0]===1||Q[1]===1)&&(K.x=te?H:x.x,K.y=ee?B:x.y,x.x=K.x,x.y=K.y,S.length>0)){const se=H-I,le=B-T;for(const ce of S)ce.position={x:ce.position.x-se+Q[0]*(P-V),y:ce.position.y-le+Q[1]*($-G)},q.push(ce)}if((z||X)&&(K.width=z&&(!a.resizeDirection||a.resizeDirection==="horizontal")?P:x.width,K.height=X&&(!a.resizeDirection||a.resizeDirection==="vertical")?$:x.height,x.width=K.width,x.height=K.height),_&&p.expandParent){const se=Q[0]*(K.width??0);K.x&&K.x<se&&(x.x=se,b.x=b.x-(K.x-se));const le=Q[1]*(K.height??0);K.y&&K.y<le&&(x.y=le,b.y=b.y-(K.y-le))}const re=QE({width:x.width,prevWidth:V,height:x.height,prevHeight:G,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),ne={...x,direction:re};(v==null?void 0:v(R,ne))!==!1&&(A=!0,m==null||m(R,ne),n(K,q))}).on("end",R=>{A&&(y==null||y(R,{...x}),i==null||i({...x}),A=!1)});o.call(k)}function c(){o.on(".drag",null)}return{update:s,destroy:c}}const iC={},Tf=e=>{let t;const r=new Set,n=(l,d)=>{const f=typeof l=="function"?l(t):l;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(m=>m(t,h))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>u,subscribe:l=>(r.add(l),()=>r.delete(l)),destroy:()=>{(iC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,i,c);return c},oC=e=>e?Tf(e):Tf,{useDebugValue:aC}=lw,{useSyncExternalStoreWithSelector:sC}=uw,cC=e=>e;function P0(e,t=cC,r){const n=sC(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return aC(n),n}const Af=(e,t)=>{const r=oC(e),n=(i,o=t)=>P0(r,i,o);return Object.assign(n,r),n},uC=(e,t)=>e?Af(e,t):Af;function he(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}const mi=E.createContext(null),lC=mi.Provider,L0=lt.error001();function de(e,t){const r=E.useContext(mi);if(r===null)throw new Error(L0);return P0(r,e,t)}function pe(){const e=E.useContext(mi);if(e===null)throw new Error(L0);return E.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const kf={display:"none"},dC={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},O0="react-flow__node-desc",D0="react-flow__edge-desc",fC="react-flow__aria-live",hC=e=>e.ariaLiveMessage,pC=e=>e.ariaLabelConfig;function gC({rfId:e}){const t=de(hC);return g.jsx("div",{id:`${fC}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:dC,children:t})}function mC({rfId:e,disableKeyboardA11y:t}){const r=de(pC);return g.jsxs(g.Fragment,{children:[g.jsx("div",{id:`${O0}-${e}`,style:kf,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),g.jsx("div",{id:`${D0}-${e}`,style:kf,children:r["edge.a11yDescription.default"]}),!t&&g.jsx(gC,{rfId:e})]})}const dn=E.forwardRef(({position:e="top-left",children:t,className:r,style:n,...i},o)=>{const a=`${e}`.split("-");return g.jsx("div",{className:be(["react-flow__panel",r,...a]),style:n,ref:o,...i,children:t})});dn.displayName="Panel";function vC({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:g.jsx(dn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:g.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const yC=e=>{const t=[],r=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,n]of e.edgeLookup)n.selected&&r.push(n);return{selectedNodes:t,selectedEdges:r}},Dn=e=>e.id;function xC(e,t){return he(e.selectedNodes.map(Dn),t.selectedNodes.map(Dn))&&he(e.selectedEdges.map(Dn),t.selectedEdges.map(Dn))}function bC({onSelectionChange:e}){const t=pe(),{selectedNodes:r,selectedEdges:n}=de(yC,xC);return E.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChangeHandlers.forEach(o=>o(i))},[r,n,e]),null}const wC=e=>!!e.onSelectionChangeHandlers;function _C({onSelectionChange:e}){const t=de(wC);return e||t?g.jsx(bC,{onSelectionChange:e}):null}const F0=[0,0],NC={x:0,y:0,zoom:1},SC=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],jf=[...SC,"rfId"],EC=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Mf={translateExtent:Qr,nodeOrigin:F0,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function CC(e){const{setNodes:t,setEdges:r,setMinZoom:n,setMaxZoom:i,setTranslateExtent:o,setNodeExtent:a,reset:s,setDefaultNodesAndEdges:c}=de(EC,he),u=pe();E.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{l.current=Mf,s()}),[]);const l=E.useRef(Mf);return E.useEffect(()=>{for(const d of jf){const f=e[d],h=l.current[d];f!==h&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?r(f):d==="minZoom"?n(f):d==="maxZoom"?i(f):d==="translateExtent"?o(f):d==="nodeExtent"?a(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:mE(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}l.current=e},jf.map(d=>e[d])),null}function qf(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function IC(e){var n;const[t,r]=E.useState(e==="system"?null:e);return E.useEffect(()=>{if(e!=="system"){r(e);return}const i=qf(),o=()=>r(i!=null&&i.matches?"dark":"light");return o(),i==null||i.addEventListener("change",o),()=>{i==null||i.removeEventListener("change",o)}},[e]),t!==null?t:(n=qf())!=null&&n.matches?"dark":"light"}const Pf=typeof document<"u"?document:null;function rn(e=null,t={target:Pf,actInsideInputWithModifier:!0}){const[r,n]=E.useState(!1),i=E.useRef(!1),o=E.useRef(new Set([])),[a,s]=E.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=u.reduce((d,f)=>d.concat(...f),[]);return[u,l]}return[[],[]]},[e]);return E.useEffect(()=>{const c=(t==null?void 0:t.target)??Pf,u=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const l=h=>{var v,x;if(i.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!i.current||i.current&&!u)&&y0(h))return!1;const y=Of(h.code,s);if(o.current.add(h[y]),Lf(a,o.current,!1)){const b=((x=(v=h.composedPath)==null?void 0:v.call(h))==null?void 0:x[0])||h.target,p=(b==null?void 0:b.nodeName)==="BUTTON"||(b==null?void 0:b.nodeName)==="A";t.preventDefault!==!1&&(i.current||!p)&&h.preventDefault(),n(!0)}},d=h=>{const m=Of(h.code,s);Lf(a,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(h[m]),h.key==="Meta"&&o.current.clear(),i.current=!1},f=()=>{o.current.clear(),n(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,n]),r}function Lf(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function Of(e,t){return t.includes(e)?"code":"key"}const RC=()=>{const e=pe();return E.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:n}=e.getState();return n?n.scaleTo(t,{duration:r==null?void 0:r.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[n,i,o],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??n,y:t.y??i,zoom:t.zoom??o},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,n]=e.getState().transform;return{x:t,y:r,zoom:n}},setCenter:async(t,r,n)=>e.getState().setCenter(t,r,n),fitBounds:async(t,r)=>{const{width:n,height:i,minZoom:o,maxZoom:a,panZoom:s}=e.getState(),c=xd(t,n,i,o,a,(r==null?void 0:r.padding)??.1);return s?(await s.setViewport(c,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:n,snapGrid:i,snapToGrid:o,domNode:a}=e.getState();if(!a)return t;const{x:s,y:c}=a.getBoundingClientRect(),u={x:t.x-s,y:t.y-c},l=r.snapGrid??i,d=r.snapToGrid??o;return ln(u,n,d,l)},flowToScreenPosition:t=>{const{transform:r,domNode:n}=e.getState();if(!n)return t;const{x:i,y:o}=n.getBoundingClientRect(),a=ti(t,r);return{x:a.x+i,y:a.y+o}}}),[])};function $0(e,t){const r=[],n=new Map,i=[];for(const o of e)if(o.type==="add"){i.push(o);continue}else if(o.type==="remove"||o.type==="replace")n.set(o.id,[o]);else{const a=n.get(o.id);a?a.push(o):n.set(o.id,[o])}for(const o of t){const a=n.get(o.id);if(!a){r.push(o);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){r.push({...a[0].item});continue}const s={...o};for(const c of a)TC(c,s);r.push(s)}return i.length&&i.forEach(o=>{o.index!==void 0?r.splice(o.index,0,{...o.item}):r.push({...o.item})}),r}function TC(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function B0(e,t){return $0(e,t)}function z0(e,t){return $0(e,t)}function $t(e,t){return{id:e,type:"select",selected:t}}function ur(e,t=new Set,r=!1){const n=[];for(const[i,o]of e){const a=t.has(i);!(o.selected===void 0&&!a)&&o.selected!==a&&(r&&(o.selected=a),n.push($t(o.id,a)))}return n}function Df({items:e=[],lookup:t}){var i;const r=[],n=new Map(e.map(o=>[o.id,o]));for(const[o,a]of e.entries()){const s=t.get(a.id),c=((i=s==null?void 0:s.internals)==null?void 0:i.userNode)??s;c!==void 0&&c!==a&&r.push({id:a.id,item:a,type:"replace"}),c===void 0&&r.push({item:a,type:"add",index:o})}for(const[o]of t)n.get(o)===void 0&&r.push({id:o,type:"remove"});return r}function Ff(e){return{id:e.id,type:"remove"}}const $f=e=>aE(e),AC=e=>l0(e);function H0(e){return E.forwardRef(e)}const kC=typeof window<"u"?E.useLayoutEffect:E.useEffect;function Bf(e){const[t,r]=E.useState(BigInt(0)),[n]=E.useState(()=>jC(()=>r(i=>i+BigInt(1))));return kC(()=>{const i=n.get();i.length&&(e(i),n.reset())},[t]),n}function jC(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const V0=E.createContext(null);function MC({children:e}){const t=pe(),r=E.useCallback(s=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:l,onNodesChange:d,nodeLookup:f,fitViewQueued:h,onNodesChangeMiddlewareMap:m}=t.getState();let y=c;for(const x of s)y=typeof x=="function"?x(y):x;let v=Df({items:y,lookup:f});for(const x of m.values())v=x(v);l&&u(y),v.length>0?d==null||d(v):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:b,setNodes:p}=t.getState();x&&p(b)})},[]),n=Bf(r),i=E.useCallback(s=>{const{edges:c=[],setEdges:u,hasDefaultEdges:l,onEdgesChange:d,edgeLookup:f}=t.getState();let h=c;for(const m of s)h=typeof m=="function"?m(h):m;l?u(h):d&&d(Df({items:h,lookup:f}))},[]),o=Bf(i),a=E.useMemo(()=>({nodeQueue:n,edgeQueue:o}),[]);return g.jsx(V0.Provider,{value:a,children:e})}function qC(){const e=E.useContext(V0);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const PC=e=>!!e.panZoom;function fn(){const e=RC(),t=pe(),r=qC(),n=de(PC),i=E.useMemo(()=>{const o=d=>t.getState().nodeLookup.get(d),a=d=>{r.nodeQueue.push(d)},s=d=>{r.edgeQueue.push(d)},c=d=>{var x,b;const{nodeLookup:f,nodeOrigin:h}=t.getState(),m=$f(d)?d:f.get(d.id),y=m.parentId?m0(m.position,m.measured,m.parentId,f,h):m.position,v={...m,position:y,width:((x=m.measured)==null?void 0:x.width)??m.width,height:((b=m.measured)==null?void 0:b.height)??m.height};return yr(v)},u=(d,f,h={replace:!1})=>{a(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return h.replace&&$f(v)?v:{...y,...v}}return y}))},l=(d,f,h={replace:!1})=>{s(m=>m.map(y=>{if(y.id===d){const v=typeof f=="function"?f(y):f;return h.replace&&AC(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=o(d))==null?void 0:f.internals.userNode},getInternalNode:o,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:a,setEdges:s,addNodes:d=>{const f=Array.isArray(d)?d:[d];r.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];r.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[m,y,v]=h;return{nodes:d.map(x=>({...x})),edges:f.map(x=>({...x})),viewport:{x:m,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:m,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:x,triggerEdgeChanges:b,onDelete:p,onBeforeDelete:w}=t.getState(),{nodes:S,edges:_}=await dE({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:m,onBeforeDelete:w}),N=_.length>0,j=S.length>0;if(N){const A=_.map(Ff);v==null||v(_),b(A)}if(j){const A=S.map(Ff);y==null||y(S),x(A)}return(j||N)&&(p==null||p({nodes:S,edges:_})),{deletedNodes:S,deletedEdges:_}},getIntersectingNodes:(d,f=!0,h)=>{const m=mf(d),y=m?d:c(d),v=h!==void 0;return y?(h||t.getState().nodes).filter(x=>{const b=t.getState().nodeLookup.get(x.id);if(b&&!m&&(x.id===d.id||!b.internals.positionAbsolute))return!1;const p=yr(v?x:b),w=en(p,y);return f&&w>0||w>=p.width*p.height||w>=y.width*y.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const y=mf(d)?d:c(d);if(!y)return!1;const v=en(y,f);return h&&v>0||v>=f.width*f.height||v>=y.width*y.height},updateNode:u,updateNodeData:(d,f,h={replace:!1})=>{u(d,m=>{const y=typeof f=="function"?f(m):f;return h.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},h)},updateEdge:l,updateEdgeData:(d,f,h={replace:!1})=>{l(d,m=>{const y=typeof f=="function"?f(m):f;return h.replace?{...m,data:y}:{...m,data:{...m.data,...y}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return sE(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:m.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:m.values())??[])},fitView:async d=>{const f=t.getState().fitViewResolver??gE();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),r.nodeQueue.push(h=>[...h]),f.promise}}},[]);return E.useMemo(()=>({...i,...e,viewportInitialized:n}),[n])}const zf=e=>e.selected,LC=typeof window<"u"?window:void 0;function OC({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=pe(),{deleteElements:n}=fn(),i=rn(e,{actInsideInputWithModifier:!1}),o=rn(t,{target:LC});E.useEffect(()=>{if(i){const{edges:a,nodes:s}=r.getState();n({nodes:s.filter(zf),edges:a.filter(zf)}),r.setState({nodesSelectionActive:!1})}},[i]),E.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])}function DC(e){const t=pe();E.useEffect(()=>{const r=()=>{var i,o,a,s;if(!e.current||!(((o=(i=e.current).checkVisibility)==null?void 0:o.call(i))??!0))return!1;const n=bd(e.current);(n.height===0||n.width===0)&&((s=(a=t.getState()).onError)==null||s.call(a,"004",lt.error004())),t.setState({width:n.width||500,height:n.height||500})};if(e.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}},[])}const vi={position:"absolute",width:"100%",height:"100%",top:0,left:0},FC=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function $C({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:i=.5,panOnScrollMode:o=Ht.Free,zoomOnDoubleClick:a=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:u,minZoom:l,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:m,noWheelClassName:y,noPanClassName:v,onViewportChange:x,isControlledViewport:b,paneClickDistance:p,selectionOnDrag:w}){const S=pe(),_=E.useRef(null),{userSelectionActive:N,lib:j,connectionInProgress:A}=de(FC,he),k=rn(f),R=E.useRef();DC(_);const M=E.useCallback(F=>{x==null||x({x:F[0],y:F[1],zoom:F[2]}),b||S.setState({transform:F})},[x,b]);return E.useEffect(()=>{if(_.current){R.current=ZE({domNode:_.current,minZoom:l,maxZoom:d,translateExtent:u,viewport:c,onDraggingChange:O=>S.setState({paneDragging:O}),onPanZoomStart:(O,q)=>{const{onViewportChangeStart:I,onMoveStart:T}=S.getState();T==null||T(O,q),I==null||I(q)},onPanZoom:(O,q)=>{const{onViewportChange:I,onMove:T}=S.getState();T==null||T(O,q),I==null||I(q)},onPanZoomEnd:(O,q)=>{const{onViewportChangeEnd:I,onMoveEnd:T}=S.getState();T==null||T(O,q),I==null||I(q)}});const{x:F,y:C,zoom:D}=R.current.getViewport();return S.setState({panZoom:R.current,transform:[F,C,D],domNode:_.current.closest(".react-flow")}),()=>{var O;(O=R.current)==null||O.destroy()}}},[]),E.useEffect(()=>{var F;(F=R.current)==null||F.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:i,panOnScrollMode:o,zoomOnDoubleClick:a,panOnDrag:s,zoomActivationKeyPressed:k,preventScrolling:h,noPanClassName:v,userSelectionActive:N,noWheelClassName:y,lib:j,onTransformChange:M,connectionInProgress:A,selectionOnDrag:w,paneClickDistance:p})},[e,t,r,n,i,o,a,s,k,h,v,N,y,j,M,A,w,p]),g.jsx("div",{className:"react-flow__renderer",ref:_,style:vi,children:m})}const BC=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function zC(){const{userSelectionActive:e,userSelectionRect:t}=de(BC,he);return e&&t?g.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const lo=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},HC=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function VC({isSelecting:e,selectionKeyPressed:t,selectionMode:r=Jr.Full,panOnDrag:n,paneClickDistance:i,selectionOnDrag:o,onSelectionStart:a,onSelectionEnd:s,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:h,children:m}){const y=pe(),{userSelectionActive:v,elementsSelectable:x,dragging:b,connectionInProgress:p}=de(HC,he),w=x&&(e||v),S=E.useRef(null),_=E.useRef(),N=E.useRef(new Set),j=E.useRef(new Set),A=E.useRef(!1),k=I=>{if(A.current||p){A.current=!1;return}c==null||c(I),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},R=I=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){I.preventDefault();return}u==null||u(I)},M=l?I=>l(I):void 0,F=I=>{A.current&&(I.stopPropagation(),A.current=!1)},C=I=>{var $,H;const{domNode:T}=y.getState();if(_.current=T==null?void 0:T.getBoundingClientRect(),!_.current)return;const V=I.target===S.current;if(!V&&!!I.target.closest(".nokey")||!e||!(o&&V||t)||I.button!==0||!I.isPrimary)return;(H=($=I.target)==null?void 0:$.setPointerCapture)==null||H.call($,I.pointerId),A.current=!1;const{x:Q,y:P}=et(I.nativeEvent,_.current);y.setState({userSelectionRect:{width:0,height:0,startX:Q,startY:P,x:Q,y:P}}),V||(I.stopPropagation(),I.preventDefault())},D=I=>{const{userSelectionRect:T,transform:V,nodeLookup:G,edgeLookup:K,connectionLookup:Q,triggerNodeChanges:P,triggerEdgeChanges:$,defaultEdgeOptions:H,resetSelectedElements:B}=y.getState();if(!_.current||!T)return;const{x:z,y:X}=et(I.nativeEvent,_.current),{startX:te,startY:ee}=T;if(!A.current){const le=t?0:i;if(Math.hypot(z-te,X-ee)<=le)return;B(),a==null||a(I)}A.current=!0;const re={startX:te,startY:ee,x:z<te?z:te,y:X<ee?X:ee,width:Math.abs(z-te),height:Math.abs(X-ee)},ne=N.current,Z=j.current;N.current=new Set(yd(G,re,V,r===Jr.Partial,!0).map(le=>le.id)),j.current=new Set;const se=(H==null?void 0:H.selectable)??!0;for(const le of N.current){const ce=Q.get(le);if(ce)for(const{edgeId:_e}of ce.values()){const Ne=K.get(_e);Ne&&(Ne.selectable??se)&&j.current.add(_e)}}if(!vf(ne,N.current)){const le=ur(G,N.current,!0);P(le)}if(!vf(Z,j.current)){const le=ur(K,j.current);$(le)}y.setState({userSelectionRect:re,userSelectionActive:!0,nodesSelectionActive:!1})},O=I=>{var T,V;I.button===0&&((V=(T=I.target)==null?void 0:T.releasePointerCapture)==null||V.call(T,I.pointerId),!v&&I.target===S.current&&y.getState().userSelectionRect&&(k==null||k(I)),y.setState({userSelectionActive:!1,userSelectionRect:null}),A.current&&(s==null||s(I),y.setState({nodesSelectionActive:N.current.size>0})))},q=n===!0||Array.isArray(n)&&n.includes(0);return g.jsxs("div",{className:be(["react-flow__pane",{draggable:q,dragging:b,selection:e}]),onClick:w?void 0:lo(k,S),onContextMenu:lo(R,S),onWheel:lo(M,S),onPointerEnter:w?void 0:d,onPointerMove:w?D:f,onPointerUp:w?O:void 0,onPointerDownCapture:w?C:void 0,onClickCapture:w?F:void 0,onPointerLeave:h,ref:S,style:vi,children:[m,g.jsx(zC,{})]})}function Kl({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:a,nodeLookup:s,onError:c}=t.getState(),u=s.get(e);if(!u){c==null||c("012",lt.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&a)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var l;return(l=n==null?void 0:n.current)==null?void 0:l.blur()})):i([e])}function G0({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:o,nodeClickDistance:a}){const s=pe(),[c,u]=E.useState(!1),l=E.useRef();return E.useEffect(()=>{l.current=OE({getStoreItems:()=>s.getState(),onNodeMouseDown:d=>{Kl({id:d,store:s,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),E.useEffect(()=>{var d,f;if(t)(d=l.current)==null||d.destroy();else if(e.current)return(f=l.current)==null||f.update({noDragClassName:r,handleSelector:n,domNode:e.current,isSelectable:o,nodeId:i,nodeClickDistance:a}),()=>{var h;(h=l.current)==null||h.destroy()}},[r,n,t,o,e,i]),c}const GC=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function U0(){const e=pe();return E.useCallback(r=>{const{nodeExtent:n,snapToGrid:i,snapGrid:o,nodesDraggable:a,onError:s,updateNodePositions:c,nodeLookup:u,nodeOrigin:l}=e.getState(),d=new Map,f=GC(a),h=i?o[0]:5,m=i?o[1]:5,y=r.direction.x*h*r.factor,v=r.direction.y*m*r.factor;for(const[,x]of u){if(!f(x))continue;let b={x:x.internals.positionAbsolute.x+y,y:x.internals.positionAbsolute.y+v};i&&(b=un(b,o));const{position:p,positionAbsolute:w}=d0({nodeId:x.id,nextPosition:b,nodeLookup:u,nodeExtent:n,nodeOrigin:l,onError:s});x.position=p,x.internals.positionAbsolute=w,d.set(x.id,x)}c(d)},[])}const Cd=E.createContext(null),UC=Cd.Provider;Cd.Consumer;const K0=()=>E.useContext(Cd),KC=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),WC=(e,t,r)=>n=>{const{connectionClickStartHandle:i,connectionMode:o,connection:a}=n,{fromHandle:s,toHandle:c,isValid:u}=a,l=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===r;return{connectingFrom:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===r,connectingTo:l,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===r,isPossibleEndHandle:o===gr.Strict?(s==null?void 0:s.type)!==r:e!==(s==null?void 0:s.nodeId)||t!==(s==null?void 0:s.id),connectionInProcess:!!s,clickConnectionInProcess:!!i,valid:l&&u}};function YC({type:e="source",position:t=ae.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:o=!0,id:a,onConnect:s,children:c,className:u,onMouseDown:l,onTouchStart:d,...f},h){var D,O;const m=a||null,y=e==="target",v=pe(),x=K0(),{connectOnClick:b,noPanClassName:p,rfId:w}=de(KC,he),{connectingFrom:S,connectingTo:_,clickConnecting:N,isPossibleEndHandle:j,connectionInProcess:A,clickConnectionInProcess:k,valid:R}=de(WC(x,m,e),he);x||(O=(D=v.getState()).onError)==null||O.call(D,"010",lt.error010());const M=q=>{const{defaultEdgeOptions:I,onConnect:T,hasDefaultEdges:V}=v.getState(),G={...I,...q};if(V){const{edges:K,setEdges:Q}=v.getState();Q(zl(G,K))}T==null||T(G),s==null||s(G)},F=q=>{if(!x)return;const I=x0(q.nativeEvent);if(i&&(I&&q.button===0||!I)){const T=v.getState();Ul.onPointerDown(q.nativeEvent,{handleDomNode:q.currentTarget,autoPanOnConnect:T.autoPanOnConnect,connectionMode:T.connectionMode,connectionRadius:T.connectionRadius,domNode:T.domNode,nodeLookup:T.nodeLookup,lib:T.lib,isTarget:y,handleId:m,nodeId:x,flowId:T.rfId,panBy:T.panBy,cancelConnection:T.cancelConnection,onConnectStart:T.onConnectStart,onConnectEnd:T.onConnectEnd,updateConnection:T.updateConnection,onConnect:M,isValidConnection:r||T.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:T.autoPanSpeed,dragThreshold:T.connectionDragThreshold})}I?l==null||l(q):d==null||d(q)},C=q=>{const{onClickConnectStart:I,onClickConnectEnd:T,connectionClickStartHandle:V,connectionMode:G,isValidConnection:K,lib:Q,rfId:P,nodeLookup:$,connection:H}=v.getState();if(!x||!V&&!i)return;if(!V){I==null||I(q.nativeEvent,{nodeId:x,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:x,type:e,id:m}});return}const B=v0(q.target),z=r||K,{connection:X,isValid:te}=Ul.isValid(q.nativeEvent,{handle:{nodeId:x,id:m,type:e},connectionMode:G,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:z,flowId:P,doc:B,lib:Q,nodeLookup:$});te&&X&&M(X);const ee=structuredClone(H);delete ee.inProgress,ee.toPosition=ee.toHandle?ee.toHandle.position:null,T==null||T(q,ee),v.setState({connectionClickStartHandle:null})};return g.jsx("div",{"data-handleid":m,"data-nodeid":x,"data-handlepos":t,"data-id":`${w}-${x}-${m}-${e}`,className:be(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,u,{source:!y,target:y,connectable:n,connectablestart:i,connectableend:o,clickconnecting:N,connectingfrom:S,connectingto:_,valid:R,connectionindicator:n&&(!A||j)&&(A||k?o:i)}]),onMouseDown:F,onTouchStart:F,onClick:b?C:void 0,ref:h,...f,children:c})}const Te=E.memo(H0(YC));function XC({data:e,isConnectable:t,sourcePosition:r=ae.Bottom}){return g.jsxs(g.Fragment,{children:[e==null?void 0:e.label,g.jsx(Te,{type:"source",position:r,isConnectable:t})]})}function ZC({data:e,isConnectable:t,targetPosition:r=ae.Top,sourcePosition:n=ae.Bottom}){return g.jsxs(g.Fragment,{children:[g.jsx(Te,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,g.jsx(Te,{type:"source",position:n,isConnectable:t})]})}function QC(){return null}function JC({data:e,isConnectable:t,targetPosition:r=ae.Top}){return g.jsxs(g.Fragment,{children:[g.jsx(Te,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label]})}const ri={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Hf={input:XC,default:ZC,output:JC,group:QC};function eI(e){var t,r,n,i;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((r=e.style)==null?void 0:r.height)}:{width:e.width??((n=e.style)==null?void 0:n.width),height:e.height??((i=e.style)==null?void 0:i.height)}}const tI=e=>{const{width:t,height:r,x:n,y:i}=cn(e.nodeLookup,{filter:o=>!!o.selected});return{width:Je(t)?t:null,height:Je(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${n}px,${i}px)`}};function rI({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=pe(),{width:i,height:o,transformString:a,userSelectionActive:s}=de(tI,he),c=U0(),u=E.useRef(null);if(E.useEffect(()=>{var f;r||(f=u.current)==null||f.focus({preventScroll:!0})},[r]),G0({nodeRef:u}),s||!i||!o)return null;const l=e?f=>{const h=n.getState().nodes.filter(m=>m.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(ri,f.key)&&(f.preventDefault(),c({direction:ri[f.key],factor:f.shiftKey?4:1}))};return g.jsx("div",{className:be(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:g.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:l,tabIndex:r?void 0:-1,onKeyDown:r?void 0:d,style:{width:i,height:o}})})}const Vf=typeof window<"u"?window:void 0,nI=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function W0({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:l,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:w,panOnScrollSpeed:S,panOnScrollMode:_,zoomOnDoubleClick:N,panOnDrag:j,defaultViewport:A,translateExtent:k,minZoom:R,maxZoom:M,preventScrolling:F,onSelectionContextMenu:C,noWheelClassName:D,noPanClassName:O,disableKeyboardA11y:q,onViewportChange:I,isControlledViewport:T}){const{nodesSelectionActive:V,userSelectionActive:G}=de(nI,he),K=rn(u,{target:Vf}),Q=rn(y,{target:Vf}),P=Q||j,$=Q||w,H=l&&P!==!0,B=K||G||H;return OC({deleteKeyCode:c,multiSelectionKeyCode:m}),g.jsx($C,{onPaneContextMenu:o,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:$,panOnScrollSpeed:S,panOnScrollMode:_,zoomOnDoubleClick:N,panOnDrag:!K&&P,defaultViewport:A,translateExtent:k,minZoom:R,maxZoom:M,zoomActivationKeyCode:v,preventScrolling:F,noWheelClassName:D,noPanClassName:O,onViewportChange:I,isControlledViewport:T,paneClickDistance:s,selectionOnDrag:H,children:g.jsxs(VC,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:P,isSelecting:!!B,selectionMode:d,selectionKeyPressed:K,paneClickDistance:s,selectionOnDrag:H,children:[e,V&&g.jsx(rI,{onSelectionContextMenu:C,noPanClassName:O,disableKeyboardA11y:q})]})})}W0.displayName="FlowRenderer";const iI=E.memo(W0),oI=e=>t=>e?yd(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function aI(e){return de(E.useCallback(oI(e),[e]),he)}const sI=e=>e.updateNodeInternals;function cI(){const e=de(sI),[t]=E.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(i=>{const o=i.target.getAttribute("data-id");n.set(o,{id:o,nodeElement:i.target,force:!0})}),e(n)}));return E.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function uI({node:e,nodeType:t,hasDimensions:r,resizeObserver:n}){const i=pe(),o=E.useRef(null),a=E.useRef(null),s=E.useRef(e.sourcePosition),c=E.useRef(e.targetPosition),u=E.useRef(t),l=r&&!!e.internals.handleBounds;return E.useEffect(()=>{o.current&&!e.hidden&&(!l||a.current!==o.current)&&(a.current&&(n==null||n.unobserve(a.current)),n==null||n.observe(o.current),a.current=o.current)},[l,e.hidden]),E.useEffect(()=>()=>{a.current&&(n==null||n.unobserve(a.current),a.current=null)},[]),E.useEffect(()=>{if(o.current){const d=u.current!==t,f=s.current!==e.sourcePosition,h=c.current!==e.targetPosition;(d||f||h)&&(u.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function lI({id:e,onClick:t,onMouseEnter:r,onMouseMove:n,onMouseLeave:i,onContextMenu:o,onDoubleClick:a,nodesDraggable:s,elementsSelectable:c,nodesConnectable:u,nodesFocusable:l,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:m,rfId:y,nodeTypes:v,nodeClickDistance:x,onError:b}){const{node:p,internals:w,isParent:S}=de(z=>{const X=z.nodeLookup.get(e),te=z.parentLookup.has(e);return{node:X,internals:X.internals,isParent:te}},he);let _=p.type||"default",N=(v==null?void 0:v[_])||Hf[_];N===void 0&&(b==null||b("003",lt.error003(_)),_="default",N=(v==null?void 0:v.default)||Hf.default);const j=!!(p.draggable||s&&typeof p.draggable>"u"),A=!!(p.selectable||c&&typeof p.selectable>"u"),k=!!(p.connectable||u&&typeof p.connectable>"u"),R=!!(p.focusable||l&&typeof p.focusable>"u"),M=pe(),F=g0(p),C=uI({node:p,nodeType:_,hasDimensions:F,resizeObserver:d}),D=G0({nodeRef:C,disabled:p.hidden||!j,noDragClassName:f,handleSelector:p.dragHandle,nodeId:e,isSelectable:A,nodeClickDistance:x}),O=U0();if(p.hidden)return null;const q=xt(p),I=eI(p),T=A||j||t||r||n||i,V=r?z=>r(z,{...w.userNode}):void 0,G=n?z=>n(z,{...w.userNode}):void 0,K=i?z=>i(z,{...w.userNode}):void 0,Q=o?z=>o(z,{...w.userNode}):void 0,P=a?z=>a(z,{...w.userNode}):void 0,$=z=>{const{selectNodesOnDrag:X,nodeDragThreshold:te}=M.getState();A&&(!X||!j||te>0)&&Kl({id:e,store:M,nodeRef:C}),t&&t(z,{...w.userNode})},H=z=>{if(!(y0(z.nativeEvent)||m)){if(a0.includes(z.key)&&A){const X=z.key==="Escape";Kl({id:e,store:M,unselect:X,nodeRef:C})}else if(j&&p.selected&&Object.prototype.hasOwnProperty.call(ri,z.key)){z.preventDefault();const{ariaLabelConfig:X}=M.getState();M.setState({ariaLiveMessage:X["node.a11yDescription.ariaLiveMessage"]({direction:z.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),O({direction:ri[z.key],factor:z.shiftKey?4:1})}}},B=()=>{var Z;if(m||!((Z=C.current)!=null&&Z.matches(":focus-visible")))return;const{transform:z,width:X,height:te,autoPanOnNodeFocus:ee,setCenter:re}=M.getState();if(!ee)return;yd(new Map([[e,p]]),{x:0,y:0,width:X,height:te},z,!0).length>0||re(p.position.x+q.width/2,p.position.y+q.height/2,{zoom:z[2]})};return g.jsx("div",{className:be(["react-flow__node",`react-flow__node-${_}`,{[h]:j},p.className,{selected:p.selected,selectable:A,parent:S,draggable:j,dragging:D}]),ref:C,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:T?"all":"none",visibility:F?"visible":"hidden",...p.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:G,onMouseLeave:K,onContextMenu:Q,onClick:$,onDoubleClick:P,onKeyDown:R?H:void 0,tabIndex:R?0:void 0,onFocus:R?B:void 0,role:p.ariaRole??(R?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${O0}-${y}`,"aria-label":p.ariaLabel,...p.domAttributes,children:g.jsx(UC,{value:e,children:g.jsx(N,{id:e,data:p.data,type:_,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:p.selected??!1,selectable:A,draggable:j,deletable:p.deletable??!0,isConnectable:k,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:D,dragHandle:p.dragHandle,zIndex:w.z,parentId:p.parentId,...q})})})}var dI=E.memo(lI);const fI=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Y0(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,onError:o}=de(fI,he),a=aI(e.onlyRenderVisibleElements),s=cI();return g.jsx("div",{className:"react-flow__nodes",style:vi,children:a.map(c=>g.jsx(dI,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}Y0.displayName="NodeRenderer";const hI=E.memo(Y0);function pI(e){return de(E.useCallback(r=>{if(!e)return r.edges.map(i=>i.id);const n=[];if(r.width&&r.height)for(const i of r.edges){const o=r.nodeLookup.get(i.source),a=r.nodeLookup.get(i.target);o&&a&&xE({sourceNode:o,targetNode:a,width:r.width,height:r.height,transform:r.transform})&&n.push(i.id)}return n},[e]),he)}const gI=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return g.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},mI=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return g.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Gf={[mr.Arrow]:gI,[mr.ArrowClosed]:mI};function vI(e){const t=pe();return E.useMemo(()=>{var i,o;return Object.prototype.hasOwnProperty.call(Gf,e)?Gf[e]:((o=(i=t.getState()).onError)==null||o.call(i,"009",lt.error009(e)),null)},[e])}const yI=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:s="auto-start-reverse"})=>{const c=vI(t);return c?g.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:g.jsx(c,{color:r,strokeWidth:a})}):null},X0=({defaultColor:e,rfId:t})=>{const r=de(o=>o.edges),n=de(o=>o.defaultEdgeOptions),i=E.useMemo(()=>CE(r,{id:t,defaultColor:e,defaultMarkerStart:n==null?void 0:n.markerStart,defaultMarkerEnd:n==null?void 0:n.markerEnd}),[r,n,t,e]);return i.length?g.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:g.jsx("defs",{children:i.map(o=>g.jsx(yI,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};X0.displayName="MarkerDefinitions";var xI=E.memo(X0);function Z0({x:e,y:t,label:r,labelStyle:n,labelShowBg:i=!0,labelBgStyle:o,labelBgPadding:a=[2,4],labelBgBorderRadius:s=2,children:c,className:u,...l}){const[d,f]=E.useState({x:1,y:0,width:0,height:0}),h=be(["react-flow__edge-textwrapper",u]),m=E.useRef(null);return E.useEffect(()=>{if(m.current){const y=m.current.getBBox();f({x:y.x,y:y.y,width:y.width,height:y.height})}},[r]),r?g.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...l,children:[i&&g.jsx("rect",{width:d.width+2*a[0],x:-a[0],y:-a[1],height:d.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),g.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:m,style:n,children:r}),c]}):null}Z0.displayName="EdgeText";const bI=E.memo(Z0);function yi({path:e,labelX:t,labelY:r,label:n,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c,interactionWidth:u=20,...l}){return g.jsxs(g.Fragment,{children:[g.jsx("path",{...l,d:e,fill:"none",className:be(["react-flow__edge-path",l.className])}),u?g.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,n&&Je(t)&&Je(r)?g.jsx(bI,{x:t,y:r,label:n,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c}):null]})}function Uf({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===ae.Left||e===ae.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function Q0({sourceX:e,sourceY:t,sourcePosition:r=ae.Bottom,targetX:n,targetY:i,targetPosition:o=ae.Top}){const[a,s]=Uf({pos:r,x1:e,y1:t,x2:n,y2:i}),[c,u]=Uf({pos:o,x1:n,y1:i,x2:e,y2:t}),[l,d,f,h]=b0({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:a,sourceControlY:s,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${s} ${c},${u} ${n},${i}`,l,d,f,h]}function J0(e){return E.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,sourcePosition:a,targetPosition:s,label:c,labelStyle:u,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:v,interactionWidth:x})=>{const[b,p,w]=Q0({sourceX:r,sourceY:n,sourcePosition:a,targetX:i,targetY:o,targetPosition:s}),S=e.isInternal?void 0:t;return g.jsx(yi,{id:S,path:b,labelX:p,labelY:w,label:c,labelStyle:u,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:v,interactionWidth:x})})}const wI=J0({isInternal:!1}),ex=J0({isInternal:!0});wI.displayName="SimpleBezierEdge";ex.displayName="SimpleBezierEdgeInternal";function tx(e){return E.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:f,sourcePosition:h=ae.Bottom,targetPosition:m=ae.Top,markerEnd:y,markerStart:v,pathOptions:x,interactionWidth:b})=>{const[p,w,S]=Hl({sourceX:r,sourceY:n,sourcePosition:h,targetX:i,targetY:o,targetPosition:m,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset,stepPosition:x==null?void 0:x.stepPosition}),_=e.isInternal?void 0:t;return g.jsx(yi,{id:_,path:p,labelX:w,labelY:S,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:v,interactionWidth:b})})}const rx=tx({isInternal:!1}),nx=tx({isInternal:!0});rx.displayName="SmoothStepEdge";nx.displayName="SmoothStepEdgeInternal";function ix(e){return E.memo(({id:t,...r})=>{var i;const n=e.isInternal?void 0:t;return g.jsx(rx,{...r,id:n,pathOptions:E.useMemo(()=>{var o;return{borderRadius:0,offset:(o=r.pathOptions)==null?void 0:o.offset}},[(i=r.pathOptions)==null?void 0:i.offset])})})}const _I=ix({isInternal:!1}),ox=ix({isInternal:!0});_I.displayName="StepEdge";ox.displayName="StepEdgeInternal";function ax(e){return E.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:m,interactionWidth:y})=>{const[v,x,b]=N0({sourceX:r,sourceY:n,targetX:i,targetY:o}),p=e.isInternal?void 0:t;return g.jsx(yi,{id:p,path:v,labelX:x,labelY:b,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:m,interactionWidth:y})})}const NI=ax({isInternal:!1}),sx=ax({isInternal:!0});NI.displayName="StraightEdge";sx.displayName="StraightEdgeInternal";function cx(e){return E.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:o,sourcePosition:a=ae.Bottom,targetPosition:s=ae.Top,label:c,labelStyle:u,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:v,pathOptions:x,interactionWidth:b})=>{const[p,w,S]=w0({sourceX:r,sourceY:n,sourcePosition:a,targetX:i,targetY:o,targetPosition:s,curvature:x==null?void 0:x.curvature}),_=e.isInternal?void 0:t;return g.jsx(yi,{id:_,path:p,labelX:w,labelY:S,label:c,labelStyle:u,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:v,interactionWidth:b})})}const SI=cx({isInternal:!1}),ux=cx({isInternal:!0});SI.displayName="BezierEdge";ux.displayName="BezierEdgeInternal";const Kf={default:ux,straight:sx,step:ox,smoothstep:nx,simplebezier:ex},Wf={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},EI=(e,t,r)=>r===ae.Left?e-t:r===ae.Right?e+t:e,CI=(e,t,r)=>r===ae.Top?e-t:r===ae.Bottom?e+t:e,Yf="react-flow__edgeupdater";function Xf({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:o,onMouseOut:a,type:s}){return g.jsx("circle",{onMouseDown:i,onMouseEnter:o,onMouseOut:a,className:be([Yf,`${Yf}-${s}`]),cx:EI(t,n,e),cy:CI(r,n,e),r:n,stroke:"transparent",fill:"transparent"})}function II({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:n,sourceY:i,targetX:o,targetY:a,sourcePosition:s,targetPosition:c,onReconnect:u,onReconnectStart:l,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const m=pe(),y=(w,S)=>{if(w.button!==0)return;const{autoPanOnConnect:_,domNode:N,isValidConnection:j,connectionMode:A,connectionRadius:k,lib:R,onConnectStart:M,onConnectEnd:F,cancelConnection:C,nodeLookup:D,rfId:O,panBy:q,updateConnection:I}=m.getState(),T=S.type==="target",V=(Q,P)=>{f(!1),d==null||d(Q,r,S.type,P)},G=Q=>u==null?void 0:u(r,Q),K=(Q,P)=>{f(!0),l==null||l(w,r,S.type),M==null||M(Q,P)};Ul.onPointerDown(w.nativeEvent,{autoPanOnConnect:_,connectionMode:A,connectionRadius:k,domNode:N,handleId:S.id,nodeId:S.nodeId,nodeLookup:D,isTarget:T,edgeUpdaterType:S.type,lib:R,flowId:O,cancelConnection:C,panBy:q,isValidConnection:j,onConnect:G,onConnectStart:K,onConnectEnd:F,onReconnectEnd:V,updateConnection:I,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},v=w=>y(w,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),x=w=>y(w,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),b=()=>h(!0),p=()=>h(!1);return g.jsxs(g.Fragment,{children:[(e===!0||e==="source")&&g.jsx(Xf,{position:s,centerX:n,centerY:i,radius:t,onMouseDown:v,onMouseEnter:b,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&g.jsx(Xf,{position:c,centerX:o,centerY:a,radius:t,onMouseDown:x,onMouseEnter:b,onMouseOut:p,type:"target"})]})}function RI({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:n,onClick:i,onDoubleClick:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,reconnectRadius:l,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:m,edgeTypes:y,noPanClassName:v,onError:x,disableKeyboardA11y:b}){let p=de(re=>re.edgeLookup.get(e));const w=de(re=>re.defaultEdgeOptions);p=w?{...w,...p}:p;let S=p.type||"default",_=(y==null?void 0:y[S])||Kf[S];_===void 0&&(x==null||x("011",lt.error011(S)),S="default",_=(y==null?void 0:y.default)||Kf.default);const N=!!(p.focusable||t&&typeof p.focusable>"u"),j=typeof d<"u"&&(p.reconnectable||r&&typeof p.reconnectable>"u"),A=!!(p.selectable||n&&typeof p.selectable>"u"),k=E.useRef(null),[R,M]=E.useState(!1),[F,C]=E.useState(!1),D=pe(),{zIndex:O,sourceX:q,sourceY:I,targetX:T,targetY:V,sourcePosition:G,targetPosition:K}=de(E.useCallback(re=>{const ne=re.nodeLookup.get(p.source),Z=re.nodeLookup.get(p.target);if(!ne||!Z)return{zIndex:p.zIndex,...Wf};const se=EE({id:e,sourceNode:ne,targetNode:Z,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:re.connectionMode,onError:x});return{zIndex:yE({selected:p.selected,zIndex:p.zIndex,sourceNode:ne,targetNode:Z,elevateOnSelect:re.elevateEdgesOnSelect,zIndexMode:re.zIndexMode}),...se||Wf}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),he),Q=E.useMemo(()=>p.markerStart?`url('#${Vl(p.markerStart,m)}')`:void 0,[p.markerStart,m]),P=E.useMemo(()=>p.markerEnd?`url('#${Vl(p.markerEnd,m)}')`:void 0,[p.markerEnd,m]);if(p.hidden||q===null||I===null||T===null||V===null)return null;const $=re=>{var le;const{addSelectedEdges:ne,unselectNodesAndEdges:Z,multiSelectionActive:se}=D.getState();A&&(D.setState({nodesSelectionActive:!1}),p.selected&&se?(Z({nodes:[],edges:[p]}),(le=k.current)==null||le.blur()):ne([e])),i&&i(re,p)},H=o?re=>{o(re,{...p})}:void 0,B=a?re=>{a(re,{...p})}:void 0,z=s?re=>{s(re,{...p})}:void 0,X=c?re=>{c(re,{...p})}:void 0,te=u?re=>{u(re,{...p})}:void 0,ee=re=>{var ne;if(!b&&a0.includes(re.key)&&A){const{unselectNodesAndEdges:Z,addSelectedEdges:se}=D.getState();re.key==="Escape"?((ne=k.current)==null||ne.blur(),Z({edges:[p]})):se([e])}};return g.jsx("svg",{style:{zIndex:O},children:g.jsxs("g",{className:be(["react-flow__edge",`react-flow__edge-${S}`,p.className,v,{selected:p.selected,animated:p.animated,inactive:!A&&!i,updating:R,selectable:A}]),onClick:$,onDoubleClick:H,onContextMenu:B,onMouseEnter:z,onMouseMove:X,onMouseLeave:te,onKeyDown:N?ee:void 0,tabIndex:N?0:void 0,role:p.ariaRole??(N?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":N?`${D0}-${m}`:void 0,ref:k,...p.domAttributes,children:[!F&&g.jsx(_,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:A,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:q,sourceY:I,targetX:T,targetY:V,sourcePosition:G,targetPosition:K,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:Q,markerEnd:P,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),j&&g.jsx(II,{edge:p,isReconnectable:j,reconnectRadius:l,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:q,sourceY:I,targetX:T,targetY:V,sourcePosition:G,targetPosition:K,setUpdateHover:M,setReconnecting:C})]})})}var TI=E.memo(RI);const AI=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function lx({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:n,noPanClassName:i,onReconnect:o,onEdgeContextMenu:a,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:b,onError:p}=de(AI,he),w=pI(t);return g.jsxs("div",{className:"react-flow__edges",children:[g.jsx(xI,{defaultColor:e,rfId:r}),w.map(S=>g.jsx(TI,{id:S,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:b,noPanClassName:i,onReconnect:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,onClick:l,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,rfId:r,onError:p,edgeTypes:n,disableKeyboardA11y:y},S))]})}lx.displayName="EdgeRenderer";const kI=E.memo(lx),jI=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function MI({children:e}){const t=de(jI);return g.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function qI(e){const t=fn(),r=E.useRef(!1);E.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const PI=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function LI(e){const t=de(PI),r=pe();return E.useEffect(()=>{e&&(t==null||t(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function OI(e){return e.connection.inProgress?{...e.connection,to:ln(e.connection.to,e.transform)}:{...e.connection}}function DI(e){return OI}function FI(e){const t=DI();return de(t,he)}const $I=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function BI({containerStyle:e,style:t,type:r,component:n}){const{nodesConnectable:i,width:o,height:a,isValid:s,inProgress:c}=de($I,he);return!(o&&i&&c)?null:g.jsx("svg",{style:e,width:o,height:a,className:"react-flow__connectionline react-flow__container",children:g.jsx("g",{className:be(["react-flow__connection",u0(s)]),children:g.jsx(dx,{style:t,type:r,CustomComponent:n,isValid:s})})})}const dx=({style:e,type:t=Tt.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:i,from:o,fromNode:a,fromHandle:s,fromPosition:c,to:u,toNode:l,toHandle:d,toPosition:f,pointer:h}=FI();if(!i)return;if(r)return g.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:s,fromX:o.x,fromY:o.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:f,connectionStatus:u0(n),toNode:l,toHandle:d,pointer:h});let m="";const y={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Tt.Bezier:[m]=w0(y);break;case Tt.SimpleBezier:[m]=Q0(y);break;case Tt.Step:[m]=Hl({...y,borderRadius:0});break;case Tt.SmoothStep:[m]=Hl(y);break;default:[m]=N0(y)}return g.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:e})};dx.displayName="ConnectionLine";const zI={};function Zf(e=zI){E.useRef(e),pe(),E.useEffect(()=>{},[e])}function HI(){pe(),E.useRef(!1),E.useEffect(()=>{},[])}function fx({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:n,onEdgeClick:i,onNodeDoubleClick:o,onEdgeDoubleClick:a,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:l,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:b,selectionOnDrag:p,selectionMode:w,multiSelectionKeyCode:S,panActivationKeyCode:_,zoomActivationKeyCode:N,deleteKeyCode:j,onlyRenderVisibleElements:A,elementsSelectable:k,defaultViewport:R,translateExtent:M,minZoom:F,maxZoom:C,preventScrolling:D,defaultMarkerColor:O,zoomOnScroll:q,zoomOnPinch:I,panOnScroll:T,panOnScrollSpeed:V,panOnScrollMode:G,zoomOnDoubleClick:K,panOnDrag:Q,onPaneClick:P,onPaneMouseEnter:$,onPaneMouseMove:H,onPaneMouseLeave:B,onPaneScroll:z,onPaneContextMenu:X,paneClickDistance:te,nodeClickDistance:ee,onEdgeContextMenu:re,onEdgeMouseEnter:ne,onEdgeMouseMove:Z,onEdgeMouseLeave:se,reconnectRadius:le,onReconnect:ce,onReconnectStart:_e,onReconnectEnd:Ne,noDragClassName:Le,noWheelClassName:Re,noPanClassName:Ie,disableKeyboardA11y:fe,nodeExtent:Oe,rfId:Ee,viewport:Ae,onViewportChange:ke}){return Zf(e),Zf(t),HI(),qI(r),LI(Ae),g.jsx(iI,{onPaneClick:P,onPaneMouseEnter:$,onPaneMouseMove:H,onPaneMouseLeave:B,onPaneContextMenu:X,onPaneScroll:z,paneClickDistance:te,deleteKeyCode:j,selectionKeyCode:b,selectionOnDrag:p,selectionMode:w,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:S,panActivationKeyCode:_,zoomActivationKeyCode:N,elementsSelectable:k,zoomOnScroll:q,zoomOnPinch:I,zoomOnDoubleClick:K,panOnScroll:T,panOnScrollSpeed:V,panOnScrollMode:G,panOnDrag:Q,defaultViewport:R,translateExtent:M,minZoom:F,maxZoom:C,onSelectionContextMenu:d,preventScrolling:D,noDragClassName:Le,noWheelClassName:Re,noPanClassName:Ie,disableKeyboardA11y:fe,onViewportChange:ke,isControlledViewport:!!Ae,children:g.jsxs(MI,{children:[g.jsx(kI,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:a,onReconnect:ce,onReconnectStart:_e,onReconnectEnd:Ne,onlyRenderVisibleElements:A,onEdgeContextMenu:re,onEdgeMouseEnter:ne,onEdgeMouseMove:Z,onEdgeMouseLeave:se,reconnectRadius:le,defaultMarkerColor:O,noPanClassName:Ie,disableKeyboardA11y:fe,rfId:Ee}),g.jsx(BI,{style:y,type:m,component:v,containerStyle:x}),g.jsx("div",{className:"react-flow__edgelabel-renderer"}),g.jsx(hI,{nodeTypes:e,onNodeClick:n,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:l,nodeClickDistance:ee,onlyRenderVisibleElements:A,noPanClassName:Ie,noDragClassName:Le,disableKeyboardA11y:fe,nodeExtent:Oe,rfId:Ee}),g.jsx("div",{className:"react-flow__viewport-portal"})]})})}fx.displayName="GraphView";const VI=E.memo(fx),Qf=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c=.5,maxZoom:u=2,nodeOrigin:l,nodeExtent:d,zIndexMode:f="basic"}={})=>{const h=new Map,m=new Map,y=new Map,v=new Map,x=n??t??[],b=r??e??[],p=l??[0,0],w=d??Qr;C0(y,v,x);const S=Gl(b,h,m,{nodeOrigin:p,nodeExtent:w,zIndexMode:f});let _=[0,0,1];if(a&&i&&o){const N=cn(h,{filter:R=>!!((R.width||R.initialWidth)&&(R.height||R.initialHeight))}),{x:j,y:A,zoom:k}=xd(N,i,o,c,u,(s==null?void 0:s.padding)??.1);_=[j,A,k]}return{rfId:"1",width:i??0,height:o??0,transform:_,nodes:b,nodesInitialized:S,nodeLookup:h,parentLookup:m,edges:x,edgeLookup:v,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:Qr,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:gr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:p,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:s,fitViewResolver:null,connection:{...c0},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:fE,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:s0,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},GI=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:l,nodeExtent:d,zIndexMode:f})=>uC((h,m)=>{async function y(){const{nodeLookup:v,panZoom:x,fitViewOptions:b,fitViewResolver:p,width:w,height:S,minZoom:_,maxZoom:N}=m();x&&(await lE({nodes:v,width:w,height:S,panZoom:x,minZoom:_,maxZoom:N},b),p==null||p.resolve(!0),h({fitViewResolver:null}))}return{...Qf({nodes:e,edges:t,width:i,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:l,nodeExtent:d,defaultNodes:r,defaultEdges:n,zIndexMode:f}),setNodes:v=>{const{nodeLookup:x,parentLookup:b,nodeOrigin:p,elevateNodesOnSelect:w,fitViewQueued:S,zIndexMode:_}=m(),N=Gl(v,x,b,{nodeOrigin:p,nodeExtent:d,elevateNodesOnSelect:w,checkEquality:!0,zIndexMode:_});S&&N?(y(),h({nodes:v,nodesInitialized:N,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:v,nodesInitialized:N})},setEdges:v=>{const{connectionLookup:x,edgeLookup:b}=m();C0(x,b,v),h({edges:v})},setDefaultNodesAndEdges:(v,x)=>{if(v){const{setNodes:b}=m();b(v),h({hasDefaultNodes:!0})}if(x){const{setEdges:b}=m();b(x),h({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:x,nodeLookup:b,parentLookup:p,domNode:w,nodeOrigin:S,nodeExtent:_,debug:N,fitViewQueued:j,zIndexMode:A}=m(),{changes:k,updatedInternals:R}=ME(v,b,p,w,S,_,A);R&&(TE(b,p,{nodeOrigin:S,nodeExtent:_,zIndexMode:A}),j?(y(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),(k==null?void 0:k.length)>0&&(N&&console.log("React Flow: trigger node changes",k),x==null||x(k)))},updateNodePositions:(v,x=!1)=>{const b=[];let p=[];const{nodeLookup:w,triggerNodeChanges:S,connection:_,updateConnection:N,onNodesChangeMiddlewareMap:j}=m();for(const[A,k]of v){const R=w.get(A),M=!!(R!=null&&R.expandParent&&(R!=null&&R.parentId)&&(k!=null&&k.position)),F={id:A,type:"position",position:M?{x:Math.max(0,k.position.x),y:Math.max(0,k.position.y)}:k.position,dragging:x};if(R&&_.inProgress&&_.fromNode.id===R.id){const C=Kt(R,_.fromHandle,ae.Left,!0);N({..._,from:C})}M&&R.parentId&&b.push({id:A,parentId:R.parentId,rect:{...k.internals.positionAbsolute,width:k.measured.width??0,height:k.measured.height??0}}),p.push(F)}if(b.length>0){const{parentLookup:A,nodeOrigin:k}=m(),R=Ed(b,w,A,k);p.push(...R)}for(const A of j.values())p=A(p);S(p)},triggerNodeChanges:v=>{const{onNodesChange:x,setNodes:b,nodes:p,hasDefaultNodes:w,debug:S}=m();if(v!=null&&v.length){if(w){const _=B0(v,p);b(_)}S&&console.log("React Flow: trigger node changes",v),x==null||x(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:x,setEdges:b,edges:p,hasDefaultEdges:w,debug:S}=m();if(v!=null&&v.length){if(w){const _=z0(v,p);b(_)}S&&console.log("React Flow: trigger edge changes",v),x==null||x(v)}},addSelectedNodes:v=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:p,triggerNodeChanges:w,triggerEdgeChanges:S}=m();if(x){const _=v.map(N=>$t(N,!0));w(_);return}w(ur(p,new Set([...v]),!0)),S(ur(b))},addSelectedEdges:v=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:p,triggerNodeChanges:w,triggerEdgeChanges:S}=m();if(x){const _=v.map(N=>$t(N,!0));S(_);return}S(ur(b,new Set([...v]))),w(ur(p,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:x}={})=>{const{edges:b,nodes:p,nodeLookup:w,triggerNodeChanges:S,triggerEdgeChanges:_}=m(),N=v||p,j=x||b,A=N.map(R=>{const M=w.get(R.id);return M&&(M.selected=!1),$t(R.id,!1)}),k=j.map(R=>$t(R.id,!1));S(A),_(k)},setMinZoom:v=>{const{panZoom:x,maxZoom:b}=m();x==null||x.setScaleExtent([v,b]),h({minZoom:v})},setMaxZoom:v=>{const{panZoom:x,minZoom:b}=m();x==null||x.setScaleExtent([b,v]),h({maxZoom:v})},setTranslateExtent:v=>{var x;(x=m().panZoom)==null||x.setTranslateExtent(v),h({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:x,triggerNodeChanges:b,triggerEdgeChanges:p,elementsSelectable:w}=m();if(!w)return;const S=x.reduce((N,j)=>j.selected?[...N,$t(j.id,!1)]:N,[]),_=v.reduce((N,j)=>j.selected?[...N,$t(j.id,!1)]:N,[]);b(S),p(_)},setNodeExtent:v=>{const{nodes:x,nodeLookup:b,parentLookup:p,nodeOrigin:w,elevateNodesOnSelect:S,nodeExtent:_,zIndexMode:N}=m();v[0][0]===_[0][0]&&v[0][1]===_[0][1]&&v[1][0]===_[1][0]&&v[1][1]===_[1][1]||(Gl(x,b,p,{nodeOrigin:w,nodeExtent:v,elevateNodesOnSelect:S,checkEquality:!1,zIndexMode:N}),h({nodeExtent:v}))},panBy:v=>{const{transform:x,width:b,height:p,panZoom:w,translateExtent:S}=m();return qE({delta:v,panZoom:w,transform:x,translateExtent:S,width:b,height:p})},setCenter:async(v,x,b)=>{const{width:p,height:w,maxZoom:S,panZoom:_}=m();if(!_)return Promise.resolve(!1);const N=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:S;return await _.setViewport({x:p/2-v*N,y:w/2-x*N,zoom:N},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...c0}})},updateConnection:v=>{h({connection:v})},reset:()=>h({...Qf()})}},Object.is);function UI({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:n,initialWidth:i,initialHeight:o,initialMinZoom:a,initialMaxZoom:s,initialFitViewOptions:c,fitView:u,nodeOrigin:l,nodeExtent:d,zIndexMode:f,children:h}){const[m]=E.useState(()=>GI({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:o,fitView:u,minZoom:a,maxZoom:s,fitViewOptions:c,nodeOrigin:l,nodeExtent:d,zIndexMode:f}));return g.jsx(lC,{value:m,children:g.jsx(MC,{children:h})})}function KI({children:e,nodes:t,edges:r,defaultNodes:n,defaultEdges:i,width:o,height:a,fitView:s,fitViewOptions:c,minZoom:u,maxZoom:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h}){return E.useContext(mi)?g.jsx(g.Fragment,{children:e}):g.jsx(UI,{initialNodes:t,initialEdges:r,defaultNodes:n,defaultEdges:i,initialWidth:o,initialHeight:a,fitView:s,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h,children:e})}const WI={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function YI({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:o,edgeTypes:a,onNodeClick:s,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:_,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:A,onNodesDelete:k,onEdgesDelete:R,onDelete:M,onSelectionChange:F,onSelectionDragStart:C,onSelectionDrag:D,onSelectionDragStop:O,onSelectionContextMenu:q,onSelectionStart:I,onSelectionEnd:T,onBeforeDelete:V,connectionMode:G,connectionLineType:K=Tt.Bezier,connectionLineStyle:Q,connectionLineComponent:P,connectionLineContainerStyle:$,deleteKeyCode:H="Backspace",selectionKeyCode:B="Shift",selectionOnDrag:z=!1,selectionMode:X=Jr.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:ee=tn()?"Meta":"Control",zoomActivationKeyCode:re=tn()?"Meta":"Control",snapToGrid:ne,snapGrid:Z,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:le,nodesDraggable:ce,autoPanOnNodeFocus:_e,nodesConnectable:Ne,nodesFocusable:Le,nodeOrigin:Re=F0,edgesFocusable:Ie,edgesReconnectable:fe,elementsSelectable:Oe=!0,defaultViewport:Ee=NC,minZoom:Ae=.5,maxZoom:ke=2,translateExtent:He=Qr,preventScrolling:De=!0,nodeExtent:Ve,defaultMarkerColor:pt="#b1b1b7",zoomOnScroll:Pt=!0,zoomOnPinch:Se=!0,panOnScroll:Ge=!1,panOnScrollSpeed:Fi=.5,panOnScrollMode:Ir=Ht.Free,zoomOnDoubleClick:$i=!0,panOnDrag:Rr=!0,onPaneClick:_t,onPaneMouseEnter:yn,onPaneMouseMove:ot,onPaneMouseLeave:Tr,onPaneScroll:xn,onPaneContextMenu:Lt,paneClickDistance:Bi=1,nodeClickDistance:er=0,children:tr,onReconnect:bn,onReconnectStart:Ar,onReconnectEnd:ye,onEdgeContextMenu:wn,onEdgeDoubleClick:rr,onEdgeMouseEnter:_n,onEdgeMouseMove:kr,onEdgeMouseLeave:Nt,reconnectRadius:Nn=10,onNodesChange:zi,onEdgesChange:Hi,noDragClassName:Vi="nodrag",noWheelClassName:Gi="nowheel",noPanClassName:Sn="nopan",fitView:jr,fitViewOptions:En,connectOnClick:at,attributionPosition:St,proOptions:Et,defaultEdgeOptions:Ot,elevateNodesOnSelect:Ct=!0,elevateEdgesOnSelect:Ui=!1,disableKeyboardA11y:Cn=!1,autoPanOnConnect:gt,autoPanOnNodeDrag:Dt,autoPanSpeed:Ki,connectionRadius:Wi,isValidConnection:Mr,onError:qr,style:Yi,id:In,nodeDragThreshold:Ft,connectionDragThreshold:Xi,viewport:Zi,onViewportChange:Pr,width:Rn,height:Tn,colorMode:L="light",debug:U,onScroll:Y,ariaLabelConfig:W,zIndexMode:J="basic",...ie},oe){const ue=In||"1",me=IC(L),ve=E.useCallback(je=>{je.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Y==null||Y(je)},[Y]);return g.jsx("div",{"data-testid":"rf__wrapper",...ie,onScroll:ve,style:{...Yi,...WI},ref:oe,className:be(["react-flow",i,me]),id:In,role:"application",children:g.jsxs(KI,{nodes:e,edges:t,width:Rn,height:Tn,fitView:jr,fitViewOptions:En,minZoom:Ae,maxZoom:ke,nodeOrigin:Re,nodeExtent:Ve,zIndexMode:J,children:[g.jsx(VI,{onInit:u,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:_,nodeTypes:o,edgeTypes:a,connectionLineType:K,connectionLineStyle:Q,connectionLineComponent:P,connectionLineContainerStyle:$,selectionKeyCode:B,selectionOnDrag:z,selectionMode:X,deleteKeyCode:H,multiSelectionKeyCode:ee,panActivationKeyCode:te,zoomActivationKeyCode:re,onlyRenderVisibleElements:se,defaultViewport:Ee,translateExtent:He,minZoom:Ae,maxZoom:ke,preventScrolling:De,zoomOnScroll:Pt,zoomOnPinch:Se,zoomOnDoubleClick:$i,panOnScroll:Ge,panOnScrollSpeed:Fi,panOnScrollMode:Ir,panOnDrag:Rr,onPaneClick:_t,onPaneMouseEnter:yn,onPaneMouseMove:ot,onPaneMouseLeave:Tr,onPaneScroll:xn,onPaneContextMenu:Lt,paneClickDistance:Bi,nodeClickDistance:er,onSelectionContextMenu:q,onSelectionStart:I,onSelectionEnd:T,onReconnect:bn,onReconnectStart:Ar,onReconnectEnd:ye,onEdgeContextMenu:wn,onEdgeDoubleClick:rr,onEdgeMouseEnter:_n,onEdgeMouseMove:kr,onEdgeMouseLeave:Nt,reconnectRadius:Nn,defaultMarkerColor:pt,noDragClassName:Vi,noWheelClassName:Gi,noPanClassName:Sn,rfId:ue,disableKeyboardA11y:Cn,nodeExtent:Ve,viewport:Zi,onViewportChange:Pr}),g.jsx(CC,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:ce,autoPanOnNodeFocus:_e,nodesConnectable:Ne,nodesFocusable:Le,edgesFocusable:Ie,edgesReconnectable:fe,elementsSelectable:Oe,elevateNodesOnSelect:Ct,elevateEdgesOnSelect:Ui,minZoom:Ae,maxZoom:ke,nodeExtent:Ve,onNodesChange:zi,onEdgesChange:Hi,snapToGrid:ne,snapGrid:Z,connectionMode:G,translateExtent:He,connectOnClick:at,defaultEdgeOptions:Ot,fitView:jr,fitViewOptions:En,onNodesDelete:k,onEdgesDelete:R,onDelete:M,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:A,onSelectionDrag:D,onSelectionDragStart:C,onSelectionDragStop:O,onMove:l,onMoveStart:d,onMoveEnd:f,noPanClassName:Sn,nodeOrigin:Re,rfId:ue,autoPanOnConnect:gt,autoPanOnNodeDrag:Dt,autoPanSpeed:Ki,onError:qr,connectionRadius:Wi,isValidConnection:Mr,selectNodesOnDrag:le,nodeDragThreshold:Ft,connectionDragThreshold:Xi,onBeforeDelete:V,debug:U,ariaLabelConfig:W,zIndexMode:J}),g.jsx(_C,{onSelectionChange:F}),tr,g.jsx(vC,{proOptions:Et,position:St}),g.jsx(mC,{rfId:ue,disableKeyboardA11y:Cn})]})})}var XI=H0(YI);function ZI(e){const[t,r]=E.useState(e),n=E.useCallback(i=>r(o=>B0(i,o)),[]);return[t,r,n]}function QI(e){const[t,r]=E.useState(e),n=E.useCallback(i=>r(o=>z0(i,o)),[]);return[t,r,n]}function JI({dimensions:e,lineWidth:t,variant:r,className:n}){return g.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:be(["react-flow__background-pattern",r,n])})}function eR({radius:e,className:t}){return g.jsx("circle",{cx:e,cy:e,r:e,className:be(["react-flow__background-pattern","dots",t])})}var At;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(At||(At={}));const tR={[At.Dots]:1,[At.Lines]:1,[At.Cross]:6},rR=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function hx({id:e,variant:t=At.Dots,gap:r=20,size:n,lineWidth:i=1,offset:o=0,color:a,bgColor:s,style:c,className:u,patternClassName:l}){const d=E.useRef(null),{transform:f,patternId:h}=de(rR,he),m=n||tR[t],y=t===At.Dots,v=t===At.Cross,x=Array.isArray(r)?r:[r,r],b=[x[0]*f[2]||1,x[1]*f[2]||1],p=m*f[2],w=Array.isArray(o)?o:[o,o],S=v?[p,p]:b,_=[w[0]*f[2]||1+S[0]/2,w[1]*f[2]||1+S[1]/2],N=`${h}${e||""}`;return g.jsxs("svg",{className:be(["react-flow__background",u]),style:{...c,...vi,"--xy-background-color-props":s,"--xy-background-pattern-color-props":a},ref:d,"data-testid":"rf__background",children:[g.jsx("pattern",{id:N,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:y?g.jsx(eR,{radius:p/2,className:l}):g.jsx(JI,{dimensions:S,lineWidth:i,variant:t,className:l})}),g.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}hx.displayName="Background";const nR=E.memo(hx);function iR(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:g.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function oR(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:g.jsx("path",{d:"M0 0h32v4.2H0z"})})}function aR(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:g.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function sR(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function cR(){return g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:g.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Fn({children:e,className:t,...r}){return g.jsx("button",{type:"button",className:be(["react-flow__controls-button",t]),...r,children:e})}const uR=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function px({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:i,onZoomIn:o,onZoomOut:a,onFitView:s,onInteractiveChange:c,className:u,children:l,position:d="bottom-left",orientation:f="vertical","aria-label":h}){const m=pe(),{isInteractive:y,minZoomReached:v,maxZoomReached:x,ariaLabelConfig:b}=de(uR,he),{zoomIn:p,zoomOut:w,fitView:S}=fn(),_=()=>{p(),o==null||o()},N=()=>{w(),a==null||a()},j=()=>{S(i),s==null||s()},A=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)},k=f==="horizontal"?"horizontal":"vertical";return g.jsxs(dn,{className:be(["react-flow__controls",k,u]),position:d,style:e,"data-testid":"rf__controls","aria-label":h??b["controls.ariaLabel"],children:[t&&g.jsxs(g.Fragment,{children:[g.jsx(Fn,{onClick:_,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:x,children:g.jsx(iR,{})}),g.jsx(Fn,{onClick:N,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:v,children:g.jsx(oR,{})})]}),r&&g.jsx(Fn,{className:"react-flow__controls-fitview",onClick:j,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:g.jsx(aR,{})}),n&&g.jsx(Fn,{className:"react-flow__controls-interactive",onClick:A,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:y?g.jsx(cR,{}):g.jsx(sR,{})}),l]})}px.displayName="Controls";E.memo(px);function lR({id:e,x:t,y:r,width:n,height:i,style:o,color:a,strokeColor:s,strokeWidth:c,className:u,borderRadius:l,shapeRendering:d,selected:f,onClick:h}){const{background:m,backgroundColor:y}=o||{},v=a||m||y;return g.jsx("rect",{className:be(["react-flow__minimap-node",{selected:f},u]),x:t,y:r,rx:l,ry:l,width:n,height:i,style:{fill:v,stroke:s,strokeWidth:c},shapeRendering:d,onClick:h?x=>h(x,e):void 0})}const dR=E.memo(lR),fR=e=>e.nodes.map(t=>t.id),fo=e=>e instanceof Function?e:()=>e;function hR({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i,nodeComponent:o=dR,onClick:a}){const s=de(fR,he),c=fo(t),u=fo(e),l=fo(r),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return g.jsx(g.Fragment,{children:s.map(f=>g.jsx(gR,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:l,nodeBorderRadius:n,nodeStrokeWidth:i,NodeComponent:o,onClick:a,shapeRendering:d},f))})}function pR({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:i,nodeStrokeWidth:o,shapeRendering:a,NodeComponent:s,onClick:c}){const{node:u,x:l,y:d,width:f,height:h}=de(m=>{const{internals:y}=m.nodeLookup.get(e),v=y.userNode,{x,y:b}=y.positionAbsolute,{width:p,height:w}=xt(v);return{node:v,x,y:b,width:p,height:w}},he);return!u||u.hidden||!g0(u)?null:g.jsx(s,{x:l,y:d,width:f,height:h,style:u.style,selected:!!u.selected,className:n(u),color:t(u),borderRadius:i,strokeColor:r(u),strokeWidth:o,shapeRendering:a,onClick:c,id:u.id})}const gR=E.memo(pR);var mR=E.memo(hR);const vR=200,yR=150,xR=e=>!e.hidden,bR=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?p0(cn(e.nodeLookup,{filter:xR}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},wR="react-flow__minimap-desc";function gx({style:e,className:t,nodeStrokeColor:r,nodeColor:n,nodeClassName:i="",nodeBorderRadius:o=5,nodeStrokeWidth:a,nodeComponent:s,bgColor:c,maskColor:u,maskStrokeColor:l,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:m,pannable:y=!1,zoomable:v=!1,ariaLabel:x,inversePan:b,zoomStep:p=1,offsetScale:w=5}){const S=pe(),_=E.useRef(null),{boundingRect:N,viewBB:j,rfId:A,panZoom:k,translateExtent:R,flowWidth:M,flowHeight:F,ariaLabelConfig:C}=de(bR,he),D=(e==null?void 0:e.width)??vR,O=(e==null?void 0:e.height)??yR,q=N.width/D,I=N.height/O,T=Math.max(q,I),V=T*D,G=T*O,K=w*T,Q=N.x-(V-N.width)/2-K,P=N.y-(G-N.height)/2-K,$=V+K*2,H=G+K*2,B=`${wR}-${A}`,z=E.useRef(0),X=E.useRef();z.current=T,E.useEffect(()=>{if(_.current&&k)return X.current=HE({domNode:_.current,panZoom:k,getTransform:()=>S.getState().transform,getViewScale:()=>z.current}),()=>{var ne;(ne=X.current)==null||ne.destroy()}},[k]),E.useEffect(()=>{var ne;(ne=X.current)==null||ne.update({translateExtent:R,width:M,height:F,inversePan:b,pannable:y,zoomStep:p,zoomable:v})},[y,v,b,p,R,M,F]);const te=h?ne=>{var le;const[Z,se]=((le=X.current)==null?void 0:le.pointer(ne))||[0,0];h(ne,{x:Z,y:se})}:void 0,ee=m?E.useCallback((ne,Z)=>{const se=S.getState().nodeLookup.get(Z).internals.userNode;m(ne,se)},[]):void 0,re=x??C["minimap.ariaLabel"];return g.jsx(dn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*T:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:be(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:g.jsxs("svg",{width:D,height:O,viewBox:`${Q} ${P} ${$} ${H}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":B,ref:_,onClick:te,children:[re&&g.jsx("title",{id:B,children:re}),g.jsx(mR,{onClick:ee,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:i,nodeStrokeWidth:a,nodeComponent:s}),g.jsx("path",{className:"react-flow__minimap-mask",d:`M${Q-K},${P-K}h${$+K*2}v${H+K*2}h${-$-K*2}z
        M${j.x},${j.y}h${j.width}v${j.height}h${-j.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}gx.displayName="MiniMap";const _R=E.memo(gx),NR=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,SR={[br.Line]:"right",[br.Handle]:"bottom-right"};function ER({nodeId:e,position:t,variant:r=br.Handle,className:n,style:i=void 0,children:o,color:a,minWidth:s=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:l=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:h=!0,shouldResize:m,onResizeStart:y,onResize:v,onResizeEnd:x}){const b=K0(),p=typeof e=="string"?e:b,w=pe(),S=E.useRef(null),_=r===br.Handle,N=de(E.useCallback(NR(_&&h),[_,h]),he),j=E.useRef(null),A=t??SR[r];E.useEffect(()=>{if(!(!S.current||!p))return j.current||(j.current=nC({domNode:S.current,nodeId:p,getStoreItems:()=>{const{nodeLookup:R,transform:M,snapGrid:F,snapToGrid:C,nodeOrigin:D,domNode:O}=w.getState();return{nodeLookup:R,transform:M,snapGrid:F,snapToGrid:C,nodeOrigin:D,paneDomNode:O}},onChange:(R,M)=>{const{triggerNodeChanges:F,nodeLookup:C,parentLookup:D,nodeOrigin:O}=w.getState(),q=[],I={x:R.x,y:R.y},T=C.get(p);if(T&&T.expandParent&&T.parentId){const V=T.origin??O,G=R.width??T.measured.width??0,K=R.height??T.measured.height??0,Q={id:T.id,parentId:T.parentId,rect:{width:G,height:K,...m0({x:R.x??T.position.x,y:R.y??T.position.y},{width:G,height:K},T.parentId,C,V)}},P=Ed([Q],C,D,O);q.push(...P),I.x=R.x?Math.max(V[0]*G,R.x):void 0,I.y=R.y?Math.max(V[1]*K,R.y):void 0}if(I.x!==void 0&&I.y!==void 0){const V={id:p,type:"position",position:{...I}};q.push(V)}if(R.width!==void 0&&R.height!==void 0){const G={id:p,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:R.width,height:R.height}};q.push(G)}for(const V of M){const G={...V,type:"position"};q.push(G)}F(q)},onEnd:({width:R,height:M})=>{const F={id:p,type:"dimensions",resizing:!1,dimensions:{width:R,height:M}};w.getState().triggerNodeChanges([F])}})),j.current.update({controlPosition:A,boundaries:{minWidth:s,minHeight:c,maxWidth:u,maxHeight:l},keepAspectRatio:d,resizeDirection:f,onResizeStart:y,onResize:v,onResizeEnd:x,shouldResize:m}),()=>{var R;(R=j.current)==null||R.destroy()}},[A,s,c,u,l,d,y,v,x,m]);const k=A.split("-");return g.jsx("div",{className:be(["react-flow__resize-control","nodrag",...k,r,n]),ref:S,style:{...i,scale:N,...a&&{[_?"backgroundColor":"borderColor"]:a}},children:o})}E.memo(ER);var ho,Jf;function CR(){if(Jf)return ho;Jf=1;function e(){this.__data__=[],this.size=0}return ho=e,ho}var po,eh;function wr(){if(eh)return po;eh=1;function e(t,r){return t===r||t!==t&&r!==r}return po=e,po}var go,th;function xi(){if(th)return go;th=1;var e=wr();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return go=t,go}var mo,rh;function IR(){if(rh)return mo;rh=1;var e=xi(),t=Array.prototype,r=t.splice;function n(i){var o=this.__data__,a=e(o,i);if(a<0)return!1;var s=o.length-1;return a==s?o.pop():r.call(o,a,1),--this.size,!0}return mo=n,mo}var vo,nh;function RR(){if(nh)return vo;nh=1;var e=xi();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return vo=t,vo}var yo,ih;function TR(){if(ih)return yo;ih=1;var e=xi();function t(r){return e(this.__data__,r)>-1}return yo=t,yo}var xo,oh;function AR(){if(oh)return xo;oh=1;var e=xi();function t(r,n){var i=this.__data__,o=e(i,r);return o<0?(++this.size,i.push([r,n])):i[o][1]=n,this}return xo=t,xo}var bo,ah;function bi(){if(ah)return bo;ah=1;var e=CR(),t=IR(),r=RR(),n=TR(),i=AR();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,bo=o,bo}var wo,sh;function kR(){if(sh)return wo;sh=1;var e=bi();function t(){this.__data__=new e,this.size=0}return wo=t,wo}var _o,ch;function jR(){if(ch)return _o;ch=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return _o=e,_o}var No,uh;function MR(){if(uh)return No;uh=1;function e(t){return this.__data__.get(t)}return No=e,No}var So,lh;function qR(){if(lh)return So;lh=1;function e(t){return this.__data__.has(t)}return So=e,So}var Eo,dh;function mx(){if(dh)return Eo;dh=1;var e=typeof An=="object"&&An&&An.Object===Object&&An;return Eo=e,Eo}var Co,fh;function it(){if(fh)return Co;fh=1;var e=mx(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Co=r,Co}var Io,hh;function _r(){if(hh)return Io;hh=1;var e=it(),t=e.Symbol;return Io=t,Io}var Ro,ph;function PR(){if(ph)return Ro;ph=1;var e=_r(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function o(a){var s=r.call(a,i),c=a[i];try{a[i]=void 0;var u=!0}catch{}var l=n.call(a);return u&&(s?a[i]=c:delete a[i]),l}return Ro=o,Ro}var To,gh;function LR(){if(gh)return To;gh=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return To=r,To}var Ao,mh;function Xt(){if(mh)return Ao;mh=1;var e=_r(),t=PR(),r=LR(),n="[object Null]",i="[object Undefined]",o=e?e.toStringTag:void 0;function a(s){return s==null?s===void 0?i:n:o&&o in Object(s)?t(s):r(s)}return Ao=a,Ao}var ko,vh;function Ke(){if(vh)return ko;vh=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return ko=e,ko}var jo,yh;function hn(){if(yh)return jo;yh=1;var e=Xt(),t=Ke(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",o="[object Proxy]";function a(s){if(!t(s))return!1;var c=e(s);return c==n||c==i||c==r||c==o}return jo=a,jo}var Mo,xh;function OR(){if(xh)return Mo;xh=1;var e=it(),t=e["__core-js_shared__"];return Mo=t,Mo}var qo,bh;function DR(){if(bh)return qo;bh=1;var e=OR(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return qo=r,qo}var Po,wh;function vx(){if(wh)return Po;wh=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Po=r,Po}var Lo,_h;function FR(){if(_h)return Lo;_h=1;var e=hn(),t=DR(),r=Ke(),n=vx(),i=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,l=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!r(f)||t(f))return!1;var h=e(f)?l:o;return h.test(n(f))}return Lo=d,Lo}var Oo,Nh;function $R(){if(Nh)return Oo;Nh=1;function e(t,r){return t==null?void 0:t[r]}return Oo=e,Oo}var Do,Sh;function Zt(){if(Sh)return Do;Sh=1;var e=FR(),t=$R();function r(n,i){var o=t(n,i);return e(o)?o:void 0}return Do=r,Do}var Fo,Eh;function Id(){if(Eh)return Fo;Eh=1;var e=Zt(),t=it(),r=e(t,"Map");return Fo=r,Fo}var $o,Ch;function wi(){if(Ch)return $o;Ch=1;var e=Zt(),t=e(Object,"create");return $o=t,$o}var Bo,Ih;function BR(){if(Ih)return Bo;Ih=1;var e=wi();function t(){this.__data__=e?e(null):{},this.size=0}return Bo=t,Bo}var zo,Rh;function zR(){if(Rh)return zo;Rh=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return zo=e,zo}var Ho,Th;function HR(){if(Th)return Ho;Th=1;var e=wi(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(o){var a=this.__data__;if(e){var s=a[o];return s===t?void 0:s}return n.call(a,o)?a[o]:void 0}return Ho=i,Ho}var Vo,Ah;function VR(){if(Ah)return Vo;Ah=1;var e=wi(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var o=this.__data__;return e?o[i]!==void 0:r.call(o,i)}return Vo=n,Vo}var Go,kh;function GR(){if(kh)return Go;kh=1;var e=wi(),t="__lodash_hash_undefined__";function r(n,i){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&i===void 0?t:i,this}return Go=r,Go}var Uo,jh;function UR(){if(jh)return Uo;jh=1;var e=BR(),t=zR(),r=HR(),n=VR(),i=GR();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,Uo=o,Uo}var Ko,Mh;function KR(){if(Mh)return Ko;Mh=1;var e=UR(),t=bi(),r=Id();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Ko=n,Ko}var Wo,qh;function WR(){if(qh)return Wo;qh=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Wo=e,Wo}var Yo,Ph;function _i(){if(Ph)return Yo;Ph=1;var e=WR();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Yo=t,Yo}var Xo,Lh;function YR(){if(Lh)return Xo;Lh=1;var e=_i();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Xo=t,Xo}var Zo,Oh;function XR(){if(Oh)return Zo;Oh=1;var e=_i();function t(r){return e(this,r).get(r)}return Zo=t,Zo}var Qo,Dh;function ZR(){if(Dh)return Qo;Dh=1;var e=_i();function t(r){return e(this,r).has(r)}return Qo=t,Qo}var Jo,Fh;function QR(){if(Fh)return Jo;Fh=1;var e=_i();function t(r,n){var i=e(this,r),o=i.size;return i.set(r,n),this.size+=i.size==o?0:1,this}return Jo=t,Jo}var ea,$h;function Rd(){if($h)return ea;$h=1;var e=KR(),t=YR(),r=XR(),n=ZR(),i=QR();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=i,ea=o,ea}var ta,Bh;function JR(){if(Bh)return ta;Bh=1;var e=bi(),t=Id(),r=Rd(),n=200;function i(o,a){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<n-1)return c.push([o,a]),this.size=++s.size,this;s=this.__data__=new r(c)}return s.set(o,a),this.size=s.size,this}return ta=i,ta}var ra,zh;function Ni(){if(zh)return ra;zh=1;var e=bi(),t=kR(),r=jR(),n=MR(),i=qR(),o=JR();function a(s){var c=this.__data__=new e(s);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=n,a.prototype.has=i,a.prototype.set=o,ra=a,ra}var na,Hh;function Td(){if(Hh)return na;Hh=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return na=e,na}var ia,Vh;function yx(){if(Vh)return ia;Vh=1;var e=Zt(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return ia=t,ia}var oa,Gh;function Si(){if(Gh)return oa;Gh=1;var e=yx();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return oa=t,oa}var aa,Uh;function Ei(){if(Uh)return aa;Uh=1;var e=Si(),t=wr(),r=Object.prototype,n=r.hasOwnProperty;function i(o,a,s){var c=o[a];(!(n.call(o,a)&&t(c,s))||s===void 0&&!(a in o))&&e(o,a,s)}return aa=i,aa}var sa,Kh;function pn(){if(Kh)return sa;Kh=1;var e=Ei(),t=Si();function r(n,i,o,a){var s=!o;o||(o={});for(var c=-1,u=i.length;++c<u;){var l=i[c],d=a?a(o[l],n[l],l,o,n):void 0;d===void 0&&(d=n[l]),s?t(o,l,d):e(o,l,d)}return o}return sa=r,sa}var ca,Wh;function eT(){if(Wh)return ca;Wh=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return ca=e,ca}var ua,Yh;function ht(){if(Yh)return ua;Yh=1;function e(t){return t!=null&&typeof t=="object"}return ua=e,ua}var la,Xh;function tT(){if(Xh)return la;Xh=1;var e=Xt(),t=ht(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return la=n,la}var da,Zh;function gn(){if(Zh)return da;Zh=1;var e=tT(),t=ht(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,o=e((function(){return arguments})())?e:function(a){return t(a)&&n.call(a,"callee")&&!i.call(a,"callee")};return da=o,da}var fa,Qh;function we(){if(Qh)return fa;Qh=1;var e=Array.isArray;return fa=e,fa}var $r={exports:{}},ha,Jh;function rT(){if(Jh)return ha;Jh=1;function e(){return!1}return ha=e,ha}$r.exports;var ep;function Nr(){return ep||(ep=1,(function(e,t){var r=it(),n=rT(),i=t&&!t.nodeType&&t,o=i&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===i,s=a?r.Buffer:void 0,c=s?s.isBuffer:void 0,u=c||n;e.exports=u})($r,$r.exports)),$r.exports}var pa,tp;function Ci(){if(tp)return pa;tp=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var o=typeof n;return i=i??e,!!i&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return pa=r,pa}var ga,rp;function Ad(){if(rp)return ga;rp=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return ga=t,ga}var ma,np;function nT(){if(np)return ma;np=1;var e=Xt(),t=Ad(),r=ht(),n="[object Arguments]",i="[object Array]",o="[object Boolean]",a="[object Date]",s="[object Error]",c="[object Function]",u="[object Map]",l="[object Number]",d="[object Object]",f="[object RegExp]",h="[object Set]",m="[object String]",y="[object WeakMap]",v="[object ArrayBuffer]",x="[object DataView]",b="[object Float32Array]",p="[object Float64Array]",w="[object Int8Array]",S="[object Int16Array]",_="[object Int32Array]",N="[object Uint8Array]",j="[object Uint8ClampedArray]",A="[object Uint16Array]",k="[object Uint32Array]",R={};R[b]=R[p]=R[w]=R[S]=R[_]=R[N]=R[j]=R[A]=R[k]=!0,R[n]=R[i]=R[v]=R[o]=R[x]=R[a]=R[s]=R[c]=R[u]=R[l]=R[d]=R[f]=R[h]=R[m]=R[y]=!1;function M(F){return r(F)&&t(F.length)&&!!R[e(F)]}return ma=M,ma}var va,ip;function Ii(){if(ip)return va;ip=1;function e(t){return function(r){return t(r)}}return va=e,va}var Br={exports:{}};Br.exports;var op;function kd(){return op||(op=1,(function(e,t){var r=mx(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o&&r.process,s=(function(){try{var c=i&&i.require&&i.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}})();e.exports=s})(Br,Br.exports)),Br.exports}var ya,ap;function mn(){if(ap)return ya;ap=1;var e=nT(),t=Ii(),r=kd(),n=r&&r.isTypedArray,i=n?t(n):e;return ya=i,ya}var xa,sp;function xx(){if(sp)return xa;sp=1;var e=eT(),t=gn(),r=we(),n=Nr(),i=Ci(),o=mn(),a=Object.prototype,s=a.hasOwnProperty;function c(u,l){var d=r(u),f=!d&&t(u),h=!d&&!f&&n(u),m=!d&&!f&&!h&&o(u),y=d||f||h||m,v=y?e(u.length,String):[],x=v.length;for(var b in u)(l||s.call(u,b))&&!(y&&(b=="length"||h&&(b=="offset"||b=="parent")||m&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,x)))&&v.push(b);return v}return xa=c,xa}var ba,cp;function Ri(){if(cp)return ba;cp=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return ba=t,ba}var wa,up;function bx(){if(up)return wa;up=1;function e(t,r){return function(n){return t(r(n))}}return wa=e,wa}var _a,lp;function iT(){if(lp)return _a;lp=1;var e=bx(),t=e(Object.keys,Object);return _a=t,_a}var Na,dp;function jd(){if(dp)return Na;dp=1;var e=Ri(),t=iT(),r=Object.prototype,n=r.hasOwnProperty;function i(o){if(!e(o))return t(o);var a=[];for(var s in Object(o))n.call(o,s)&&s!="constructor"&&a.push(s);return a}return Na=i,Na}var Sa,fp;function bt(){if(fp)return Sa;fp=1;var e=hn(),t=Ad();function r(n){return n!=null&&t(n.length)&&!e(n)}return Sa=r,Sa}var Ea,hp;function jt(){if(hp)return Ea;hp=1;var e=xx(),t=jd(),r=bt();function n(i){return r(i)?e(i):t(i)}return Ea=n,Ea}var Ca,pp;function oT(){if(pp)return Ca;pp=1;var e=pn(),t=jt();function r(n,i){return n&&e(i,t(i),n)}return Ca=r,Ca}var Ia,gp;function aT(){if(gp)return Ia;gp=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Ia=e,Ia}var Ra,mp;function sT(){if(mp)return Ra;mp=1;var e=Ke(),t=Ri(),r=aT(),n=Object.prototype,i=n.hasOwnProperty;function o(a){if(!e(a))return r(a);var s=t(a),c=[];for(var u in a)u=="constructor"&&(s||!i.call(a,u))||c.push(u);return c}return Ra=o,Ra}var Ta,vp;function Qt(){if(vp)return Ta;vp=1;var e=xx(),t=sT(),r=bt();function n(i){return r(i)?e(i,!0):t(i)}return Ta=n,Ta}var Aa,yp;function cT(){if(yp)return Aa;yp=1;var e=pn(),t=Qt();function r(n,i){return n&&e(i,t(i),n)}return Aa=r,Aa}var zr={exports:{}};zr.exports;var xp;function wx(){return xp||(xp=1,(function(e,t){var r=it(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function c(u,l){if(l)return u.slice();var d=u.length,f=s?s(d):new u.constructor(d);return u.copy(f),f}e.exports=c})(zr,zr.exports)),zr.exports}var ka,bp;function _x(){if(bp)return ka;bp=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return ka=e,ka}var ja,wp;function Nx(){if(wp)return ja;wp=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=0,a=[];++n<i;){var s=t[n];r(s,n,t)&&(a[o++]=s)}return a}return ja=e,ja}var Ma,_p;function Sx(){if(_p)return Ma;_p=1;function e(){return[]}return Ma=e,Ma}var qa,Np;function Md(){if(Np)return qa;Np=1;var e=Nx(),t=Sx(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,o=i?function(a){return a==null?[]:(a=Object(a),e(i(a),function(s){return n.call(a,s)}))}:t;return qa=o,qa}var Pa,Sp;function uT(){if(Sp)return Pa;Sp=1;var e=pn(),t=Md();function r(n,i){return e(n,t(n),i)}return Pa=r,Pa}var La,Ep;function qd(){if(Ep)return La;Ep=1;function e(t,r){for(var n=-1,i=r.length,o=t.length;++n<i;)t[o+n]=r[n];return t}return La=e,La}var Oa,Cp;function Ti(){if(Cp)return Oa;Cp=1;var e=bx(),t=e(Object.getPrototypeOf,Object);return Oa=t,Oa}var Da,Ip;function Ex(){if(Ip)return Da;Ip=1;var e=qd(),t=Ti(),r=Md(),n=Sx(),i=Object.getOwnPropertySymbols,o=i?function(a){for(var s=[];a;)e(s,r(a)),a=t(a);return s}:n;return Da=o,Da}var Fa,Rp;function lT(){if(Rp)return Fa;Rp=1;var e=pn(),t=Ex();function r(n,i){return e(n,t(n),i)}return Fa=r,Fa}var $a,Tp;function Cx(){if(Tp)return $a;Tp=1;var e=qd(),t=we();function r(n,i,o){var a=i(n);return t(n)?a:e(a,o(n))}return $a=r,$a}var Ba,Ap;function Ix(){if(Ap)return Ba;Ap=1;var e=Cx(),t=Md(),r=jt();function n(i){return e(i,r,t)}return Ba=n,Ba}var za,kp;function dT(){if(kp)return za;kp=1;var e=Cx(),t=Ex(),r=Qt();function n(i){return e(i,r,t)}return za=n,za}var Ha,jp;function fT(){if(jp)return Ha;jp=1;var e=Zt(),t=it(),r=e(t,"DataView");return Ha=r,Ha}var Va,Mp;function hT(){if(Mp)return Va;Mp=1;var e=Zt(),t=it(),r=e(t,"Promise");return Va=r,Va}var Ga,qp;function Rx(){if(qp)return Ga;qp=1;var e=Zt(),t=it(),r=e(t,"Set");return Ga=r,Ga}var Ua,Pp;function pT(){if(Pp)return Ua;Pp=1;var e=Zt(),t=it(),r=e(t,"WeakMap");return Ua=r,Ua}var Ka,Lp;function Sr(){if(Lp)return Ka;Lp=1;var e=fT(),t=Id(),r=hT(),n=Rx(),i=pT(),o=Xt(),a=vx(),s="[object Map]",c="[object Object]",u="[object Promise]",l="[object Set]",d="[object WeakMap]",f="[object DataView]",h=a(e),m=a(t),y=a(r),v=a(n),x=a(i),b=o;return(e&&b(new e(new ArrayBuffer(1)))!=f||t&&b(new t)!=s||r&&b(r.resolve())!=u||n&&b(new n)!=l||i&&b(new i)!=d)&&(b=function(p){var w=o(p),S=w==c?p.constructor:void 0,_=S?a(S):"";if(_)switch(_){case h:return f;case m:return s;case y:return u;case v:return l;case x:return d}return w}),Ka=b,Ka}var Wa,Op;function gT(){if(Op)return Wa;Op=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,o=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return Wa=r,Wa}var Ya,Dp;function Tx(){if(Dp)return Ya;Dp=1;var e=it(),t=e.Uint8Array;return Ya=t,Ya}var Xa,Fp;function Pd(){if(Fp)return Xa;Fp=1;var e=Tx();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return Xa=t,Xa}var Za,$p;function mT(){if($p)return Za;$p=1;var e=Pd();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return Za=t,Za}var Qa,Bp;function vT(){if(Bp)return Qa;Bp=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return Qa=t,Qa}var Ja,zp;function yT(){if(zp)return Ja;zp=1;var e=_r(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Ja=n,Ja}var es,Hp;function Ax(){if(Hp)return es;Hp=1;var e=Pd();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return es=t,es}var ts,Vp;function xT(){if(Vp)return ts;Vp=1;var e=Pd(),t=mT(),r=vT(),n=yT(),i=Ax(),o="[object Boolean]",a="[object Date]",s="[object Map]",c="[object Number]",u="[object RegExp]",l="[object Set]",d="[object String]",f="[object Symbol]",h="[object ArrayBuffer]",m="[object DataView]",y="[object Float32Array]",v="[object Float64Array]",x="[object Int8Array]",b="[object Int16Array]",p="[object Int32Array]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",_="[object Uint16Array]",N="[object Uint32Array]";function j(A,k,R){var M=A.constructor;switch(k){case h:return e(A);case o:case a:return new M(+A);case m:return t(A,R);case y:case v:case x:case b:case p:case w:case S:case _:case N:return i(A,R);case s:return new M;case c:case d:return new M(A);case u:return r(A);case l:return new M;case f:return n(A)}}return ts=j,ts}var rs,Gp;function kx(){if(Gp)return rs;Gp=1;var e=Ke(),t=Object.create,r=(function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var o=new n;return n.prototype=void 0,o}})();return rs=r,rs}var ns,Up;function jx(){if(Up)return ns;Up=1;var e=kx(),t=Ti(),r=Ri();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return ns=n,ns}var is,Kp;function bT(){if(Kp)return is;Kp=1;var e=Sr(),t=ht(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return is=n,is}var os,Wp;function wT(){if(Wp)return os;Wp=1;var e=bT(),t=Ii(),r=kd(),n=r&&r.isMap,i=n?t(n):e;return os=i,os}var as,Yp;function _T(){if(Yp)return as;Yp=1;var e=Sr(),t=ht(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return as=n,as}var ss,Xp;function NT(){if(Xp)return ss;Xp=1;var e=_T(),t=Ii(),r=kd(),n=r&&r.isSet,i=n?t(n):e;return ss=i,ss}var cs,Zp;function Mx(){if(Zp)return cs;Zp=1;var e=Ni(),t=Td(),r=Ei(),n=oT(),i=cT(),o=wx(),a=_x(),s=uT(),c=lT(),u=Ix(),l=dT(),d=Sr(),f=gT(),h=xT(),m=jx(),y=we(),v=Nr(),x=wT(),b=Ke(),p=NT(),w=jt(),S=Qt(),_=1,N=2,j=4,A="[object Arguments]",k="[object Array]",R="[object Boolean]",M="[object Date]",F="[object Error]",C="[object Function]",D="[object GeneratorFunction]",O="[object Map]",q="[object Number]",I="[object Object]",T="[object RegExp]",V="[object Set]",G="[object String]",K="[object Symbol]",Q="[object WeakMap]",P="[object ArrayBuffer]",$="[object DataView]",H="[object Float32Array]",B="[object Float64Array]",z="[object Int8Array]",X="[object Int16Array]",te="[object Int32Array]",ee="[object Uint8Array]",re="[object Uint8ClampedArray]",ne="[object Uint16Array]",Z="[object Uint32Array]",se={};se[A]=se[k]=se[P]=se[$]=se[R]=se[M]=se[H]=se[B]=se[z]=se[X]=se[te]=se[O]=se[q]=se[I]=se[T]=se[V]=se[G]=se[K]=se[ee]=se[re]=se[ne]=se[Z]=!0,se[F]=se[C]=se[Q]=!1;function le(ce,_e,Ne,Le,Re,Ie){var fe,Oe=_e&_,Ee=_e&N,Ae=_e&j;if(Ne&&(fe=Re?Ne(ce,Le,Re,Ie):Ne(ce)),fe!==void 0)return fe;if(!b(ce))return ce;var ke=y(ce);if(ke){if(fe=f(ce),!Oe)return a(ce,fe)}else{var He=d(ce),De=He==C||He==D;if(v(ce))return o(ce,Oe);if(He==I||He==A||De&&!Re){if(fe=Ee||De?{}:m(ce),!Oe)return Ee?c(ce,i(fe,ce)):s(ce,n(fe,ce))}else{if(!se[He])return Re?ce:{};fe=h(ce,He,Oe)}}Ie||(Ie=new e);var Ve=Ie.get(ce);if(Ve)return Ve;Ie.set(ce,fe),p(ce)?ce.forEach(function(Se){fe.add(le(Se,_e,Ne,Se,ce,Ie))}):x(ce)&&ce.forEach(function(Se,Ge){fe.set(Ge,le(Se,_e,Ne,Ge,ce,Ie))});var pt=Ae?Ee?l:u:Ee?S:w,Pt=ke?void 0:pt(ce);return t(Pt||ce,function(Se,Ge){Pt&&(Ge=Se,Se=ce[Ge]),r(fe,Ge,le(Se,_e,Ne,Ge,ce,Ie))}),fe}return cs=le,cs}var us,Qp;function ST(){if(Qp)return us;Qp=1;var e=Mx(),t=4;function r(n){return e(n,t)}return us=r,us}var ls,Jp;function Ld(){if(Jp)return ls;Jp=1;function e(t){return function(){return t}}return ls=e,ls}var ds,eg;function ET(){if(eg)return ds;eg=1;function e(t){return function(r,n,i){for(var o=-1,a=Object(r),s=i(r),c=s.length;c--;){var u=s[t?c:++o];if(n(a[u],u,a)===!1)break}return r}}return ds=e,ds}var fs,tg;function Od(){if(tg)return fs;tg=1;var e=ET(),t=e();return fs=t,fs}var hs,rg;function Dd(){if(rg)return hs;rg=1;var e=Od(),t=jt();function r(n,i){return n&&e(n,i,t)}return hs=r,hs}var ps,ng;function CT(){if(ng)return ps;ng=1;var e=bt();function t(r,n){return function(i,o){if(i==null)return i;if(!e(i))return r(i,o);for(var a=i.length,s=n?a:-1,c=Object(i);(n?s--:++s<a)&&o(c[s],s,c)!==!1;);return i}}return ps=t,ps}var gs,ig;function Ai(){if(ig)return gs;ig=1;var e=Dd(),t=CT(),r=t(e);return gs=r,gs}var ms,og;function Jt(){if(og)return ms;og=1;function e(t){return t}return ms=e,ms}var vs,ag;function qx(){if(ag)return vs;ag=1;var e=Jt();function t(r){return typeof r=="function"?r:e}return vs=t,vs}var ys,sg;function Px(){if(sg)return ys;sg=1;var e=Td(),t=Ai(),r=qx(),n=we();function i(o,a){var s=n(o)?e:t;return s(o,r(a))}return ys=i,ys}var xs,cg;function Lx(){return cg||(cg=1,xs=Px()),xs}var bs,ug;function IT(){if(ug)return bs;ug=1;var e=Ai();function t(r,n){var i=[];return e(r,function(o,a,s){n(o,a,s)&&i.push(o)}),i}return bs=t,bs}var ws,lg;function RT(){if(lg)return ws;lg=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return ws=t,ws}var _s,dg;function TT(){if(dg)return _s;dg=1;function e(t){return this.__data__.has(t)}return _s=e,_s}var Ns,fg;function Ox(){if(fg)return Ns;fg=1;var e=Rd(),t=RT(),r=TT();function n(i){var o=-1,a=i==null?0:i.length;for(this.__data__=new e;++o<a;)this.add(i[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Ns=n,Ns}var Ss,hg;function AT(){if(hg)return Ss;hg=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return Ss=e,Ss}var Es,pg;function Dx(){if(pg)return Es;pg=1;function e(t,r){return t.has(r)}return Es=e,Es}var Cs,gg;function Fx(){if(gg)return Cs;gg=1;var e=Ox(),t=AT(),r=Dx(),n=1,i=2;function o(a,s,c,u,l,d){var f=c&n,h=a.length,m=s.length;if(h!=m&&!(f&&m>h))return!1;var y=d.get(a),v=d.get(s);if(y&&v)return y==s&&v==a;var x=-1,b=!0,p=c&i?new e:void 0;for(d.set(a,s),d.set(s,a);++x<h;){var w=a[x],S=s[x];if(u)var _=f?u(S,w,x,s,a,d):u(w,S,x,a,s,d);if(_!==void 0){if(_)continue;b=!1;break}if(p){if(!t(s,function(N,j){if(!r(p,j)&&(w===N||l(w,N,c,u,d)))return p.push(j)})){b=!1;break}}else if(!(w===S||l(w,S,c,u,d))){b=!1;break}}return d.delete(a),d.delete(s),b}return Cs=o,Cs}var Is,mg;function kT(){if(mg)return Is;mg=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,o){n[++r]=[o,i]}),n}return Is=e,Is}var Rs,vg;function Fd(){if(vg)return Rs;vg=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return Rs=e,Rs}var Ts,yg;function jT(){if(yg)return Ts;yg=1;var e=_r(),t=Tx(),r=wr(),n=Fx(),i=kT(),o=Fd(),a=1,s=2,c="[object Boolean]",u="[object Date]",l="[object Error]",d="[object Map]",f="[object Number]",h="[object RegExp]",m="[object Set]",y="[object String]",v="[object Symbol]",x="[object ArrayBuffer]",b="[object DataView]",p=e?e.prototype:void 0,w=p?p.valueOf:void 0;function S(_,N,j,A,k,R,M){switch(j){case b:if(_.byteLength!=N.byteLength||_.byteOffset!=N.byteOffset)return!1;_=_.buffer,N=N.buffer;case x:return!(_.byteLength!=N.byteLength||!R(new t(_),new t(N)));case c:case u:case f:return r(+_,+N);case l:return _.name==N.name&&_.message==N.message;case h:case y:return _==N+"";case d:var F=i;case m:var C=A&a;if(F||(F=o),_.size!=N.size&&!C)return!1;var D=M.get(_);if(D)return D==N;A|=s,M.set(_,N);var O=n(F(_),F(N),A,k,R,M);return M.delete(_),O;case v:if(w)return w.call(_)==w.call(N)}return!1}return Ts=S,Ts}var As,xg;function MT(){if(xg)return As;xg=1;var e=Ix(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(o,a,s,c,u,l){var d=s&t,f=e(o),h=f.length,m=e(a),y=m.length;if(h!=y&&!d)return!1;for(var v=h;v--;){var x=f[v];if(!(d?x in a:n.call(a,x)))return!1}var b=l.get(o),p=l.get(a);if(b&&p)return b==a&&p==o;var w=!0;l.set(o,a),l.set(a,o);for(var S=d;++v<h;){x=f[v];var _=o[x],N=a[x];if(c)var j=d?c(N,_,x,a,o,l):c(_,N,x,o,a,l);if(!(j===void 0?_===N||u(_,N,s,c,l):j)){w=!1;break}S||(S=x=="constructor")}if(w&&!S){var A=o.constructor,k=a.constructor;A!=k&&"constructor"in o&&"constructor"in a&&!(typeof A=="function"&&A instanceof A&&typeof k=="function"&&k instanceof k)&&(w=!1)}return l.delete(o),l.delete(a),w}return As=i,As}var ks,bg;function qT(){if(bg)return ks;bg=1;var e=Ni(),t=Fx(),r=jT(),n=MT(),i=Sr(),o=we(),a=Nr(),s=mn(),c=1,u="[object Arguments]",l="[object Array]",d="[object Object]",f=Object.prototype,h=f.hasOwnProperty;function m(y,v,x,b,p,w){var S=o(y),_=o(v),N=S?l:i(y),j=_?l:i(v);N=N==u?d:N,j=j==u?d:j;var A=N==d,k=j==d,R=N==j;if(R&&a(y)){if(!a(v))return!1;S=!0,A=!1}if(R&&!A)return w||(w=new e),S||s(y)?t(y,v,x,b,p,w):r(y,v,N,x,b,p,w);if(!(x&c)){var M=A&&h.call(y,"__wrapped__"),F=k&&h.call(v,"__wrapped__");if(M||F){var C=M?y.value():y,D=F?v.value():v;return w||(w=new e),p(C,D,x,b,w)}}return R?(w||(w=new e),n(y,v,x,b,p,w)):!1}return ks=m,ks}var js,wg;function $x(){if(wg)return js;wg=1;var e=qT(),t=ht();function r(n,i,o,a,s){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,o,a,r,s)}return js=r,js}var Ms,_g;function PT(){if(_g)return Ms;_g=1;var e=Ni(),t=$x(),r=1,n=2;function i(o,a,s,c){var u=s.length,l=u,d=!c;if(o==null)return!l;for(o=Object(o);u--;){var f=s[u];if(d&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++u<l;){f=s[u];var h=f[0],m=o[h],y=f[1];if(d&&f[2]){if(m===void 0&&!(h in o))return!1}else{var v=new e;if(c)var x=c(m,y,h,o,a,v);if(!(x===void 0?t(y,m,r|n,c,v):x))return!1}}return!0}return Ms=i,Ms}var qs,Ng;function Bx(){if(Ng)return qs;Ng=1;var e=Ke();function t(r){return r===r&&!e(r)}return qs=t,qs}var Ps,Sg;function LT(){if(Sg)return Ps;Sg=1;var e=Bx(),t=jt();function r(n){for(var i=t(n),o=i.length;o--;){var a=i[o],s=n[a];i[o]=[a,s,e(s)]}return i}return Ps=r,Ps}var Ls,Eg;function zx(){if(Eg)return Ls;Eg=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Ls=e,Ls}var Os,Cg;function OT(){if(Cg)return Os;Cg=1;var e=PT(),t=LT(),r=zx();function n(i){var o=t(i);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(a){return a===i||e(a,i,o)}}return Os=n,Os}var Ds,Ig;function Er(){if(Ig)return Ds;Ig=1;var e=Xt(),t=ht(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return Ds=n,Ds}var Fs,Rg;function $d(){if(Rg)return Fs;Rg=1;var e=we(),t=Er(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(o,a){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||a!=null&&o in Object(a)}return Fs=i,Fs}var $s,Tg;function DT(){if(Tg)return $s;Tg=1;var e=Rd(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var o=function(){var a=arguments,s=i?i.apply(this,a):a[0],c=o.cache;if(c.has(s))return c.get(s);var u=n.apply(this,a);return o.cache=c.set(s,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,$s=r,$s}var Bs,Ag;function FT(){if(Ag)return Bs;Ag=1;var e=DT(),t=500;function r(n){var i=e(n,function(a){return o.size===t&&o.clear(),a}),o=i.cache;return i}return Bs=r,Bs}var zs,kg;function $T(){if(kg)return zs;kg=1;var e=FT(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(t,function(a,s,c,u){o.push(c?u.replace(r,"$1"):s||a)}),o});return zs=n,zs}var Hs,jg;function ki(){if(jg)return Hs;jg=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,o=Array(i);++n<i;)o[n]=r(t[n],n,t);return o}return Hs=e,Hs}var Vs,Mg;function BT(){if(Mg)return Vs;Mg=1;var e=_r(),t=ki(),r=we(),n=Er(),i=e?e.prototype:void 0,o=i?i.toString:void 0;function a(s){if(typeof s=="string")return s;if(r(s))return t(s,a)+"";if(n(s))return o?o.call(s):"";var c=s+"";return c=="0"&&1/s==-1/0?"-0":c}return Vs=a,Vs}var Gs,qg;function Hx(){if(qg)return Gs;qg=1;var e=BT();function t(r){return r==null?"":e(r)}return Gs=t,Gs}var Us,Pg;function ji(){if(Pg)return Us;Pg=1;var e=we(),t=$d(),r=$T(),n=Hx();function i(o,a){return e(o)?o:t(o,a)?[o]:r(n(o))}return Us=i,Us}var Ks,Lg;function vn(){if(Lg)return Ks;Lg=1;var e=Er();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Ks=t,Ks}var Ws,Og;function Mi(){if(Og)return Ws;Og=1;var e=ji(),t=vn();function r(n,i){i=e(i,n);for(var o=0,a=i.length;n!=null&&o<a;)n=n[t(i[o++])];return o&&o==a?n:void 0}return Ws=r,Ws}var Ys,Dg;function zT(){if(Dg)return Ys;Dg=1;var e=Mi();function t(r,n,i){var o=r==null?void 0:e(r,n);return o===void 0?i:o}return Ys=t,Ys}var Xs,Fg;function HT(){if(Fg)return Xs;Fg=1;function e(t,r){return t!=null&&r in Object(t)}return Xs=e,Xs}var Zs,$g;function Vx(){if($g)return Zs;$g=1;var e=ji(),t=gn(),r=we(),n=Ci(),i=Ad(),o=vn();function a(s,c,u){c=e(c,s);for(var l=-1,d=c.length,f=!1;++l<d;){var h=o(c[l]);if(!(f=s!=null&&u(s,h)))break;s=s[h]}return f||++l!=d?f:(d=s==null?0:s.length,!!d&&i(d)&&n(h,d)&&(r(s)||t(s)))}return Zs=a,Zs}var Qs,Bg;function Gx(){if(Bg)return Qs;Bg=1;var e=HT(),t=Vx();function r(n,i){return n!=null&&t(n,i,e)}return Qs=r,Qs}var Js,zg;function VT(){if(zg)return Js;zg=1;var e=$x(),t=zT(),r=Gx(),n=$d(),i=Bx(),o=zx(),a=vn(),s=1,c=2;function u(l,d){return n(l)&&i(d)?o(a(l),d):function(f){var h=t(f,l);return h===void 0&&h===d?r(f,l):e(d,h,s|c)}}return Js=u,Js}var ec,Hg;function Ux(){if(Hg)return ec;Hg=1;function e(t){return function(r){return r==null?void 0:r[t]}}return ec=e,ec}var tc,Vg;function GT(){if(Vg)return tc;Vg=1;var e=Mi();function t(r){return function(n){return e(n,r)}}return tc=t,tc}var rc,Gg;function UT(){if(Gg)return rc;Gg=1;var e=Ux(),t=GT(),r=$d(),n=vn();function i(o){return r(o)?e(n(o)):t(o)}return rc=i,rc}var nc,Ug;function wt(){if(Ug)return nc;Ug=1;var e=OT(),t=VT(),r=Jt(),n=we(),i=UT();function o(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?n(a)?t(a[0],a[1]):e(a):i(a)}return nc=o,nc}var ic,Kg;function Kx(){if(Kg)return ic;Kg=1;var e=Nx(),t=IT(),r=wt(),n=we();function i(o,a){var s=n(o)?e:t;return s(o,r(a,3))}return ic=i,ic}var oc,Wg;function KT(){if(Wg)return oc;Wg=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return oc=r,oc}var ac,Yg;function Wx(){if(Yg)return ac;Yg=1;var e=KT(),t=Vx();function r(n,i){return n!=null&&t(n,i,e)}return ac=r,ac}var sc,Xg;function WT(){if(Xg)return sc;Xg=1;var e=jd(),t=Sr(),r=gn(),n=we(),i=bt(),o=Nr(),a=Ri(),s=mn(),c="[object Map]",u="[object Set]",l=Object.prototype,d=l.hasOwnProperty;function f(h){if(h==null)return!0;if(i(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||s(h)||r(h)))return!h.length;var m=t(h);if(m==c||m==u)return!h.size;if(a(h))return!e(h).length;for(var y in h)if(d.call(h,y))return!1;return!0}return sc=f,sc}var cc,Zg;function Yx(){if(Zg)return cc;Zg=1;function e(t){return t===void 0}return cc=e,cc}var uc,Qg;function Xx(){if(Qg)return uc;Qg=1;var e=Ai(),t=bt();function r(n,i){var o=-1,a=t(n)?Array(n.length):[];return e(n,function(s,c,u){a[++o]=i(s,c,u)}),a}return uc=r,uc}var lc,Jg;function Zx(){if(Jg)return lc;Jg=1;var e=ki(),t=wt(),r=Xx(),n=we();function i(o,a){var s=n(o)?e:r;return s(o,t(a,3))}return lc=i,lc}var dc,em;function YT(){if(em)return dc;em=1;function e(t,r,n,i){var o=-1,a=t==null?0:t.length;for(i&&a&&(n=t[++o]);++o<a;)n=r(n,t[o],o,t);return n}return dc=e,dc}var fc,tm;function XT(){if(tm)return fc;tm=1;function e(t,r,n,i,o){return o(t,function(a,s,c){n=i?(i=!1,a):r(n,a,s,c)}),n}return fc=e,fc}var hc,rm;function Qx(){if(rm)return hc;rm=1;var e=YT(),t=Ai(),r=wt(),n=XT(),i=we();function o(a,s,c){var u=i(a)?e:n,l=arguments.length<3;return u(a,r(s,4),c,l,t)}return hc=o,hc}var pc,nm;function ZT(){if(nm)return pc;nm=1;var e=Xt(),t=we(),r=ht(),n="[object String]";function i(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return pc=i,pc}var gc,im;function QT(){if(im)return gc;im=1;var e=Ux(),t=e("length");return gc=t,gc}var mc,om;function JT(){if(om)return mc;om=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",a="\\u200d",s=RegExp("["+a+e+i+o+"]");function c(u){return s.test(u)}return mc=c,mc}var vc,am;function eA(){if(am)return vc;am=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,o="\\ufe0e\\ufe0f",a="["+e+"]",s="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+s+"|"+c+")",l="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",m=u+"?",y="["+o+"]?",v="(?:"+h+"(?:"+[l,d,f].join("|")+")"+y+m+")*",x=y+m+v,b="(?:"+[l+s+"?",s,d,f,a].join("|")+")",p=RegExp(c+"(?="+c+")|"+b+x,"g");function w(S){for(var _=p.lastIndex=0;p.test(S);)++_;return _}return vc=w,vc}var yc,sm;function tA(){if(sm)return yc;sm=1;var e=QT(),t=JT(),r=eA();function n(i){return t(i)?r(i):e(i)}return yc=n,yc}var xc,cm;function rA(){if(cm)return xc;cm=1;var e=jd(),t=Sr(),r=bt(),n=ZT(),i=tA(),o="[object Map]",a="[object Set]";function s(c){if(c==null)return 0;if(r(c))return n(c)?i(c):c.length;var u=t(c);return u==o||u==a?c.size:e(c).length}return xc=s,xc}var bc,um;function nA(){if(um)return bc;um=1;var e=Td(),t=kx(),r=Dd(),n=wt(),i=Ti(),o=we(),a=Nr(),s=hn(),c=Ke(),u=mn();function l(d,f,h){var m=o(d),y=m||a(d)||u(d);if(f=n(f,4),h==null){var v=d&&d.constructor;y?h=m?new v:[]:c(d)?h=s(v)?t(i(d)):{}:h={}}return(y?e:r)(d,function(x,b,p){return f(h,x,b,p)}),h}return bc=l,bc}var wc,lm;function iA(){if(lm)return wc;lm=1;var e=_r(),t=gn(),r=we(),n=e?e.isConcatSpreadable:void 0;function i(o){return r(o)||t(o)||!!(n&&o&&o[n])}return wc=i,wc}var _c,dm;function Bd(){if(dm)return _c;dm=1;var e=qd(),t=iA();function r(n,i,o,a,s){var c=-1,u=n.length;for(o||(o=t),s||(s=[]);++c<u;){var l=n[c];i>0&&o(l)?i>1?r(l,i-1,o,a,s):e(s,l):a||(s[s.length]=l)}return s}return _c=r,_c}var Nc,fm;function oA(){if(fm)return Nc;fm=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Nc=e,Nc}var Sc,hm;function Jx(){if(hm)return Sc;hm=1;var e=oA(),t=Math.max;function r(n,i,o){return i=t(i===void 0?n.length-1:i,0),function(){for(var a=arguments,s=-1,c=t(a.length-i,0),u=Array(c);++s<c;)u[s]=a[i+s];s=-1;for(var l=Array(i+1);++s<i;)l[s]=a[s];return l[i]=o(u),e(n,this,l)}}return Sc=r,Sc}var Ec,pm;function aA(){if(pm)return Ec;pm=1;var e=Ld(),t=yx(),r=Jt(),n=t?function(i,o){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Ec=n,Ec}var Cc,gm;function sA(){if(gm)return Cc;gm=1;var e=800,t=16,r=Date.now;function n(i){var o=0,a=0;return function(){var s=r(),c=t-(s-a);if(a=s,c>0){if(++o>=e)return arguments[0]}else o=0;return i.apply(void 0,arguments)}}return Cc=n,Cc}var Ic,mm;function eb(){if(mm)return Ic;mm=1;var e=aA(),t=sA(),r=t(e);return Ic=r,Ic}var Rc,vm;function qi(){if(vm)return Rc;vm=1;var e=Jt(),t=Jx(),r=eb();function n(i,o){return r(t(i,o,e),i+"")}return Rc=n,Rc}var Tc,ym;function tb(){if(ym)return Tc;ym=1;function e(t,r,n,i){for(var o=t.length,a=n+(i?1:-1);i?a--:++a<o;)if(r(t[a],a,t))return a;return-1}return Tc=e,Tc}var Ac,xm;function cA(){if(xm)return Ac;xm=1;function e(t){return t!==t}return Ac=e,Ac}var kc,bm;function uA(){if(bm)return kc;bm=1;function e(t,r,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===r)return i;return-1}return kc=e,kc}var jc,wm;function lA(){if(wm)return jc;wm=1;var e=tb(),t=cA(),r=uA();function n(i,o,a){return o===o?r(i,o,a):e(i,t,a)}return jc=n,jc}var Mc,_m;function dA(){if(_m)return Mc;_m=1;var e=lA();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return Mc=t,Mc}var qc,Nm;function fA(){if(Nm)return qc;Nm=1;function e(t,r,n){for(var i=-1,o=t==null?0:t.length;++i<o;)if(n(r,t[i]))return!0;return!1}return qc=e,qc}var Pc,Sm;function hA(){if(Sm)return Pc;Sm=1;function e(){}return Pc=e,Pc}var Lc,Em;function pA(){if(Em)return Lc;Em=1;var e=Rx(),t=hA(),r=Fd(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Lc=i,Lc}var Oc,Cm;function gA(){if(Cm)return Oc;Cm=1;var e=Ox(),t=dA(),r=fA(),n=Dx(),i=pA(),o=Fd(),a=200;function s(c,u,l){var d=-1,f=t,h=c.length,m=!0,y=[],v=y;if(l)m=!1,f=r;else if(h>=a){var x=u?null:i(c);if(x)return o(x);m=!1,f=n,v=new e}else v=u?[]:y;e:for(;++d<h;){var b=c[d],p=u?u(b):b;if(b=l||b!==0?b:0,m&&p===p){for(var w=v.length;w--;)if(v[w]===p)continue e;u&&v.push(p),y.push(b)}else f(v,p,l)||(v!==y&&v.push(p),y.push(b))}return y}return Oc=s,Oc}var Dc,Im;function rb(){if(Im)return Dc;Im=1;var e=bt(),t=ht();function r(n){return t(n)&&e(n)}return Dc=r,Dc}var Fc,Rm;function mA(){if(Rm)return Fc;Rm=1;var e=Bd(),t=qi(),r=gA(),n=rb(),i=t(function(o){return r(e(o,1,n,!0))});return Fc=i,Fc}var $c,Tm;function vA(){if(Tm)return $c;Tm=1;var e=ki();function t(r,n){return e(n,function(i){return r[i]})}return $c=t,$c}var Bc,Am;function nb(){if(Am)return Bc;Am=1;var e=vA(),t=jt();function r(n){return n==null?[]:e(n,t(n))}return Bc=r,Bc}var zc,km;function We(){if(km)return zc;km=1;var e;if(typeof ad=="function")try{e={clone:ST(),constant:Ld(),each:Lx(),filter:Kx(),has:Wx(),isArray:we(),isEmpty:WT(),isFunction:hn(),isUndefined:Yx(),keys:jt(),map:Zx(),reduce:Qx(),size:rA(),transform:nA(),union:mA(),values:nb()}}catch{}return e||(e=window._),zc=e,zc}var Hc,jm;function zd(){if(jm)return Hc;jm=1;var e=We();Hc=i;var t="\0",r="\0",n="";function i(l){this._isDirected=e.has(l,"directed")?l.directed:!0,this._isMultigraph=e.has(l,"multigraph")?l.multigraph:!1,this._isCompound=e.has(l,"compound")?l.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(l){return this._label=l,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(l){return e.isFunction(l)||(l=e.constant(l)),this._defaultNodeLabelFn=l,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var l=this;return e.filter(this.nodes(),function(d){return e.isEmpty(l._in[d])})},i.prototype.sinks=function(){var l=this;return e.filter(this.nodes(),function(d){return e.isEmpty(l._out[d])})},i.prototype.setNodes=function(l,d){var f=arguments,h=this;return e.each(l,function(m){f.length>1?h.setNode(m,d):h.setNode(m)}),this},i.prototype.setNode=function(l,d){return e.has(this._nodes,l)?(arguments.length>1&&(this._nodes[l]=d),this):(this._nodes[l]=arguments.length>1?d:this._defaultNodeLabelFn(l),this._isCompound&&(this._parent[l]=r,this._children[l]={},this._children[r][l]=!0),this._in[l]={},this._preds[l]={},this._out[l]={},this._sucs[l]={},++this._nodeCount,this)},i.prototype.node=function(l){return this._nodes[l]},i.prototype.hasNode=function(l){return e.has(this._nodes,l)},i.prototype.removeNode=function(l){var d=this;if(e.has(this._nodes,l)){var f=function(h){d.removeEdge(d._edgeObjs[h])};delete this._nodes[l],this._isCompound&&(this._removeFromParentsChildList(l),delete this._parent[l],e.each(this.children(l),function(h){d.setParent(h)}),delete this._children[l]),e.each(e.keys(this._in[l]),f),delete this._in[l],delete this._preds[l],e.each(e.keys(this._out[l]),f),delete this._out[l],delete this._sucs[l],--this._nodeCount}return this},i.prototype.setParent=function(l,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(d))d=r;else{d+="";for(var f=d;!e.isUndefined(f);f=this.parent(f))if(f===l)throw new Error("Setting "+d+" as parent of "+l+" would create a cycle");this.setNode(d)}return this.setNode(l),this._removeFromParentsChildList(l),this._parent[l]=d,this._children[d][l]=!0,this},i.prototype._removeFromParentsChildList=function(l){delete this._children[this._parent[l]][l]},i.prototype.parent=function(l){if(this._isCompound){var d=this._parent[l];if(d!==r)return d}},i.prototype.children=function(l){if(e.isUndefined(l)&&(l=r),this._isCompound){var d=this._children[l];if(d)return e.keys(d)}else{if(l===r)return this.nodes();if(this.hasNode(l))return[]}},i.prototype.predecessors=function(l){var d=this._preds[l];if(d)return e.keys(d)},i.prototype.successors=function(l){var d=this._sucs[l];if(d)return e.keys(d)},i.prototype.neighbors=function(l){var d=this.predecessors(l);if(d)return e.union(d,this.successors(l))},i.prototype.isLeaf=function(l){var d;return this.isDirected()?d=this.successors(l):d=this.neighbors(l),d.length===0},i.prototype.filterNodes=function(l){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;e.each(this._nodes,function(y,v){l(v)&&d.setNode(v,y)}),e.each(this._edgeObjs,function(y){d.hasNode(y.v)&&d.hasNode(y.w)&&d.setEdge(y,f.edge(y))});var h={};function m(y){var v=f.parent(y);return v===void 0||d.hasNode(v)?(h[y]=v,v):v in h?h[v]:m(v)}return this._isCompound&&e.each(d.nodes(),function(y){d.setParent(y,m(y))}),d},i.prototype.setDefaultEdgeLabel=function(l){return e.isFunction(l)||(l=e.constant(l)),this._defaultEdgeLabelFn=l,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(l,d){var f=this,h=arguments;return e.reduce(l,function(m,y){return h.length>1?f.setEdge(m,y,d):f.setEdge(m,y),y}),this},i.prototype.setEdge=function(){var l,d,f,h,m=!1,y=arguments[0];typeof y=="object"&&y!==null&&"v"in y?(l=y.v,d=y.w,f=y.name,arguments.length===2&&(h=arguments[1],m=!0)):(l=y,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],m=!0)),l=""+l,d=""+d,e.isUndefined(f)||(f=""+f);var v=s(this._isDirected,l,d,f);if(e.has(this._edgeLabels,v))return m&&(this._edgeLabels[v]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(l),this.setNode(d),this._edgeLabels[v]=m?h:this._defaultEdgeLabelFn(l,d,f);var x=c(this._isDirected,l,d,f);return l=x.v,d=x.w,Object.freeze(x),this._edgeObjs[v]=x,o(this._preds[d],l),o(this._sucs[l],d),this._in[d][v]=x,this._out[l][v]=x,this._edgeCount++,this},i.prototype.edge=function(l,d,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,l,d,f);return this._edgeLabels[h]},i.prototype.hasEdge=function(l,d,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,l,d,f);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(l,d,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,l,d,f),m=this._edgeObjs[h];return m&&(l=m.v,d=m.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[d],l),a(this._sucs[l],d),delete this._in[d][h],delete this._out[l][h],this._edgeCount--),this},i.prototype.inEdges=function(l,d){var f=this._in[l];if(f){var h=e.values(f);return d?e.filter(h,function(m){return m.v===d}):h}},i.prototype.outEdges=function(l,d){var f=this._out[l];if(f){var h=e.values(f);return d?e.filter(h,function(m){return m.w===d}):h}},i.prototype.nodeEdges=function(l,d){var f=this.inEdges(l,d);if(f)return f.concat(this.outEdges(l,d))};function o(l,d){l[d]?l[d]++:l[d]=1}function a(l,d){--l[d]||delete l[d]}function s(l,d,f,h){var m=""+d,y=""+f;if(!l&&m>y){var v=m;m=y,y=v}return m+n+y+n+(e.isUndefined(h)?t:h)}function c(l,d,f,h){var m=""+d,y=""+f;if(!l&&m>y){var v=m;m=y,y=v}var x={v:m,w:y};return h&&(x.name=h),x}function u(l,d){return s(l,d.v,d.w,d.name)}return Hc}var Vc,Mm;function yA(){return Mm||(Mm=1,Vc="2.1.8"),Vc}var Gc,qm;function xA(){return qm||(qm=1,Gc={Graph:zd(),version:yA()}),Gc}var Uc,Pm;function bA(){if(Pm)return Uc;Pm=1;var e=We(),t=zd();Uc={write:r,read:o};function r(a){var s={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:n(a),edges:i(a)};return e.isUndefined(a.graph())||(s.value=e.clone(a.graph())),s}function n(a){return e.map(a.nodes(),function(s){var c=a.node(s),u=a.parent(s),l={v:s};return e.isUndefined(c)||(l.value=c),e.isUndefined(u)||(l.parent=u),l})}function i(a){return e.map(a.edges(),function(s){var c=a.edge(s),u={v:s.v,w:s.w};return e.isUndefined(s.name)||(u.name=s.name),e.isUndefined(c)||(u.value=c),u})}function o(a){var s=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){s.setNode(c.v,c.value),c.parent&&s.setParent(c.v,c.parent)}),e.each(a.edges,function(c){s.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),s}return Uc}var Kc,Lm;function wA(){if(Lm)return Kc;Lm=1;var e=We();Kc=t;function t(r){var n={},i=[],o;function a(s){e.has(n,s)||(n[s]=!0,o.push(s),e.each(r.successors(s),a),e.each(r.predecessors(s),a))}return e.each(r.nodes(),function(s){o=[],a(s),o.length&&i.push(o)}),i}return Kc}var Wc,Om;function ib(){if(Om)return Wc;Om=1;var e=We();Wc=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var o=this._arr,a=o.length;return i[r]=a,o.push({key:r,priority:n}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,o=i+1,a=r;i<n.length&&(a=n[i].priority<n[a].priority?i:a,o<n.length&&(a=n[o].priority<n[a].priority?o:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<i));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var i=this._arr,o=this._keyIndices,a=i[r],s=i[n];i[r]=s,i[n]=a,o[s.key]=r,o[a.key]=n},Wc}var Yc,Dm;function ob(){if(Dm)return Yc;Dm=1;var e=We(),t=ib();Yc=n;var r=e.constant(1);function n(o,a,s,c){return i(o,String(a),s||r,c||function(u){return o.outEdges(u)})}function i(o,a,s,c){var u={},l=new t,d,f,h=function(m){var y=m.v!==d?m.v:m.w,v=u[y],x=s(m),b=f.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+x);b<v.distance&&(v.distance=b,v.predecessor=d,l.decrease(y,b))};for(o.nodes().forEach(function(m){var y=m===a?0:Number.POSITIVE_INFINITY;u[m]={distance:y},l.add(m,y)});l.size()>0&&(d=l.removeMin(),f=u[d],f.distance!==Number.POSITIVE_INFINITY);)c(d).forEach(h);return u}return Yc}var Xc,Fm;function _A(){if(Fm)return Xc;Fm=1;var e=ob(),t=We();Xc=r;function r(n,i,o){return t.transform(n.nodes(),function(a,s){a[s]=e(n,s,i,o)},{})}return Xc}var Zc,$m;function ab(){if($m)return Zc;$m=1;var e=We();Zc=t;function t(r){var n=0,i=[],o={},a=[];function s(c){var u=o[c]={onStack:!0,lowlink:n,index:n++};if(i.push(c),r.successors(c).forEach(function(f){e.has(o,f)?o[f].onStack&&(u.lowlink=Math.min(u.lowlink,o[f].index)):(s(f),u.lowlink=Math.min(u.lowlink,o[f].lowlink))}),u.lowlink===u.index){var l=[],d;do d=i.pop(),o[d].onStack=!1,l.push(d);while(c!==d);a.push(l)}}return r.nodes().forEach(function(c){e.has(o,c)||s(c)}),a}return Zc}var Qc,Bm;function NA(){if(Bm)return Qc;Bm=1;var e=We(),t=ab();Qc=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Qc}var Jc,zm;function SA(){if(zm)return Jc;zm=1;var e=We();Jc=r;var t=e.constant(1);function r(i,o,a){return n(i,o||t,a||function(s){return i.outEdges(s)})}function n(i,o,a){var s={},c=i.nodes();return c.forEach(function(u){s[u]={},s[u][u]={distance:0},c.forEach(function(l){u!==l&&(s[u][l]={distance:Number.POSITIVE_INFINITY})}),a(u).forEach(function(l){var d=l.v===u?l.w:l.v,f=o(l);s[u][d]={distance:f,predecessor:u}})}),c.forEach(function(u){var l=s[u];c.forEach(function(d){var f=s[d];c.forEach(function(h){var m=f[u],y=l[h],v=f[h],x=m.distance+y.distance;x<v.distance&&(v.distance=x,v.predecessor=y.predecessor)})})}),s}return Jc}var eu,Hm;function sb(){if(Hm)return eu;Hm=1;var e=We();eu=t,t.CycleException=r;function t(n){var i={},o={},a=[];function s(c){if(e.has(o,c))throw new r;e.has(i,c)||(o[c]=!0,i[c]=!0,e.each(n.predecessors(c),s),delete o[c],a.push(c))}if(e.each(n.sinks(),s),e.size(i)!==n.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,eu}var tu,Vm;function EA(){if(Vm)return tu;Vm=1;var e=sb();tu=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return tu}var ru,Gm;function cb(){if(Gm)return ru;Gm=1;var e=We();ru=t;function t(n,i,o){e.isArray(i)||(i=[i]);var a=(n.isDirected()?n.successors:n.neighbors).bind(n),s=[],c={};return e.each(i,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,o==="post",c,a,s)}),s}function r(n,i,o,a,s,c){e.has(a,i)||(a[i]=!0,o||c.push(i),e.each(s(i),function(u){r(n,u,o,a,s,c)}),o&&c.push(i))}return ru}var nu,Um;function CA(){if(Um)return nu;Um=1;var e=cb();nu=t;function t(r,n){return e(r,n,"post")}return nu}var iu,Km;function IA(){if(Km)return iu;Km=1;var e=cb();iu=t;function t(r,n){return e(r,n,"pre")}return iu}var ou,Wm;function RA(){if(Wm)return ou;Wm=1;var e=We(),t=zd(),r=ib();ou=n;function n(i,o){var a=new t,s={},c=new r,u;function l(f){var h=f.v===u?f.w:f.v,m=c.priority(h);if(m!==void 0){var y=o(f);y<m&&(s[h]=u,c.decrease(h,y))}}if(i.nodeCount()===0)return a;e.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),a.setNode(f)}),c.decrease(i.nodes()[0],0);for(var d=!1;c.size()>0;){if(u=c.removeMin(),e.has(s,u))a.setEdge(u,s[u]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(u).forEach(l)}return a}return ou}var au,Ym;function TA(){return Ym||(Ym=1,au={components:wA(),dijkstra:ob(),dijkstraAll:_A(),findCycles:NA(),floydWarshall:SA(),isAcyclic:EA(),postorder:CA(),preorder:IA(),prim:RA(),tarjan:ab(),topsort:sb()}),au}var su,Xm;function AA(){if(Xm)return su;Xm=1;var e=xA();return su={Graph:e.Graph,json:bA(),alg:TA(),version:e.version},su}var cu,Zm;function tt(){if(Zm)return cu;Zm=1;var e;if(typeof ad=="function")try{e=AA()}catch{}return e||(e=window.graphlib),cu=e,cu}var uu,Qm;function kA(){if(Qm)return uu;Qm=1;var e=Mx(),t=1,r=4;function n(i){return e(i,t|r)}return uu=n,uu}var lu,Jm;function Pi(){if(Jm)return lu;Jm=1;var e=wr(),t=bt(),r=Ci(),n=Ke();function i(o,a,s){if(!n(s))return!1;var c=typeof a;return(c=="number"?t(s)&&r(a,s.length):c=="string"&&a in s)?e(s[a],o):!1}return lu=i,lu}var du,ev;function jA(){if(ev)return du;ev=1;var e=qi(),t=wr(),r=Pi(),n=Qt(),i=Object.prototype,o=i.hasOwnProperty,a=e(function(s,c){s=Object(s);var u=-1,l=c.length,d=l>2?c[2]:void 0;for(d&&r(c[0],c[1],d)&&(l=1);++u<l;)for(var f=c[u],h=n(f),m=-1,y=h.length;++m<y;){var v=h[m],x=s[v];(x===void 0||t(x,i[v])&&!o.call(s,v))&&(s[v]=f[v])}return s});return du=a,du}var fu,tv;function MA(){if(tv)return fu;tv=1;var e=wt(),t=bt(),r=jt();function n(i){return function(o,a,s){var c=Object(o);if(!t(o)){var u=e(a,3);o=r(o),a=function(d){return u(c[d],d,c)}}var l=i(o,a,s);return l>-1?c[u?o[l]:l]:void 0}}return fu=n,fu}var hu,rv;function qA(){if(rv)return hu;rv=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return hu=t,hu}var pu,nv;function PA(){if(nv)return pu;nv=1;var e=qA(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return pu=r,pu}var gu,iv;function LA(){if(iv)return gu;iv=1;var e=PA(),t=Ke(),r=Er(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var l=typeof u.valueOf=="function"?u.valueOf():u;u=t(l)?l+"":l}if(typeof u!="string")return u===0?u:+u;u=e(u);var d=o.test(u);return d||a.test(u)?s(u.slice(2),d?2:8):i.test(u)?n:+u}return gu=c,gu}var mu,ov;function ub(){if(ov)return mu;ov=1;var e=LA(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var o=i<0?-1:1;return o*r}return i===i?i:0}return mu=n,mu}var vu,av;function OA(){if(av)return vu;av=1;var e=ub();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return vu=t,vu}var yu,sv;function DA(){if(sv)return yu;sv=1;var e=tb(),t=wt(),r=OA(),n=Math.max;function i(o,a,s){var c=o==null?0:o.length;if(!c)return-1;var u=s==null?0:r(s);return u<0&&(u=n(c+u,0)),e(o,t(a,3),u)}return yu=i,yu}var xu,cv;function FA(){if(cv)return xu;cv=1;var e=MA(),t=DA(),r=e(t);return xu=r,xu}var bu,uv;function lb(){if(uv)return bu;uv=1;var e=Bd();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return bu=t,bu}var wu,lv;function $A(){if(lv)return wu;lv=1;var e=Od(),t=qx(),r=Qt();function n(i,o){return i==null?i:e(i,t(o),r)}return wu=n,wu}var _u,dv;function BA(){if(dv)return _u;dv=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return _u=e,_u}var Nu,fv;function zA(){if(fv)return Nu;fv=1;var e=Si(),t=Dd(),r=wt();function n(i,o){var a={};return o=r(o,3),t(i,function(s,c,u){e(a,c,o(s,c,u))}),a}return Nu=n,Nu}var Su,hv;function Hd(){if(hv)return Su;hv=1;var e=Er();function t(r,n,i){for(var o=-1,a=r.length;++o<a;){var s=r[o],c=n(s);if(c!=null&&(u===void 0?c===c&&!e(c):i(c,u)))var u=c,l=s}return l}return Su=t,Su}var Eu,pv;function HA(){if(pv)return Eu;pv=1;function e(t,r){return t>r}return Eu=e,Eu}var Cu,gv;function VA(){if(gv)return Cu;gv=1;var e=Hd(),t=HA(),r=Jt();function n(i){return i&&i.length?e(i,r,t):void 0}return Cu=n,Cu}var Iu,mv;function db(){if(mv)return Iu;mv=1;var e=Si(),t=wr();function r(n,i,o){(o!==void 0&&!t(n[i],o)||o===void 0&&!(i in n))&&e(n,i,o)}return Iu=r,Iu}var Ru,vv;function GA(){if(vv)return Ru;vv=1;var e=Xt(),t=Ti(),r=ht(),n="[object Object]",i=Function.prototype,o=Object.prototype,a=i.toString,s=o.hasOwnProperty,c=a.call(Object);function u(l){if(!r(l)||e(l)!=n)return!1;var d=t(l);if(d===null)return!0;var f=s.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&a.call(f)==c}return Ru=u,Ru}var Tu,yv;function fb(){if(yv)return Tu;yv=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Tu=e,Tu}var Au,xv;function UA(){if(xv)return Au;xv=1;var e=pn(),t=Qt();function r(n){return e(n,t(n))}return Au=r,Au}var ku,bv;function KA(){if(bv)return ku;bv=1;var e=db(),t=wx(),r=Ax(),n=_x(),i=jx(),o=gn(),a=we(),s=rb(),c=Nr(),u=hn(),l=Ke(),d=GA(),f=mn(),h=fb(),m=UA();function y(v,x,b,p,w,S,_){var N=h(v,b),j=h(x,b),A=_.get(j);if(A){e(v,b,A);return}var k=S?S(N,j,b+"",v,x,_):void 0,R=k===void 0;if(R){var M=a(j),F=!M&&c(j),C=!M&&!F&&f(j);k=j,M||F||C?a(N)?k=N:s(N)?k=n(N):F?(R=!1,k=t(j,!0)):C?(R=!1,k=r(j,!0)):k=[]:d(j)||o(j)?(k=N,o(N)?k=m(N):(!l(N)||u(N))&&(k=i(j))):R=!1}R&&(_.set(j,k),w(k,j,p,S,_),_.delete(j)),e(v,b,k)}return ku=y,ku}var ju,wv;function WA(){if(wv)return ju;wv=1;var e=Ni(),t=db(),r=Od(),n=KA(),i=Ke(),o=Qt(),a=fb();function s(c,u,l,d,f){c!==u&&r(u,function(h,m){if(f||(f=new e),i(h))n(c,u,m,l,s,d,f);else{var y=d?d(a(c,m),h,m+"",c,u,f):void 0;y===void 0&&(y=h),t(c,m,y)}},o)}return ju=s,ju}var Mu,_v;function YA(){if(_v)return Mu;_v=1;var e=qi(),t=Pi();function r(n){return e(function(i,o){var a=-1,s=o.length,c=s>1?o[s-1]:void 0,u=s>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(s--,c):void 0,u&&t(o[0],o[1],u)&&(c=s<3?void 0:c,s=1),i=Object(i);++a<s;){var l=o[a];l&&n(i,l,a,c)}return i})}return Mu=r,Mu}var qu,Nv;function XA(){if(Nv)return qu;Nv=1;var e=WA(),t=YA(),r=t(function(n,i,o){e(n,i,o)});return qu=r,qu}var Pu,Sv;function hb(){if(Sv)return Pu;Sv=1;function e(t,r){return t<r}return Pu=e,Pu}var Lu,Ev;function ZA(){if(Ev)return Lu;Ev=1;var e=Hd(),t=hb(),r=Jt();function n(i){return i&&i.length?e(i,r,t):void 0}return Lu=n,Lu}var Ou,Cv;function QA(){if(Cv)return Ou;Cv=1;var e=Hd(),t=wt(),r=hb();function n(i,o){return i&&i.length?e(i,t(o,2),r):void 0}return Ou=n,Ou}var Du,Iv;function JA(){if(Iv)return Du;Iv=1;var e=it(),t=function(){return e.Date.now()};return Du=t,Du}var Fu,Rv;function ek(){if(Rv)return Fu;Rv=1;var e=Ei(),t=ji(),r=Ci(),n=Ke(),i=vn();function o(a,s,c,u){if(!n(a))return a;s=t(s,a);for(var l=-1,d=s.length,f=d-1,h=a;h!=null&&++l<d;){var m=i(s[l]),y=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return a;if(l!=f){var v=h[m];y=u?u(v,m,h):void 0,y===void 0&&(y=n(v)?v:r(s[l+1])?[]:{})}e(h,m,y),h=h[m]}return a}return Fu=o,Fu}var $u,Tv;function tk(){if(Tv)return $u;Tv=1;var e=Mi(),t=ek(),r=ji();function n(i,o,a){for(var s=-1,c=o.length,u={};++s<c;){var l=o[s],d=e(i,l);a(d,l)&&t(u,r(l,i),d)}return u}return $u=n,$u}var Bu,Av;function rk(){if(Av)return Bu;Av=1;var e=tk(),t=Gx();function r(n,i){return e(n,i,function(o,a){return t(n,a)})}return Bu=r,Bu}var zu,kv;function nk(){if(kv)return zu;kv=1;var e=lb(),t=Jx(),r=eb();function n(i){return r(t(i,void 0,e),i+"")}return zu=n,zu}var Hu,jv;function ik(){if(jv)return Hu;jv=1;var e=rk(),t=nk(),r=t(function(n,i){return n==null?{}:e(n,i)});return Hu=r,Hu}var Vu,Mv;function ok(){if(Mv)return Vu;Mv=1;var e=Math.ceil,t=Math.max;function r(n,i,o,a){for(var s=-1,c=t(e((i-n)/(o||1)),0),u=Array(c);c--;)u[a?c:++s]=n,n+=o;return u}return Vu=r,Vu}var Gu,qv;function ak(){if(qv)return Gu;qv=1;var e=ok(),t=Pi(),r=ub();function n(i){return function(o,a,s){return s&&typeof s!="number"&&t(o,a,s)&&(a=s=void 0),o=r(o),a===void 0?(a=o,o=0):a=r(a),s=s===void 0?o<a?1:-1:r(s),e(o,a,s,i)}}return Gu=n,Gu}var Uu,Pv;function sk(){if(Pv)return Uu;Pv=1;var e=ak(),t=e();return Uu=t,Uu}var Ku,Lv;function ck(){if(Lv)return Ku;Lv=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Ku=e,Ku}var Wu,Ov;function uk(){if(Ov)return Wu;Ov=1;var e=Er();function t(r,n){if(r!==n){var i=r!==void 0,o=r===null,a=r===r,s=e(r),c=n!==void 0,u=n===null,l=n===n,d=e(n);if(!u&&!d&&!s&&r>n||s&&c&&l&&!u&&!d||o&&c&&l||!i&&l||!a)return 1;if(!o&&!s&&!d&&r<n||d&&i&&a&&!o&&!s||u&&i&&a||!c&&a||!l)return-1}return 0}return Wu=t,Wu}var Yu,Dv;function lk(){if(Dv)return Yu;Dv=1;var e=uk();function t(r,n,i){for(var o=-1,a=r.criteria,s=n.criteria,c=a.length,u=i.length;++o<c;){var l=e(a[o],s[o]);if(l){if(o>=u)return l;var d=i[o];return l*(d=="desc"?-1:1)}}return r.index-n.index}return Yu=t,Yu}var Xu,Fv;function dk(){if(Fv)return Xu;Fv=1;var e=ki(),t=Mi(),r=wt(),n=Xx(),i=ck(),o=Ii(),a=lk(),s=Jt(),c=we();function u(l,d,f){d.length?d=e(d,function(y){return c(y)?function(v){return t(v,y.length===1?y[0]:y)}:y}):d=[s];var h=-1;d=e(d,o(r));var m=n(l,function(y,v,x){var b=e(d,function(p){return p(y)});return{criteria:b,index:++h,value:y}});return i(m,function(y,v){return a(y,v,f)})}return Xu=u,Xu}var Zu,$v;function fk(){if($v)return Zu;$v=1;var e=Bd(),t=dk(),r=qi(),n=Pi(),i=r(function(o,a){if(o==null)return[];var s=a.length;return s>1&&n(o,a[0],a[1])?a=[]:s>2&&n(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return Zu=i,Zu}var Qu,Bv;function hk(){if(Bv)return Qu;Bv=1;var e=Hx(),t=0;function r(n){var i=++t;return e(n)+i}return Qu=r,Qu}var Ju,zv;function pk(){if(zv)return Ju;zv=1;function e(t,r,n){for(var i=-1,o=t.length,a=r.length,s={};++i<o;){var c=i<a?r[i]:void 0;n(s,t[i],c)}return s}return Ju=e,Ju}var el,Hv;function gk(){if(Hv)return el;Hv=1;var e=Ei(),t=pk();function r(n,i){return t(n||[],i||[],e)}return el=r,el}var tl,Vv;function ge(){if(Vv)return tl;Vv=1;var e;if(typeof ad=="function")try{e={cloneDeep:kA(),constant:Ld(),defaults:jA(),each:Lx(),filter:Kx(),find:FA(),flatten:lb(),forEach:Px(),forIn:$A(),has:Wx(),isUndefined:Yx(),last:BA(),map:Zx(),mapValues:zA(),max:VA(),merge:XA(),min:ZA(),minBy:QA(),now:JA(),pick:ik(),range:sk(),reduce:Qx(),sortBy:fk(),uniqueId:hk(),values:nb(),zipObject:gk()}}catch{}return e||(e=window._),tl=e,tl}var rl,Gv;function mk(){if(Gv)return rl;Gv=1,rl=e;function e(){var n={};n._next=n._prev=n,this._sentinel=n}e.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return t(i),i},e.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&t(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},e.prototype.toString=function(){for(var n=[],i=this._sentinel,o=i._prev;o!==i;)n.push(JSON.stringify(o,r)),o=o._prev;return"["+n.join(", ")+"]"};function t(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function r(n,i){if(n!=="_next"&&n!=="_prev")return i}return rl}var nl,Uv;function vk(){if(Uv)return nl;Uv=1;var e=ge(),t=tt().Graph,r=mk();nl=i;var n=e.constant(1);function i(u,l){if(u.nodeCount()<=1)return[];var d=s(u,l||n),f=o(d.graph,d.buckets,d.zeroIdx);return e.flatten(e.map(f,function(h){return u.outEdges(h.v,h.w)}),!0)}function o(u,l,d){for(var f=[],h=l[l.length-1],m=l[0],y;u.nodeCount();){for(;y=m.dequeue();)a(u,l,d,y);for(;y=h.dequeue();)a(u,l,d,y);if(u.nodeCount()){for(var v=l.length-2;v>0;--v)if(y=l[v].dequeue(),y){f=f.concat(a(u,l,d,y,!0));break}}}return f}function a(u,l,d,f,h){var m=h?[]:void 0;return e.forEach(u.inEdges(f.v),function(y){var v=u.edge(y),x=u.node(y.v);h&&m.push({v:y.v,w:y.w}),x.out-=v,c(l,d,x)}),e.forEach(u.outEdges(f.v),function(y){var v=u.edge(y),x=y.w,b=u.node(x);b.in-=v,c(l,d,b)}),u.removeNode(f.v),m}function s(u,l){var d=new t,f=0,h=0;e.forEach(u.nodes(),function(v){d.setNode(v,{v,in:0,out:0})}),e.forEach(u.edges(),function(v){var x=d.edge(v.v,v.w)||0,b=l(v),p=x+b;d.setEdge(v.v,v.w,p),h=Math.max(h,d.node(v.v).out+=b),f=Math.max(f,d.node(v.w).in+=b)});var m=e.range(h+f+3).map(function(){return new r}),y=f+1;return e.forEach(d.nodes(),function(v){c(m,y,d.node(v))}),{graph:d,buckets:m,zeroIdx:y}}function c(u,l,d){d.out?d.in?u[d.out-d.in+l].enqueue(d):u[u.length-1].enqueue(d):u[0].enqueue(d)}return nl}var il,Kv;function yk(){if(Kv)return il;Kv=1;var e=ge(),t=vk();il={run:r,undo:i};function r(o){var a=o.graph().acyclicer==="greedy"?t(o,s(o)):n(o);e.forEach(a,function(c){var u=o.edge(c);o.removeEdge(c),u.forwardName=c.name,u.reversed=!0,o.setEdge(c.w,c.v,u,e.uniqueId("rev"))});function s(c){return function(u){return c.edge(u).weight}}}function n(o){var a=[],s={},c={};function u(l){e.has(c,l)||(c[l]=!0,s[l]=!0,e.forEach(o.outEdges(l),function(d){e.has(s,d.w)?a.push(d):u(d.w)}),delete s[l])}return e.forEach(o.nodes(),u),a}function i(o){e.forEach(o.edges(),function(a){var s=o.edge(a);if(s.reversed){o.removeEdge(a);var c=s.forwardName;delete s.reversed,delete s.forwardName,o.setEdge(a.w,a.v,s,c)}})}return il}var ol,Wv;function qe(){if(Wv)return ol;Wv=1;var e=ge(),t=tt().Graph;ol={addDummyNode:r,simplify:n,asNonCompoundGraph:i,successorWeights:o,predecessorWeights:a,intersectRect:s,buildLayerMatrix:c,normalizeRanks:u,removeEmptyRanks:l,addBorderNode:d,maxRank:f,partition:h,time:m,notime:y};function r(v,x,b,p){var w;do w=e.uniqueId(p);while(v.hasNode(w));return b.dummy=x,v.setNode(w,b),w}function n(v){var x=new t().setGraph(v.graph());return e.forEach(v.nodes(),function(b){x.setNode(b,v.node(b))}),e.forEach(v.edges(),function(b){var p=x.edge(b.v,b.w)||{weight:0,minlen:1},w=v.edge(b);x.setEdge(b.v,b.w,{weight:p.weight+w.weight,minlen:Math.max(p.minlen,w.minlen)})}),x}function i(v){var x=new t({multigraph:v.isMultigraph()}).setGraph(v.graph());return e.forEach(v.nodes(),function(b){v.children(b).length||x.setNode(b,v.node(b))}),e.forEach(v.edges(),function(b){x.setEdge(b,v.edge(b))}),x}function o(v){var x=e.map(v.nodes(),function(b){var p={};return e.forEach(v.outEdges(b),function(w){p[w.w]=(p[w.w]||0)+v.edge(w).weight}),p});return e.zipObject(v.nodes(),x)}function a(v){var x=e.map(v.nodes(),function(b){var p={};return e.forEach(v.inEdges(b),function(w){p[w.v]=(p[w.v]||0)+v.edge(w).weight}),p});return e.zipObject(v.nodes(),x)}function s(v,x){var b=v.x,p=v.y,w=x.x-b,S=x.y-p,_=v.width/2,N=v.height/2;if(!w&&!S)throw new Error("Not possible to find intersection inside of the rectangle");var j,A;return Math.abs(S)*_>Math.abs(w)*N?(S<0&&(N=-N),j=N*w/S,A=N):(w<0&&(_=-_),j=_,A=_*S/w),{x:b+j,y:p+A}}function c(v){var x=e.map(e.range(f(v)+1),function(){return[]});return e.forEach(v.nodes(),function(b){var p=v.node(b),w=p.rank;e.isUndefined(w)||(x[w][p.order]=b)}),x}function u(v){var x=e.min(e.map(v.nodes(),function(b){return v.node(b).rank}));e.forEach(v.nodes(),function(b){var p=v.node(b);e.has(p,"rank")&&(p.rank-=x)})}function l(v){var x=e.min(e.map(v.nodes(),function(S){return v.node(S).rank})),b=[];e.forEach(v.nodes(),function(S){var _=v.node(S).rank-x;b[_]||(b[_]=[]),b[_].push(S)});var p=0,w=v.graph().nodeRankFactor;e.forEach(b,function(S,_){e.isUndefined(S)&&_%w!==0?--p:p&&e.forEach(S,function(N){v.node(N).rank+=p})})}function d(v,x,b,p){var w={width:0,height:0};return arguments.length>=4&&(w.rank=b,w.order=p),r(v,"border",w,x)}function f(v){return e.max(e.map(v.nodes(),function(x){var b=v.node(x).rank;if(!e.isUndefined(b))return b}))}function h(v,x){var b={lhs:[],rhs:[]};return e.forEach(v,function(p){x(p)?b.lhs.push(p):b.rhs.push(p)}),b}function m(v,x){var b=e.now();try{return x()}finally{console.log(v+" time: "+(e.now()-b)+"ms")}}function y(v,x){return x()}return ol}var al,Yv;function xk(){if(Yv)return al;Yv=1;var e=ge(),t=qe();al={run:r,undo:i};function r(o){o.graph().dummyChains=[],e.forEach(o.edges(),function(a){n(o,a)})}function n(o,a){var s=a.v,c=o.node(s).rank,u=a.w,l=o.node(u).rank,d=a.name,f=o.edge(a),h=f.labelRank;if(l!==c+1){o.removeEdge(a);var m,y,v;for(v=0,++c;c<l;++v,++c)f.points=[],y={width:0,height:0,edgeLabel:f,edgeObj:a,rank:c},m=t.addDummyNode(o,"edge",y,"_d"),c===h&&(y.width=f.width,y.height=f.height,y.dummy="edge-label",y.labelpos=f.labelpos),o.setEdge(s,m,{weight:f.weight},d),v===0&&o.graph().dummyChains.push(m),s=m;o.setEdge(s,u,{weight:f.weight},d)}}function i(o){e.forEach(o.graph().dummyChains,function(a){var s=o.node(a),c=s.edgeLabel,u;for(o.setEdge(s.edgeObj,c);s.dummy;)u=o.successors(a)[0],o.removeNode(a),c.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(c.x=s.x,c.y=s.y,c.width=s.width,c.height=s.height),a=u,s=o.node(a)})}return al}var sl,Xv;function ni(){if(Xv)return sl;Xv=1;var e=ge();sl={longestPath:t,slack:r};function t(n){var i={};function o(a){var s=n.node(a);if(e.has(i,a))return s.rank;i[a]=!0;var c=e.min(e.map(n.outEdges(a),function(u){return o(u.w)-n.edge(u).minlen}));return(c===Number.POSITIVE_INFINITY||c===void 0||c===null)&&(c=0),s.rank=c}e.forEach(n.sources(),o)}function r(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return sl}var cl,Zv;function pb(){if(Zv)return cl;Zv=1;var e=ge(),t=tt().Graph,r=ni().slack;cl=n;function n(s){var c=new t({directed:!1}),u=s.nodes()[0],l=s.nodeCount();c.setNode(u,{});for(var d,f;i(c,s)<l;)d=o(c,s),f=c.hasNode(d.v)?r(s,d):-r(s,d),a(c,s,f);return c}function i(s,c){function u(l){e.forEach(c.nodeEdges(l),function(d){var f=d.v,h=l===f?d.w:f;!s.hasNode(h)&&!r(c,d)&&(s.setNode(h,{}),s.setEdge(l,h,{}),u(h))})}return e.forEach(s.nodes(),u),s.nodeCount()}function o(s,c){return e.minBy(c.edges(),function(u){if(s.hasNode(u.v)!==s.hasNode(u.w))return r(c,u)})}function a(s,c,u){e.forEach(s.nodes(),function(l){c.node(l).rank+=u})}return cl}var ul,Qv;function bk(){if(Qv)return ul;Qv=1;var e=ge(),t=pb(),r=ni().slack,n=ni().longestPath,i=tt().alg.preorder,o=tt().alg.postorder,a=qe().simplify;ul=s,s.initLowLimValues=d,s.initCutValues=c,s.calcCutValue=l,s.leaveEdge=h,s.enterEdge=m,s.exchangeEdges=y;function s(p){p=a(p),n(p);var w=t(p);d(w),c(w,p);for(var S,_;S=h(w);)_=m(w,p,S),y(w,p,S,_)}function c(p,w){var S=o(p,p.nodes());S=S.slice(0,S.length-1),e.forEach(S,function(_){u(p,w,_)})}function u(p,w,S){var _=p.node(S),N=_.parent;p.edge(S,N).cutvalue=l(p,w,S)}function l(p,w,S){var _=p.node(S),N=_.parent,j=!0,A=w.edge(S,N),k=0;return A||(j=!1,A=w.edge(N,S)),k=A.weight,e.forEach(w.nodeEdges(S),function(R){var M=R.v===S,F=M?R.w:R.v;if(F!==N){var C=M===j,D=w.edge(R).weight;if(k+=C?D:-D,x(p,S,F)){var O=p.edge(S,F).cutvalue;k+=C?-O:O}}}),k}function d(p,w){arguments.length<2&&(w=p.nodes()[0]),f(p,{},1,w)}function f(p,w,S,_,N){var j=S,A=p.node(_);return w[_]=!0,e.forEach(p.neighbors(_),function(k){e.has(w,k)||(S=f(p,w,S,k,_))}),A.low=j,A.lim=S++,N?A.parent=N:delete A.parent,S}function h(p){return e.find(p.edges(),function(w){return p.edge(w).cutvalue<0})}function m(p,w,S){var _=S.v,N=S.w;w.hasEdge(_,N)||(_=S.w,N=S.v);var j=p.node(_),A=p.node(N),k=j,R=!1;j.lim>A.lim&&(k=A,R=!0);var M=e.filter(w.edges(),function(F){return R===b(p,p.node(F.v),k)&&R!==b(p,p.node(F.w),k)});return e.minBy(M,function(F){return r(w,F)})}function y(p,w,S,_){var N=S.v,j=S.w;p.removeEdge(N,j),p.setEdge(_.v,_.w,{}),d(p),c(p,w),v(p,w)}function v(p,w){var S=e.find(p.nodes(),function(N){return!w.node(N).parent}),_=i(p,S);_=_.slice(1),e.forEach(_,function(N){var j=p.node(N).parent,A=w.edge(N,j),k=!1;A||(A=w.edge(j,N),k=!0),w.node(N).rank=w.node(j).rank+(k?A.minlen:-A.minlen)})}function x(p,w,S){return p.hasEdge(w,S)}function b(p,w,S){return S.low<=w.lim&&w.lim<=S.lim}return ul}var ll,Jv;function wk(){if(Jv)return ll;Jv=1;var e=ni(),t=e.longestPath,r=pb(),n=bk();ll=i;function i(c){switch(c.graph().ranker){case"network-simplex":s(c);break;case"tight-tree":a(c);break;case"longest-path":o(c);break;default:s(c)}}var o=t;function a(c){t(c),r(c)}function s(c){n(c)}return ll}var dl,ey;function _k(){if(ey)return dl;ey=1;var e=ge();dl=t;function t(i){var o=n(i);e.forEach(i.graph().dummyChains,function(a){for(var s=i.node(a),c=s.edgeObj,u=r(i,o,c.v,c.w),l=u.path,d=u.lca,f=0,h=l[f],m=!0;a!==c.w;){if(s=i.node(a),m){for(;(h=l[f])!==d&&i.node(h).maxRank<s.rank;)f++;h===d&&(m=!1)}if(!m){for(;f<l.length-1&&i.node(h=l[f+1]).minRank<=s.rank;)f++;h=l[f]}i.setParent(a,h),a=i.successors(a)[0]}})}function r(i,o,a,s){var c=[],u=[],l=Math.min(o[a].low,o[s].low),d=Math.max(o[a].lim,o[s].lim),f,h;f=a;do f=i.parent(f),c.push(f);while(f&&(o[f].low>l||d>o[f].lim));for(h=f,f=s;(f=i.parent(f))!==h;)u.push(f);return{path:c.concat(u.reverse()),lca:h}}function n(i){var o={},a=0;function s(c){var u=a;e.forEach(i.children(c),s),o[c]={low:u,lim:a++}}return e.forEach(i.children(),s),o}return dl}var fl,ty;function Nk(){if(ty)return fl;ty=1;var e=ge(),t=qe();fl={run:r,cleanup:a};function r(s){var c=t.addDummyNode(s,"root",{},"_root"),u=i(s),l=e.max(e.values(u))-1,d=2*l+1;s.graph().nestingRoot=c,e.forEach(s.edges(),function(h){s.edge(h).minlen*=d});var f=o(s)+1;e.forEach(s.children(),function(h){n(s,c,d,f,l,u,h)}),s.graph().nodeRankFactor=d}function n(s,c,u,l,d,f,h){var m=s.children(h);if(!m.length){h!==c&&s.setEdge(c,h,{weight:0,minlen:u});return}var y=t.addBorderNode(s,"_bt"),v=t.addBorderNode(s,"_bb"),x=s.node(h);s.setParent(y,h),x.borderTop=y,s.setParent(v,h),x.borderBottom=v,e.forEach(m,function(b){n(s,c,u,l,d,f,b);var p=s.node(b),w=p.borderTop?p.borderTop:b,S=p.borderBottom?p.borderBottom:b,_=p.borderTop?l:2*l,N=w!==S?1:d-f[h]+1;s.setEdge(y,w,{weight:_,minlen:N,nestingEdge:!0}),s.setEdge(S,v,{weight:_,minlen:N,nestingEdge:!0})}),s.parent(h)||s.setEdge(c,y,{weight:0,minlen:d+f[h]})}function i(s){var c={};function u(l,d){var f=s.children(l);f&&f.length&&e.forEach(f,function(h){u(h,d+1)}),c[l]=d}return e.forEach(s.children(),function(l){u(l,1)}),c}function o(s){return e.reduce(s.edges(),function(c,u){return c+s.edge(u).weight},0)}function a(s){var c=s.graph();s.removeNode(c.nestingRoot),delete c.nestingRoot,e.forEach(s.edges(),function(u){var l=s.edge(u);l.nestingEdge&&s.removeEdge(u)})}return fl}var hl,ry;function Sk(){if(ry)return hl;ry=1;var e=ge(),t=qe();hl=r;function r(i){function o(a){var s=i.children(a),c=i.node(a);if(s.length&&e.forEach(s,o),e.has(c,"minRank")){c.borderLeft=[],c.borderRight=[];for(var u=c.minRank,l=c.maxRank+1;u<l;++u)n(i,"borderLeft","_bl",a,c,u),n(i,"borderRight","_br",a,c,u)}}e.forEach(i.children(),o)}function n(i,o,a,s,c,u){var l={width:0,height:0,rank:u,borderType:o},d=c[o][u-1],f=t.addDummyNode(i,"border",l,a);c[o][u]=f,i.setParent(f,s),d&&i.setEdge(d,f,{weight:1})}return hl}var pl,ny;function Ek(){if(ny)return pl;ny=1;var e=ge();pl={adjust:t,undo:r};function t(u){var l=u.graph().rankdir.toLowerCase();(l==="lr"||l==="rl")&&n(u)}function r(u){var l=u.graph().rankdir.toLowerCase();(l==="bt"||l==="rl")&&o(u),(l==="lr"||l==="rl")&&(s(u),n(u))}function n(u){e.forEach(u.nodes(),function(l){i(u.node(l))}),e.forEach(u.edges(),function(l){i(u.edge(l))})}function i(u){var l=u.width;u.width=u.height,u.height=l}function o(u){e.forEach(u.nodes(),function(l){a(u.node(l))}),e.forEach(u.edges(),function(l){var d=u.edge(l);e.forEach(d.points,a),e.has(d,"y")&&a(d)})}function a(u){u.y=-u.y}function s(u){e.forEach(u.nodes(),function(l){c(u.node(l))}),e.forEach(u.edges(),function(l){var d=u.edge(l);e.forEach(d.points,c),e.has(d,"x")&&c(d)})}function c(u){var l=u.x;u.x=u.y,u.y=l}return pl}var gl,iy;function Ck(){if(iy)return gl;iy=1;var e=ge();gl=t;function t(r){var n={},i=e.filter(r.nodes(),function(u){return!r.children(u).length}),o=e.max(e.map(i,function(u){return r.node(u).rank})),a=e.map(e.range(o+1),function(){return[]});function s(u){if(!e.has(n,u)){n[u]=!0;var l=r.node(u);a[l.rank].push(u),e.forEach(r.successors(u),s)}}var c=e.sortBy(i,function(u){return r.node(u).rank});return e.forEach(c,s),a}return gl}var ml,oy;function Ik(){if(oy)return ml;oy=1;var e=ge();ml=t;function t(n,i){for(var o=0,a=1;a<i.length;++a)o+=r(n,i[a-1],i[a]);return o}function r(n,i,o){for(var a=e.zipObject(o,e.map(o,function(f,h){return h})),s=e.flatten(e.map(i,function(f){return e.sortBy(e.map(n.outEdges(f),function(h){return{pos:a[h.w],weight:n.edge(h).weight}}),"pos")}),!0),c=1;c<o.length;)c<<=1;var u=2*c-1;c-=1;var l=e.map(new Array(u),function(){return 0}),d=0;return e.forEach(s.forEach(function(f){var h=f.pos+c;l[h]+=f.weight;for(var m=0;h>0;)h%2&&(m+=l[h+1]),h=h-1>>1,l[h]+=f.weight;d+=f.weight*m})),d}return ml}var vl,ay;function Rk(){if(ay)return vl;ay=1;var e=ge();vl=t;function t(r,n){return e.map(n,function(i){var o=r.inEdges(i);if(o.length){var a=e.reduce(o,function(s,c){var u=r.edge(c),l=r.node(c.v);return{sum:s.sum+u.weight*l.order,weight:s.weight+u.weight}},{sum:0,weight:0});return{v:i,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:i}})}return vl}var yl,sy;function Tk(){if(sy)return yl;sy=1;var e=ge();yl=t;function t(i,o){var a={};e.forEach(i,function(c,u){var l=a[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:u};e.isUndefined(c.barycenter)||(l.barycenter=c.barycenter,l.weight=c.weight)}),e.forEach(o.edges(),function(c){var u=a[c.v],l=a[c.w];!e.isUndefined(u)&&!e.isUndefined(l)&&(l.indegree++,u.out.push(a[c.w]))});var s=e.filter(a,function(c){return!c.indegree});return r(s)}function r(i){var o=[];function a(u){return function(l){l.merged||(e.isUndefined(l.barycenter)||e.isUndefined(u.barycenter)||l.barycenter>=u.barycenter)&&n(u,l)}}function s(u){return function(l){l.in.push(u),--l.indegree===0&&i.push(l)}}for(;i.length;){var c=i.pop();o.push(c),e.forEach(c.in.reverse(),a(c)),e.forEach(c.out,s(c))}return e.map(e.filter(o,function(u){return!u.merged}),function(u){return e.pick(u,["vs","i","barycenter","weight"])})}function n(i,o){var a=0,s=0;i.weight&&(a+=i.barycenter*i.weight,s+=i.weight),o.weight&&(a+=o.barycenter*o.weight,s+=o.weight),i.vs=o.vs.concat(i.vs),i.barycenter=a/s,i.weight=s,i.i=Math.min(o.i,i.i),o.merged=!0}return yl}var xl,cy;function Ak(){if(cy)return xl;cy=1;var e=ge(),t=qe();xl=r;function r(o,a){var s=t.partition(o,function(y){return e.has(y,"barycenter")}),c=s.lhs,u=e.sortBy(s.rhs,function(y){return-y.i}),l=[],d=0,f=0,h=0;c.sort(i(!!a)),h=n(l,u,h),e.forEach(c,function(y){h+=y.vs.length,l.push(y.vs),d+=y.barycenter*y.weight,f+=y.weight,h=n(l,u,h)});var m={vs:e.flatten(l,!0)};return f&&(m.barycenter=d/f,m.weight=f),m}function n(o,a,s){for(var c;a.length&&(c=e.last(a)).i<=s;)a.pop(),o.push(c.vs),s++;return s}function i(o){return function(a,s){return a.barycenter<s.barycenter?-1:a.barycenter>s.barycenter?1:o?s.i-a.i:a.i-s.i}}return xl}var bl,uy;function kk(){if(uy)return bl;uy=1;var e=ge(),t=Rk(),r=Tk(),n=Ak();bl=i;function i(s,c,u,l){var d=s.children(c),f=s.node(c),h=f?f.borderLeft:void 0,m=f?f.borderRight:void 0,y={};h&&(d=e.filter(d,function(S){return S!==h&&S!==m}));var v=t(s,d);e.forEach(v,function(S){if(s.children(S.v).length){var _=i(s,S.v,u,l);y[S.v]=_,e.has(_,"barycenter")&&a(S,_)}});var x=r(v,u);o(x,y);var b=n(x,l);if(h&&(b.vs=e.flatten([h,b.vs,m],!0),s.predecessors(h).length)){var p=s.node(s.predecessors(h)[0]),w=s.node(s.predecessors(m)[0]);e.has(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+p.order+w.order)/(b.weight+2),b.weight+=2}return b}function o(s,c){e.forEach(s,function(u){u.vs=e.flatten(u.vs.map(function(l){return c[l]?c[l].vs:l}),!0)})}function a(s,c){e.isUndefined(s.barycenter)?(s.barycenter=c.barycenter,s.weight=c.weight):(s.barycenter=(s.barycenter*s.weight+c.barycenter*c.weight)/(s.weight+c.weight),s.weight+=c.weight)}return bl}var wl,ly;function jk(){if(ly)return wl;ly=1;var e=ge(),t=tt().Graph;wl=r;function r(i,o,a){var s=n(i),c=new t({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(u){return i.node(u)});return e.forEach(i.nodes(),function(u){var l=i.node(u),d=i.parent(u);(l.rank===o||l.minRank<=o&&o<=l.maxRank)&&(c.setNode(u),c.setParent(u,d||s),e.forEach(i[a](u),function(f){var h=f.v===u?f.w:f.v,m=c.edge(h,u),y=e.isUndefined(m)?0:m.weight;c.setEdge(h,u,{weight:i.edge(f).weight+y})}),e.has(l,"minRank")&&c.setNode(u,{borderLeft:l.borderLeft[o],borderRight:l.borderRight[o]}))}),c}function n(i){for(var o;i.hasNode(o=e.uniqueId("_root")););return o}return wl}var _l,dy;function Mk(){if(dy)return _l;dy=1;var e=ge();_l=t;function t(r,n,i){var o={},a;e.forEach(i,function(s){for(var c=r.parent(s),u,l;c;){if(u=r.parent(c),u?(l=o[u],o[u]=c):(l=a,a=c),l&&l!==c){n.setEdge(l,c);return}c=u}})}return _l}var Nl,fy;function qk(){if(fy)return Nl;fy=1;var e=ge(),t=Ck(),r=Ik(),n=kk(),i=jk(),o=Mk(),a=tt().Graph,s=qe();Nl=c;function c(f){var h=s.maxRank(f),m=u(f,e.range(1,h+1),"inEdges"),y=u(f,e.range(h-1,-1,-1),"outEdges"),v=t(f);d(f,v);for(var x=Number.POSITIVE_INFINITY,b,p=0,w=0;w<4;++p,++w){l(p%2?m:y,p%4>=2),v=s.buildLayerMatrix(f);var S=r(f,v);S<x&&(w=0,b=e.cloneDeep(v),x=S)}d(f,b)}function u(f,h,m){return e.map(h,function(y){return i(f,y,m)})}function l(f,h){var m=new a;e.forEach(f,function(y){var v=y.graph().root,x=n(y,v,m,h);e.forEach(x.vs,function(b,p){y.node(b).order=p}),o(y,m,x.vs)})}function d(f,h){e.forEach(h,function(m){e.forEach(m,function(y,v){f.node(y).order=v})})}return Nl}var Sl,hy;function Pk(){if(hy)return Sl;hy=1;var e=ge(),t=tt().Graph,r=qe();Sl={positionX:m,findType1Conflicts:n,findType2Conflicts:i,addConflict:a,hasConflict:s,verticalAlignment:c,horizontalCompaction:u,alignCoordinates:f,findSmallestWidthAlignment:d,balance:h};function n(x,b){var p={};function w(S,_){var N=0,j=0,A=S.length,k=e.last(_);return e.forEach(_,function(R,M){var F=o(x,R),C=F?x.node(F).order:A;(F||R===k)&&(e.forEach(_.slice(j,M+1),function(D){e.forEach(x.predecessors(D),function(O){var q=x.node(O),I=q.order;(I<N||C<I)&&!(q.dummy&&x.node(D).dummy)&&a(p,O,D)})}),j=M+1,N=C)}),_}return e.reduce(b,w),p}function i(x,b){var p={};function w(_,N,j,A,k){var R;e.forEach(e.range(N,j),function(M){R=_[M],x.node(R).dummy&&e.forEach(x.predecessors(R),function(F){var C=x.node(F);C.dummy&&(C.order<A||C.order>k)&&a(p,F,R)})})}function S(_,N){var j=-1,A,k=0;return e.forEach(N,function(R,M){if(x.node(R).dummy==="border"){var F=x.predecessors(R);F.length&&(A=x.node(F[0]).order,w(N,k,M,j,A),k=M,j=A)}w(N,k,N.length,A,_.length)}),N}return e.reduce(b,S),p}function o(x,b){if(x.node(b).dummy)return e.find(x.predecessors(b),function(p){return x.node(p).dummy})}function a(x,b,p){if(b>p){var w=b;b=p,p=w}var S=x[b];S||(x[b]=S={}),S[p]=!0}function s(x,b,p){if(b>p){var w=b;b=p,p=w}return e.has(x[b],p)}function c(x,b,p,w){var S={},_={},N={};return e.forEach(b,function(j){e.forEach(j,function(A,k){S[A]=A,_[A]=A,N[A]=k})}),e.forEach(b,function(j){var A=-1;e.forEach(j,function(k){var R=w(k);if(R.length){R=e.sortBy(R,function(O){return N[O]});for(var M=(R.length-1)/2,F=Math.floor(M),C=Math.ceil(M);F<=C;++F){var D=R[F];_[k]===k&&A<N[D]&&!s(p,k,D)&&(_[D]=k,_[k]=S[k]=S[D],A=N[D])}}})}),{root:S,align:_}}function u(x,b,p,w,S){var _={},N=l(x,b,p,S),j=S?"borderLeft":"borderRight";function A(M,F){for(var C=N.nodes(),D=C.pop(),O={};D;)O[D]?M(D):(O[D]=!0,C.push(D),C=C.concat(F(D))),D=C.pop()}function k(M){_[M]=N.inEdges(M).reduce(function(F,C){return Math.max(F,_[C.v]+N.edge(C))},0)}function R(M){var F=N.outEdges(M).reduce(function(D,O){return Math.min(D,_[O.w]-N.edge(O))},Number.POSITIVE_INFINITY),C=x.node(M);F!==Number.POSITIVE_INFINITY&&C.borderType!==j&&(_[M]=Math.max(_[M],F))}return A(k,N.predecessors.bind(N)),A(R,N.successors.bind(N)),e.forEach(w,function(M){_[M]=_[p[M]]}),_}function l(x,b,p,w){var S=new t,_=x.graph(),N=y(_.nodesep,_.edgesep,w);return e.forEach(b,function(j){var A;e.forEach(j,function(k){var R=p[k];if(S.setNode(R),A){var M=p[A],F=S.edge(M,R);S.setEdge(M,R,Math.max(N(x,k,A),F||0))}A=k})}),S}function d(x,b){return e.minBy(e.values(b),function(p){var w=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY;return e.forIn(p,function(_,N){var j=v(x,N)/2;w=Math.max(_+j,w),S=Math.min(_-j,S)}),w-S})}function f(x,b){var p=e.values(b),w=e.min(p),S=e.max(p);e.forEach(["u","d"],function(_){e.forEach(["l","r"],function(N){var j=_+N,A=x[j],k;if(A!==b){var R=e.values(A);k=N==="l"?w-e.min(R):S-e.max(R),k&&(x[j]=e.mapValues(A,function(M){return M+k}))}})})}function h(x,b){return e.mapValues(x.ul,function(p,w){if(b)return x[b.toLowerCase()][w];var S=e.sortBy(e.map(x,w));return(S[1]+S[2])/2})}function m(x){var b=r.buildLayerMatrix(x),p=e.merge(n(x,b),i(x,b)),w={},S;e.forEach(["u","d"],function(N){S=N==="u"?b:e.values(b).reverse(),e.forEach(["l","r"],function(j){j==="r"&&(S=e.map(S,function(M){return e.values(M).reverse()}));var A=(N==="u"?x.predecessors:x.successors).bind(x),k=c(x,S,p,A),R=u(x,S,k.root,k.align,j==="r");j==="r"&&(R=e.mapValues(R,function(M){return-M})),w[N+j]=R})});var _=d(x,w);return f(w,_),h(w,x.graph().align)}function y(x,b,p){return function(w,S,_){var N=w.node(S),j=w.node(_),A=0,k;if(A+=N.width/2,e.has(N,"labelpos"))switch(N.labelpos.toLowerCase()){case"l":k=-N.width/2;break;case"r":k=N.width/2;break}if(k&&(A+=p?k:-k),k=0,A+=(N.dummy?b:x)/2,A+=(j.dummy?b:x)/2,A+=j.width/2,e.has(j,"labelpos"))switch(j.labelpos.toLowerCase()){case"l":k=j.width/2;break;case"r":k=-j.width/2;break}return k&&(A+=p?k:-k),k=0,A}}function v(x,b){return x.node(b).width}return Sl}var El,py;function Lk(){if(py)return El;py=1;var e=ge(),t=qe(),r=Pk().positionX;El=n;function n(o){o=t.asNonCompoundGraph(o),i(o),e.forEach(r(o),function(a,s){o.node(s).x=a})}function i(o){var a=t.buildLayerMatrix(o),s=o.graph().ranksep,c=0;e.forEach(a,function(u){var l=e.max(e.map(u,function(d){return o.node(d).height}));e.forEach(u,function(d){o.node(d).y=c+l/2}),c+=l+s})}return El}var Cl,gy;function Ok(){if(gy)return Cl;gy=1;var e=ge(),t=yk(),r=xk(),n=wk(),i=qe().normalizeRanks,o=_k(),a=qe().removeEmptyRanks,s=Nk(),c=Sk(),u=Ek(),l=qk(),d=Lk(),f=qe(),h=tt().Graph;Cl=m;function m(P,$){var H=$&&$.debugTiming?f.time:f.notime;H("layout",function(){var B=H("  buildLayoutGraph",function(){return A(P)});H("  runLayout",function(){y(B,H)}),H("  updateInputGraph",function(){v(P,B)})})}function y(P,$){$("    makeSpaceForEdgeLabels",function(){k(P)}),$("    removeSelfEdges",function(){T(P)}),$("    acyclic",function(){t.run(P)}),$("    nestingGraph.run",function(){s.run(P)}),$("    rank",function(){n(f.asNonCompoundGraph(P))}),$("    injectEdgeLabelProxies",function(){R(P)}),$("    removeEmptyRanks",function(){a(P)}),$("    nestingGraph.cleanup",function(){s.cleanup(P)}),$("    normalizeRanks",function(){i(P)}),$("    assignRankMinMax",function(){M(P)}),$("    removeEdgeLabelProxies",function(){F(P)}),$("    normalize.run",function(){r.run(P)}),$("    parentDummyChains",function(){o(P)}),$("    addBorderSegments",function(){c(P)}),$("    order",function(){l(P)}),$("    insertSelfEdges",function(){V(P)}),$("    adjustCoordinateSystem",function(){u.adjust(P)}),$("    position",function(){d(P)}),$("    positionSelfEdges",function(){G(P)}),$("    removeBorderNodes",function(){I(P)}),$("    normalize.undo",function(){r.undo(P)}),$("    fixupEdgeLabelCoords",function(){O(P)}),$("    undoCoordinateSystem",function(){u.undo(P)}),$("    translateGraph",function(){C(P)}),$("    assignNodeIntersects",function(){D(P)}),$("    reversePoints",function(){q(P)}),$("    acyclic.undo",function(){t.undo(P)})}function v(P,$){e.forEach(P.nodes(),function(H){var B=P.node(H),z=$.node(H);B&&(B.x=z.x,B.y=z.y,$.children(H).length&&(B.width=z.width,B.height=z.height))}),e.forEach(P.edges(),function(H){var B=P.edge(H),z=$.edge(H);B.points=z.points,e.has(z,"x")&&(B.x=z.x,B.y=z.y)}),P.graph().width=$.graph().width,P.graph().height=$.graph().height}var x=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},p=["acyclicer","ranker","rankdir","align"],w=["width","height"],S={width:0,height:0},_=["minlen","weight","width","height","labeloffset"],N={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},j=["labelpos"];function A(P){var $=new h({multigraph:!0,compound:!0}),H=Q(P.graph());return $.setGraph(e.merge({},b,K(H,x),e.pick(H,p))),e.forEach(P.nodes(),function(B){var z=Q(P.node(B));$.setNode(B,e.defaults(K(z,w),S)),$.setParent(B,P.parent(B))}),e.forEach(P.edges(),function(B){var z=Q(P.edge(B));$.setEdge(B,e.merge({},N,K(z,_),e.pick(z,j)))}),$}function k(P){var $=P.graph();$.ranksep/=2,e.forEach(P.edges(),function(H){var B=P.edge(H);B.minlen*=2,B.labelpos.toLowerCase()!=="c"&&($.rankdir==="TB"||$.rankdir==="BT"?B.width+=B.labeloffset:B.height+=B.labeloffset)})}function R(P){e.forEach(P.edges(),function($){var H=P.edge($);if(H.width&&H.height){var B=P.node($.v),z=P.node($.w),X={rank:(z.rank-B.rank)/2+B.rank,e:$};f.addDummyNode(P,"edge-proxy",X,"_ep")}})}function M(P){var $=0;e.forEach(P.nodes(),function(H){var B=P.node(H);B.borderTop&&(B.minRank=P.node(B.borderTop).rank,B.maxRank=P.node(B.borderBottom).rank,$=e.max($,B.maxRank))}),P.graph().maxRank=$}function F(P){e.forEach(P.nodes(),function($){var H=P.node($);H.dummy==="edge-proxy"&&(P.edge(H.e).labelRank=H.rank,P.removeNode($))})}function C(P){var $=Number.POSITIVE_INFINITY,H=0,B=Number.POSITIVE_INFINITY,z=0,X=P.graph(),te=X.marginx||0,ee=X.marginy||0;function re(ne){var Z=ne.x,se=ne.y,le=ne.width,ce=ne.height;$=Math.min($,Z-le/2),H=Math.max(H,Z+le/2),B=Math.min(B,se-ce/2),z=Math.max(z,se+ce/2)}e.forEach(P.nodes(),function(ne){re(P.node(ne))}),e.forEach(P.edges(),function(ne){var Z=P.edge(ne);e.has(Z,"x")&&re(Z)}),$-=te,B-=ee,e.forEach(P.nodes(),function(ne){var Z=P.node(ne);Z.x-=$,Z.y-=B}),e.forEach(P.edges(),function(ne){var Z=P.edge(ne);e.forEach(Z.points,function(se){se.x-=$,se.y-=B}),e.has(Z,"x")&&(Z.x-=$),e.has(Z,"y")&&(Z.y-=B)}),X.width=H-$+te,X.height=z-B+ee}function D(P){e.forEach(P.edges(),function($){var H=P.edge($),B=P.node($.v),z=P.node($.w),X,te;H.points?(X=H.points[0],te=H.points[H.points.length-1]):(H.points=[],X=z,te=B),H.points.unshift(f.intersectRect(B,X)),H.points.push(f.intersectRect(z,te))})}function O(P){e.forEach(P.edges(),function($){var H=P.edge($);if(e.has(H,"x"))switch((H.labelpos==="l"||H.labelpos==="r")&&(H.width-=H.labeloffset),H.labelpos){case"l":H.x-=H.width/2+H.labeloffset;break;case"r":H.x+=H.width/2+H.labeloffset;break}})}function q(P){e.forEach(P.edges(),function($){var H=P.edge($);H.reversed&&H.points.reverse()})}function I(P){e.forEach(P.nodes(),function($){if(P.children($).length){var H=P.node($),B=P.node(H.borderTop),z=P.node(H.borderBottom),X=P.node(e.last(H.borderLeft)),te=P.node(e.last(H.borderRight));H.width=Math.abs(te.x-X.x),H.height=Math.abs(z.y-B.y),H.x=X.x+H.width/2,H.y=B.y+H.height/2}}),e.forEach(P.nodes(),function($){P.node($).dummy==="border"&&P.removeNode($)})}function T(P){e.forEach(P.edges(),function($){if($.v===$.w){var H=P.node($.v);H.selfEdges||(H.selfEdges=[]),H.selfEdges.push({e:$,label:P.edge($)}),P.removeEdge($)}})}function V(P){var $=f.buildLayerMatrix(P);e.forEach($,function(H){var B=0;e.forEach(H,function(z,X){var te=P.node(z);te.order=X+B,e.forEach(te.selfEdges,function(ee){f.addDummyNode(P,"selfedge",{width:ee.label.width,height:ee.label.height,rank:te.rank,order:X+ ++B,e:ee.e,label:ee.label},"_se")}),delete te.selfEdges})})}function G(P){e.forEach(P.nodes(),function($){var H=P.node($);if(H.dummy==="selfedge"){var B=P.node(H.e.v),z=B.x+B.width/2,X=B.y,te=H.x-z,ee=B.height/2;P.setEdge(H.e,H.label),P.removeNode($),H.label.points=[{x:z+2*te/3,y:X-ee},{x:z+5*te/6,y:X-ee},{x:z+te,y:X},{x:z+5*te/6,y:X+ee},{x:z+2*te/3,y:X+ee}],H.label.x=H.x,H.label.y=H.y}})}function K(P,$){return e.mapValues(e.pick(P,$),Number)}function Q(P){var $={};return e.forEach(P,function(H,B){$[B.toLowerCase()]=H}),$}return Cl}var Il,my;function Dk(){if(my)return Il;my=1;var e=ge(),t=qe(),r=tt().Graph;Il={debugOrdering:n};function n(i){var o=t.buildLayerMatrix(i),a=new r({compound:!0,multigraph:!0}).setGraph({});return e.forEach(i.nodes(),function(s){a.setNode(s,{label:s}),a.setParent(s,"layer"+i.node(s).rank)}),e.forEach(i.edges(),function(s){a.setEdge(s.v,s.w,{},s.name)}),e.forEach(o,function(s,c){var u="layer"+c;a.setNode(u,{rank:"same"}),e.reduce(s,function(l,d){return a.setEdge(l,d,{style:"invis"}),d})}),a}return Il}var Rl,vy;function Fk(){return vy||(vy=1,Rl="0.8.5"),Rl}var Tl,yy;function $k(){return yy||(yy=1,Tl={graphlib:tt(),layout:Ok(),debug:Dk(),util:{time:qe().time,notime:qe().notime},version:Fk()}),Tl}var Bk=$k();const xy=dw(Bk);function zk({className:e="",minZoom:t=.5,maxZoom:r=2,step:n=.1}){const{setViewport:i,getZoom:o,getViewport:a}=fn(),s=o(),u=(Math.min(Math.max(s,t),r)-t)/(r-t)*100,l=h=>Math.min(Math.max(h,t),r),d=h=>{const{x:m,y}=a();i({x:m,y,zoom:l(h)},{duration:200})},f=h=>{const m=parseFloat(h.target.value),y=t+m/100*(r-t);d(y)};return g.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 ${e}`,children:[g.jsx("button",{onClick:()=>d(s+n),className:"w-6 h-6 flex items-center justify-center rounded border border-border bg-background hover:bg-accent transition-colors",title:"Zoom In",children:g.jsx(Kr,{className:"w-4 h-4"})}),g.jsx("input",{type:"range",min:"0",max:"100",value:u,onChange:f,className:"slider-vertical h-24 w-1.5",style:{writingMode:"vertical-lr",direction:"rtl"},title:`Zoom: ${Math.round(s*100)}%`}),g.jsx("button",{onClick:()=>d(s-n),className:"w-6 h-6 flex items-center justify-center rounded border border-border bg-background hover:bg-accent transition-colors",title:"Zoom Out",children:g.jsx(N_,{className:"w-4 h-4"})})]})}const gb=E.forwardRef(({className:e,...t},r)=>g.jsx("div",{ref:r,role:"group",className:Pe("inline-flex items-center gap-1",e),...t}));gb.displayName="ButtonGroup";const Hk=E.forwardRef(({className:e,...t},r)=>g.jsx("div",{ref:r,"aria-hidden":"true",className:Pe("h-4 w-px bg-border mx-1",e),...t}));Hk.displayName="ButtonGroupSeparator";const Vk=E.forwardRef(({className:e,...t},r)=>g.jsx("span",{ref:r,className:Pe("text-sm font-medium text-foreground/90",e),...t}));Vk.displayName="ButtonGroupText";const mb=E.memo(({data:e,selected:t})=>{const{t:r}=rt();return g.jsxs("div",{className:`
				min-w-[200px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-green-500"}
			`,children:[g.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-t-md flex items-center gap-2",children:[g.jsx(Ty,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||r("editor.nodes.start")})]}),g.jsx("div",{className:"p-4",children:g.jsx("p",{className:"text-xs text-muted-foreground",children:r("editor.nodes.startDescription")})}),g.jsx(Te,{type:"source",position:ae.Bottom,className:"!bg-green-500 !w-3 !h-3 !border-2 !border-white"})]})});mb.displayName="StartNode";const vb=E.memo(({data:e,selected:t})=>{const{t:r}=rt(),n=e.dialogueRows||(e.text?[{text:e.text}]:[]),i=n[0],o=n.length>1,a=i!=null&&i.text?i.text.length>50?i.text.substring(0,50)+"...":i.text:r("editor.nodes.npcPlaceholder"),s=[];e.participant&&s.push(`${r("editor.nodes.tooltip.participant")}: ${e.participant}`),e.decorators&&e.decorators.length>0&&s.push(`${r("editor.nodes.tooltip.decorators")}: ${e.decorators.length}`),n.length>0&&s.push(`${r("editor.nodes.tooltip.dialogueRows")}: ${n.length}`);const c=s.join(`
`);return g.jsxs("div",{className:`
				min-w-[250px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-blue-500"}
			`,title:c,children:[g.jsx(Te,{type:"target",position:ae.Top,className:"!bg-blue-500 !w-3 !h-3 !border-2 !border-white"}),g.jsxs("div",{className:"bg-blue-500 text-white px-4 py-2 rounded-t-md flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(rd,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||r("editor.nodes.npc")})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[o&&g.jsx("span",{className:"text-xs opacity-80",children:r("editor.nodes.rows",{count:n.length})}),e.hasAudio&&g.jsx(si,{className:"h-3 w-3"})]})]}),g.jsxs("div",{className:"p-4 space-y-2",children:[g.jsx("p",{className:"text-sm text-foreground",children:a}),e.participant&&g.jsx("div",{className:"flex items-center gap-2 pt-1",children:g.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",children:[g.jsx(fr,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((u,l)=>g.jsxs("div",{className:"flex items-center gap-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-0.5 rounded-full text-xs",title:u.values&&Object.keys(u.values).length>0?Object.entries(u.values).map(([d,f])=>`${d}: ${f}`).join(", "):void 0,children:[g.jsx(ai,{className:"h-3 w-3"}),u.name||u]},l))})]}),g.jsx(Te,{type:"source",position:ae.Bottom,className:"!bg-blue-500 !w-3 !h-3 !border-2 !border-white"})]})});vb.displayName="LeadNode";const yb=E.memo(({data:e,selected:t})=>{const{t:r}=rt(),n=e.dialogueRows||(e.text?[{text:e.text}]:[]),i=n[0],o=n.length>1,a=i!=null&&i.text?i.text.length>50?i.text.substring(0,50)+"...":i.text:r("editor.nodes.playerPlaceholder"),s=[];e.participant&&s.push(`${r("editor.nodes.tooltip.participant")}: ${e.participant}`),e.decorators&&e.decorators.length>0&&s.push(`${r("editor.nodes.tooltip.decorators")}: ${e.decorators.length}`),n.length>0&&s.push(`${r("editor.nodes.tooltip.dialogueRows")}: ${n.length}`);const c=s.join(`
`);return g.jsxs("div",{className:`
				min-w-[250px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-purple-500"}
			`,title:c,children:[g.jsx(Te,{type:"target",position:ae.Top,className:"!bg-purple-500 !w-3 !h-3 !border-2 !border-white"}),g.jsxs("div",{className:"bg-purple-500 text-white px-4 py-2 rounded-t-md flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(fr,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||r("editor.nodes.player")})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[o&&g.jsx("span",{className:"text-xs opacity-80",children:r("editor.nodes.rows",{count:n.length})}),e.hasAudio&&g.jsx(si,{className:"h-3 w-3"})]})]}),g.jsxs("div",{className:"p-4 space-y-2",children:[g.jsx("p",{className:"text-sm text-foreground",children:a}),e.participant&&g.jsx("div",{className:"flex items-center gap-2 pt-1",children:g.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",children:[g.jsx(fr,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((u,l)=>g.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",title:u.values&&Object.keys(u.values).length>0?Object.entries(u.values).map(([d,f])=>`${d}: ${f}`).join(", "):void 0,children:[g.jsx(ai,{className:"h-3 w-3"}),u.name||u]},l))})]}),g.jsx(Te,{type:"source",position:ae.Bottom,className:"!bg-purple-500 !w-3 !h-3 !border-2 !border-white"})]})});yb.displayName="AnswerNode";const xb=E.memo(({data:e,selected:t})=>{var c,u;const{t:r}=rt(),{getNodes:n}=fn(),o=n().find(l=>l.id===e.targetNode),a=((c=o==null?void 0:o.data)==null?void 0:c.displayName)||((u=o==null?void 0:o.data)==null?void 0:u.label)||r("editor.nodes.returnSelectNode"),s=e.targetNode?e.targetNode.substring(0,8):"";return g.jsxs("div",{className:`
				min-w-[220px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-orange-500"}
			`,children:[g.jsx(Te,{type:"target",position:ae.Top,className:"!bg-orange-500 !w-3 !h-3 !border-2 !border-white"}),g.jsxs("div",{className:"bg-orange-500 text-white px-4 py-2 rounded-t-md flex items-center gap-2",children:[g.jsx(ud,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||r("editor.nodes.return")})]}),g.jsxs("div",{className:"p-4 space-y-2",children:[g.jsx("div",{className:"text-xs text-muted-foreground",children:r("editor.nodes.returnTarget")}),g.jsx("div",{className:"font-medium text-sm text-foreground",children:a}),s&&g.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[g.jsx(w_,{className:"h-3 w-3"}),g.jsx("code",{children:s})]})]})]})});xb.displayName="ReturnNode";const bb=E.memo(({data:e,selected:t})=>{const{t:r}=rt(),n="#CC2100",i="rgba(204, 33, 0, 0.12)",o=e.dialogueRows||(e.text?[{text:e.text}]:[]),a=o[0],s=o.length>1,c=a!=null&&a.text?a.text.length>50?a.text.substring(0,50)+"...":a.text:r("editor.nodes.completePlaceholder"),u=[];e.participant&&u.push(`${r("editor.nodes.tooltip.participant")}: ${e.participant}`),e.decorators&&e.decorators.length>0&&u.push(`${r("editor.nodes.tooltip.decorators")}: ${e.decorators.length}`),o.length>0&&u.push(`${r("editor.nodes.tooltip.dialogueRows")}: ${o.length}`);const l=u.join(`
`);return g.jsxs("div",{className:"min-w-[250px] rounded-lg border-2 bg-card shadow-lg",style:{borderColor:n,boxShadow:t?`0 0 0 4px ${i}`:void 0},title:l,children:[g.jsx(Te,{type:"target",position:ae.Top,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:n}}),g.jsxs("div",{className:"text-white px-4 py-2 rounded-t-md flex items-center justify-between",style:{backgroundColor:n},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(nd,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||r("editor.nodes.complete")})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[s&&g.jsx("span",{className:"text-xs opacity-80",children:r("editor.nodes.rows",{count:o.length})}),e.hasAudio&&g.jsx(si,{className:"h-3 w-3"})]})]}),g.jsxs("div",{className:"p-4 space-y-2",children:[g.jsx("p",{className:"text-sm text-foreground",children:c}),e.participant&&g.jsx("div",{className:"flex items-center gap-2 pt-1",children:g.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:i,color:n},children:[g.jsx(fr,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((d,f)=>g.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:i,color:n},title:d.values&&Object.keys(d.values).length>0?Object.entries(d.values).map(([h,m])=>`${h}: ${m}`).join(", "):void 0,children:[g.jsx(ai,{className:"h-3 w-3"}),d.name||d]},f))})]})]})});bb.displayName="CompleteNode";function Gk({id:e,data:t,selected:r,positionAbsoluteX:n,positionAbsoluteY:i}){const{t:o}=rt(),a=()=>{if(t.onClick){const s={x:n,y:i};t.onClick(e,s,t.parentNodeId)}};return g.jsxs("div",{className:`
				relative bg-card border-2 border-dashed rounded-lg p-4 min-w-[180px]
				transition-all cursor-pointer hover:border-primary hover:bg-accent
				${r?"border-primary shadow-lg":"border-border"}
			`,onClick:a,children:[g.jsx(Te,{type:"target",position:ae.Top,className:"w-3 h-3 !bg-muted-foreground"}),g.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-muted-foreground",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:g.jsx(Kr,{className:"h-5 w-5"})}),g.jsx("span",{className:"text-sm font-medium",children:o("editor.placeholder.addNode")})]}),g.jsx(Te,{type:"source",position:ae.Bottom,className:"w-3 h-3 !bg-muted-foreground"})]})}const Uk=E.memo(Gk),wb=E.memo(({data:e,selected:t})=>{const{t:r}=rt(),n="#7dd3fc",i="rgba(125, 211, 252, 0.18)",o=typeof e.duration=="number"?e.duration:1;return g.jsxs("div",{className:"min-w-[230px] rounded-lg border-2 bg-card shadow-lg",style:{borderColor:n,boxShadow:t?`0 0 0 4px ${i}`:void 0},children:[g.jsx(Te,{type:"target",position:ae.Top,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:n}}),g.jsxs("div",{className:"text-slate-900 px-4 py-2 rounded-t-md flex items-center justify-between",style:{backgroundColor:n},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(sd,{className:"h-4 w-4"}),g.jsx("span",{className:"font-semibold text-sm",children:e.displayName||r("editor.nodes.delay")})]}),g.jsx("span",{className:"text-xs font-medium",children:r("editor.nodes.delaySeconds",{count:o})})]}),g.jsx("div",{className:"p-4",children:g.jsx("p",{className:"text-sm text-foreground",children:r("editor.nodes.delayDescription",{count:o})})}),g.jsx(Te,{type:"source",position:ae.Bottom,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:n}})]})});wb.displayName="DelayNode";const _b=E.forwardRef(({className:e,min:t=0,max:r=100,step:n=1,value:i=[50],onValueChange:o,...a},s)=>{const c=u=>{const l=parseFloat(u.target.value);o&&o([l])};return g.jsx("input",{ref:s,type:"range",min:t,max:r,step:n,value:i[0],onChange:c,className:Pe("w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer","[&::-webkit-slider-thumb]:appearance-none","[&::-webkit-slider-thumb]:w-5","[&::-webkit-slider-thumb]:h-5","[&::-webkit-slider-thumb]:rounded-full","[&::-webkit-slider-thumb]:bg-primary","[&::-webkit-slider-thumb]:cursor-pointer","[&::-webkit-slider-thumb]:border-2","[&::-webkit-slider-thumb]:border-background","[&::-webkit-slider-thumb]:shadow-sm","[&::-moz-range-thumb]:w-5","[&::-moz-range-thumb]:h-5","[&::-moz-range-thumb]:rounded-full","[&::-moz-range-thumb]:bg-primary","[&::-moz-range-thumb]:cursor-pointer","[&::-moz-range-thumb]:border-2","[&::-moz-range-thumb]:border-background","[&::-moz-range-thumb]:shadow-sm","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",e),...a})});_b.displayName="Slider";async function Kk(e){try{const t=await e.arrayBuffer(),r={id:crypto.randomUUID(),name:e.name,type:e.type,size:e.size,data:t,createdAt:new Date().toISOString()};return{id:r.id,name:r.name,type:r.type,size:r.size,blob:new Blob([t],{type:e.type}),dataUrl:await Wk(e)}}catch(t){throw console.error("Error storing audio file:",t),t}}function Wk(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)})}function Yk(e){return new Promise((t,r)=>{const n=new Audio,i=URL.createObjectURL(e);n.addEventListener("loadedmetadata",()=>{URL.revokeObjectURL(i),t(n.duration)}),n.addEventListener("error",()=>{URL.revokeObjectURL(i),r(new Error("Failed to load audio"))}),n.src=i})}function Xk(e){return["audio/wav","audio/mpeg","audio/mp3"].includes(e.type)?e.size>10485760?{valid:!1,error:"File too large. Maximum size is 10MB."}:{valid:!0}:{valid:!1,error:"Invalid file type. Please upload WAV or MP3 files."}}function Zk({dialogueRows:e=[],onChange:t,participants:r=[]}){const{toast:n}=Cy(),[i,o]=E.useState(new Set([0])),[a,s]=E.useState(null),c=E.useRef({}),u=E.useRef({}),l=E.useRef({}),[d,f]=E.useState({});E.useEffect(()=>{if(!e.some(T=>!(T!=null&&T.id)))return;const I=e.map(T=>({...T,id:(T==null?void 0:T.id)||sr(),text:(T==null?void 0:T.text)||"",duration:typeof(T==null?void 0:T.duration)=="number"?T.duration:3,audioFile:(T==null?void 0:T.audioFile)||null}));t(I)},[e,t]),E.useEffect(()=>{const q=new Set;e.forEach(I=>{if(I.audioFile){q.add(I.id);let T=null,V=!1;if(I.audioFile.blob)T=URL.createObjectURL(I.audioFile.blob),V=!0;else if(I.audioFile.dataUrl)try{const G=I.audioFile.dataUrl.split(","),K=G[0].match(/:(.*?);/)[1],Q=atob(G[1]);let P=Q.length;const $=new Uint8Array(P);for(;P--;)$[P]=Q.charCodeAt(P);const H=new Blob([$],{type:K});T=URL.createObjectURL(H),V=!0}catch(G){console.error("Error creating audio URL:",G)}else I.audioFile.url&&(T=I.audioFile.url);T&&u.current[I.id]!==T&&(u.current[I.id]&&l.current[I.id]&&u.current[I.id].startsWith("blob:")&&u.current[I.id]!==T&&URL.revokeObjectURL(u.current[I.id]),u.current[I.id]=T,l.current[I.id]=V)}}),Object.keys(u.current).forEach(I=>{q.has(I)||(u.current[I]&&l.current[I]&&u.current[I].startsWith("blob:")&&URL.revokeObjectURL(u.current[I]),delete u.current[I],delete l.current[I])}),Object.keys(c.current).forEach(I=>{q.has(I)||delete c.current[I]}),f({...u.current})},[e]),E.useEffect(()=>{const q=u.current,I=l.current;return()=>{Object.keys(q).forEach(T=>{const V=q[T];V&&I[T]&&V.startsWith("blob:")&&URL.revokeObjectURL(V)})}},[]);const h=q=>{const I=new Set(i);I.has(q)?I.delete(q):I.add(q),o(I)},m=()=>{const q={id:sr(),text:"",audioFile:null,duration:3},I=[...e,q];t(I),o(new Set([...i,e.length]))},y=q=>{const I=e.filter((V,G)=>G!==q);t(I);const T=new Set(i);T.delete(q),o(T)},v=(q,I)=>{const T=e.map((V,G)=>G===q?{...V,...I}:V);t(T)},[x,b]=E.useState(null),[p,w]=E.useState(!1),[S,_]=E.useState({top:0,left:0}),[N,j]=E.useState(""),A=E.useRef({}),k=(q,I,T)=>{v(q,{text:I});const V=T.target.selectionStart,G=I.substring(0,V),K=G.lastIndexOf("$");if(K!==-1&&V-K<=20){const Q=G.substring(K+1);if(!Q.includes("}")&&!Q.includes(" ")&&!Q.includes(`
`)){b(q),j(Q.toLowerCase()),w(!0);const $=T.target.getBoundingClientRect();_({top:$.top-150,left:$.left+10})}else w(!1)}else w(!1)},R=q=>{if(x===null)return;const I=e[x],T=A.current[x];if(!T)return;const V=T.selectionStart,K=I.text.substring(0,V).lastIndexOf("$"),Q=I.text.substring(0,K)+`\${${q}}`+I.text.substring(V);v(x,{text:Q}),w(!1),setTimeout(()=>{T.focus();const P=K+q.length+3;T.setSelectionRange(P,P)},0)},M=r.filter(q=>q.name.toLowerCase().includes(N)),F=async(q,I)=>{if(!I)return;const T=Xk(I);if(!T.valid){n({variant:"error",title:"Invalid Audio File",description:T.error});return}try{const V=await Kk(I),G=await Yk(I);v(q,{audioFile:V,duration:G||3}),n({variant:"success",title:"Audio Uploaded",description:`${I.name} uploaded successfully`})}catch(V){console.error("Error uploading audio:",V),n({variant:"error",title:"Upload Failed",description:"Failed to upload audio file. Please try again."})}},C=q=>{const I=c.current[q];if(!I)return;const T=u.current[q]||d[q];if(!T){n({variant:"error",title:"Playback Failed",description:"No audio source found for this row."});return}I.src!==T&&(I.src=T,I.load()),a===q?(I.pause(),s(null)):(a!==null&&c.current[a]&&c.current[a].pause(),I.play().then(()=>{s(q)}).catch(V=>{console.error("Error playing audio:",V),s(null),n({variant:"error",title:"Playback Failed",description:"Failed to play audio clip."})}))},D=q=>{a===q&&s(null)},O=q=>{const I=e[q];I&&(u.current[I.id]&&l.current[I.id]&&u.current[I.id].startsWith("blob:")&&URL.revokeObjectURL(u.current[I.id]),delete u.current[I.id],delete l.current[I.id],f(T=>{const V={...T};return delete V[I.id],V})),v(q,{audioFile:null}),I&&a===I.id&&s(null)};return g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(Ze,{className:"text-sm font-bold",children:"Dialogue Rows"}),g.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.length," ",e.length===1?"row":"rows"]})]}),e.length===0?g.jsxs("div",{className:"text-center py-6 border border-dashed border-border rounded-lg",children:[g.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No dialogue rows yet"}),g.jsxs(xe,{variant:"outline",size:"sm",onClick:m,className:"gap-2",children:[g.jsx(Kr,{className:"h-3.5 w-3.5"}),"Add First Row"]})]}):g.jsx("div",{className:"space-y-2",children:e.map((q,I)=>{const T=i.has(I),V=q.text?q.text.length>40?q.text.substring(0,40)+"...":q.text:"Empty dialogue...";return g.jsxs("div",{className:"border border-border rounded-lg overflow-hidden bg-card",children:[g.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>h(I),children:[g.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[T?g.jsx(nn,{className:"h-4 w-4 text-muted-foreground shrink-0"}):g.jsx(cd,{className:"h-4 w-4 text-muted-foreground shrink-0"}),g.jsxs("span",{className:"text-xs font-medium text-muted-foreground shrink-0",children:["[",I,"]"]}),g.jsx("span",{className:"text-sm flex-1 truncate",children:V})]}),g.jsx(xe,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:G=>{G.stopPropagation(),y(I)},children:g.jsx(Un,{className:"h-3.5 w-3.5 text-destructive"})})]}),T&&g.jsxs("div",{className:"p-4 pt-0 space-y-4 border-t border-border",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsxs(Ze,{htmlFor:`text-${q.id}`,children:["Dialogue Text",g.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Type $ for participants)"})]}),g.jsx(fw,{id:`text-${q.id}`,ref:G=>A.current[I]=G,value:q.text||"",onChange:G=>k(I,G.target.value,G),placeholder:"Enter dialogue text... Type $ to insert participant names",className:"min-h-[100px] font-mono text-sm"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(Ze,{htmlFor:`audio-${q.id}`,children:"Audio Clip"}),q.audioFile?g.jsxs("div",{className:"flex items-center gap-2 p-3 bg-accent/50 rounded-lg border border-border",children:[g.jsx(xe,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>C(q.id),children:a===q.id?g.jsx(C_,{className:"h-4 w-4"}):g.jsx(Ty,{className:"h-4 w-4"})}),g.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(si,{className:"h-3 w-3 text-muted-foreground"}),g.jsx("span",{className:"text-sm font-medium truncate",children:q.audioFile.name})]}),g.jsxs("span",{className:"text-xs text-muted-foreground",children:[(q.audioFile.size/1024).toFixed(1)," KB"]})]}),g.jsx(xe,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:()=>O(I),children:g.jsx(jl,{className:"h-3.5 w-3.5 text-destructive"})}),g.jsx("audio",{ref:G=>c.current[q.id]=G,src:d[q.id]||"",onEnded:()=>D(q.id),className:"hidden"})]}):g.jsx(Ur,{id:`audio-${q.id}`,type:"file",accept:".wav,.mp3,audio/wav,audio/mpeg",onChange:G=>{var Q;const K=(Q=G.target.files)==null?void 0:Q[0];K&&F(I,K),G.target.value=""},className:"cursor-pointer"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(Ze,{htmlFor:`duration-${q.id}`,children:"Duration (seconds)"}),g.jsxs("span",{className:"text-sm font-medium",children:[q.duration.toFixed(1),"s"]})]}),g.jsx(_b,{id:`duration-${q.id}`,value:[q.duration],onValueChange:([G])=>v(I,{duration:G}),min:.5,max:30,step:.1,className:"w-full"})]})]})]},q.id)})}),e.length>0&&g.jsxs(xe,{variant:"outline",size:"sm",onClick:m,className:"w-full gap-2",children:[g.jsx(Kr,{className:"h-3.5 w-3.5"}),"Add Dialogue Row"]}),p&&M.length>0&&g.jsx("div",{className:"fixed z-50 bg-popover border border-border rounded-lg shadow-lg max-h-48 overflow-y-auto",style:{top:`${S.top}px`,left:`${S.left}px`,minWidth:"200px"},children:M.map(q=>g.jsxs("button",{onClick:()=>R(q.name),className:"w-full px-3 py-2 text-left text-sm hover:bg-accent transition-colors flex items-center gap-2",children:[g.jsx("span",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-bold",children:q.name.charAt(0).toUpperCase()}),g.jsx("span",{children:q.name})]},q.id))})]})}function by(e,[t,r]){return Math.min(r,Math.max(t,e))}function Qk(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Jk=[" ","Enter","ArrowUp","ArrowDown"],ej=[" ","Enter"],Wt="Select",[Li,Oi,tj]=c_(Wt),[Cr]=vw(Wt,[tj,Iy]),Di=Iy(),[rj,Mt]=Cr(Wt),[nj,ij]=Cr(Wt),Nb=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:i,onOpenChange:o,value:a,defaultValue:s,onValueChange:c,dir:u,name:l,autoComplete:d,disabled:f,required:h,form:m}=e,y=Di(t),[v,x]=E.useState(null),[b,p]=E.useState(null),[w,S]=E.useState(!1),_=s_(u),[N,j]=Kd({prop:n,defaultProp:i??!1,onChange:o,caller:Wt}),[A,k]=Kd({prop:a,defaultProp:s,onChange:c,caller:Wt}),R=E.useRef(null),M=v?m||!!v.closest("form"):!0,[F,C]=E.useState(new Set),D=Array.from(F).map(O=>O.props.value).join(";");return g.jsx(hw,{...y,children:g.jsxs(rj,{required:h,scope:t,trigger:v,onTriggerChange:x,valueNode:b,onValueNodeChange:p,valueNodeHasChildren:w,onValueNodeHasChildrenChange:S,contentId:id(),value:A,onValueChange:k,open:N,onOpenChange:j,dir:_,triggerPointerDownPosRef:R,disabled:f,children:[g.jsx(Li.Provider,{scope:t,children:g.jsx(nj,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(O=>{C(q=>new Set(q).add(O))},[]),onNativeOptionRemove:E.useCallback(O=>{C(q=>{const I=new Set(q);return I.delete(O),I})},[]),children:r})}),M?g.jsxs(Kb,{"aria-hidden":!0,required:h,tabIndex:-1,name:l,autoComplete:d,value:A,onChange:O=>k(O.target.value),disabled:f,form:m,children:[A===void 0?g.jsx("option",{value:""}):null,Array.from(F)]},D):null]})})};Nb.displayName=Wt;var Sb="SelectTrigger",Eb=E.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,o=Di(r),a=Mt(Sb,r),s=a.disabled||n,c=dt(t,a.onTriggerChange),u=Oi(r),l=E.useRef("touch"),[d,f,h]=Yb(y=>{const v=u().filter(p=>!p.disabled),x=v.find(p=>p.value===a.value),b=Xb(v,y,x);b!==void 0&&a.onValueChange(b.value)}),m=y=>{s||(a.onOpenChange(!0),h()),y&&(a.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return g.jsx(gw,{asChild:!0,...o,children:g.jsx(ze.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":Wb(a.value)?"":void 0,...i,ref:c,onClick:Ce(i.onClick,y=>{y.currentTarget.focus(),l.current!=="mouse"&&m(y)}),onPointerDown:Ce(i.onPointerDown,y=>{l.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:Ce(i.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&f(y.key),!(v&&y.key===" ")&&Jk.includes(y.key)&&(m(),y.preventDefault())})})})});Eb.displayName=Sb;var Cb="SelectValue",Ib=E.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:o,placeholder:a="",...s}=e,c=Mt(Cb,r),{onValueNodeHasChildrenChange:u}=c,l=o!==void 0,d=dt(t,c.onValueNodeChange);return kt(()=>{u(l)},[u,l]),g.jsx(ze.span,{...s,ref:d,style:{pointerEvents:"none"},children:Wb(c.value)?g.jsx(g.Fragment,{children:a}):o})});Ib.displayName=Cb;var oj="SelectIcon",Rb=E.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return g.jsx(ze.span,{"aria-hidden":!0,...i,ref:t,children:n||""})});Rb.displayName=oj;var aj="SelectPortal",Tb=e=>g.jsx(mw,{asChild:!0,...e});Tb.displayName=aj;var Yt="SelectContent",Ab=E.forwardRef((e,t)=>{const r=Mt(Yt,e.__scopeSelect),[n,i]=E.useState();if(kt(()=>{i(new DocumentFragment)},[]),!r.open){const o=n;return o?od.createPortal(g.jsx(kb,{scope:e.__scopeSelect,children:g.jsx(Li.Slot,{scope:e.__scopeSelect,children:g.jsx("div",{children:e.children})})}),o):null}return g.jsx(jb,{...e,ref:t})});Ab.displayName=Yt;var Ye=10,[kb,qt]=Cr(Yt),sj="SelectContentImpl",cj=Sw("SelectContent.RemoveScroll"),jb=E.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:a,side:s,sideOffset:c,align:u,alignOffset:l,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:m,hideWhenDetached:y,avoidCollisions:v,...x}=e,b=Mt(Yt,r),[p,w]=E.useState(null),[S,_]=E.useState(null),N=dt(t,B=>w(B)),[j,A]=E.useState(null),[k,R]=E.useState(null),M=Oi(r),[F,C]=E.useState(!1),D=E.useRef(!1);E.useEffect(()=>{if(p)return xw(p)},[p]),bw();const O=E.useCallback(B=>{const[z,...X]=M().map(re=>re.ref.current),[te]=X.slice(-1),ee=document.activeElement;for(const re of B)if(re===ee||(re==null||re.scrollIntoView({block:"nearest"}),re===z&&S&&(S.scrollTop=0),re===te&&S&&(S.scrollTop=S.scrollHeight),re==null||re.focus(),document.activeElement!==ee))return},[M,S]),q=E.useCallback(()=>O([j,p]),[O,j,p]);E.useEffect(()=>{F&&q()},[F,q]);const{onOpenChange:I,triggerPointerDownPosRef:T}=b;E.useEffect(()=>{if(p){let B={x:0,y:0};const z=te=>{var ee,re;B={x:Math.abs(Math.round(te.pageX)-(((ee=T.current)==null?void 0:ee.x)??0)),y:Math.abs(Math.round(te.pageY)-(((re=T.current)==null?void 0:re.y)??0))}},X=te=>{B.x<=10&&B.y<=10?te.preventDefault():p.contains(te.target)||I(!1),document.removeEventListener("pointermove",z),T.current=null};return T.current!==null&&(document.addEventListener("pointermove",z),document.addEventListener("pointerup",X,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",X,{capture:!0})}}},[p,I,T]),E.useEffect(()=>{const B=()=>I(!1);return window.addEventListener("blur",B),window.addEventListener("resize",B),()=>{window.removeEventListener("blur",B),window.removeEventListener("resize",B)}},[I]);const[V,G]=Yb(B=>{const z=M().filter(ee=>!ee.disabled),X=z.find(ee=>ee.ref.current===document.activeElement),te=Xb(z,B,X);te&&setTimeout(()=>te.ref.current.focus())}),K=E.useCallback((B,z,X)=>{const te=!D.current&&!X;(b.value!==void 0&&b.value===z||te)&&(A(B),te&&(D.current=!0))},[b.value]),Q=E.useCallback(()=>p==null?void 0:p.focus(),[p]),P=E.useCallback((B,z,X)=>{const te=!D.current&&!X;(b.value!==void 0&&b.value===z||te)&&R(B)},[b.value]),$=n==="popper"?Wl:Mb,H=$===Wl?{side:s,sideOffset:c,align:u,alignOffset:l,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:m,hideWhenDetached:y,avoidCollisions:v}:{};return g.jsx(kb,{scope:r,content:p,viewport:S,onViewportChange:_,itemRefCallback:K,selectedItem:j,onItemLeave:Q,itemTextRefCallback:P,focusSelectedItem:q,selectedItemText:k,position:n,isPositioned:F,searchRef:V,children:g.jsx(ww,{as:cj,allowPinchZoom:!0,children:g.jsx(_w,{asChild:!0,trapped:b.open,onMountAutoFocus:B=>{B.preventDefault()},onUnmountAutoFocus:Ce(i,B=>{var z;(z=b.trigger)==null||z.focus({preventScroll:!0}),B.preventDefault()}),children:g.jsx(Nw,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:B=>B.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:g.jsx($,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:B=>B.preventDefault(),...x,...H,onPlaced:()=>C(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Ce(x.onKeyDown,B=>{const z=B.ctrlKey||B.altKey||B.metaKey;if(B.key==="Tab"&&B.preventDefault(),!z&&B.key.length===1&&G(B.key),["ArrowUp","ArrowDown","Home","End"].includes(B.key)){let te=M().filter(ee=>!ee.disabled).map(ee=>ee.ref.current);if(["ArrowUp","End"].includes(B.key)&&(te=te.slice().reverse()),["ArrowUp","ArrowDown"].includes(B.key)){const ee=B.target,re=te.indexOf(ee);te=te.slice(re+1)}setTimeout(()=>O(te)),B.preventDefault()}})})})})})})});jb.displayName=sj;var uj="SelectItemAlignedPosition",Mb=E.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,o=Mt(Yt,r),a=qt(Yt,r),[s,c]=E.useState(null),[u,l]=E.useState(null),d=dt(t,N=>l(N)),f=Oi(r),h=E.useRef(!1),m=E.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:x,focusSelectedItem:b}=a,p=E.useCallback(()=>{if(o.trigger&&o.valueNode&&s&&u&&y&&v&&x){const N=o.trigger.getBoundingClientRect(),j=u.getBoundingClientRect(),A=o.valueNode.getBoundingClientRect(),k=x.getBoundingClientRect();if(o.dir!=="rtl"){const ee=k.left-j.left,re=A.left-ee,ne=N.left-re,Z=N.width+ne,se=Math.max(Z,j.width),le=window.innerWidth-Ye,ce=by(re,[Ye,Math.max(Ye,le-se)]);s.style.minWidth=Z+"px",s.style.left=ce+"px"}else{const ee=j.right-k.right,re=window.innerWidth-A.right-ee,ne=window.innerWidth-N.right-re,Z=N.width+ne,se=Math.max(Z,j.width),le=window.innerWidth-Ye,ce=by(re,[Ye,Math.max(Ye,le-se)]);s.style.minWidth=Z+"px",s.style.right=ce+"px"}const R=f(),M=window.innerHeight-Ye*2,F=y.scrollHeight,C=window.getComputedStyle(u),D=parseInt(C.borderTopWidth,10),O=parseInt(C.paddingTop,10),q=parseInt(C.borderBottomWidth,10),I=parseInt(C.paddingBottom,10),T=D+O+F+I+q,V=Math.min(v.offsetHeight*5,T),G=window.getComputedStyle(y),K=parseInt(G.paddingTop,10),Q=parseInt(G.paddingBottom,10),P=N.top+N.height/2-Ye,$=M-P,H=v.offsetHeight/2,B=v.offsetTop+H,z=D+O+B,X=T-z;if(z<=P){const ee=R.length>0&&v===R[R.length-1].ref.current;s.style.bottom="0px";const re=u.clientHeight-y.offsetTop-y.offsetHeight,ne=Math.max($,H+(ee?Q:0)+re+q),Z=z+ne;s.style.height=Z+"px"}else{const ee=R.length>0&&v===R[0].ref.current;s.style.top="0px";const ne=Math.max(P,D+y.offsetTop+(ee?K:0)+H)+X;s.style.height=ne+"px",y.scrollTop=z-P+y.offsetTop}s.style.margin=`${Ye}px 0`,s.style.minHeight=V+"px",s.style.maxHeight=M+"px",n==null||n(),requestAnimationFrame(()=>h.current=!0)}},[f,o.trigger,o.valueNode,s,u,y,v,x,o.dir,n]);kt(()=>p(),[p]);const[w,S]=E.useState();kt(()=>{u&&S(window.getComputedStyle(u).zIndex)},[u]);const _=E.useCallback(N=>{N&&m.current===!0&&(p(),b==null||b(),m.current=!1)},[p,b]);return g.jsx(dj,{scope:r,contentWrapper:s,shouldExpandOnScrollRef:h,onScrollButtonChange:_,children:g.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:g.jsx(ze.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Mb.displayName=uj;var lj="SelectPopperPosition",Wl=E.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=Ye,...o}=e,a=Di(r);return g.jsx(Ew,{...a,...o,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Wl.displayName=lj;var[dj,Vd]=Cr(Yt,{}),Yl="SelectViewport",qb=E.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,o=qt(Yl,r),a=Vd(Yl,r),s=dt(t,o.onViewportChange),c=E.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),g.jsx(Li.Slot,{scope:r,children:g.jsx(ze.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:s,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Ce(i.onScroll,u=>{const l=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=a;if(f!=null&&f.current&&d){const h=Math.abs(c.current-l.scrollTop);if(h>0){const m=window.innerHeight-Ye*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(y,v);if(x<m){const b=x+h,p=Math.min(m,b),w=b-p;d.style.height=p+"px",d.style.bottom==="0px"&&(l.scrollTop=w>0?w:0,d.style.justifyContent="flex-end")}}}c.current=l.scrollTop})})})]})});qb.displayName=Yl;var Pb="SelectGroup",[fj,hj]=Cr(Pb),pj=E.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=id();return g.jsx(fj,{scope:r,id:i,children:g.jsx(ze.div,{role:"group","aria-labelledby":i,...n,ref:t})})});pj.displayName=Pb;var Lb="SelectLabel",Ob=E.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=hj(Lb,r);return g.jsx(ze.div,{id:i.id,...n,ref:t})});Ob.displayName=Lb;var ii="SelectItem",[gj,Db]=Cr(ii),Fb=E.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:o,...a}=e,s=Mt(ii,r),c=qt(ii,r),u=s.value===n,[l,d]=E.useState(o??""),[f,h]=E.useState(!1),m=dt(t,b=>{var p;return(p=c.itemRefCallback)==null?void 0:p.call(c,b,n,i)}),y=id(),v=E.useRef("touch"),x=()=>{i||(s.onValueChange(n),s.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(gj,{scope:r,value:n,disabled:i,textId:y,isSelected:u,onItemTextChange:E.useCallback(b=>{d(p=>p||((b==null?void 0:b.textContent)??"").trim())},[]),children:g.jsx(Li.ItemSlot,{scope:r,value:n,disabled:i,textValue:l,children:g.jsx(ze.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:m,onFocus:Ce(a.onFocus,()=>h(!0)),onBlur:Ce(a.onBlur,()=>h(!1)),onClick:Ce(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Ce(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Ce(a.onPointerDown,b=>{v.current=b.pointerType}),onPointerMove:Ce(a.onPointerMove,b=>{var p;v.current=b.pointerType,i?(p=c.onItemLeave)==null||p.call(c):v.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ce(a.onPointerLeave,b=>{var p;b.currentTarget===document.activeElement&&((p=c.onItemLeave)==null||p.call(c))}),onKeyDown:Ce(a.onKeyDown,b=>{var w;((w=c.searchRef)==null?void 0:w.current)!==""&&b.key===" "||(ej.includes(b.key)&&x(),b.key===" "&&b.preventDefault())})})})})});Fb.displayName=ii;var Hr="SelectItemText",$b=E.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...o}=e,a=Mt(Hr,r),s=qt(Hr,r),c=Db(Hr,r),u=ij(Hr,r),[l,d]=E.useState(null),f=dt(t,x=>d(x),c.onItemTextChange,x=>{var b;return(b=s.itemTextRefCallback)==null?void 0:b.call(s,x,c.value,c.disabled)}),h=l==null?void 0:l.textContent,m=E.useMemo(()=>g.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=u;return kt(()=>(y(m),()=>v(m)),[y,v,m]),g.jsxs(g.Fragment,{children:[g.jsx(ze.span,{id:c.textId,...o,ref:f}),c.isSelected&&a.valueNode&&!a.valueNodeHasChildren?od.createPortal(o.children,a.valueNode):null]})});$b.displayName=Hr;var Bb="SelectItemIndicator",zb=E.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Db(Bb,r).isSelected?g.jsx(ze.span,{"aria-hidden":!0,...n,ref:t}):null});zb.displayName=Bb;var Xl="SelectScrollUpButton",Hb=E.forwardRef((e,t)=>{const r=qt(Xl,e.__scopeSelect),n=Vd(Xl,e.__scopeSelect),[i,o]=E.useState(!1),a=dt(t,n.onScrollButtonChange);return kt(()=>{if(r.viewport&&r.isPositioned){let s=function(){const u=c.scrollTop>0;o(u)};const c=r.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),i?g.jsx(Gb,{...e,ref:a,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=r;s&&c&&(s.scrollTop=s.scrollTop-c.offsetHeight)}}):null});Hb.displayName=Xl;var Zl="SelectScrollDownButton",Vb=E.forwardRef((e,t)=>{const r=qt(Zl,e.__scopeSelect),n=Vd(Zl,e.__scopeSelect),[i,o]=E.useState(!1),a=dt(t,n.onScrollButtonChange);return kt(()=>{if(r.viewport&&r.isPositioned){let s=function(){const u=c.scrollHeight-c.clientHeight,l=Math.ceil(c.scrollTop)<u;o(l)};const c=r.viewport;return s(),c.addEventListener("scroll",s),()=>c.removeEventListener("scroll",s)}},[r.viewport,r.isPositioned]),i?g.jsx(Gb,{...e,ref:a,onAutoScroll:()=>{const{viewport:s,selectedItem:c}=r;s&&c&&(s.scrollTop=s.scrollTop+c.offsetHeight)}}):null});Vb.displayName=Zl;var Gb=E.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,o=qt("SelectScrollButton",r),a=E.useRef(null),s=Oi(r),c=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>c(),[c]),kt(()=>{var l;const u=s().find(d=>d.ref.current===document.activeElement);(l=u==null?void 0:u.ref.current)==null||l.scrollIntoView({block:"nearest"})},[s]),g.jsx(ze.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:Ce(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:Ce(i.onPointerMove,()=>{var u;(u=o.onItemLeave)==null||u.call(o),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:Ce(i.onPointerLeave,()=>{c()})})}),mj="SelectSeparator",Ub=E.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return g.jsx(ze.div,{"aria-hidden":!0,...n,ref:t})});Ub.displayName=mj;var Ql="SelectArrow",vj=E.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=Di(r),o=Mt(Ql,r),a=qt(Ql,r);return o.open&&a.position==="popper"?g.jsx(Cw,{...i,...n,ref:t}):null});vj.displayName=Ql;var yj="SelectBubbleInput",Kb=E.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const i=E.useRef(null),o=dt(n,i),a=Qk(t);return E.useEffect(()=>{const s=i.current;if(!s)return;const c=window.HTMLSelectElement.prototype,l=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==t&&l){const d=new Event("change",{bubbles:!0});l.call(s,t),s.dispatchEvent(d)}},[a,t]),g.jsx(ze.select,{...r,style:{...pw,...r.style},ref:o,defaultValue:t})});Kb.displayName=yj;function Wb(e){return e===""||e===void 0}function Yb(e){const t=yw(e),r=E.useRef(""),n=E.useRef(0),i=E.useCallback(a=>{const s=r.current+a;t(s),(function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))})(s)},[t]),o=E.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,o]}function Xb(e,t,r){const i=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let a=xj(e,Math.max(o,0));i.length===1&&(a=a.filter(u=>u!==r));const c=a.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return c!==r?c:void 0}function xj(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var bj=Nb,Zb=Eb,wj=Ib,_j=Rb,Nj=Tb,Qb=Ab,Sj=qb,Jb=Ob,ew=Fb,Ej=$b,Cj=zb,tw=Hb,rw=Vb,nw=Ub;const wy=bj,_y=wj,Jl=E.forwardRef(({className:e,children:t,...r},n)=>g.jsxs(Zb,{ref:n,className:Pe("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,g.jsx(_j,{asChild:!0,children:g.jsx(nn,{className:"h-4 w-4 opacity-50"})})]}));Jl.displayName=Zb.displayName;const iw=E.forwardRef(({className:e,...t},r)=>g.jsx(tw,{ref:r,className:Pe("flex cursor-default items-center justify-center py-1",e),...t,children:g.jsx(x_,{className:"h-4 w-4"})}));iw.displayName=tw.displayName;const ow=E.forwardRef(({className:e,...t},r)=>g.jsx(rw,{ref:r,className:Pe("flex cursor-default items-center justify-center py-1",e),...t,children:g.jsx(nn,{className:"h-4 w-4"})}));ow.displayName=rw.displayName;const ed=E.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>g.jsx(Nj,{children:g.jsxs(Qb,{ref:i,className:Pe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[g.jsx(iw,{}),g.jsx(Sj,{className:Pe("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),g.jsx(ow,{})]})}));ed.displayName=Qb.displayName;const Ij=E.forwardRef(({className:e,...t},r)=>g.jsx(Jb,{ref:r,className:Pe("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Ij.displayName=Jb.displayName;const Gn=E.forwardRef(({className:e,children:t,...r},n)=>g.jsxs(ew,{ref:n,className:Pe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(Cj,{children:g.jsx(Ry,{className:"h-4 w-4"})})}),g.jsx(Ej,{children:t})]}));Gn.displayName=ew.displayName;const Rj=E.forwardRef(({className:e,...t},r)=>g.jsx(nw,{ref:r,className:Pe("-mx-1 my-1 h-px bg-muted",e),...t}));Rj.displayName=nw.displayName;function Tj({decorators:e=[],availableDecorators:t=[],onAddDecorator:r,onRemoveDecorator:n,onUpdateDecorator:i}){const{t:o}=rt(),[a,s]=E.useState(new Set([0])),[c,u]=E.useState(""),l=h=>{const m=new Set(a);m.has(h)?m.delete(h):m.add(h),s(m)},d=()=>{if(!c)return;const h=t.find(m=>m.id===c);h&&(r(h),u(""),s(new Set([...a,e.length])))},f=(h,m,y)=>{const x={...e[h].values,[m]:y};i(h,x)};return g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(Ze,{className:"text-sm font-bold",children:o("decorators.panelTitle")}),g.jsx("span",{className:"text-xs text-muted-foreground",children:o("decorators.count",{count:e.length})})]}),e.length===0?g.jsx("div",{className:"text-center py-6 border border-dashed border-border rounded-lg",children:g.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:o("decorators.none")})}):g.jsx("div",{className:"space-y-2",children:e.map((h,m)=>{const y=a.has(m),v=t.find(b=>b.id===h.id),x=(v==null?void 0:v.properties)&&v.properties.length>0;return g.jsxs("div",{className:"border border-border rounded-lg overflow-hidden bg-card",children:[g.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>l(m),children:[g.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[y?g.jsx(nn,{className:"h-4 w-4 text-muted-foreground shrink-0"}):g.jsx(cd,{className:"h-4 w-4 text-muted-foreground shrink-0"}),g.jsxs("span",{className:"text-xs font-medium text-muted-foreground shrink-0",children:["[",m,"]"]}),g.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[g.jsx(ai,{className:"h-3.5 w-3.5 text-primary shrink-0"}),g.jsx("span",{className:"text-sm font-medium truncate",children:h.name||o("decorators.unnamed")})]})]}),g.jsx(xe,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:b=>{b.stopPropagation(),n(m)},children:g.jsx(Un,{className:"h-3.5 w-3.5 text-destructive"})})]}),y&&x&&g.jsx("div",{className:"p-4 pt-0 space-y-4 border-t border-border",children:v.properties.map(b=>{var p;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs(Ze,{htmlFor:`${h.id}-${m}-${b.name}`,children:[b.name,g.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",b.type,")"]})]}),b.type==="string"&&g.jsx(Ur,{id:`${h.id}-${m}-${b.name}`,value:h.values[b.name]||"",onChange:w=>f(m,b.name,w.target.value),placeholder:o("decorators.enterProperty",{name:b.name})}),b.type==="number"&&g.jsx(Ur,{id:`${h.id}-${m}-${b.name}`,type:"number",value:h.values[b.name]||0,onChange:w=>f(m,b.name,parseFloat(w.target.value)||0),placeholder:o("decorators.enterProperty",{name:b.name})}),b.type==="boolean"&&g.jsxs(wy,{value:((p=h.values[b.name])==null?void 0:p.toString())||"false",onValueChange:w=>f(m,b.name,w==="true"),children:[g.jsx(Jl,{children:g.jsx(_y,{})}),g.jsxs(ed,{children:[g.jsx(Gn,{value:"true",children:o("common.true")}),g.jsx(Gn,{value:"false",children:o("common.false")})]})]})]},b.name)})})]},`${h.id}-${m}`)})}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs(wy,{value:c,onValueChange:u,children:[g.jsx(Jl,{className:"flex-1",children:g.jsx(_y,{placeholder:o("decorators.selectPlaceholder")})}),g.jsx(ed,{children:t.map(h=>g.jsx(Gn,{value:h.id,children:h.name},h.id))})]}),g.jsxs(xe,{variant:"outline",size:"sm",onClick:d,disabled:!c,className:"gap-2 shrink-0",children:[g.jsx(Kr,{className:"h-3.5 w-3.5"}),o("common.add")]})]})]})}function Aj({title:e,defaultOpen:t=!0,children:r}){const[n,i]=E.useState(t);return g.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[g.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-3 flex items-center justify-between bg-muted/50 hover:bg-muted transition-colors",children:[g.jsx("h4",{className:"text-sm font-semibold",children:e}),n?g.jsx(nn,{className:"h-4 w-4 text-muted-foreground"}):g.jsx(cd,{className:"h-4 w-4 text-muted-foreground"})]}),n&&g.jsx("div",{className:"p-4 space-y-3",children:r})]})}function kj({status:e="saved",lastSaved:t,className:r}){const{t:n}=rt(),i={saved:{icon:Ry,iconClass:"text-green-500",text:n("editor.saveStatus.saved"),dotClass:"bg-green-500"},saving:{icon:Rw,iconClass:"text-blue-500 animate-spin",text:n("editor.saveStatus.saving"),dotClass:"bg-blue-500"},unsaved:{icon:b_,iconClass:"text-orange-500",text:n("editor.saveStatus.unsaved"),dotClass:"bg-orange-500 animate-pulse"},error:{icon:Iw,iconClass:"text-red-500",text:n("editor.saveStatus.error"),dotClass:"bg-red-500"}},o=i[e]||i.saved,a=o.icon,s=c=>{if(!c)return"";const l=new Date-c;if(l<6e4)return n("common.time.justNow");if(l<36e5){const d=Math.floor(l/6e4);return n("common.time.minutesAgo",{count:d})}if(l<864e5){const d=Math.floor(l/36e5);return n("common.time.hoursAgo",{count:d})}return c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return g.jsxs("div",{className:Pe("flex items-center gap-2 text-sm text-muted-foreground",r),children:[g.jsxs("div",{className:"flex items-center gap-1.5",children:[g.jsx(a,{className:Pe("h-3.5 w-3.5",o.iconClass)}),g.jsx("span",{className:"font-medium",children:o.text})]}),t&&e==="saved"&&g.jsxs("span",{className:"text-xs opacity-70",children:["(",s(t),")"]})]})}const jj={type:"startNode",label:"Start",description:"Dialogue entry point",section:"system",creatable:!1,canHaveOutputs:!0,minimapColor:"#22c55e",defaultData:{label:"Dialogue entry point",displayName:"Start",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]}]},Mj={type:"leadNode",label:"NPC",description:"Add an NPC dialogue node",section:"dialogue",creatable:!0,canHaveOutputs:!0,icon:"messageCircle",colorClass:"text-blue-500",minimapColor:"#3b82f6",defaultData:{label:"New NPC",displayName:"NPC",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},qj={type:"answerNode",label:"Player",description:"Add a player response node",section:"dialogue",creatable:!0,canHaveOutputs:!0,icon:"user",colorClass:"text-purple-500",minimapColor:"#8b5cf6",defaultData:{label:"New Player",displayName:"Player",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},Pj={type:"returnNode",label:"Return",description:"Return to a previous node",section:"flow",creatable:!0,canHaveOutputs:!1,icon:"cornerUpLeft",colorClass:"text-orange-500",minimapColor:"#f97316",defaultData:{label:"New Return",displayName:"Return",targetNode:""},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"returnTarget",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"targetNode",type:"select",labelKey:"editor.sections.targetNode",placeholderKey:"editor.sections.targetNodePlaceholder",options:"nodes"}]}]},Lj={type:"completeNode",label:"Complete",description:"Mark dialogue as complete",section:"flow",creatable:!0,canHaveOutputs:!1,icon:"checkCircle2",colorClass:"text-[#CC2100]",minimapColor:"#CC2100",defaultData:{label:"New Complete",displayName:"Complete",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},Oj={type:"delayNode",label:"Delay",description:"Pause the dialogue for a set duration",section:"flow",creatable:!0,canHaveOutputs:!0,icon:"clock",colorClass:"text-sky-400",minimapColor:"#7dd3fc",defaultData:{label:"New Delay",displayName:"Delay",duration:1},sections:[{id:"delaySettings",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"duration",type:"slider",label:"Duration (seconds)",min:.1,max:30,step:.1,unit:"s"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]}]},Dj={startNode:jj,leadNode:Mj,answerNode:qj,returnNode:Pj,completeNode:Lj,delayNode:Oj},Gd=Dj,st=e=>Gd[e],Fj=()=>Object.values(Gd).filter(e=>e.creatable),td=e=>{var t;return((t=Gd[e])==null?void 0:t.defaultData)||{}};function $j({open:e,onOpenChange:t,onSelectType:r}){const{t:n}=rt(),i={messageCircle:rd,user:fr,cornerUpLeft:ud,checkCircle2:nd,clock:sd},o=Fj(),a=s=>{r(s),t(!1)};return g.jsx(Tw,{open:e,onOpenChange:t,children:g.jsxs(Aw,{className:"sm:max-w-md",children:[g.jsxs(kw,{children:[g.jsx(jw,{children:"Select Node Type"}),g.jsx(Mw,{children:"Choose the type of node you want to add to the dialogue"})]}),g.jsx("div",{className:"grid gap-2 py-4",children:o.map(s=>{const c=i[s.icon];return g.jsxs(xe,{variant:"outline",className:"h-auto p-4 justify-start gap-4",onClick:()=>a(s.type),children:[g.jsx("div",{className:`w-10 h-10 rounded-lg bg-muted flex items-center justify-center ${s.colorClass||""}`,children:c?g.jsx(c,{className:"h-5 w-5"}):null}),g.jsxs("div",{className:"flex flex-col items-start gap-1 text-left",children:[g.jsx("span",{className:"font-semibold",children:s.label}),g.jsx("span",{className:"text-xs text-muted-foreground",children:s.description})]})]},s.type)})})]})})}const or=st("startNode"),Al=td("startNode"),Ny=e=>[{id:"00000000-0000-0000-0000-000000000001",type:"startNode",data:{...Al,label:Al.label||(or==null?void 0:or.description)||e("editor.nodes.startDescription"),displayName:Al.displayName||(or==null?void 0:or.label)||e("editor.nodes.start")},position:{x:250,y:100},deletable:!1}],Sy=[],Bj={startNode:mb,leadNode:vb,answerNode:yb,returnNode:xb,completeNode:bb,delayNode:wb,placeholderNode:Uk},zj={startNode:{width:200,height:88},leadNode:{width:250,height:124},answerNode:{width:250,height:124},returnNode:{width:250,height:110},completeNode:{width:250,height:124},delayNode:{width:250,height:100},placeholderNode:{width:160,height:72}},Hj="00000000-0000-0000-0000-000000000001",Ey={x:250,y:100},ar=e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=parseFloat(e);return Number.isFinite(t)?t:void 0}},oi=e=>{var c,u,l,d;const t=ar((c=e==null?void 0:e.measured)==null?void 0:c.width),r=ar((u=e==null?void 0:e.measured)==null?void 0:u.height),n=ar(e==null?void 0:e.width),i=ar(e==null?void 0:e.height),o=ar((l=e==null?void 0:e.style)==null?void 0:l.width),a=ar((d=e==null?void 0:e.style)==null?void 0:d.height),s=zj[e==null?void 0:e.type]||{width:250,height:120};return{width:t||n||o||s.width,height:r||i||a||s.height}},kl=(e,t,r="TB")=>{const n=new xy.graphlib.Graph;n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:50,ranksep:100}),e.forEach(c=>{const{width:u,height:l}=oi(c);n.setNode(c.id,{width:u,height:l})}),t.forEach(c=>{n.setEdge(c.source,c.target)}),xy.layout(n);const i=e.map(c=>{const u=n.node(c.id),{width:l,height:d}=oi(c);return u?{...c,position:{x:u.x-l/2,y:u.y-d/2}}:c}),o=i.find(c=>c.id===Hj),a=o?{x:Ey.x-o.position.x,y:Ey.y-o.position.y}:{x:0,y:0};return{nodes:i.map(c=>({...c,position:{x:c.position.x+a.x,y:c.position.y+a.y}})),edges:t}};function Qj(){var Rn,Tn;const{t:e}=rt(),{theme:t,resolvedTheme:r,setTheme:n}=qw(),{projectId:i,dialogueId:o}=Pw.useParams(),{projects:a,loadProjects:s}=Lw(),{dialogues:c,loadDialogues:u,saveDialogueGraph:l,loadDialogueGraph:d,exportDialogue:f}=Ow(),{participants:h,loadParticipants:m}=r_(),{decorators:y,loadDecorators:v}=n_(),{categories:x,loadCategories:b}=a_(),[p,w,S]=ZI(Ny(e)),[_,N,j]=QI(Sy),A=E.useCallback(L=>{const U=L.filter(Y=>!(Y.type==="remove"&&Y.id==="00000000-0000-0000-0000-000000000001"));S(U)},[S]),[k,R]=E.useState(null),[M,F]=E.useState(null),[C,D]=E.useState(!1),[O,q]=E.useState(!1),[I,T]=E.useState("saved"),[V,G]=E.useState(null),[K,Q]=E.useState({x:0,y:0,zoom:1}),[P,$]=E.useState(null),[H,B]=E.useState(!1),z=E.useCallback(()=>{B(!0),T(L=>L==="saving"?L:"unsaved")},[]),{runTour:X,finishTour:te,resetTour:ee}=f_("dialogue-editor");Cy();const re=Dw(L=>L.openWithContext),ne=Fw(L=>L.openWithActions),[Z,se]=E.useState("desktop"),[le,ce]=E.useState(!1),[_e,Ne]=E.useState(null),[Le,Re]=E.useState(!1),[Ie,fe]=E.useState(!1),Oe=E.useRef(null),Ee=E.useRef(null),Ae=E.useRef(null);E.useEffect(()=>{const L=()=>{se(Wd())};return L(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),E.useLayoutEffect(()=>{if(!Oe.current)return;const L=()=>{const Y=Oe.current.getBoundingClientRect().height;document.documentElement.style.setProperty("--app-header-height",`${Y}px`)};L();const U=new ResizeObserver(L);return U.observe(Oe.current),window.addEventListener("resize",L),()=>{U.disconnect(),window.removeEventListener("resize",L)}},[]),E.useEffect(()=>{if(Z!=="mobile"){Ee.current!==null&&(document.body.style.overflow=Ee.current,Ee.current=null);return}return Ee.current===null&&(Ee.current=document.body.style.overflow),document.body.style.overflow="hidden",()=>{Ee.current!==null&&(document.body.style.overflow=Ee.current,Ee.current=null)}},[Z,Le]);const[ke,He]=E.useState([{nodes:Ny(e),edges:Sy}]),[De,Ve]=E.useState(0);E.useEffect(()=>{s(),u(i),m(i),v(i),b(i)},[s,u,m,v,b,i]);const[pt,Pt]=E.useState(!1),[Se,Ge]=E.useState(!1),[Fi,Ir]=E.useState(0),[$i,Rr]=E.useState(0),[_t,yn]=E.useState(!1),[ot,Tr]=E.useState(!1),[xn,Lt]=E.useState(0),[Bi,er]=E.useState(!1);E.useEffect(()=>{(async()=>{if(o){Ge(!1),Pt(!1),yn(!1),Tr(!1),Ir(0),Rr(0),Lt(0),er(!0);try{const U=await d(o),{nodes:Y,edges:W,viewport:J}=U;(Y.length>0||W.length>0)&&(w(Y),N(W),He([{nodes:Y,edges:W}]),Ve(0));const ie=Wd()!=="mobile";J&&P&&ie&&(P.setViewport(J,{duration:0}),Pt(!0))}catch(U){console.error("Failed to load dialogue graph:",U)}finally{Ge(!0)}}})()},[o,d,w,N,P]);const tr=Z==="mobile"&&(!Se||!pt&&(!_t||!ot));E.useEffect(()=>{if(Z!=="mobile"){er(!1),Lt(100),Ae.current=null;return}tr&&(er(!0),Ae.current===null&&(Ae.current=Date.now()))},[Z,tr]),E.useEffect(()=>{if(Z!=="mobile")return;let L=15;Se&&(L=55),Se&&_t&&(L=85),(pt||ot)&&(L=100),Lt(U=>L>U?L:U)},[Z,Se,_t,pt,ot]),E.useEffect(()=>{if(Z!=="mobile")return;if(!tr){Lt(100);const U=Ae.current??Date.now(),Y=Date.now()-U,W=Math.max(2e3-Y,0),J=setTimeout(()=>{er(!1),Ae.current=null},W);return()=>clearTimeout(J)}const L=setInterval(()=>{Lt(U=>Math.min(U+1,96))},70);return()=>clearInterval(L)},[Z,tr]),E.useEffect(()=>{if(k){const L=p.find(U=>U.id===k.id);L&&R(L)}},[p]),E.useEffect(()=>{H&&I==="saved"&&T("unsaved")},[H,I]);const bn=E.useCallback(()=>{if(!P)return;const L=p.find(W=>W.id==="00000000-0000-0000-0000-000000000001");if(!L)return;const{width:U,height:Y}=oi(L);P.setCenter(L.position.x+U/2,L.position.y+Y/2,{zoom:1,duration:300}),Tr(!0)},[P,p]),Ar=E.useCallback(L=>{if(!P)return;const U=L.find(Y=>Y.id==="00000000-0000-0000-0000-000000000001");U&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{try{P.fitView({nodes:[{id:U.id}],padding:.45,duration:320,minZoom:.7,maxZoom:1.15})}catch{const{width:W,height:J}=oi(U);P.setCenter(U.position.x+W/2,U.position.y+J/2,{zoom:1,duration:320})}Tr(!0)})})},[P]);E.useEffect(()=>{if(Z!=="mobile"&&Se&&P&&p.length>0&&!ot&&!pt){const L=setTimeout(()=>{bn()},120);return()=>clearTimeout(L)}},[Se,Z,P,p.length,ot,pt,bn]);const ye=E.useCallback((L,U)=>{He(Y=>{const W=Y.slice(0,De+1);return W.push({nodes:L,edges:U}),W.length>50?(W.shift(),Ve(W.length-1),W):(Ve(W.length-1),W)})},[De]),wn=E.useRef(k);E.useEffect(()=>{const L=wn.current;L&&L!==k&&(ye(p,_),z()),wn.current=k},[k,p,_,ye,z]),E.useEffect(()=>{const L=U=>{if(H)return U.preventDefault(),U.returnValue="",""};return window.addEventListener("beforeunload",L),()=>window.removeEventListener("beforeunload",L)},[H]);const rr=y_({shouldBlockFn:()=>H,enableBeforeUnload:!0,withResolver:!0});E.useEffect(()=>{if(rr.status!=="blocked")return;window.confirm(`${e("editor.validation.unsavedLeaveTitle")}
${e("editor.validation.unsavedLeaveDescription")}`)?rr.proceed():rr.reset()},[rr,e]),E.useEffect(()=>()=>{ro()},[]);const _n=a.find(L=>L.id===i),kr=c.find(L=>L.id===o),Nt=k?st(k.type):null,Nn=x.filter(L=>L.projectId===i),zi=L=>{if(!k)return null;const U=L.labelKey?e(L.labelKey):L.label||"",Y=L.required?`${U} *`:U;switch(L.type){case"text":return g.jsxs("div",{className:"grid gap-2",children:[g.jsx(Ze,{htmlFor:L.id,children:Y}),g.jsx(Ur,{id:L.id,value:k.data[L.id]||"",onChange:W=>Ct(k.id,{[L.id]:W.target.value}),placeholder:L.placeholderKey?e(L.placeholderKey):void 0,maxLength:L.maxLength})]},L.id);case"select":if(L.options==="participants"){const W=new Map,J=oe=>{const ue=Nn.find(je=>je.name===oe);if(!ue)return oe;const me=[];let ve=ue;for(;ve;)me.unshift(ve.name),ve=Nn.find(je=>je.id===ve.parentCategoryId);return me.join(" > ")};h.forEach(oe=>{const ue=oe.category||e("categories.title"),me=J(ue),ve=me.split(" > ")[0]||ue;W.has(ve)||W.set(ve,[]),W.get(ve).push({id:oe.id,name:oe.name,label:`${me}  ${oe.name}`})});const ie=Array.from(W.entries()).map(([oe,ue])=>({label:oe,options:ue.sort((me,ve)=>me.label.localeCompare(ve.label))})).sort((oe,ue)=>oe.label.localeCompare(ue.label));return g.jsxs("div",{className:"space-y-2",children:[g.jsx(Ze,{htmlFor:L.id,children:Y}),g.jsxs(Yd,{id:L.id,value:k.data[L.id]||"",onChange:oe=>Ct(k.id,{[L.id]:oe.target.value}),children:[g.jsx("option",{value:"",disabled:!0,children:L.placeholderKey?e(L.placeholderKey):void 0}),ie.map(oe=>g.jsx("optgroup",{label:oe.label,children:oe.options.map(ue=>g.jsx("option",{value:ue.name,children:ue.label},ue.id))},oe.label))]})]},L.id)}if(L.options==="nodes"){const W=new Map;p.filter(ie=>ie.id!==k.id).forEach(ie=>{var ue;const oe=((ue=st(ie.type))==null?void 0:ue.label)||ie.type||"Node";W.has(oe)||W.set(oe,[]),W.get(oe).push({id:ie.id,label:ie.data.displayName||ie.data.label||ie.id})});const J=Array.from(W.entries()).map(([ie,oe])=>({label:ie,options:oe.sort((ue,me)=>ue.label.localeCompare(me.label))})).sort((ie,oe)=>ie.label.localeCompare(oe.label));return g.jsxs("div",{className:"space-y-2",children:[g.jsx(Ze,{htmlFor:L.id,children:Y}),g.jsxs(Yd,{id:L.id,value:k.data[L.id]||"",onChange:ie=>Ct(k.id,{[L.id]:ie.target.value}),children:[g.jsx("option",{value:"",disabled:!0,children:L.placeholderKey?e(L.placeholderKey):void 0}),J.map(ie=>g.jsx("optgroup",{label:ie.label,children:ie.options.map(oe=>g.jsx("option",{value:oe.id,children:oe.label},oe.id))},ie.label))]})]},L.id)}return null;case"dialogueRows":return g.jsx("div",{className:"space-y-2",children:g.jsx(Zk,{dialogueRows:k.data.dialogueRows||[],onChange:W=>Ct(k.id,{dialogueRows:W}),participants:h})},L.id);case"decorators":return g.jsx(Tj,{decorators:k.data.decorators||[],availableDecorators:y,onAddDecorator:W=>Ui(k.id,W),onRemoveDecorator:W=>Cn(k.id,W),onUpdateDecorator:(W,J)=>{const ie=[...k.data.decorators];ie[W]={...ie[W],values:J},Ct(k.id,{decorators:ie})}},L.id);case"slider":return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx(Ze,{htmlFor:L.id,children:Y}),g.jsxs("span",{className:"text-xs text-muted-foreground",children:[k.data[L.id]??L.min,L.unit?` ${L.unit}`:""]})]}),g.jsx(Ur,{id:L.id,type:"range",min:L.min,max:L.max,step:L.step,value:k.data[L.id]??L.min,onChange:W=>Ct(k.id,{[L.id]:parseFloat(W.target.value)})})]},L.id);case"nodeId":return g.jsxs("div",{children:[g.jsx(Ze,{className:"text-xs text-muted-foreground",children:Y}),g.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded block mt-1",children:k.id})]},L.id);default:return null}},Hi=E.useCallback(L=>{const U={...L,markerEnd:{type:mr.ArrowClosed}};N(Y=>{const W=zl(U,Y);return ye(p,W),z(),W})},[N,p,ye,z]),Vi=E.useCallback((L,U)=>{U.type!=="placeholderNode"&&(R(U),F(null))},[]),Gi=E.useCallback((L,U)=>{F(U),R(null)},[]),Sn=E.useCallback(()=>{R(null),F(null)},[]),jr=E.useCallback(()=>{k&&k.id!=="00000000-0000-0000-0000-000000000001"&&(w(L=>{const U=L.filter(W=>{var J;return W.type==="placeholderNode"&&((J=W.data)==null?void 0:J.parentNodeId)===k.id}).map(W=>W.id),Y=L.filter(W=>W.id!==k.id&&!U.includes(W.id));return N(W=>{const J=W.filter(ie=>ie.source!==k.id&&ie.target!==k.id&&!U.includes(ie.source)&&!U.includes(ie.target));return ye(Y,J),z(),J}),Y}),R(null))},[k,w,N,ye,z]),En=E.useCallback(()=>{if(!k||k.id==="00000000-0000-0000-0000-000000000001")return;const L=new Set([k.id]),U=[k.id];for(;U.length>0;){const Y=U.shift();_.forEach(W=>{W.source===Y&&!L.has(W.target)&&(L.add(W.target),U.push(W.target))})}w(Y=>{Y.filter(ie=>{var oe;return ie.type==="placeholderNode"&&L.has((oe=ie.data)==null?void 0:oe.parentNodeId)}).map(ie=>ie.id).forEach(ie=>L.add(ie));const J=Y.filter(ie=>!L.has(ie.id));return N(ie=>{const oe=ie.filter(ue=>!L.has(ue.source)&&!L.has(ue.target));return ye(J,oe),z(),oe}),J}),R(null)},[k,_,w,N,ye,z]),at=E.useCallback(()=>{const L=new Map;return p.forEach(U=>{if(U.type==="placeholderNode")return;const Y=st(U.type);if(!(Y!=null&&Y.sections))return;const W=[];Y.sections.forEach(J=>{var ie;(ie=J.fields)==null||ie.forEach(oe=>{var ve;if(!oe.required)return;const ue=(ve=U.data)==null?void 0:ve[oe.id];(ue==null||typeof ue=="string"&&ue.trim()==="")&&W.push(oe.id)})}),W.length>0&&L.set(U.id,{node:U,missingFields:W})}),L},[p]),St=E.useCallback(()=>{var U,Y,W;const L=at();if(L.size===0){console.info("[validation] No missing required fields.");return}console.warn("[validation] Missing required fields:");for(const[J,ie]of L.entries()){const oe=ie.node,ue=((U=oe.data)==null?void 0:U.displayName)||((Y=oe.data)==null?void 0:Y.label)||((W=st(oe.type))==null?void 0:W.label)||oe.type;console.warn(`- ${ue} (${J})`,ie.missingFields)}},[at]),Et=E.useCallback(L=>{var U,Y,W;if(L.size!==0)for(const[J,ie]of L.entries()){const oe=ie.node,ue=((U=oe.data)==null?void 0:U.displayName)||((Y=oe.data)==null?void 0:Y.label)||((W=st(oe.type))==null?void 0:W.label)||oe.type,me=$w({variant:"warning",title:e("editor.validation.nodeMissingTitle"),description:e("editor.validation.nodeMissingDescription",{name:ue}),duration:8e3,action:{label:e("editor.validation.focusNode"),onClick:()=>{R(oe),F(null),Z==="mobile"&&Re(!0)}}});console.log("[validation] toast",me,J)}},[e,Z]),Ot=E.useCallback(async()=>{D(!0),q(!1),T("saving");try{ro();const L=p.filter(J=>J.type!=="placeholderNode"),U=_.filter(J=>{var ie;return!((ie=J.data)!=null&&ie.isPlaceholder)}),Y=at();St(),Et(Y),await l(o,L,U,K),G(new Date),q(!0),T("saved"),B(!1),i_(),setTimeout(()=>q(!1),2e3)}catch(L){console.error("Failed to save dialogue:",L),T("error"),setTimeout(()=>T("unsaved"),3e3)}finally{D(!1)}},[_,p,K,o,l,at,St,Et,ro,D,q,T,B,G,Z]),Ct=E.useCallback((L,U)=>{w(Y=>Y.map(W=>W.id===L?{...W,data:{...W.data,...U}}:W))},[w]),Ui=E.useCallback((L,U)=>{w(Y=>{const W=Y.map(J=>{if(J.id===L){const ie={id:U.id,name:U.name,values:{}};return U.properties&&U.properties.length>0&&U.properties.forEach(oe=>{ie.values[oe.name]=oe.defaultValue||""}),{...J,data:{...J.data,decorators:[...J.data.decorators||[],ie]}}}return J});return ye(W,_),z(),W})},[w,_,ye,z]),Cn=E.useCallback((L,U)=>{w(Y=>{const W=Y.map(J=>J.id===L?{...J,data:{...J.data,decorators:J.data.decorators.filter((ie,oe)=>oe!==U)}}:J);return ye(W,_),z(),W})},[w,_,ye,z]),gt=E.useCallback((L,U)=>{const Y=st(L),W=td(L),J=(Y==null?void 0:Y.label)||"Node",ie=W.label||`New ${J}`,oe=W.displayName||J,ue={id:sr(),type:L,data:{...W,label:ie,displayName:oe},position:U||{x:Math.random()*400+100,y:Math.random()*400+100}};w(ve=>{const je=[...ve,ue];return ye(je,_),je}),z();const me=at();St(),Et(me)},[w,_,ye,z,St,at,Et]),Dt=E.useCallback((L,U,Y)=>{Ne({placeholderId:L,position:U,parentNodeId:Y}),ce(!0)},[]),Ki=E.useCallback(L=>{if(!_e)return;const{placeholderId:U,position:Y,parentNodeId:W}=_e,J=sr(),ie=st(L),oe=td(L),ue=(ie==null?void 0:ie.label)||"Node",me=oe.label||`New ${ue}`,ve=oe.displayName||ue,je={id:J,type:L,position:Y,data:{...oe,label:me,displayName:ve}},Ud=W==="00000000-0000-0000-0000-000000000001",Qi=(ie==null?void 0:ie.canHaveOutputs)??!0,Ji=Qi?sr():null;w(eo=>{let Ue=[...eo];return Ud&&(Ue=Ue.filter(to=>to.id!==U)),Ue.push(je),Qi&&Ue.push({id:Ji,type:"placeholderNode",data:{label:"Add Node",onClick:Dt,parentNodeId:J},position:{x:Y.x,y:Y.y+250}}),Ue}),z();const aw=at();St(),Et(aw),N(eo=>{let Ue=[...eo];Ud&&(Ue=Ue.filter(sw=>sw.id!==`${W}-${U}`));const to={id:`${W}-${J}`,source:W,target:J,type:"default",markerEnd:{type:mr.ArrowClosed}};return Ue=zl(to,Ue),Qi&&Ue.push({id:`${J}-${Ji}`,source:J,target:Ji,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}}),Ue}),ce(!1),Ne(null)},[_e,w,N,Dt,z,St,at,Et]);E.useEffect(()=>{if(Z!=="mobile"||p.length===0)return;const L=p.filter(J=>J.type!=="placeholderNode"),U=p.filter(J=>J.type==="placeholderNode"),Y=[],W=[];L.forEach(J=>{const ie=st(J.type);if(ie&&ie.canHaveOutputs===!1)return;if(!U.some(ue=>{var me;return((me=ue.data)==null?void 0:me.parentNodeId)===J.id})){const ue=sr();J.id==="00000000-0000-0000-0000-000000000001"?_.some(ve=>{var je;return ve.source===J.id&&!((je=ve.data)!=null&&je.isPlaceholder)})||(Y.push({id:ue,type:"placeholderNode",data:{label:"Add Node",onClick:Dt,parentNodeId:J.id},position:{x:J.position.x,y:J.position.y+250}}),W.push({id:`${J.id}-${ue}`,source:J.id,target:ue,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}})):(Y.push({id:ue,type:"placeholderNode",data:{label:"Add Node",onClick:Dt,parentNodeId:J.id},position:{x:J.position.x,y:J.position.y+250}}),W.push({id:`${J.id}-${ue}`,source:J.id,target:ue,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}}))}}),Y.length>0&&(w(J=>[...J,...Y]),N(J=>[...J,...W]))},[Z,p,_,Dt,w,N]);const Wi=E.useCallback(()=>{const{nodes:L,edges:U}=kl(p,_);w(L),N(U),ye(L,U),z()},[p,_,w,N,ye,z]);E.useEffect(()=>{if(Z!=="mobile"||!Se)return;const L=p.filter(W=>W.type!=="placeholderNode").length,U=p.length-L;if(!_t&&p.length>0&&L>0){const{nodes:W,edges:J}=kl(p,_);w(W),N(J),Ir(L),Rr(U),yn(!0),ot||Ar(W);return}const Y=L!==Fi||U!==$i;if(_t&&L>0&&Y){const{nodes:W,edges:J}=kl(p,_);w(W),N(J),Ir(L),Rr(U),ot||Ar(W)}},[Z,Se,p.length,_.length,_t,ot,Ar]);const Mr=E.useCallback(()=>{if(De>0){const L=De-1,{nodes:U,edges:Y}=ke[L];w(U),N(Y),Ve(L)}},[De,ke,w,N]),qr=E.useCallback(()=>{if(De<ke.length-1){const L=De+1,{nodes:U,edges:Y}=ke[L];w(U),N(Y),Ve(L)}},[De,ke,w,N]);E.useEffect(()=>{const L=U=>{if((U.ctrlKey||U.metaKey)&&U.key.toLowerCase()==="s"){U.preventDefault(),Ot();return}const Y=U.target,W=Y.tagName==="INPUT"||Y.tagName==="TEXTAREA"||Y.isContentEditable;if(!W&&(U.ctrlKey||U.metaKey)){const J=U.key.toLowerCase();if(J==="z"&&!U.shiftKey){U.preventDefault(),Mr();return}if(J==="y"||J==="z"&&U.shiftKey){U.preventDefault(),qr();return}}(U.key==="Delete"||U.key==="Backspace")&&!W&&(U.preventDefault(),k&&k.id!=="00000000-0000-0000-0000-000000000001"?jr():M&&(N(J=>{const ie=J.filter(oe=>oe.id!==M.id);return ye(p,ie),z(),ie}),F(null)))};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[k,M,jr,N,p,ye,z,Ot,Mr,qr]);const Yi=E.useCallback((L,U)=>{Q(U)},[]),In=E.useCallback(L=>{var U;return((U=st(L.type))==null?void 0:U.minimapColor)||"#6b7280"},[]),Ft=E.useCallback((L,U)=>{L.dataTransfer.setData("application/reactflow",U),L.dataTransfer.effectAllowed="move"},[]),Xi=E.useCallback(L=>{L.preventDefault();const U=L.dataTransfer.getData("application/reactflow");if(!U||!P)return;const Y=P.screenToFlowPosition({x:L.clientX,y:L.clientY});gt(U,Y)},[P,gt]),Zi=E.useCallback(L=>{L.preventDefault(),L.dataTransfer.dropEffect="move"},[]),Pr=async()=>{try{const L=p.filter(Y=>Y.type!=="placeholderNode"),U=_.filter(Y=>{var W;return!((W=Y.data)!=null&&W.isPlaceholder)});await l(o,L,U,K),await f(o)}catch(L){console.error("Failed to export dialogue:",L)}};return E.useEffect(()=>{const L=Y=>{const W=Y==null?void 0:Y.detail;!W||W.dialogueId!==o||Ot()},U=Y=>{const W=Y==null?void 0:Y.detail;!W||W.dialogueId!==o||Pr()};return window.addEventListener("command:dialogue-save",L),window.addEventListener("command:dialogue-export",U),()=>{window.removeEventListener("command:dialogue-save",L),window.removeEventListener("command:dialogue-export",U)}},[o,Ot,Pr]),!kr||!_n?g.jsx("div",{className:"h-screen flex items-center justify-center",children:g.jsx("p",{className:"text-muted-foreground",children:e("common.loading")})}):g.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[Z!=="mobile"&&g.jsx(h_,{run:X,onFinish:te,tourType:"editor"}),g.jsx(u_,{ref:Oe,"data-tour":"editor-header",left:g.jsxs(g.Fragment,{children:[g.jsx(Uw,{to:"/projects/$projectId",params:{projectId:i},children:g.jsx(xe,{variant:"ghost",size:"icon",className:"rounded-full shrink-0",children:g.jsx(d_,{className:"h-5 w-5"})})}),g.jsxs("div",{className:"min-w-0",children:[g.jsx("h1",{className:"text-sm md:text-2xl font-bold tracking-tight truncate",children:kr.name}),g.jsx("p",{className:"text-xs md:text-sm text-muted-foreground truncate",children:_n.name})]})]}),right:g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"hidden md:flex","data-header-mobile-hidden":!0,children:g.jsx(kj,{status:I,lastSaved:V,className:"hidden md:flex"})}),g.jsx(xe,{variant:"outline",size:"icon",className:"rounded-full","data-tour":"save-button",onClick:()=>ne({placeholder:e("common.search"),actions:[{group:e("editor.menu.file"),items:[{icon:Bw,label:e(C?"common.saving":"common.save"),shortcut:"Ctrl+S",onSelect:Ot},{icon:zw,label:e("common.export"),shortcut:"Ctrl+E",onSelect:Pr}]},{group:e("editor.menu.edit"),items:[{icon:Hw,label:e("editor.menu.undo"),shortcut:"Ctrl+Z",onSelect:Mr},{icon:Vw,label:e("editor.menu.redo"),shortcut:"Ctrl+Y",onSelect:qr}]},{group:e("editor.menu.view"),items:[{key:"language-selector",render:()=>g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:e("settings.language")}),g.jsx(l_,{})]})},{icon:r==="dark"?g_:m_,label:e(r==="dark"?"settings.lightMode":"settings.darkMode"),shortcut:"",onSelect:()=>n(r==="dark"?"light":"dark")},...Z!=="mobile"?[{icon:p_,label:e("editor.menu.showTour"),shortcut:"",onSelect:ee}]:[]]},{group:e("settings.title"),items:[{icon:Gw,label:e("settings.title"),shortcut:"",onSelect:()=>re({context:{type:"dialogue",name:kr.name,projectId:i,dialogueId:o},mode:"detail"})},{icon:__,label:e("editor.menu.support"),shortcut:"",onSelect:()=>window.open("https://github.com/sponsors/Mountea-Framework","_blank")}]}]}),children:g.jsx(o_,{className:"h-4 w-4"})})]})}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsx("div",{className:"flex-1 relative",onDrop:Z!=="mobile"?Xi:void 0,onDragOver:Z!=="mobile"?Zi:void 0,"data-tour":"canvas",children:g.jsxs(XI,{nodes:p,edges:_.map(L=>({...L,animated:(M==null?void 0:M.id)===L.id,style:{...L.style,stroke:(M==null?void 0:M.id)===L.id?"#3b82f6":void 0,strokeWidth:(M==null?void 0:M.id)===L.id?3:2}})),onNodesChange:A,onEdgesChange:j,onConnect:Hi,onNodeClick:Vi,onEdgeClick:Gi,onPaneClick:Sn,onMove:Yi,onInit:$,nodeTypes:Bj,className:"bg-grid",proOptions:{hideAttribution:!0},nodesDraggable:Z!=="mobile",panOnDrag:!0,panOnScroll:!1,zoomOnScroll:!1,zoomOnPinch:!1,zoomOnDoubleClick:!1,nodesConnectable:Z!=="mobile",elementsSelectable:!0,minZoom:.5,maxZoom:2,children:[g.jsx(nR,{}),g.jsx(dn,{position:"bottom-left",className:"mb-2",children:g.jsx("div",{className:"bg-card border border-border rounded-full shadow-lg px-2 py-3 absolute bottom-6",children:g.jsx(zk,{className:"!p-0 !bg-transparent !border-0 !shadow-none"})})}),Z!=="mobile"&&g.jsx(_R,{nodeColor:In,className:"!bg-card !border !border-border !rounded-lg !shadow-lg",maskColor:"rgb(0, 0, 0, 0.1)","data-tour":"minimap"})]})}),Z==="mobile"&&k&&g.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-20 flex items-center gap-2 bg-card border rounded-full shadow-lg px-4 py-2",children:[g.jsx("span",{className:"text-sm font-medium truncate max-w-32",children:k.data.displayName||((Rn=k.type)==null?void 0:Rn.replace("Node",""))}),g.jsx("div",{className:"h-4 w-px bg-border"}),g.jsx("div",{className:"flex items-center gap-1",children:g.jsxs(gb,{children:[g.jsx(xe,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full",onClick:()=>Re(!0),children:g.jsx(E_,{className:"h-4 w-4"})}),k.id!=="00000000-0000-0000-0000-000000000001"&&g.jsx(xe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10 rounded-full",onClick:()=>fe(!0),children:g.jsx(Un,{className:"h-4 w-4"})}),g.jsx(xe,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full",onClick:()=>R(null),children:g.jsx(jl,{className:"h-4 w-4"})})]})})]}),Z==="mobile"&&g.jsx(Kw,{open:Ie,onOpenChange:fe,children:g.jsxs(Ww,{variant:"destructive",size:"sm",children:[g.jsxs(Yw,{children:[g.jsx(Xw,{className:"bg-destructive/10 text-destructive dark:bg-destructive/20 dark:text-destructive",children:g.jsx(Un,{className:"h-6 w-6"})}),g.jsx(Zw,{children:e("editor.deleteCascadeTitle")}),g.jsx(Qw,{children:e("editor.deleteCascadeDescription")})]}),g.jsxs(Jw,{children:[g.jsx(e_,{variant:"outline",children:e("common.cancel")}),g.jsx(t_,{variant:"destructive",onClick:()=>{fe(!1),En()},children:e("editor.deleteCascadeConfirm")})]})]})}),Z==="mobile"&&Le&&g.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:()=>Re(!1)}),k&&(Z!=="mobile"||Le)&&g.jsx("div",{className:`${Z==="mobile"?"fixed right-0 z-40 w-80 overscroll-contain touch-pan-y":"w-96"} border-l bg-card overflow-y-auto`,style:Z==="mobile"?{top:"var(--app-header-height)",bottom:0}:void 0,children:g.jsxs("div",{className:"p-6 space-y-6",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h3",{className:"text-lg font-bold",children:((Nt==null?void 0:Nt.label)||"Node")+" "+e("editor.nodeDetails")}),g.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>{Z==="mobile"?Re(!1):R(null)},className:"h-8 w-8",children:g.jsx(jl,{className:"h-4 w-4"})})]}),(Tn=Nt==null?void 0:Nt.sections)==null?void 0:Tn.map(L=>g.jsx(Aj,{title:e(L.titleKey),defaultOpen:L.defaultOpen??!0,children:g.jsx("div",{className:"space-y-4",children:L.fields.map(U=>zi(U))})},L.id))]})})]}),Z!=="mobile"&&g.jsxs("div",{className:"border-t bg-card px-6 py-3 flex items-center justify-between","data-tour":"node-toolbar",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(nr,{content:e("editor.nodeToolbar.autoLayoutTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2",onClick:Wi,children:[g.jsx(S_,{className:"h-4 w-4"}),e("editor.nodeToolbar.autoLayout")]})}),g.jsx("div",{className:"h-6 w-px bg-border mx-1"}),g.jsx(nr,{content:e("editor.nodeToolbar.addNpcTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:L=>Ft(L,"leadNode"),onClick:()=>gt("leadNode"),children:[g.jsx(rd,{className:"h-4 w-4"}),e("editor.nodeToolbar.npc")]})}),g.jsx(nr,{content:e("editor.nodeToolbar.addPlayerTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:L=>Ft(L,"answerNode"),onClick:()=>gt("answerNode"),children:[g.jsx(fr,{className:"h-4 w-4"}),e("editor.nodeToolbar.player")]})}),g.jsx(nr,{content:e("editor.nodeToolbar.addReturnTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:L=>Ft(L,"returnNode"),onClick:()=>gt("returnNode"),children:[g.jsx(ud,{className:"h-4 w-4"}),e("editor.nodeToolbar.return")]})}),g.jsx(nr,{content:e("editor.nodeToolbar.addCompleteTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:L=>Ft(L,"completeNode"),onClick:()=>gt("completeNode"),children:[g.jsx(nd,{className:"h-4 w-4"}),e("editor.nodeToolbar.complete")]})}),g.jsx(nr,{content:e("editor.nodeToolbar.addDelayTooltip"),side:"top",children:g.jsxs(xe,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:L=>Ft(L,"delayNode"),onClick:()=>gt("delayNode"),children:[g.jsx(sd,{className:"h-4 w-4"}),e("editor.nodeToolbar.delay")]})})]}),g.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[g.jsxs("span",{children:[p.length," ",e("dialogues.nodes"),"  ",_.length," ",e("dialogues.edges")]}),g.jsxs("span",{className:"text-xs hidden md:block",children:[e("editor.nodeToolbar.poweredBy")," ",g.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition-colors",children:"React Flow"})]})]})]}),g.jsx($j,{open:le,onOpenChange:ce,onSelectType:Ki}),Bi&&Z==="mobile"&&typeof document<"u"&&od.createPortal(g.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-2xl backdrop-saturate-150",children:g.jsxs("div",{className:"w-[82%] max-w-xs rounded-xl border border-border/70 bg-card/95 p-4 shadow-2xl",children:[g.jsxs("div",{className:"mb-2 flex items-center justify-between text-sm",children:[g.jsx("span",{className:"font-medium",children:e("common.loading")}),g.jsxs("span",{className:"text-muted-foreground",children:[xn,"%"]})]}),g.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:g.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${xn}%`}})}),g.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Preparing dialogue graph..."})]})}),document.body)]})}export{Qj as component};
