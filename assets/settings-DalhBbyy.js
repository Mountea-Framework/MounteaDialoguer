import{u as B,V as G,aD as J,a as O,b as V,k as K,r as l,j as e,B as n,s as Q,o as m,aE as x,aF as h,aG as Z,aH as u,p as j,L as C,I as q,T as U,ax as W,aI as v,t as b,y as X,aJ as Y,z as A,G as _,H as ee,J as se,K as ae,N as te,O as ie,P as ne,Q as le,R as re}from"./index-C8QteWGv.js";import{A as de,L as oe}from"./app-header-Dpx8Rubn.js";import{S as ce,M as me,A as xe}from"./sun-lQlfeQN1.js";function pe(){const{t:s}=B(),{theme:he,resolvedTheme:N,setTheme:S}=G(),{projectId:r,dialogueId:d}=J.useParams(),k=O(),{projects:I,loadProjects:D}=V(),{dialogues:E,loadDialogues:w,updateDialogue:F,deleteDialogue:T,exportDialogue:L}=K(),[o,g]=l.useState(!1),[p,y]=l.useState(!1),[P,f]=l.useState(!1),[i,c]=l.useState({name:"",description:""});l.useEffect(()=>{D(),w(r)},[D,w,r]);const H=I.find(t=>t.id===r),a=E.find(t=>t.id===d);l.useEffect(()=>{a&&c({name:a.name||"",description:a.description||""})},[a]);const M=async()=>{if(i.name.trim()){y(!0);try{await F(d,{name:i.name,description:i.description}),g(!1)}catch(t){console.error("Failed to update dialogue:",t)}finally{y(!1)}}},z=()=>{c({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||""}),g(!1)},R=async()=>{try{await L(d)}catch(t){console.error("Failed to export dialogue:",t)}},$=async()=>{try{await T(d),f(!1),k({to:"/projects/$projectId",params:{projectId:r}})}catch(t){console.error("Failed to delete dialogue:",t)}};return!a||!H?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):e.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[e.jsx(de,{left:e.jsxs(e.Fragment,{children:[e.jsx(Q,{to:"/projects/$projectId/dialogue/$dialogueId",params:{projectId:r,dialogueId:d},children:e.jsx(n,{variant:"ghost",size:"icon",className:"rounded-full",children:e.jsx(xe,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.name})]})})]}),menuItems:e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>S(N==="dark"?"light":"dark"),className:"justify-start",children:N==="dark"?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),s("settings.lightMode")]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),s("settings.darkMode")]})})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-8 md:p-12 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure dialogue properties and behavior"})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),s("settings.projectInfo")]}),e.jsx(u,{className:"mt-1.5",children:"Edit dialogue name and description"})]}),!o&&e.jsx(n,{onClick:()=>g(!0),variant:"outline",children:s("common.edit")})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"name",children:s("dialogues.dialogueName")}),e.jsx(q,{id:"name",value:i.name,onChange:t=>c({...i,name:t.target.value}),disabled:!o,placeholder:s("dialogues.dialogueName")})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(U,{id:"description",value:i.description,onChange:t=>c({...i,description:t.target.value}),disabled:!o,placeholder:"Enter dialogue description",rows:3})]})]}),o&&e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(n,{variant:"outline",onClick:z,disabled:p,children:s("common.cancel")}),e.jsxs(n,{onClick:M,disabled:p||!i.name.trim(),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),s(p?"common.saving":"common.save")]})]})]})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:s("settings.metadata")}),e.jsx(u,{children:"View dialogue metadata and timestamps"})]}),e.jsx(j,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Dialogue ID"}),e.jsx("code",{className:"text-sm font-mono bg-muted px-2 py-1 rounded",children:a.id})]}),e.jsx(v,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.created")}),e.jsx("span",{className:"text-sm font-medium",children:b(a.createdAt)})]}),e.jsx(v,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.modified")}),e.jsx("span",{className:"text-sm font-medium",children:b(a.modifiedAt)})]}),e.jsx(v,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("dialogues.nodes")}),e.jsx("span",{className:"text-sm font-medium",children:a.nodeCount||0})]})]})})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Export Dialogue"}),e.jsx(u,{children:"Download this dialogue as a standalone file"})]}),e.jsx(j,{children:e.jsxs(n,{onClick:R,variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Export Dialogue"]})})]}),e.jsxs(m,{className:"border-destructive",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Y,{className:"h-5 w-5"}),s("settings.dangerZone")]}),e.jsx(u,{children:"Permanently delete this dialogue and all its nodes"})]}),e.jsx(j,{children:e.jsxs(n,{variant:"destructive",onClick:()=>f(!0),className:"w-full justify-start gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Delete Dialogue"]})})]})]})}),e.jsx(_,{open:P,onOpenChange:f,children:e.jsxs(ee,{variant:"destructive",size:"sm",children:[e.jsxs(se,{children:[e.jsx(ae,{className:"bg-destructive/10 text-destructive dark:bg-destructive/20 dark:text-destructive",children:e.jsx(A,{className:"h-6 w-6"})}),e.jsx(te,{children:"Delete Dialogue"}),e.jsxs(ie,{children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone and will delete all nodes and connections.']})]}),e.jsxs(ne,{children:[e.jsx(le,{variant:"outline",children:s("common.cancel")}),e.jsx(re,{variant:"destructive",onClick:$,children:s("common.delete")})]})]})})]})}export{pe as component};
