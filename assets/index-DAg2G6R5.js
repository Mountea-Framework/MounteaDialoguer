import{c as M,u as $,r as m,j as e,T as B,B as h,d as u,F as I,P as C,M as P,S as V,L as G}from"./index-BO74Ulvp.js";import{u as p,a as A,L,I as E,b as H}from"./label-BTuZ-_Jd.js";import{D as _,a as q,b as Q,c as R,d as J,e as K,S as F,f as z,g as T,h as U,i as W}from"./select-Bn5XQdI4.js";import{C as k,a as w,f as X,b as Y}from"./card-BvxO7sga.js";import{u as Z,O as ee,C as se}from"./onboarding-tour-CWPNGAFW.js";import{E as te,C as ae}from"./empty-state-DWLdzmyI.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=M("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=M("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);function oe({open:s,onOpenChange:r}){const{t:a}=p(),c=$(),{createProject:t}=A(),[o,d]=m.useState({name:"",description:"",version:""}),[i,l]=m.useState({}),[g,v]=m.useState(!1),j=(n,x)=>{d(b=>({...b,[n]:x})),i[n]&&l(b=>({...b,[n]:null}))},S=()=>{const n={};return o.name.trim()?/\s/.test(o.name)&&(n.name="Name cannot contain whitespace"):n.name=a("validation.required"),l(n),Object.keys(n).length===0},D=async n=>{if(n.preventDefault(),!!S()){v(!0);try{const x=await t({name:o.name.trim(),description:o.description.trim(),version:o.version.trim()||"1.0.0"});d({name:"",description:"",version:""}),l({}),r(!1),c({to:"/projects/$projectId",params:{projectId:x.id}})}catch(x){console.error("Error creating project:",x),l({submit:a("common.error")})}finally{v(!1)}}},f=()=>{d({name:"",description:"",version:""}),l({}),r(!1)};return e.jsx(_,{open:s,onOpenChange:r,children:e.jsxs(q,{className:"sm:max-w-[500px]",children:[e.jsxs(Q,{children:[e.jsx(R,{children:a("projects.createNew")}),e.jsx(J,{children:a("projects.createFirst")})]}),e.jsxs("form",{onSubmit:D,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"name",children:[a("projects.projectName")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(E,{id:"name",placeholder:"My Awesome Game",value:o.name,onChange:n=>j("name",n.target.value),className:i.name?"border-destructive":"",autoFocus:!0}),i.name&&e.jsx("p",{className:"text-xs text-destructive",children:i.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"description",children:a("projects.projectDescription")}),e.jsx(B,{id:"description",placeholder:"A brief description of your project...",value:o.description,onChange:n=>j("description",n.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"version",children:"Version"}),e.jsx(E,{id:"version",placeholder:"1.0.0",value:o.version,onChange:n=>j("version",n.target.value)})]}),i.submit&&e.jsx("p",{className:"text-sm text-destructive",children:i.submit}),e.jsxs(K,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:f,disabled:g,children:a("common.cancel")}),e.jsx(h,{type:"submit",disabled:g,children:a(g?"common.loading":"common.create")})]})]})]})})}const y=[{code:"en",name:"English",flag:"ðŸ‡¬ðŸ‡§"},{code:"de",name:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{code:"fr",name:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{code:"es",name:"EspaÃ±ol",flag:"ðŸ‡ªðŸ‡¸"}];function ce({variant:s="default"}){const{i18n:r}=p(),a=t=>{r.changeLanguage(t),localStorage.setItem("i18nextLng",t)},c=y.find(t=>t.code===r.language)||y[0];return s==="icon"?e.jsxs(F,{value:r.language,onValueChange:a,children:[e.jsx(z,{className:"w-[50px] px-2",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(T,{children:y.map(t=>e.jsx(U,{value:t.code,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t.flag}),e.jsx("span",{children:t.name})]})},t.code))})]}):e.jsxs(F,{value:r.language,onValueChange:a,children:[e.jsx(z,{className:"w-[180px]",children:e.jsx(W,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:c.flag}),e.jsx("span",{children:c.name})]})})}),e.jsx(T,{children:y.map(t=>e.jsx(U,{value:t.code,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t.flag}),e.jsx("span",{children:t.name})]})},t.code))})]})}async function ie(){try{return"storage"in navigator&&"estimate"in navigator.storage?(await navigator.storage.estimate()).usage||0:await le()}catch(s){return console.error("Error calculating disk usage:",s),0}}async function le(){try{const[s,r,a,c,t,o,d]=await Promise.all([u.projects.count(),u.dialogues.count(),u.nodes.count(),u.edges.count(),u.participants.count(),u.categories.count(),u.decorators.count()]);return s*500+r*300+a*200+c*100+(t+o+d)*150}catch(s){return console.error("Error estimating data size:",s),0}}function de({onNewProject:s,onSearch:r,searchQuery:a,onShowTour:c}){const{t}=p();return e.jsx("header",{className:"sticky top-0 z-50 border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:h-16 md:items-center px-4 py-3 md:px-12 max-w-7xl mx-auto w-full gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 justify-between md:justify-start",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center",children:e.jsx(P,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight",children:t("app.title")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("app.subtitle")})]})]}),e.jsxs(h,{onClick:s,size:"sm",className:"md:hidden gap-1",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:t("common.new")})]})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2 md:justify-end",children:[e.jsxs("div",{className:"relative flex-1 md:w-64 md:flex-none","data-tour":"search",children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(E,{type:"text",placeholder:t("common.search"),value:a,onChange:o=>r(o.target.value),className:"pl-9 h-9"})]}),e.jsx(ce,{}),e.jsx(h,{variant:"ghost",size:"icon",onClick:c,className:"rounded-full shrink-0",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsxs(h,{onClick:s,className:"hidden md:flex gap-2","data-tour":"create-project",children:[e.jsx(C,{className:"h-4 w-4"}),t("projects.createNew")]})]})]})})}function me({projectCount:s,dialogueCount:r,diskUsage:a}){const{t:c}=p();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(k,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("projects.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:s})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center",children:e.jsx(I,{className:"h-6 w-6 text-primary"})})]})})}),e.jsx(k,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("dialogues.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:r})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center",children:e.jsx(P,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})})}),e.jsx(k,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("dashboard.diskUsage")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:a})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center",children:e.jsx(re,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})})]})}function xe({project:s}){const{t:r}=p(),{dialogues:a}=H(),c=a.filter(l=>l.projectId===s.id),t=["from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20","from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20","from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20","from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20"],o=["text-blue-500 dark:text-blue-400","text-purple-500 dark:text-purple-400","text-orange-500 dark:text-orange-400","text-green-500 dark:text-green-400"],d=["#3b82f6","#9333ea","#f97316","#22c55e"],i=parseInt(s.id.substring(0,8),16)%t.length;return e.jsx(G,{to:"/projects/$projectId",params:{projectId:s.id},children:e.jsxs(k,{className:"group cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all h-full flex flex-col overflow-hidden rounded-lg",children:[e.jsxs("div",{className:`h-32 bg-gradient-to-br ${t[i]} flex items-center justify-center relative overflow-hidden rounded-t-lg`,children:[e.jsx("div",{className:"absolute inset-0 opacity-30 dark:opacity-20 bg-[radial-gradient(circle,currentColor_1px,transparent_1px)] [background-size:16px_16px]",style:{color:d[i]}}),e.jsx(I,{className:`h-12 w-12 ${o[i]} opacity-80 group-hover:scale-110 group-hover:rotate-6 transition-all duration-300 relative z-10`}),e.jsxs("div",{className:"absolute top-3 right-3 text-xs text-muted-foreground flex items-center gap-1 bg-background/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[e.jsx(ae,{className:"h-3 w-3"}),Y(s.createdAt)]})]}),e.jsxs(w,{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-base group-hover:text-primary transition-colors line-clamp-1",children:s.name}),s.version&&e.jsxs("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded",children:["v",s.version]})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2 leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-auto pt-3 border-t flex items-center justify-center text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(P,{className:`h-3.5 w-3.5 group-hover:${o[i].replace("text-","text-")} transition-colors`}),e.jsxs("span",{className:"font-medium",children:[c.length," ",c.length===1?r("dialogues.title").slice(0,-1):r("dialogues.title")]})]})})]})]})})}function be(){const{t:s}=p(),{projects:r,loadProjects:a,isLoading:c}=A(),{dialogues:t}=H(),[o,d]=m.useState(""),[i,l]=m.useState(!1),[g,v]=m.useState(0),{runTour:j,finishTour:S,resetTour:D}=Z("dashboard");m.useEffect(()=>{a()},[a]),m.useEffect(()=>{(async()=>{const O=await ie();v(O)})()},[r,t]);const f=()=>{l(!0)},n=r.filter(N=>N.name.toLowerCase().includes(o.toLowerCase())),x=t.length,b=X(g);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted/20",children:[e.jsx(ee,{run:j,onFinish:S,tourType:"dashboard"}),e.jsx(oe,{open:i,onOpenChange:l}),e.jsx(de,{onNewProject:f,onSearch:d,searchQuery:o,onShowTour:D}),e.jsxs("main",{className:"flex-1 p-6 md:p-12 max-w-7xl mx-auto w-full",children:[e.jsx(me,{projectCount:r.length,dialogueCount:x,diskUsage:b}),e.jsxs("div",{className:"mt-10",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:s("projects.recentProjects")})}),c?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):n.length===0?e.jsx(te,{icon:I,title:s("projects.noProjects"),description:s("projects.createFirst"),action:e.jsxs(h,{onClick:f,children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),s("projects.createNew")]}),tips:["Projects help organize your dialogues by game or story","Each project can contain multiple dialogues","Use the search bar to quickly find projects"]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6","data-tour":"projects-grid",children:[n.map(N=>e.jsx(xe,{project:N},N.id)),e.jsxs("button",{onClick:f,className:"border-2 border-dashed rounded-2xl flex flex-col items-center justify-center min-h-[320px] hover:border-primary hover:bg-primary/5 transition-all group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(C,{className:"h-8 w-8 text-primary"})}),e.jsx("span",{className:"font-bold text-lg",children:s("projects.createNew")}),e.jsx("span",{className:"text-sm text-muted-foreground mt-2",children:s("projects.createNewDescription")})]})]})]})]})]})}export{be as component};
