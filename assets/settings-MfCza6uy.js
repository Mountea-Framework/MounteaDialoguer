import{i as H,a8 as M,r as n,j as e,L as R,B as l,I as O,T as V,g as Z,D as q,h as G}from"./index-DF_inT1z.js";import{u as J,a as K,b as Q,L as b,I as U}from"./label-DwzAeXcI.js";import{C as m,d as x,e as h,g as u,a as j,b as C}from"./card-DtXxRA6S.js";import{S as N,A as W,a as X,b as Y,c as _,d as ee,e as se,f as ae,g as te}from"./separator-RrnshEOr.js";import{A as ie,S as le,M as ne,T as re}from"./trash-2-gloldIIT.js";function ue(){const{t:s}=J(),{theme:de,resolvedTheme:v,setTheme:S}=H(),{projectId:r,dialogueId:d}=M.useParams(),{projects:A,loadProjects:D}=K(),{dialogues:k,loadDialogues:w,updateDialogue:I,deleteDialogue:T,exportDialogue:E}=Q(),[o,g]=n.useState(!1),[p,y]=n.useState(!1),[F,f]=n.useState(!1),[i,c]=n.useState({name:"",description:""});n.useEffect(()=>{D(),w(r)},[D,w,r]);const L=A.find(t=>t.id===r),a=k.find(t=>t.id===d);n.useEffect(()=>{a&&c({name:a.name||"",description:a.description||""})},[a]);const P=async()=>{if(i.name.trim()){y(!0);try{await I(d,{name:i.name,description:i.description}),g(!1)}catch(t){console.error("Failed to update dialogue:",t)}finally{y(!1)}}},z=()=>{c({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||""}),g(!1)},$=async()=>{try{await E(d)}catch(t){console.error("Failed to export dialogue:",t)}},B=async()=>{try{await T(d),f(!1),window.location.href=`#/projects/${r}`}catch(t){console.error("Failed to delete dialogue:",t)}};return!a||!L?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):e.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[e.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b px-6 md:px-12 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(R,{to:"/projects/$projectId/dialogue/$dialogueId",params:{projectId:r,dialogueId:d},children:e.jsx(l,{variant:"ghost",size:"icon",className:"rounded-full",children:e.jsx(ie,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.name})]})})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(l,{variant:"outline",size:"icon",onClick:()=>S(v==="dark"?"light":"dark"),className:"rounded-full",children:v==="dark"?e.jsx(le,{className:"h-4 w-4"}):e.jsx(ne,{className:"h-4 w-4"})})})]}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-8 md:p-12 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure dialogue properties and behavior"})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-primary"}),s("settings.projectInfo")]}),e.jsx(u,{className:"mt-1.5",children:"Edit dialogue name and description"})]}),!o&&e.jsx(l,{onClick:()=>g(!0),variant:"outline",children:s("common.edit")})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"name",children:s("dialogues.dialogueName")}),e.jsx(U,{id:"name",value:i.name,onChange:t=>c({...i,name:t.target.value}),disabled:!o,placeholder:s("dialogues.dialogueName")})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"description",children:"Description"}),e.jsx(V,{id:"description",value:i.description,onChange:t=>c({...i,description:t.target.value}),disabled:!o,placeholder:"Enter dialogue description",rows:3})]})]}),o&&e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(l,{variant:"outline",onClick:z,disabled:p,children:s("common.cancel")}),e.jsxs(l,{onClick:P,disabled:p||!i.name.trim(),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),s(p?"common.saving":"common.save")]})]})]})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:s("settings.metadata")}),e.jsx(u,{children:"View dialogue metadata and timestamps"})]}),e.jsx(j,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Dialogue ID"}),e.jsx("code",{className:"text-sm font-mono bg-muted px-2 py-1 rounded",children:a.id})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.created")}),e.jsx("span",{className:"text-sm font-medium",children:C(a.createdAt)})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.modified")}),e.jsx("span",{className:"text-sm font-medium",children:C(a.modifiedAt)})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("dialogues.nodes")}),e.jsx("span",{className:"text-sm font-medium",children:a.nodeCount||0})]})]})})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Export Dialogue"}),e.jsx(u,{children:"Download this dialogue as a standalone file"})]}),e.jsx(j,{children:e.jsxs(l,{onClick:$,variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Export Dialogue"]})})]}),e.jsxs(m,{className:"border-destructive",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(G,{className:"h-5 w-5"}),s("settings.dangerZone")]}),e.jsx(u,{children:"Permanently delete this dialogue and all its nodes"})]}),e.jsx(j,{children:e.jsxs(l,{variant:"destructive",onClick:()=>f(!0),className:"w-full justify-start gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Delete Dialogue"]})})]})]})}),e.jsx(W,{open:F,onOpenChange:f,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(_,{children:"Delete Dialogue"}),e.jsxs(ee,{children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone and will delete all nodes and connections.']})]}),e.jsxs(se,{children:[e.jsx(ae,{children:s("common.cancel")}),e.jsx(te,{onClick:B,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("common.delete")})]})]})})]})}export{ue as component};
