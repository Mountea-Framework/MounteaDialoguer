import{k as Bx,r as j,c as Re,l as Hx,m as Vx,j as m,n as rn,o as Gx,P as Er,M as wl,e as Mn,C as _l,a as nl,p as Fv,B as be,T as Ux,X as il,q as Kx,s as Yx,i as Wx,t as Xx,v as Ci,w as Zx,L as fd,g as Qx,D as Jx,b as eb}from"./index-C_2ZHYJu.js";import{c as Nl}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{T as El,h as tb,S as rb,M as nb,A as ib,a as ab,b as sb,c as ob,d as ub,e as cb,f as lb,g as db}from"./alert-dialog-C_rh_z4Y.js";import{L as Be,I as Cr,v as gr,u as $v,a as fb,b as hb}from"./label-ZJnYtPtm.js";import{C as Cl,u as pb,g as gb,h as mb,D as vb,a as yb,M as xb,b as bb,i as Si,c as vt,d as Ii,S as Ft}from"./confetti-B6JnPpu8.js";import{C as Sl,S as yn,f as xn,i as bn,g as wn,h as wr,k as wb,D as _b,a as Nb,b as Eb,c as Cb,d as Sb,l as Ib}from"./deviceDetection-B_Qf1Bpl.js";import{u as Rb,O as qb,C as kb}from"./onboarding-tour-CO6qA8lS.js";import"./categoryStore-BMC-QPTa.js";function Ab(e,t){if(e===void 0)return{shouldBlockFn:()=>!0,withResolver:!1};if("shouldBlockFn"in e)return e;if(typeof e=="function")return{shouldBlockFn:async()=>await e(),enableBeforeUnload:!0,withResolver:!1};const r=!!(e.condition??!0),n=e.blockerFn;return{shouldBlockFn:async()=>r&&n!==void 0?await n():r,enableBeforeUnload:r,withResolver:n===void 0}}function jb(e,t){const{shouldBlockFn:r,enableBeforeUnload:n=!0,disabled:i=!1,withResolver:a=!1}=Ab(e),s=Bx(),{history:o}=s,[u,c]=j.useState({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0});return j.useEffect(()=>{const l=async d=>{function f(b){const g=s.parseLocation(b),w=s.getMatchedRoutes(g.pathname);return w.foundRoute===void 0?{routeId:"__notFound__",fullPath:g.pathname,pathname:g.pathname,params:w.routeParams,search:s.options.parseSearch(b.search)}:{routeId:w.foundRoute.id,fullPath:w.foundRoute.fullPath,pathname:g.pathname,params:w.routeParams,search:s.options.parseSearch(b.search)}}const h=f(d.currentLocation),v=f(d.nextLocation);if(h.routeId==="__notFound__"&&v.routeId!=="__notFound__")return!1;const x=await r({action:d.action,current:h,next:v});if(!a)return x;if(!x)return!1;const p=await new Promise(b=>{c({status:"blocked",current:h,next:v,action:d.action,proceed:()=>b(!1),reset:()=>b(!0)})});return c({status:"idle",current:void 0,next:void 0,action:void 0,proceed:void 0,reset:void 0}),p};return i?void 0:o.block({blockerFn:l,enableBeforeUnload:n})},[r,n,i,a,o,s]),u}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=Re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=Re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Re("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=Re("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=Re("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=Re("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=Re("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=Re("PanelRightOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Re("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=Re("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=Re("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=Re("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=Re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=Re("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);function we(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=we(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Bb={value:()=>{}};function Pn(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new hn(r)}function hn(e){this._=e}function Hb(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}hn.prototype=Pn.prototype={constructor:hn,on:function(e,t){var r=this._,n=Hb(e+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(e=n[a]).type)&&(i=Vb(r[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<s;)if(i=(e=n[a]).type)r[i]=hd(r[i],e.name,t);else if(t==null)for(i in r)r[i]=hd(r[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new hn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],n=0,i=a.length;n<i;++n)a[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,a=n.length;i<a;++i)n[i].value.apply(t,r)}};function Vb(e,t){for(var r=0,n=e.length,i;r<n;++r)if((i=e[r]).name===t)return i.value}function hd(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=Bb,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var al="http://www.w3.org/1999/xhtml";const pd={svg:"http://www.w3.org/2000/svg",xhtml:al,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Dn(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),pd.hasOwnProperty(t)?{space:pd[t],local:e}:e}function Gb(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===al&&t.documentElement.namespaceURI===al?t.createElement(e):t.createElementNS(r,e)}}function Ub(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Bv(e){var t=Dn(e);return(t.local?Ub:Gb)(t)}function Kb(){}function ql(e){return e==null?Kb:function(){return this.querySelector(e)}}function Yb(e){typeof e!="function"&&(e=ql(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a=t[i],s=a.length,o=n[i]=new Array(s),u,c,l=0;l<s;++l)(u=a[l])&&(c=e.call(u,u.__data__,l,a))&&("__data__"in u&&(c.__data__=u.__data__),o[l]=c);return new ke(n,this._parents)}function Wb(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Xb(){return[]}function Hv(e){return e==null?Xb:function(){return this.querySelectorAll(e)}}function Zb(e){return function(){return Wb(e.apply(this,arguments))}}function Qb(e){typeof e=="function"?e=Zb(e):e=Hv(e);for(var t=this._groups,r=t.length,n=[],i=[],a=0;a<r;++a)for(var s=t[a],o=s.length,u,c=0;c<o;++c)(u=s[c])&&(n.push(e.call(u,u.__data__,c,s)),i.push(u));return new ke(n,i)}function Vv(e){return function(){return this.matches(e)}}function Gv(e){return function(t){return t.matches(e)}}var Jb=Array.prototype.find;function ew(e){return function(){return Jb.call(this.children,e)}}function tw(){return this.firstElementChild}function rw(e){return this.select(e==null?tw:ew(typeof e=="function"?e:Gv(e)))}var nw=Array.prototype.filter;function iw(){return Array.from(this.children)}function aw(e){return function(){return nw.call(this.children,e)}}function sw(e){return this.selectAll(e==null?iw:aw(typeof e=="function"?e:Gv(e)))}function ow(e){typeof e!="function"&&(e=Vv(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a=t[i],s=a.length,o=n[i]=[],u,c=0;c<s;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&o.push(u);return new ke(n,this._parents)}function Uv(e){return new Array(e.length)}function uw(){return new ke(this._enter||this._groups.map(Uv),this._parents)}function _n(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}_n.prototype={constructor:_n,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cw(e){return function(){return e}}function lw(e,t,r,n,i,a){for(var s=0,o,u=t.length,c=a.length;s<c;++s)(o=t[s])?(o.__data__=a[s],n[s]=o):r[s]=new _n(e,a[s]);for(;s<u;++s)(o=t[s])&&(i[s]=o)}function dw(e,t,r,n,i,a,s){var o,u,c=new Map,l=t.length,d=a.length,f=new Array(l),h;for(o=0;o<l;++o)(u=t[o])&&(f[o]=h=s.call(u,u.__data__,o,t)+"",c.has(h)?i[o]=u:c.set(h,u));for(o=0;o<d;++o)h=s.call(e,a[o],o,a)+"",(u=c.get(h))?(n[o]=u,u.__data__=a[o],c.delete(h)):r[o]=new _n(e,a[o]);for(o=0;o<l;++o)(u=t[o])&&c.get(f[o])===u&&(i[o]=u)}function fw(e){return e.__data__}function hw(e,t){if(!arguments.length)return Array.from(this,fw);var r=t?dw:lw,n=this._parents,i=this._groups;typeof e!="function"&&(e=cw(e));for(var a=i.length,s=new Array(a),o=new Array(a),u=new Array(a),c=0;c<a;++c){var l=n[c],d=i[c],f=d.length,h=pw(e.call(l,l&&l.__data__,c,n)),v=h.length,x=o[c]=new Array(v),y=s[c]=new Array(v),p=u[c]=new Array(f);r(l,d,x,y,p,h,t);for(var b=0,g=0,w,_;b<v;++b)if(w=x[b]){for(b>=g&&(g=b+1);!(_=y[g])&&++g<v;);w._next=_||null}}return s=new ke(s,n),s._enter=o,s._exit=u,s}function pw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function gw(){return new ke(this._exit||this._groups.map(Uv),this._parents)}function mw(e,t,r){var n=this.enter(),i=this,a=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function vw(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),u=0;u<s;++u)for(var c=r[u],l=n[u],d=c.length,f=o[u]=new Array(d),h,v=0;v<d;++v)(h=c[v]||l[v])&&(f[v]=h);for(;u<i;++u)o[u]=r[u];return new ke(o,this._parents)}function yw(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function xw(e){e||(e=bw);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,u=i[a]=new Array(o),c,l=0;l<o;++l)(c=s[l])&&(u[l]=c);u.sort(t)}return new ke(i,this._parents).order()}function bw(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ww(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function _w(){return Array.from(this)}function Nw(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function Ew(){let e=0;for(const t of this)++e;return e}function Cw(){return!this.node()}function Sw(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i=t[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this}function Iw(e){return function(){this.removeAttribute(e)}}function Rw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qw(e,t){return function(){this.setAttribute(e,t)}}function kw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Aw(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function jw(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Mw(e,t){var r=Dn(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?Rw:Iw:typeof t=="function"?r.local?jw:Aw:r.local?kw:qw)(r,t))}function Kv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Tw(e){return function(){this.style.removeProperty(e)}}function Pw(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Dw(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function Lw(e,t,r){return arguments.length>1?this.each((t==null?Tw:typeof t=="function"?Dw:Pw)(e,t,r??"")):Kt(this.node(),e)}function Kt(e,t){return e.style.getPropertyValue(t)||Kv(e).getComputedStyle(e,null).getPropertyValue(t)}function Ow(e){return function(){delete this[e]}}function Fw(e,t){return function(){this[e]=t}}function $w(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function zw(e,t){return arguments.length>1?this.each((t==null?Ow:typeof t=="function"?$w:Fw)(e,t)):this.node()[e]}function Yv(e){return e.trim().split(/^|\s+/)}function kl(e){return e.classList||new Wv(e)}function Wv(e){this._node=e,this._names=Yv(e.getAttribute("class")||"")}Wv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Xv(e,t){for(var r=kl(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function Zv(e,t){for(var r=kl(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function Bw(e){return function(){Xv(this,e)}}function Hw(e){return function(){Zv(this,e)}}function Vw(e,t){return function(){(t.apply(this,arguments)?Xv:Zv)(this,e)}}function Gw(e,t){var r=Yv(e+"");if(arguments.length<2){for(var n=kl(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof t=="function"?Vw:t?Bw:Hw)(r,t))}function Uw(){this.textContent=""}function Kw(e){return function(){this.textContent=e}}function Yw(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Ww(e){return arguments.length?this.each(e==null?Uw:(typeof e=="function"?Yw:Kw)(e)):this.node().textContent}function Xw(){this.innerHTML=""}function Zw(e){return function(){this.innerHTML=e}}function Qw(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Jw(e){return arguments.length?this.each(e==null?Xw:(typeof e=="function"?Qw:Zw)(e)):this.node().innerHTML}function e_(){this.nextSibling&&this.parentNode.appendChild(this)}function t_(){return this.each(e_)}function r_(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function n_(){return this.each(r_)}function i_(e){var t=typeof e=="function"?e:Bv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function a_(){return null}function s_(e,t){var r=typeof e=="function"?e:Bv(e),n=t==null?a_:typeof t=="function"?t:ql(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function o_(){var e=this.parentNode;e&&e.removeChild(this)}function u_(){return this.each(o_)}function c_(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function l_(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function d_(e){return this.select(e?l_:c_)}function f_(e){return arguments.length?this.property("__data__",e):this.node().__data__}function h_(e){return function(t){e.call(this,t,this.__data__)}}function p_(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function g_(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,i=t.length,a;r<i;++r)a=t[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++n]=a;++n?t.length=n:delete this.__on}}}function m_(e,t,r){return function(){var n=this.__on,i,a=h_(t);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=t;return}}this.addEventListener(e.type,a,r),i={type:e.type,name:e.name,value:t,listener:a,options:r},n?n.push(i):this.__on=[i]}}function v_(e,t,r){var n=p_(e+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var u=0,c=o.length,l;u<c;++u)for(i=0,l=o[u];i<a;++i)if((s=n[i]).type===l.type&&s.name===l.name)return l.value}return}for(o=t?m_:g_,i=0;i<a;++i)this.each(o(n[i],t,r));return this}function Qv(e,t,r){var n=Kv(e),i=n.CustomEvent;typeof i=="function"?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function y_(e,t){return function(){return Qv(this,e,t)}}function x_(e,t){return function(){return Qv(this,e,t.apply(this,arguments))}}function b_(e,t){return this.each((typeof t=="function"?x_:y_)(e,t))}function*w_(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var Jv=[null];function ke(e,t){this._groups=e,this._parents=t}function Pr(){return new ke([[document.documentElement]],Jv)}function __(){return this}ke.prototype=Pr.prototype={constructor:ke,select:Yb,selectAll:Qb,selectChild:rw,selectChildren:sw,filter:ow,data:hw,enter:uw,exit:gw,join:mw,merge:vw,selection:__,order:yw,sort:xw,call:ww,nodes:_w,node:Nw,size:Ew,empty:Cw,each:Sw,attr:Mw,style:Lw,property:zw,classed:Gw,text:Ww,html:Jw,raise:t_,lower:n_,append:i_,insert:s_,remove:u_,clone:d_,datum:f_,on:v_,dispatch:b_,[Symbol.iterator]:w_};function qe(e){return typeof e=="string"?new ke([[document.querySelector(e)]],[document.documentElement]):new ke([[e]],Jv)}function N_(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ze(e,t){if(e=N_(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const E_={passive:!1},Sr={capture:!0,passive:!1};function Ri(e){e.stopImmediatePropagation()}function Vt(e){e.preventDefault(),e.stopImmediatePropagation()}function ey(e){var t=e.document.documentElement,r=qe(e).on("dragstart.drag",Vt,Sr);"onselectstart"in t?r.on("selectstart.drag",Vt,Sr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ty(e,t){var r=e.document.documentElement,n=qe(e).on("dragstart.drag",null);t&&(n.on("click.drag",Vt,Sr),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const nn=e=>()=>e;function sl(e,{sourceEvent:t,subject:r,target:n,identifier:i,active:a,x:s,y:o,dx:u,dy:c,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:l}})}sl.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function C_(e){return!e.ctrlKey&&!e.button}function S_(){return this.parentNode}function I_(e,t){return t??{x:e.x,y:e.y}}function R_(){return navigator.maxTouchPoints||"ontouchstart"in this}function ry(){var e=C_,t=S_,r=I_,n=R_,i={},a=Pn("start","drag","end"),s=0,o,u,c,l,d=0;function f(w){w.on("mousedown.drag",h).filter(n).on("touchstart.drag",y).on("touchmove.drag",p,E_).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,_){if(!(l||!e.call(this,w,_))){var E=g(this,t.call(this,w,_),w,_,"mouse");E&&(qe(w.view).on("mousemove.drag",v,Sr).on("mouseup.drag",x,Sr),ey(w.view),Ri(w),c=!1,o=w.clientX,u=w.clientY,E("start",w))}}function v(w){if(Vt(w),!c){var _=w.clientX-o,E=w.clientY-u;c=_*_+E*E>d}i.mouse("drag",w)}function x(w){qe(w.view).on("mousemove.drag mouseup.drag",null),ty(w.view,c),Vt(w),i.mouse("end",w)}function y(w,_){if(e.call(this,w,_)){var E=w.changedTouches,C=t.call(this,w,_),S=E.length,q,M;for(q=0;q<S;++q)(M=g(this,C,w,_,E[q].identifier,E[q]))&&(Ri(w),M("start",w,E[q]))}}function p(w){var _=w.changedTouches,E=_.length,C,S;for(C=0;C<E;++C)(S=i[_[C].identifier])&&(Vt(w),S("drag",w,_[C]))}function b(w){var _=w.changedTouches,E=_.length,C,S;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),C=0;C<E;++C)(S=i[_[C].identifier])&&(Ri(w),S("end",w,_[C]))}function g(w,_,E,C,S,q){var M=a.copy(),R=ze(q||E,_),A,$,N;if((N=r.call(w,new sl("beforestart",{sourceEvent:E,target:f,identifier:S,active:s,x:R[0],y:R[1],dx:0,dy:0,dispatch:M}),C))!=null)return A=N.x-R[0]||0,$=N.y-R[1]||0,function I(k,L,P){var D=R,B;switch(k){case"start":i[S]=I,B=s++;break;case"end":delete i[S],--s;case"drag":R=ze(P||L,_),B=s;break}M.call(k,w,new sl(k,{sourceEvent:L,subject:N,target:f,identifier:S,active:B,x:R[0]+A,y:R[1]+$,dx:R[0]-D[0],dy:R[1]-D[1],dispatch:M}),C)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:nn(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:nn(w),f):t},f.subject=function(w){return arguments.length?(r=typeof w=="function"?w:nn(w),f):r},f.touchable=function(w){return arguments.length?(n=typeof w=="function"?w:nn(!!w),f):n},f.on=function(){var w=a.on.apply(a,arguments);return w===a?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function Al(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function ny(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Dr(){}var Ir=.7,Nn=1/Ir,Gt="\\s*([+-]?\\d+)\\s*",Rr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Je="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q_=/^#([0-9a-f]{3,8})$/,k_=new RegExp(`^rgb\\(${Gt},${Gt},${Gt}\\)$`),A_=new RegExp(`^rgb\\(${Je},${Je},${Je}\\)$`),j_=new RegExp(`^rgba\\(${Gt},${Gt},${Gt},${Rr}\\)$`),M_=new RegExp(`^rgba\\(${Je},${Je},${Je},${Rr}\\)$`),T_=new RegExp(`^hsl\\(${Rr},${Je},${Je}\\)$`),P_=new RegExp(`^hsla\\(${Rr},${Je},${Je},${Rr}\\)$`),gd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Al(Dr,qt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:md,formatHex:md,formatHex8:D_,formatHsl:L_,formatRgb:vd,toString:vd});function md(){return this.rgb().formatHex()}function D_(){return this.rgb().formatHex8()}function L_(){return iy(this).formatHsl()}function vd(){return this.rgb().formatRgb()}function qt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=q_.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?yd(t):r===3?new Se(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?an(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?an(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=k_.exec(e))?new Se(t[1],t[2],t[3],1):(t=A_.exec(e))?new Se(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=j_.exec(e))?an(t[1],t[2],t[3],t[4]):(t=M_.exec(e))?an(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=T_.exec(e))?wd(t[1],t[2]/100,t[3]/100,1):(t=P_.exec(e))?wd(t[1],t[2]/100,t[3]/100,t[4]):gd.hasOwnProperty(e)?yd(gd[e]):e==="transparent"?new Se(NaN,NaN,NaN,0):null}function yd(e){return new Se(e>>16&255,e>>8&255,e&255,1)}function an(e,t,r,n){return n<=0&&(e=t=r=NaN),new Se(e,t,r,n)}function O_(e){return e instanceof Dr||(e=qt(e)),e?(e=e.rgb(),new Se(e.r,e.g,e.b,e.opacity)):new Se}function ol(e,t,r,n){return arguments.length===1?O_(e):new Se(e,t,r,n??1)}function Se(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Al(Se,ol,ny(Dr,{brighter(e){return e=e==null?Nn:Math.pow(Nn,e),new Se(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ir:Math.pow(Ir,e),new Se(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Se(It(this.r),It(this.g),It(this.b),En(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xd,formatHex:xd,formatHex8:F_,formatRgb:bd,toString:bd}));function xd(){return`#${St(this.r)}${St(this.g)}${St(this.b)}`}function F_(){return`#${St(this.r)}${St(this.g)}${St(this.b)}${St((isNaN(this.opacity)?1:this.opacity)*255)}`}function bd(){const e=En(this.opacity);return`${e===1?"rgb(":"rgba("}${It(this.r)}, ${It(this.g)}, ${It(this.b)}${e===1?")":`, ${e})`}`}function En(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function It(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function St(e){return e=It(e),(e<16?"0":"")+e.toString(16)}function wd(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new He(e,t,r,n)}function iy(e){if(e instanceof He)return new He(e.h,e.s,e.l,e.opacity);if(e instanceof Dr||(e=qt(e)),!e)return new He;if(e instanceof He)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,u=(a+i)/2;return o?(t===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-t)/o+2:s=(t-r)/o+4,o/=u<.5?a+i:2-a-i,s*=60):o=u>0&&u<1?0:s,new He(s,o,u,e.opacity)}function $_(e,t,r,n){return arguments.length===1?iy(e):new He(e,t,r,n??1)}function He(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Al(He,$_,ny(Dr,{brighter(e){return e=e==null?Nn:Math.pow(Nn,e),new He(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ir:Math.pow(Ir,e),new He(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Se(qi(e>=240?e-240:e+120,i,n),qi(e,i,n),qi(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new He(_d(this.h),sn(this.s),sn(this.l),En(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=En(this.opacity);return`${e===1?"hsl(":"hsla("}${_d(this.h)}, ${sn(this.s)*100}%, ${sn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function _d(e){return e=(e||0)%360,e<0?e+360:e}function sn(e){return Math.max(0,Math.min(1,e||0))}function qi(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const jl=e=>()=>e;function z_(e,t){return function(r){return e+r*t}}function B_(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function H_(e){return(e=+e)==1?ay:function(t,r){return r-t?B_(t,r,e):jl(isNaN(t)?r:t)}}function ay(e,t){var r=t-e;return r?z_(e,r):jl(isNaN(e)?t:e)}const Cn=(function e(t){var r=H_(t);function n(i,a){var s=r((i=ol(i)).r,(a=ol(a)).r),o=r(i.g,a.g),u=r(i.b,a.b),c=ay(i.opacity,a.opacity);return function(l){return i.r=s(l),i.g=o(l),i.b=u(l),i.opacity=c(l),i+""}}return n.gamma=e,n})(1);function V_(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function G_(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function U_(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=_r(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function K_(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Qe(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Y_(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=_r(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var ul=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ki=new RegExp(ul.source,"g");function W_(e){return function(){return e}}function X_(e){return function(t){return e(t)+""}}function sy(e,t){var r=ul.lastIndex=ki.lastIndex=0,n,i,a,s=-1,o=[],u=[];for(e=e+"",t=t+"";(n=ul.exec(e))&&(i=ki.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,u.push({i:s,x:Qe(n,i)})),r=ki.lastIndex;return r<t.length&&(a=t.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?u[0]?X_(u[0].x):W_(t):(t=u.length,function(c){for(var l=0,d;l<t;++l)o[(d=u[l]).i]=d.x(c);return o.join("")})}function _r(e,t){var r=typeof t,n;return t==null||r==="boolean"?jl(t):(r==="number"?Qe:r==="string"?(n=qt(t))?(t=n,Cn):sy:t instanceof qt?Cn:t instanceof Date?K_:G_(t)?V_:Array.isArray(t)?U_:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Y_:Qe)(e,t)}var Nd=180/Math.PI,cl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function oy(e,t,r,n,i,a){var s,o,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*r+t*n)&&(r-=e*u,n-=t*u),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,u/=o),e*n<t*r&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Nd,skewX:Math.atan(u)*Nd,scaleX:s,scaleY:o}}var on;function Z_(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?cl:oy(t.a,t.b,t.c,t.d,t.e,t.f)}function Q_(e){return e==null||(on||(on=document.createElementNS("http://www.w3.org/2000/svg","g")),on.setAttribute("transform",e),!(e=on.transform.baseVal.consolidate()))?cl:(e=e.matrix,oy(e.a,e.b,e.c,e.d,e.e,e.f))}function uy(e,t,r,n){function i(c){return c.length?c.pop()+" ":""}function a(c,l,d,f,h,v){if(c!==d||l!==f){var x=h.push("translate(",null,t,null,r);v.push({i:x-4,x:Qe(c,d)},{i:x-2,x:Qe(l,f)})}else(d||f)&&h.push("translate("+d+t+f+r)}function s(c,l,d,f){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),f.push({i:d.push(i(d)+"rotate(",null,n)-2,x:Qe(c,l)})):l&&d.push(i(d)+"rotate("+l+n)}function o(c,l,d,f){c!==l?f.push({i:d.push(i(d)+"skewX(",null,n)-2,x:Qe(c,l)}):l&&d.push(i(d)+"skewX("+l+n)}function u(c,l,d,f,h,v){if(c!==d||l!==f){var x=h.push(i(h)+"scale(",null,",",null,")");v.push({i:x-4,x:Qe(c,d)},{i:x-2,x:Qe(l,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(c,l){var d=[],f=[];return c=e(c),l=e(l),a(c.translateX,c.translateY,l.translateX,l.translateY,d,f),s(c.rotate,l.rotate,d,f),o(c.skewX,l.skewX,d,f),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,d,f),c=l=null,function(h){for(var v=-1,x=f.length,y;++v<x;)d[(y=f[v]).i]=y.x(h);return d.join("")}}}var J_=uy(Z_,"px, ","px)","deg)"),e1=uy(Q_,", ",")",")"),t1=1e-12;function Ed(e){return((e=Math.exp(e))+1/e)/2}function r1(e){return((e=Math.exp(e))-1/e)/2}function n1(e){return((e=Math.exp(2*e))-1)/(e+1)}const pn=(function e(t,r,n){function i(a,s){var o=a[0],u=a[1],c=a[2],l=s[0],d=s[1],f=s[2],h=l-o,v=d-u,x=h*h+v*v,y,p;if(x<t1)p=Math.log(f/c)/t,y=function(C){return[o+C*h,u+C*v,c*Math.exp(t*C*p)]};else{var b=Math.sqrt(x),g=(f*f-c*c+n*x)/(2*c*r*b),w=(f*f-c*c-n*x)/(2*f*r*b),_=Math.log(Math.sqrt(g*g+1)-g),E=Math.log(Math.sqrt(w*w+1)-w);p=(E-_)/t,y=function(C){var S=C*p,q=Ed(_),M=c/(r*b)*(q*n1(t*S+_)-r1(_));return[o+M*h,u+M*v,c*q/Ed(t*S+_)]}}return y.duration=p*1e3*t/Math.SQRT2,y}return i.rho=function(a){var s=Math.max(.001,+a),o=s*s,u=o*o;return e(s,o,u)},i})(Math.SQRT2,2,4);var Yt=0,mr=0,hr=0,cy=1e3,Sn,vr,In=0,kt=0,Ln=0,qr=typeof performance=="object"&&performance.now?performance:Date,ly=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ml(){return kt||(ly(i1),kt=qr.now()+Ln)}function i1(){kt=0}function Rn(){this._call=this._time=this._next=null}Rn.prototype=dy.prototype={constructor:Rn,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Ml():+r)+(t==null?0:+t),!this._next&&vr!==this&&(vr?vr._next=this:Sn=this,vr=this),this._call=e,this._time=r,ll()},stop:function(){this._call&&(this._call=null,this._time=1/0,ll())}};function dy(e,t,r){var n=new Rn;return n.restart(e,t,r),n}function a1(){Ml(),++Yt;for(var e=Sn,t;e;)(t=kt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Yt}function Cd(){kt=(In=qr.now())+Ln,Yt=mr=0;try{a1()}finally{Yt=0,o1(),kt=0}}function s1(){var e=qr.now(),t=e-In;t>cy&&(Ln-=t,In=e)}function o1(){for(var e,t=Sn,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Sn=r);vr=e,ll(n)}function ll(e){if(!Yt){mr&&(mr=clearTimeout(mr));var t=e-kt;t>24?(e<1/0&&(mr=setTimeout(Cd,e-qr.now()-Ln)),hr&&(hr=clearInterval(hr))):(hr||(In=qr.now(),hr=setInterval(s1,cy)),Yt=1,ly(Cd))}}function Sd(e,t,r){var n=new Rn;return t=t==null?0:+t,n.restart(i=>{n.stop(),e(i+t)},t,r),n}var u1=Pn("start","end","cancel","interrupt"),c1=[],fy=0,Id=1,dl=2,gn=3,Rd=4,fl=5,mn=6;function On(e,t,r,n,i,a){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;l1(e,r,{name:t,index:n,group:i,on:u1,tween:c1,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:fy})}function Tl(e,t){var r=Ke(e,t);if(r.state>fy)throw new Error("too late; already scheduled");return r}function tt(e,t){var r=Ke(e,t);if(r.state>gn)throw new Error("too late; already running");return r}function Ke(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function l1(e,t,r){var n=e.__transition,i;n[t]=r,r.timer=dy(a,0,r.time);function a(c){r.state=Id,r.timer.restart(s,r.delay,r.time),r.delay<=c&&s(c-r.delay)}function s(c){var l,d,f,h;if(r.state!==Id)return u();for(l in n)if(h=n[l],h.name===r.name){if(h.state===gn)return Sd(s);h.state===Rd?(h.state=mn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[l]):+l<t&&(h.state=mn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[l])}if(Sd(function(){r.state===gn&&(r.state=Rd,r.timer.restart(o,r.delay,r.time),o(c))}),r.state=dl,r.on.call("start",e,e.__data__,r.index,r.group),r.state===dl){for(r.state=gn,i=new Array(f=r.tween.length),l=0,d=-1;l<f;++l)(h=r.tween[l].value.call(e,e.__data__,r.index,r.group))&&(i[++d]=h);i.length=d+1}}function o(c){for(var l=c<r.duration?r.ease.call(null,c/r.duration):(r.timer.restart(u),r.state=fl,1),d=-1,f=i.length;++d<f;)i[d].call(e,l);r.state===fl&&(r.on.call("end",e,e.__data__,r.index,r.group),u())}function u(){r.state=mn,r.timer.stop(),delete n[t];for(var c in n)return;delete e.__transition}}function vn(e,t){var r=e.__transition,n,i,a=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){a=!1;continue}i=n.state>dl&&n.state<fl,n.state=mn,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}a&&delete e.__transition}}function d1(e){return this.each(function(){vn(this,e)})}function f1(e,t){var r,n;return function(){var i=tt(this,e),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function h1(e,t,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=tt(this,e),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:t,value:r},u=0,c=i.length;u<c;++u)if(i[u].name===t){i[u]=o;break}u===c&&i.push(o)}a.tween=i}}function p1(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ke(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===e)return s.value;return null}return this.each((t==null?f1:h1)(r,e,t))}function Pl(e,t,r){var n=e._id;return e.each(function(){var i=tt(this,n);(i.value||(i.value={}))[t]=r.apply(this,arguments)}),function(i){return Ke(i,n).value[t]}}function hy(e,t){var r;return(typeof t=="number"?Qe:t instanceof qt?Cn:(r=qt(t))?(t=r,Cn):sy)(e,t)}function g1(e){return function(){this.removeAttribute(e)}}function m1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function v1(e,t,r){var n,i=r+"",a;return function(){var s=this.getAttribute(e);return s===i?null:s===n?a:a=t(n=s,r)}}function y1(e,t,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===n?a:a=t(n=s,r)}}function x1(e,t,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttribute(e):(s=this.getAttribute(e),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=t(n=s,o)))}}function b1(e,t,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=t(n=s,o)))}}function w1(e,t){var r=Dn(e),n=r==="transform"?e1:hy;return this.attrTween(e,typeof t=="function"?(r.local?b1:x1)(r,n,Pl(this,"attr."+e,t)):t==null?(r.local?m1:g1)(r):(r.local?y1:v1)(r,n,t))}function _1(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function N1(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function E1(e,t){var r,n;function i(){var a=t.apply(this,arguments);return a!==n&&(r=(n=a)&&N1(e,a)),r}return i._value=t,i}function C1(e,t){var r,n;function i(){var a=t.apply(this,arguments);return a!==n&&(r=(n=a)&&_1(e,a)),r}return i._value=t,i}function S1(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=Dn(e);return this.tween(r,(n.local?E1:C1)(n,t))}function I1(e,t){return function(){Tl(this,e).delay=+t.apply(this,arguments)}}function R1(e,t){return t=+t,function(){Tl(this,e).delay=t}}function q1(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?I1:R1)(t,e)):Ke(this.node(),t).delay}function k1(e,t){return function(){tt(this,e).duration=+t.apply(this,arguments)}}function A1(e,t){return t=+t,function(){tt(this,e).duration=t}}function j1(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?k1:A1)(t,e)):Ke(this.node(),t).duration}function M1(e,t){if(typeof t!="function")throw new Error;return function(){tt(this,e).ease=t}}function T1(e){var t=this._id;return arguments.length?this.each(M1(t,e)):Ke(this.node(),t).ease}function P1(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;tt(this,e).ease=r}}function D1(e){if(typeof e!="function")throw new Error;return this.each(P1(this._id,e))}function L1(e){typeof e!="function"&&(e=Vv(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a=t[i],s=a.length,o=n[i]=[],u,c=0;c<s;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&o.push(u);return new lt(n,this._parents,this._name,this._id)}function O1(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var u=t[o],c=r[o],l=u.length,d=s[o]=new Array(l),f,h=0;h<l;++h)(f=u[h]||c[h])&&(d[h]=f);for(;o<n;++o)s[o]=t[o];return new lt(s,this._parents,this._name,this._id)}function F1(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function $1(e,t,r){var n,i,a=F1(t)?Tl:tt;return function(){var s=a(this,e),o=s.on;o!==n&&(i=(n=o).copy()).on(t,r),s.on=i}}function z1(e,t){var r=this._id;return arguments.length<2?Ke(this.node(),r).on.on(e):this.each($1(r,e,t))}function B1(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function H1(){return this.on("end.remove",B1(this._id))}function V1(e){var t=this._name,r=this._id;typeof e!="function"&&(e=ql(e));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],u=o.length,c=a[s]=new Array(u),l,d,f=0;f<u;++f)(l=o[f])&&(d=e.call(l,l.__data__,f,o))&&("__data__"in l&&(d.__data__=l.__data__),c[f]=d,On(c[f],t,r,f,c,Ke(l,r)));return new lt(a,this._parents,t,r)}function G1(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Hv(e));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var u=n[o],c=u.length,l,d=0;d<c;++d)if(l=u[d]){for(var f=e.call(l,l.__data__,d,u),h,v=Ke(l,r),x=0,y=f.length;x<y;++x)(h=f[x])&&On(h,t,r,x,f,v);a.push(f),s.push(l)}return new lt(a,s,t,r)}var U1=Pr.prototype.constructor;function K1(){return new U1(this._groups,this._parents)}function Y1(e,t){var r,n,i;return function(){var a=Kt(this,e),s=(this.style.removeProperty(e),Kt(this,e));return a===s?null:a===r&&s===n?i:i=t(r=a,n=s)}}function py(e){return function(){this.style.removeProperty(e)}}function W1(e,t,r){var n,i=r+"",a;return function(){var s=Kt(this,e);return s===i?null:s===n?a:a=t(n=s,r)}}function X1(e,t,r){var n,i,a;return function(){var s=Kt(this,e),o=r(this),u=o+"";return o==null&&(u=o=(this.style.removeProperty(e),Kt(this,e))),s===u?null:s===n&&u===i?a:(i=u,a=t(n=s,o))}}function Z1(e,t){var r,n,i,a="style."+t,s="end."+a,o;return function(){var u=tt(this,e),c=u.on,l=u.value[a]==null?o||(o=py(t)):void 0;(c!==r||i!==l)&&(n=(r=c).copy()).on(s,i=l),u.on=n}}function Q1(e,t,r){var n=(e+="")=="transform"?J_:hy;return t==null?this.styleTween(e,Y1(e,n)).on("end.style."+e,py(e)):typeof t=="function"?this.styleTween(e,X1(e,n,Pl(this,"style."+e,t))).each(Z1(this._id,e)):this.styleTween(e,W1(e,n,t),r).on("end.style."+e,null)}function J1(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function eN(e,t,r){var n,i;function a(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&J1(e,s,r)),n}return a._value=t,a}function tN(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,eN(e,t,r??""))}function rN(e){return function(){this.textContent=e}}function nN(e){return function(){var t=e(this);this.textContent=t??""}}function iN(e){return this.tween("text",typeof e=="function"?nN(Pl(this,"text",e)):rN(e==null?"":e+""))}function aN(e){return function(t){this.textContent=e.call(this,t)}}function sN(e){var t,r;function n(){var i=e.apply(this,arguments);return i!==r&&(t=(r=i)&&aN(i)),t}return n._value=e,n}function oN(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,sN(e))}function uN(){for(var e=this._name,t=this._id,r=gy(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,c=0;c<o;++c)if(u=s[c]){var l=Ke(u,t);On(u,e,r,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new lt(n,this._parents,e,r)}function cN(){var e,t,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},u={value:function(){--i===0&&a()}};r.each(function(){var c=tt(this,n),l=c.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(u)),c.on=t}),i===0&&a()})}var lN=0;function lt(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function gy(){return++lN}var ot=Pr.prototype;lt.prototype={constructor:lt,select:V1,selectAll:G1,selectChild:ot.selectChild,selectChildren:ot.selectChildren,filter:L1,merge:O1,selection:K1,transition:uN,call:ot.call,nodes:ot.nodes,node:ot.node,size:ot.size,empty:ot.empty,each:ot.each,on:z1,attr:w1,attrTween:S1,style:Q1,styleTween:tN,text:iN,textTween:oN,remove:H1,tween:p1,delay:q1,duration:j1,ease:T1,easeVarying:D1,end:cN,[Symbol.iterator]:ot[Symbol.iterator]};function dN(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var fN={time:null,delay:0,duration:250,ease:dN};function hN(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function pN(e){var t,r;e instanceof lt?(t=e._id,e=e._name):(t=gy(),(r=fN).time=Ml(),e=e==null?null:e+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,c=0;c<o;++c)(u=s[c])&&On(u,e,t,c,s,r||hN(u,t));return new lt(n,this._parents,e,t)}Pr.prototype.interrupt=d1;Pr.prototype.transition=pN;const un=e=>()=>e;function gN(e,{sourceEvent:t,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function ct(e,t,r){this.k=e,this.x=t,this.y=r}ct.prototype={constructor:ct,scale:function(e){return e===1?this:new ct(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ct(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fn=new ct(1,0,0);my.prototype=ct.prototype;function my(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Fn;return e.__zoom}function Ai(e){e.stopImmediatePropagation()}function pr(e){e.preventDefault(),e.stopImmediatePropagation()}function mN(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function vN(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function qd(){return this.__zoom||Fn}function yN(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function xN(){return navigator.maxTouchPoints||"ontouchstart"in this}function bN(e,t,r){var n=e.invertX(t[0][0])-r[0][0],i=e.invertX(t[1][0])-r[1][0],a=e.invertY(t[0][1])-r[0][1],s=e.invertY(t[1][1])-r[1][1];return e.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function vy(){var e=mN,t=vN,r=bN,n=yN,i=xN,a=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],o=250,u=pn,c=Pn("start","zoom","end"),l,d,f,h=500,v=150,x=0,y=10;function p(N){N.property("__zoom",qd).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",M).filter(i).on("touchstart.zoom",R).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(N,I,k,L){var P=N.selection?N.selection():N;P.property("__zoom",qd),N!==P?_(N,I,k,L):P.interrupt().each(function(){E(this,arguments).event(L).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},p.scaleBy=function(N,I,k,L){p.scaleTo(N,function(){var P=this.__zoom.k,D=typeof I=="function"?I.apply(this,arguments):I;return P*D},k,L)},p.scaleTo=function(N,I,k,L){p.transform(N,function(){var P=t.apply(this,arguments),D=this.__zoom,B=k==null?w(P):typeof k=="function"?k.apply(this,arguments):k,K=D.invert(B),H=typeof I=="function"?I.apply(this,arguments):I;return r(g(b(D,H),B,K),P,s)},k,L)},p.translateBy=function(N,I,k,L){p.transform(N,function(){return r(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof k=="function"?k.apply(this,arguments):k),t.apply(this,arguments),s)},null,L)},p.translateTo=function(N,I,k,L,P){p.transform(N,function(){var D=t.apply(this,arguments),B=this.__zoom,K=L==null?w(D):typeof L=="function"?L.apply(this,arguments):L;return r(Fn.translate(K[0],K[1]).scale(B.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof k=="function"?-k.apply(this,arguments):-k),D,s)},L,P)};function b(N,I){return I=Math.max(a[0],Math.min(a[1],I)),I===N.k?N:new ct(I,N.x,N.y)}function g(N,I,k){var L=I[0]-k[0]*N.k,P=I[1]-k[1]*N.k;return L===N.x&&P===N.y?N:new ct(N.k,L,P)}function w(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function _(N,I,k,L){N.on("start.zoom",function(){E(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(L).end()}).tween("zoom",function(){var P=this,D=arguments,B=E(P,D).event(L),K=t.apply(P,D),H=k==null?w(K):typeof k=="function"?k.apply(P,D):k,Q=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),T=P.__zoom,F=typeof I=="function"?I.apply(P,D):I,z=u(T.invert(H).concat(Q/T.k),F.invert(H).concat(Q/F.k));return function(V){if(V===1)V=F;else{var G=z(V),W=Q/G[2];V=new ct(W,H[0]-G[0]*W,H[1]-G[1]*W)}B.zoom(null,V)}})}function E(N,I,k){return!k&&N.__zooming||new C(N,I)}function C(N,I){this.that=N,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,I),this.taps=0}C.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,I){return this.mouse&&N!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var I=qe(this.that).datum();c.call(N,this.that,new gN(N,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:c}),I)}};function S(N,...I){if(!e.apply(this,arguments))return;var k=E(this,I).event(N),L=this.__zoom,P=Math.max(a[0],Math.min(a[1],L.k*Math.pow(2,n.apply(this,arguments)))),D=ze(N);if(k.wheel)(k.mouse[0][0]!==D[0]||k.mouse[0][1]!==D[1])&&(k.mouse[1]=L.invert(k.mouse[0]=D)),clearTimeout(k.wheel);else{if(L.k===P)return;k.mouse=[D,L.invert(D)],vn(this),k.start()}pr(N),k.wheel=setTimeout(B,v),k.zoom("mouse",r(g(b(L,P),k.mouse[0],k.mouse[1]),k.extent,s));function B(){k.wheel=null,k.end()}}function q(N,...I){if(f||!e.apply(this,arguments))return;var k=N.currentTarget,L=E(this,I,!0).event(N),P=qe(N.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",Q,!0),D=ze(N,k),B=N.clientX,K=N.clientY;ey(N.view),Ai(N),L.mouse=[D,this.__zoom.invert(D)],vn(this),L.start();function H(T){if(pr(T),!L.moved){var F=T.clientX-B,z=T.clientY-K;L.moved=F*F+z*z>x}L.event(T).zoom("mouse",r(g(L.that.__zoom,L.mouse[0]=ze(T,k),L.mouse[1]),L.extent,s))}function Q(T){P.on("mousemove.zoom mouseup.zoom",null),ty(T.view,L.moved),pr(T),L.event(T).end()}}function M(N,...I){if(e.apply(this,arguments)){var k=this.__zoom,L=ze(N.changedTouches?N.changedTouches[0]:N,this),P=k.invert(L),D=k.k*(N.shiftKey?.5:2),B=r(g(b(k,D),L,P),t.apply(this,I),s);pr(N),o>0?qe(this).transition().duration(o).call(_,B,L,N):qe(this).call(p.transform,B,L,N)}}function R(N,...I){if(e.apply(this,arguments)){var k=N.touches,L=k.length,P=E(this,I,N.changedTouches.length===L).event(N),D,B,K,H;for(Ai(N),B=0;B<L;++B)K=k[B],H=ze(K,this),H=[H,this.__zoom.invert(H),K.identifier],P.touch0?!P.touch1&&P.touch0[2]!==H[2]&&(P.touch1=H,P.taps=0):(P.touch0=H,D=!0,P.taps=1+!!l);l&&(l=clearTimeout(l)),D&&(P.taps<2&&(d=H[0],l=setTimeout(function(){l=null},h)),vn(this),P.start())}}function A(N,...I){if(this.__zooming){var k=E(this,I).event(N),L=N.changedTouches,P=L.length,D,B,K,H;for(pr(N),D=0;D<P;++D)B=L[D],K=ze(B,this),k.touch0&&k.touch0[2]===B.identifier?k.touch0[0]=K:k.touch1&&k.touch1[2]===B.identifier&&(k.touch1[0]=K);if(B=k.that.__zoom,k.touch1){var Q=k.touch0[0],T=k.touch0[1],F=k.touch1[0],z=k.touch1[1],V=(V=F[0]-Q[0])*V+(V=F[1]-Q[1])*V,G=(G=z[0]-T[0])*G+(G=z[1]-T[1])*G;B=b(B,Math.sqrt(V/G)),K=[(Q[0]+F[0])/2,(Q[1]+F[1])/2],H=[(T[0]+z[0])/2,(T[1]+z[1])/2]}else if(k.touch0)K=k.touch0[0],H=k.touch0[1];else return;k.zoom("touch",r(g(B,K,H),k.extent,s))}}function $(N,...I){if(this.__zooming){var k=E(this,I).event(N),L=N.changedTouches,P=L.length,D,B;for(Ai(N),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),D=0;D<P;++D)B=L[D],k.touch0&&k.touch0[2]===B.identifier?delete k.touch0:k.touch1&&k.touch1[2]===B.identifier&&delete k.touch1;if(k.touch1&&!k.touch0&&(k.touch0=k.touch1,delete k.touch1),k.touch0)k.touch0[1]=this.__zoom.invert(k.touch0[0]);else if(k.end(),k.taps===2&&(B=ze(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<y)){var K=qe(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return p.wheelDelta=function(N){return arguments.length?(n=typeof N=="function"?N:un(+N),p):n},p.filter=function(N){return arguments.length?(e=typeof N=="function"?N:un(!!N),p):e},p.touchable=function(N){return arguments.length?(i=typeof N=="function"?N:un(!!N),p):i},p.extent=function(N){return arguments.length?(t=typeof N=="function"?N:un([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),p):t},p.scaleExtent=function(N){return arguments.length?(a[0]=+N[0],a[1]=+N[1],p):[a[0],a[1]]},p.translateExtent=function(N){return arguments.length?(s[0][0]=+N[0][0],s[1][0]=+N[1][0],s[0][1]=+N[0][1],s[1][1]=+N[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(N){return arguments.length?(r=N,p):r},p.duration=function(N){return arguments.length?(o=+N,p):o},p.interpolate=function(N){return arguments.length?(u=N,p):u},p.on=function(){var N=c.on.apply(c,arguments);return N===c?p:N},p.clickDistance=function(N){return arguments.length?(x=(N=+N)*N,p):Math.sqrt(x)},p.tapDistance=function(N){return arguments.length?(y=+N,p):y},p}const et={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:n}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},kr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],yy=["Enter"," ","Escape"],xy={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Wt;(function(e){e.Strict="strict",e.Loose="loose"})(Wt||(Wt={}));var Rt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Rt||(Rt={}));var Ar;(function(e){e.Partial="partial",e.Full="full"})(Ar||(Ar={}));const by={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var bt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(bt||(bt={}));var Xt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Xt||(Xt={}));var ee;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ee||(ee={}));const kd={[ee.Left]:ee.Right,[ee.Right]:ee.Left,[ee.Top]:ee.Bottom,[ee.Bottom]:ee.Top};function wy(e){return e===null?null:e?"valid":"invalid"}const _y=e=>"id"in e&&"source"in e&&"target"in e,wN=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Dl=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Lr=(e,t=[0,0])=>{const{width:r,height:n}=dt(e),i=e.origin??t,a=r*i[0],s=n*i[1];return{x:e.position.x-a,y:e.position.y-s}},_N=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,i)=>{const a=typeof i=="string";let s=!t.nodeLookup&&!a?i:void 0;t.nodeLookup&&(s=a?t.nodeLookup.get(i):Dl(i)?i:t.nodeLookup.get(i.id));const o=s?qn(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return $n(n,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return zn(r)},Or=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return e.forEach(i=>{(t.filter===void 0||t.filter(i))&&(r=$n(r,qn(i)),n=!0)}),n?zn(r):{x:0,y:0,width:0,height:0}},Ll=(e,t,[r,n,i]=[0,0,1],a=!1,s=!1)=>{const o={...$r(t,[r,n,i]),width:t.width/i,height:t.height/i},u=[];for(const c of e.values()){const{measured:l,selectable:d=!0,hidden:f=!1}=c;if(s&&!d||f)continue;const h=l.width??c.width??c.initialWidth??null,v=l.height??c.height??c.initialHeight??null,x=jr(o,Qt(c)),y=(h??0)*(v??0),p=a&&x>0;(!c.internals.handleBounds||p||x>=y||c.dragging)&&u.push(c)}return u},NN=(e,t)=>{const r=new Set;return e.forEach(n=>{r.add(n.id)}),t.filter(n=>r.has(n.source)||r.has(n.target))};function EN(e,t){const r=new Map,n=t!=null&&t.nodes?new Set(t.nodes.map(i=>i.id)):null;return e.forEach(i=>{i.measured.width&&i.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!i.hidden)&&(!n||n.has(i.id))&&r.set(i.id,i)}),r}async function CN({nodes:e,width:t,height:r,panZoom:n,minZoom:i,maxZoom:a},s){if(e.size===0)return Promise.resolve(!0);const o=EN(e,s),u=Or(o),c=Ol(u,t,r,(s==null?void 0:s.minZoom)??i,(s==null?void 0:s.maxZoom)??a,(s==null?void 0:s.padding)??.1);return await n.setViewport(c,{duration:s==null?void 0:s.duration,ease:s==null?void 0:s.ease,interpolate:s==null?void 0:s.interpolate}),Promise.resolve(!0)}function Ny({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:i,onError:a}){const s=r.get(e),o=s.parentId?r.get(s.parentId):void 0,{x:u,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},l=s.origin??n;let d=s.extent||i;if(s.extent==="parent"&&!s.expandParent)if(!o)a==null||a("005",et.error005());else{const h=o.measured.width,v=o.measured.height;h&&v&&(d=[[u,c],[u+h,c+v]])}else o&&Jt(s.extent)&&(d=[[s.extent[0][0]+u,s.extent[0][1]+c],[s.extent[1][0]+u,s.extent[1][1]+c]]);const f=Jt(d)?At(t,d,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&(a==null||a("015",et.error015())),{position:{x:f.x-u+(s.measured.width??0)*l[0],y:f.y-c+(s.measured.height??0)*l[1]},positionAbsolute:f}}async function SN({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:n,onBeforeDelete:i}){const a=new Set(e.map(f=>f.id)),s=[];for(const f of r){if(f.deletable===!1)continue;const h=a.has(f.id),v=!h&&f.parentId&&s.find(x=>x.id===f.parentId);(h||v)&&s.push(f)}const o=new Set(t.map(f=>f.id)),u=n.filter(f=>f.deletable!==!1),l=NN(s,u);for(const f of u)o.has(f.id)&&!l.find(v=>v.id===f.id)&&l.push(f);if(!i)return{edges:l,nodes:s};const d=await i({nodes:s,edges:l});return typeof d=="boolean"?d?{edges:l,nodes:s}:{edges:[],nodes:[]}:d}const Zt=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),At=(e={x:0,y:0},t,r)=>({x:Zt(e.x,t[0][0],t[1][0]-((r==null?void 0:r.width)??0)),y:Zt(e.y,t[0][1],t[1][1]-((r==null?void 0:r.height)??0))});function Ey(e,t,r){const{width:n,height:i}=dt(r),{x:a,y:s}=r.internals.positionAbsolute;return At(e,[[a,s],[a+n,s+i]],t)}const Ad=(e,t,r)=>e<t?Zt(Math.abs(e-t),1,t)/t:e>r?-Zt(Math.abs(e-r),1,t)/t:0,Cy=(e,t,r=15,n=40)=>{const i=Ad(e.x,n,t.width-n)*r,a=Ad(e.y,n,t.height-n)*r;return[i,a]},$n=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),hl=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),zn=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),Qt=(e,t=[0,0])=>{var i,a;const{x:r,y:n}=Dl(e)?e.internals.positionAbsolute:Lr(e,t);return{x:r,y:n,width:((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0,height:((a=e.measured)==null?void 0:a.height)??e.height??e.initialHeight??0}},qn=(e,t=[0,0])=>{var i,a;const{x:r,y:n}=Dl(e)?e.internals.positionAbsolute:Lr(e,t);return{x:r,y:n,x2:r+(((i=e.measured)==null?void 0:i.width)??e.width??e.initialWidth??0),y2:n+(((a=e.measured)==null?void 0:a.height)??e.height??e.initialHeight??0)}},Sy=(e,t)=>zn($n(hl(e),hl(t))),jr=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},jd=e=>Ve(e.width)&&Ve(e.height)&&Ve(e.x)&&Ve(e.y),Ve=e=>!isNaN(e)&&isFinite(e),IN=(e,t)=>{},Fr=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),$r=({x:e,y:t},[r,n,i],a=!1,s=[1,1])=>{const o={x:(e-r)/i,y:(t-n)/i};return a?Fr(o,s):o},kn=({x:e,y:t},[r,n,i])=>({x:e*i+r,y:t*i+n});function $t(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function RN(e,t,r){if(typeof e=="string"||typeof e=="number"){const n=$t(e,r),i=$t(e,t);return{top:n,right:i,bottom:n,left:i,x:i*2,y:n*2}}if(typeof e=="object"){const n=$t(e.top??e.y??0,r),i=$t(e.bottom??e.y??0,r),a=$t(e.left??e.x??0,t),s=$t(e.right??e.x??0,t);return{top:n,right:s,bottom:i,left:a,x:a+s,y:n+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function qN(e,t,r,n,i,a){const{x:s,y:o}=kn(e,[t,r,n]),{x:u,y:c}=kn({x:e.x+e.width,y:e.y+e.height},[t,r,n]),l=i-u,d=a-c;return{left:Math.floor(s),top:Math.floor(o),right:Math.floor(l),bottom:Math.floor(d)}}const Ol=(e,t,r,n,i,a)=>{const s=RN(a,t,r),o=(t-s.x)/e.width,u=(r-s.y)/e.height,c=Math.min(o,u),l=Zt(c,n,i),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*l,v=r/2-f*l,x=qN(e,h,v,l,t,r),y={left:Math.min(x.left-s.left,0),top:Math.min(x.top-s.top,0),right:Math.min(x.right-s.right,0),bottom:Math.min(x.bottom-s.bottom,0)};return{x:h-y.left+y.right,y:v-y.top+y.bottom,zoom:l}},Mr=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Jt(e){return e!=null&&e!=="parent"}function dt(e){var t,r;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}}function Iy(e){var t,r;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight)!==void 0}function Ry(e,t={width:0,height:0},r,n,i){const a={...e},s=n.get(r);if(s){const o=s.origin||i;a.x+=s.internals.positionAbsolute.x-(t.width??0)*o[0],a.y+=s.internals.positionAbsolute.y-(t.height??0)*o[1]}return a}function Md(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function kN(){let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}}function AN(e){return{...xy,...e||{}}}function Nr(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:n,containerBounds:i}){const{x:a,y:s}=Ge(e),o=$r({x:a-((i==null?void 0:i.left)??0),y:s-((i==null?void 0:i.top)??0)},n),{x:u,y:c}=r?Fr(o,t):o;return{xSnapped:u,ySnapped:c,...o}}const Fl=e=>({width:e.offsetWidth,height:e.offsetHeight}),qy=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},jN=["INPUT","SELECT","TEXTAREA"];function ky(e){var n,i;const t=((i=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:i[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:jN.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Ay=e=>"clientX"in e,Ge=(e,t)=>{var a,s;const r=Ay(e),n=r?e.clientX:(a=e.touches)==null?void 0:a[0].clientX,i=r?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Td=(e,t,r,n,i)=>{const a=t.querySelectorAll(`.${e}`);return!a||!a.length?null:Array.from(a).map(s=>{const o=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:i,position:s.getAttribute("data-handlepos"),x:(o.left-r.left)/n,y:(o.top-r.top)/n,...Fl(s)}})};function jy({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:i,sourceControlY:a,targetControlX:s,targetControlY:o}){const u=e*.125+i*.375+s*.375+r*.125,c=t*.125+a*.375+o*.375+n*.125,l=Math.abs(u-e),d=Math.abs(c-t);return[u,c,l,d]}function cn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Pd({pos:e,x1:t,y1:r,x2:n,y2:i,c:a}){switch(e){case ee.Left:return[t-cn(t-n,a),r];case ee.Right:return[t+cn(n-t,a),r];case ee.Top:return[t,r-cn(r-i,a)];case ee.Bottom:return[t,r+cn(i-r,a)]}}function My({sourceX:e,sourceY:t,sourcePosition:r=ee.Bottom,targetX:n,targetY:i,targetPosition:a=ee.Top,curvature:s=.25}){const[o,u]=Pd({pos:r,x1:e,y1:t,x2:n,y2:i,c:s}),[c,l]=Pd({pos:a,x1:n,y1:i,x2:e,y2:t,c:s}),[d,f,h,v]=jy({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:o,sourceControlY:u,targetControlX:c,targetControlY:l});return[`M${e},${t} C${o},${u} ${c},${l} ${n},${i}`,d,f,h,v]}function Ty({sourceX:e,sourceY:t,targetX:r,targetY:n}){const i=Math.abs(r-e)/2,a=r<e?r+i:r-i,s=Math.abs(n-t)/2,o=n<t?n+s:n-s;return[a,o,i,s]}function MN({sourceNode:e,targetNode:t,selected:r=!1,zIndex:n=0,elevateOnSelect:i=!1,zIndexMode:a="basic"}){if(a==="manual")return n;const s=i&&r?n+1e3:n,o=Math.max(e.parentId||i&&e.selected?e.internals.z:0,t.parentId||i&&t.selected?t.internals.z:0);return s+o}function TN({sourceNode:e,targetNode:t,width:r,height:n,transform:i}){const a=$n(qn(e),qn(t));a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1);const s={x:-i[0]/i[2],y:-i[1]/i[2],width:r/i[2],height:n/i[2]};return jr(s,zn(a))>0}const PN=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`xy-edge__${e}${t||""}-${r}${n||""}`,DN=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),pl=(e,t,r={})=>{if(!e.source||!e.target)return t;const n=r.getEdgeId||PN;let i;return _y(e)?i={...e}:i={...e,id:n(e)},DN(i,t)?t:(i.sourceHandle===null&&delete i.sourceHandle,i.targetHandle===null&&delete i.targetHandle,t.concat(i))};function Py({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[i,a,s,o]=Ty({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,i,a,s,o]}const Dd={[ee.Left]:{x:-1,y:0},[ee.Right]:{x:1,y:0},[ee.Top]:{x:0,y:-1},[ee.Bottom]:{x:0,y:1}},LN=({source:e,sourcePosition:t=ee.Bottom,target:r})=>t===ee.Left||t===ee.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Ld=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ON({source:e,sourcePosition:t=ee.Bottom,target:r,targetPosition:n=ee.Top,center:i,offset:a,stepPosition:s}){const o=Dd[t],u=Dd[n],c={x:e.x+o.x*a,y:e.y+o.y*a},l={x:r.x+u.x*a,y:r.y+u.y*a},d=LN({source:c,sourcePosition:t,target:l}),f=d.x!==0?"x":"y",h=d[f];let v=[],x,y;const p={x:0,y:0},b={x:0,y:0},[,,g,w]=Ty({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(o[f]*u[f]===-1){f==="x"?(x=i.x??c.x+(l.x-c.x)*s,y=i.y??(c.y+l.y)/2):(x=i.x??(c.x+l.x)/2,y=i.y??c.y+(l.y-c.y)*s);const E=[{x,y:c.y},{x,y:l.y}],C=[{x:c.x,y},{x:l.x,y}];o[f]===h?v=f==="x"?E:C:v=f==="x"?C:E}else{const E=[{x:c.x,y:l.y}],C=[{x:l.x,y:c.y}];if(f==="x"?v=o.x===h?C:E:v=o.y===h?E:C,t===n){const A=Math.abs(e[f]-r[f]);if(A<=a){const $=Math.min(a-1,a-A);o[f]===h?p[f]=(c[f]>e[f]?-1:1)*$:b[f]=(l[f]>r[f]?-1:1)*$}}if(t!==n){const A=f==="x"?"y":"x",$=o[f]===u[A],N=c[A]>l[A],I=c[A]<l[A];(o[f]===1&&(!$&&N||$&&I)||o[f]!==1&&(!$&&I||$&&N))&&(v=f==="x"?E:C)}const S={x:c.x+p.x,y:c.y+p.y},q={x:l.x+b.x,y:l.y+b.y},M=Math.max(Math.abs(S.x-v[0].x),Math.abs(q.x-v[0].x)),R=Math.max(Math.abs(S.y-v[0].y),Math.abs(q.y-v[0].y));M>=R?(x=(S.x+q.x)/2,y=v[0].y):(x=v[0].x,y=(S.y+q.y)/2)}return[[e,{x:c.x+p.x,y:c.y+p.y},...v,{x:l.x+b.x,y:l.y+b.y},r],x,y,g,w]}function FN(e,t,r,n){const i=Math.min(Ld(e,t)/2,Ld(t,r)/2,n),{x:a,y:s}=t;if(e.x===a&&a===r.x||e.y===s&&s===r.y)return`L${a} ${s}`;if(e.y===s){const c=e.x<r.x?-1:1,l=e.y<r.y?1:-1;return`L ${a+i*c},${s}Q ${a},${s} ${a},${s+i*l}`}const o=e.x<r.x?1:-1,u=e.y<r.y?-1:1;return`L ${a},${s+i*u}Q ${a},${s} ${a+i*o},${s}`}function gl({sourceX:e,sourceY:t,sourcePosition:r=ee.Bottom,targetX:n,targetY:i,targetPosition:a=ee.Top,borderRadius:s=5,centerX:o,centerY:u,offset:c=20,stepPosition:l=.5}){const[d,f,h,v,x]=ON({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:i},targetPosition:a,center:{x:o,y:u},offset:c,stepPosition:l});return[d.reduce((p,b,g)=>{let w="";return g>0&&g<d.length-1?w=FN(d[g-1],b,d[g+1],s):w=`${g===0?"M":"L"}${b.x} ${b.y}`,p+=w,p},""),f,h,v,x]}function Od(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function $N(e){var d;const{sourceNode:t,targetNode:r}=e;if(!Od(t)||!Od(r))return null;const n=t.internals.handleBounds||Fd(t.handles),i=r.internals.handleBounds||Fd(r.handles),a=$d((n==null?void 0:n.source)??[],e.sourceHandle),s=$d(e.connectionMode===Wt.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),e.targetHandle);if(!a||!s)return(d=e.onError)==null||d.call(e,"008",et.error008(a?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const o=(a==null?void 0:a.position)||ee.Bottom,u=(s==null?void 0:s.position)||ee.Top,c=jt(t,a,o),l=jt(r,s,u);return{sourceX:c.x,sourceY:c.y,targetX:l.x,targetY:l.y,sourcePosition:o,targetPosition:u}}function Fd(e){if(!e)return null;const t=[],r=[];for(const n of e)n.width=n.width??1,n.height=n.height??1,n.type==="source"?t.push(n):n.type==="target"&&r.push(n);return{source:t,target:r}}function jt(e,t,r=ee.Left,n=!1){const i=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,a=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:s,height:o}=t??dt(e);if(n)return{x:i+s/2,y:a+o/2};switch((t==null?void 0:t.position)??r){case ee.Top:return{x:i+s/2,y:a};case ee.Right:return{x:i+s,y:a+o/2};case ee.Bottom:return{x:i+s/2,y:a+o};case ee.Left:return{x:i,y:a+o/2}}}function $d(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function ml(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function zN(e,{id:t,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:i}){const a=new Set;return e.reduce((s,o)=>([o.markerStart||n,o.markerEnd||i].forEach(u=>{if(u&&typeof u=="object"){const c=ml(u,t);a.has(c)||(s.push({id:c,color:u.color||r,...u}),a.add(c))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))}const Dy=1e3,BN=10,$l={nodeOrigin:[0,0],nodeExtent:kr,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},HN={...$l,checkEquality:!0};function zl(e,t){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}function VN(e,t,r){const n=zl($l,r);for(const i of e.values())if(i.parentId)Hl(i,e,t,n);else{const a=Lr(i,n.nodeOrigin),s=Jt(i.extent)?i.extent:n.nodeExtent,o=At(a,s,dt(i));i.internals.positionAbsolute=o}}function GN(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const r=[],n=[];for(const i of e.handles){const a={id:i.id,width:i.width??1,height:i.height??1,nodeId:e.id,x:i.x,y:i.y,position:i.position,type:i.type};i.type==="source"?r.push(a):i.type==="target"&&n.push(a)}return{source:r,target:n}}function Bl(e){return e==="manual"}function vl(e,t,r,n={}){var c,l;const i=zl(HN,n),a={i:0},s=new Map(t),o=i!=null&&i.elevateNodesOnSelect&&!Bl(i.zIndexMode)?Dy:0;let u=e.length>0;t.clear(),r.clear();for(const d of e){let f=s.get(d.id);if(i.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const h=Lr(d,i.nodeOrigin),v=Jt(d.extent)?d.extent:i.nodeExtent,x=At(h,v,dt(d));f={...i.defaults,...d,measured:{width:(c=d.measured)==null?void 0:c.width,height:(l=d.measured)==null?void 0:l.height},internals:{positionAbsolute:x,handleBounds:GN(d,f),z:Ly(d,o,i.zIndexMode),userNode:d}},t.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(u=!1),d.parentId&&Hl(f,t,r,n,a)}return u}function UN(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Hl(e,t,r,n,i){const{elevateNodesOnSelect:a,nodeOrigin:s,nodeExtent:o,zIndexMode:u}=zl($l,n),c=e.parentId,l=t.get(c);if(!l){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}UN(e,r),i&&!l.parentId&&l.internals.rootParentIndex===void 0&&u==="auto"&&(l.internals.rootParentIndex=++i.i,l.internals.z=l.internals.z+i.i*BN),i&&l.internals.rootParentIndex!==void 0&&(i.i=l.internals.rootParentIndex);const d=a&&!Bl(u)?Dy:0,{x:f,y:h,z:v}=KN(e,l,s,o,d,u),{positionAbsolute:x}=e.internals,y=f!==x.x||h!==x.y;(y||v!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:f,y:h}:x,z:v}})}function Ly(e,t,r){const n=Ve(e.zIndex)?e.zIndex:0;return Bl(r)?n:n+(e.selected?t:0)}function KN(e,t,r,n,i,a){const{x:s,y:o}=t.internals.positionAbsolute,u=dt(e),c=Lr(e,r),l=Jt(e.extent)?At(c,e.extent,u):c;let d=At({x:s+l.x,y:o+l.y},n,u);e.extent==="parent"&&(d=Ey(d,u,t));const f=Ly(e,i,a),h=t.internals.z??0;return{x:d.x,y:d.y,z:h>=f?h+1:f}}function Vl(e,t,r,n=[0,0]){var s;const i=[],a=new Map;for(const o of e){const u=t.get(o.parentId);if(!u)continue;const c=((s=a.get(o.parentId))==null?void 0:s.expandedRect)??Qt(u),l=Sy(c,o.rect);a.set(o.parentId,{expandedRect:l,parent:u})}return a.size>0&&a.forEach(({expandedRect:o,parent:u},c)=>{var g;const l=u.internals.positionAbsolute,d=dt(u),f=u.origin??n,h=o.x<l.x?Math.round(Math.abs(l.x-o.x)):0,v=o.y<l.y?Math.round(Math.abs(l.y-o.y)):0,x=Math.max(d.width,Math.round(o.width)),y=Math.max(d.height,Math.round(o.height)),p=(x-d.width)*f[0],b=(y-d.height)*f[1];(h>0||v>0||p||b)&&(i.push({id:c,type:"position",position:{x:u.position.x-h+p,y:u.position.y-v+b}}),(g=r.get(c))==null||g.forEach(w=>{e.some(_=>_.id===w.id)||i.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+v}})})),(d.width<o.width||d.height<o.height||h||v)&&i.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:x+(h?f[0]*h-p:0),height:y+(v?f[1]*v-b:0)}})}),i}function YN(e,t,r,n,i,a,s){const o=n==null?void 0:n.querySelector(".xyflow__viewport");let u=!1;if(!o)return{changes:[],updatedInternals:u};const c=[],l=window.getComputedStyle(o),{m22:d}=new window.DOMMatrixReadOnly(l.transform),f=[];for(const h of e.values()){const v=t.get(h.id);if(!v)continue;if(v.hidden){t.set(v.id,{...v,internals:{...v.internals,handleBounds:void 0}}),u=!0;continue}const x=Fl(h.nodeElement),y=v.measured.width!==x.width||v.measured.height!==x.height;if(!!(x.width&&x.height&&(y||!v.internals.handleBounds||h.force))){const b=h.nodeElement.getBoundingClientRect(),g=Jt(v.extent)?v.extent:a;let{positionAbsolute:w}=v.internals;v.parentId&&v.extent==="parent"?w=Ey(w,x,t.get(v.parentId)):g&&(w=At(w,g,x));const _={...v,measured:x,internals:{...v.internals,positionAbsolute:w,handleBounds:{source:Td("source",h.nodeElement,b,d,v.id),target:Td("target",h.nodeElement,b,d,v.id)}}};t.set(v.id,_),v.parentId&&Hl(_,t,r,{nodeOrigin:i,zIndexMode:s}),u=!0,y&&(c.push({id:v.id,type:"dimensions",dimensions:x}),v.expandParent&&v.parentId&&f.push({id:v.id,parentId:v.parentId,rect:Qt(_,i)}))}}if(f.length>0){const h=Vl(f,t,r,i);c.push(...h)}return{changes:c,updatedInternals:u}}async function WN({delta:e,panZoom:t,transform:r,translateExtent:n,width:i,height:a}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[i,a]],n),o=!!s&&(s.x!==r[0]||s.y!==r[1]||s.k!==r[2]);return Promise.resolve(o)}function zd(e,t,r,n,i,a){let s=i;const o=n.get(s)||new Map;n.set(s,o.set(r,t)),s=`${i}-${e}`;const u=n.get(s)||new Map;if(n.set(s,u.set(r,t)),a){s=`${i}-${e}-${a}`;const c=n.get(s)||new Map;n.set(s,c.set(r,t))}}function Oy(e,t,r){e.clear(),t.clear();for(const n of r){const{source:i,target:a,sourceHandle:s=null,targetHandle:o=null}=n,u={edgeId:n.id,source:i,target:a,sourceHandle:s,targetHandle:o},c=`${i}-${s}--${a}-${o}`,l=`${a}-${o}--${i}-${s}`;zd("source",u,l,e,i,s),zd("target",u,c,e,a,o),t.set(n.id,n)}}function Fy(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:Fy(r,t):!1}function Bd(e,t,r){var i;let n=e;do{if((i=n==null?void 0:n.matches)!=null&&i.call(n,t))return!0;if(n===r)return!1;n=n==null?void 0:n.parentElement}while(n);return!1}function XN(e,t,r,n){const i=new Map;for(const[a,s]of e)if((s.selected||s.id===n)&&(!s.parentId||!Fy(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const o=e.get(a);o&&i.set(a,{id:a,position:o.position||{x:0,y:0},distance:{x:r.x-o.internals.positionAbsolute.x,y:r.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return i}function ji({nodeId:e,dragItems:t,nodeLookup:r,dragging:n=!0}){var s,o,u;const i=[];for(const[c,l]of t){const d=(s=r.get(c))==null?void 0:s.internals.userNode;d&&i.push({...d,position:l.position,dragging:n})}if(!e)return[i[0],i];const a=(o=r.get(e))==null?void 0:o.internals.userNode;return[a?{...a,position:((u=t.get(e))==null?void 0:u.position)||a.position,dragging:n}:i[0],i]}function ZN({dragItems:e,snapGrid:t,x:r,y:n}){const i=e.values().next().value;if(!i)return null;const a={x:r-i.distance.x,y:n-i.distance.y},s=Fr(a,t);return{x:s.x-a.x,y:s.y-a.y}}function QN({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:n,onDragStop:i}){let a={x:null,y:null},s=0,o=new Map,u=!1,c={x:0,y:0},l=null,d=!1,f=null,h=!1,v=!1,x=null;function y({noDragClassName:b,handleSelector:g,domNode:w,isSelectable:_,nodeId:E,nodeClickDistance:C=0}){f=qe(w);function S({x:A,y:$}){const{nodeLookup:N,nodeExtent:I,snapGrid:k,snapToGrid:L,nodeOrigin:P,onNodeDrag:D,onSelectionDrag:B,onError:K,updateNodePositions:H}=t();a={x:A,y:$};let Q=!1;const T=o.size>1,F=T&&I?hl(Or(o)):null,z=T&&L?ZN({dragItems:o,snapGrid:k,x:A,y:$}):null;for(const[V,G]of o){if(!N.has(V))continue;let W={x:A-G.distance.x,y:$-G.distance.y};L&&(W=z?{x:Math.round(W.x+z.x),y:Math.round(W.y+z.y)}:Fr(W,k));let te=null;if(T&&I&&!G.extent&&F){const{positionAbsolute:J}=G.internals,se=J.x-F.x+I[0][0],re=J.x+G.measured.width-F.x2+I[1][0],ue=J.y-F.y+I[0][1],oe=J.y+G.measured.height-F.y2+I[1][1];te=[[se,ue],[re,oe]]}const{position:ne,positionAbsolute:ie}=Ny({nodeId:V,nextPosition:W,nodeLookup:N,nodeExtent:te||I,nodeOrigin:P,onError:K});Q=Q||G.position.x!==ne.x||G.position.y!==ne.y,G.position=ne,G.internals.positionAbsolute=ie}if(v=v||Q,!!Q&&(H(o,!0),x&&(n||D||!E&&B))){const[V,G]=ji({nodeId:E,dragItems:o,nodeLookup:N});n==null||n(x,o,V,G),D==null||D(x,V,G),E||B==null||B(x,G)}}async function q(){if(!l)return;const{transform:A,panBy:$,autoPanSpeed:N,autoPanOnNodeDrag:I}=t();if(!I){u=!1,cancelAnimationFrame(s);return}const[k,L]=Cy(c,l,N);(k!==0||L!==0)&&(a.x=(a.x??0)-k/A[2],a.y=(a.y??0)-L/A[2],await $({x:k,y:L})&&S(a)),s=requestAnimationFrame(q)}function M(A){var T;const{nodeLookup:$,multiSelectionActive:N,nodesDraggable:I,transform:k,snapGrid:L,snapToGrid:P,selectNodesOnDrag:D,onNodeDragStart:B,onSelectionDragStart:K,unselectNodesAndEdges:H}=t();d=!0,(!D||!_)&&!N&&E&&((T=$.get(E))!=null&&T.selected||H()),_&&D&&E&&(e==null||e(E));const Q=Nr(A.sourceEvent,{transform:k,snapGrid:L,snapToGrid:P,containerBounds:l});if(a=Q,o=XN($,I,Q,E),o.size>0&&(r||B||!E&&K)){const[F,z]=ji({nodeId:E,dragItems:o,nodeLookup:$});r==null||r(A.sourceEvent,o,F,z),B==null||B(A.sourceEvent,F,z),E||K==null||K(A.sourceEvent,z)}}const R=ry().clickDistance(C).on("start",A=>{const{domNode:$,nodeDragThreshold:N,transform:I,snapGrid:k,snapToGrid:L}=t();l=($==null?void 0:$.getBoundingClientRect())||null,h=!1,v=!1,x=A.sourceEvent,N===0&&M(A),a=Nr(A.sourceEvent,{transform:I,snapGrid:k,snapToGrid:L,containerBounds:l}),c=Ge(A.sourceEvent,l)}).on("drag",A=>{const{autoPanOnNodeDrag:$,transform:N,snapGrid:I,snapToGrid:k,nodeDragThreshold:L,nodeLookup:P}=t(),D=Nr(A.sourceEvent,{transform:N,snapGrid:I,snapToGrid:k,containerBounds:l});if(x=A.sourceEvent,(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1||E&&!P.has(E))&&(h=!0),!h){if(!u&&$&&d&&(u=!0,q()),!d){const B=Ge(A.sourceEvent,l),K=B.x-c.x,H=B.y-c.y;Math.sqrt(K*K+H*H)>L&&M(A)}(a.x!==D.xSnapped||a.y!==D.ySnapped)&&o&&d&&(c=Ge(A.sourceEvent,l),S(D))}}).on("end",A=>{if(!(!d||h)&&(u=!1,d=!1,cancelAnimationFrame(s),o.size>0)){const{nodeLookup:$,updateNodePositions:N,onNodeDragStop:I,onSelectionDragStop:k}=t();if(v&&(N(o,!1),v=!1),i||I||!E&&k){const[L,P]=ji({nodeId:E,dragItems:o,nodeLookup:$,dragging:!1});i==null||i(A.sourceEvent,o,L,P),I==null||I(A.sourceEvent,L,P),E||k==null||k(A.sourceEvent,P)}}}).filter(A=>{const $=A.target;return!A.button&&(!b||!Bd($,`.${b}`,w))&&(!g||Bd($,g,w))});f.call(R)}function p(){f==null||f.on(".drag",null)}return{update:y,destroy:p}}function JN(e,t,r){const n=[],i={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const a of t.values())jr(i,Qt(a))>0&&n.push(a);return n}const eE=250;function tE(e,t,r,n){var o,u;let i=[],a=1/0;const s=JN(e,r,t+eE);for(const c of s){const l=[...((o=c.internals.handleBounds)==null?void 0:o.source)??[],...((u=c.internals.handleBounds)==null?void 0:u.target)??[]];for(const d of l){if(n.nodeId===d.nodeId&&n.type===d.type&&n.id===d.id)continue;const{x:f,y:h}=jt(c,d,d.position,!0),v=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));v>t||(v<a?(i=[{...d,x:f,y:h}],a=v):v===a&&i.push({...d,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const c=n.type==="source"?"target":"source";return i.find(l=>l.type===c)??i[0]}return i[0]}function $y(e,t,r,n,i,a=!1){var c,l,d;const s=n.get(e);if(!s)return null;const o=i==="strict"?(c=s.internals.handleBounds)==null?void 0:c[t]:[...((l=s.internals.handleBounds)==null?void 0:l.source)??[],...((d=s.internals.handleBounds)==null?void 0:d.target)??[]],u=(r?o==null?void 0:o.find(f=>f.id===r):o==null?void 0:o[0])??null;return u&&a?{...u,...jt(s,u,u.position,!0)}:u}function zy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function rE(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const By=()=>!0;function nE(e,{connectionMode:t,connectionRadius:r,handleId:n,nodeId:i,edgeUpdaterType:a,isTarget:s,domNode:o,nodeLookup:u,lib:c,autoPanOnConnect:l,flowId:d,panBy:f,cancelConnection:h,onConnectStart:v,onConnect:x,onConnectEnd:y,isValidConnection:p=By,onReconnectEnd:b,updateConnection:g,getTransform:w,getFromHandle:_,autoPanSpeed:E,dragThreshold:C=1,handleDomNode:S}){const q=qy(e.target);let M=0,R;const{x:A,y:$}=Ge(e),N=zy(a,S),I=o==null?void 0:o.getBoundingClientRect();let k=!1;if(!I||!N)return;const L=$y(i,N,n,u,t);if(!L)return;let P=Ge(e,I),D=!1,B=null,K=!1,H=null;function Q(){if(!l||!I)return;const[ne,ie]=Cy(P,I,E);f({x:ne,y:ie}),M=requestAnimationFrame(Q)}const T={...L,nodeId:i,type:N,position:L.position},F=u.get(i);let V={inProgress:!0,isValid:null,from:jt(F,T,ee.Left,!0),fromHandle:T,fromPosition:T.position,fromNode:F,to:P,toHandle:null,toPosition:kd[T.position],toNode:null,pointer:P};function G(){k=!0,g(V),v==null||v(e,{nodeId:i,handleId:n,handleType:N})}C===0&&G();function W(ne){if(!k){const{x:oe,y:Ne}=Ge(ne),me=oe-A,Ae=Ne-$;if(!(me*me+Ae*Ae>C*C))return;G()}if(!_()||!T){te(ne);return}const ie=w();P=Ge(ne,I),R=tE($r(P,ie,!1,[1,1]),r,u,T),D||(Q(),D=!0);const J=Hy(ne,{handle:R,connectionMode:t,fromNodeId:i,fromHandleId:n,fromType:s?"target":"source",isValidConnection:p,doc:q,lib:c,flowId:d,nodeLookup:u});H=J.handleDomNode,B=J.connection,K=rE(!!R,J.isValid);const se=u.get(i),re=se?jt(se,T,ee.Left,!0):V.from,ue={...V,from:re,isValid:K,to:J.toHandle&&K?kn({x:J.toHandle.x,y:J.toHandle.y},ie):P,toHandle:J.toHandle,toPosition:K&&J.toHandle?J.toHandle.position:kd[T.position],toNode:J.toHandle?u.get(J.toHandle.nodeId):null,pointer:P};g(ue),V=ue}function te(ne){if(!("touches"in ne&&ne.touches.length>0)){if(k){(R||H)&&B&&K&&(x==null||x(B));const{inProgress:ie,...J}=V,se={...J,toPosition:V.toHandle?V.toPosition:null};y==null||y(ne,se),a&&(b==null||b(ne,se))}h(),cancelAnimationFrame(M),D=!1,K=!1,B=null,H=null,q.removeEventListener("mousemove",W),q.removeEventListener("mouseup",te),q.removeEventListener("touchmove",W),q.removeEventListener("touchend",te)}}q.addEventListener("mousemove",W),q.addEventListener("mouseup",te),q.addEventListener("touchmove",W),q.addEventListener("touchend",te)}function Hy(e,{handle:t,connectionMode:r,fromNodeId:n,fromHandleId:i,fromType:a,doc:s,lib:o,flowId:u,isValidConnection:c=By,nodeLookup:l}){const d=a==="target",f=t?s.querySelector(`.${o}-flow__handle[data-id="${u}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:v}=Ge(e),x=s.elementFromPoint(h,v),y=x!=null&&x.classList.contains(`${o}-flow__handle`)?x:f,p={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const b=zy(void 0,y),g=y.getAttribute("data-nodeid"),w=y.getAttribute("data-handleid"),_=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!g||!b)return p;const C={source:d?g:n,sourceHandle:d?w:i,target:d?n:g,targetHandle:d?i:w};p.connection=C;const q=_&&E&&(r===Wt.Strict?d&&b==="source"||!d&&b==="target":g!==n||w!==i);p.isValid=q&&c(C),p.toHandle=$y(g,b,w,l,r,!0)}return p}const yl={onPointerDown:nE,isValid:Hy};function iE({domNode:e,panZoom:t,getTransform:r,getViewScale:n}){const i=qe(e);function a({translateExtent:o,width:u,height:c,zoomStep:l=1,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const v=g=>{if(g.sourceEvent.type!=="wheel"||!t)return;const w=r(),_=g.sourceEvent.ctrlKey&&Mr()?10:1,E=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*l,C=w[2]*Math.pow(2,E*_);t.scaleTo(C)};let x=[0,0];const y=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(x=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},p=g=>{const w=r();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const _=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],E=[_[0]-x[0],_[1]-x[1]];x=_;const C=n()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),S={x:w[0]-E[0]*C,y:w[1]-E[1]*C},q=[[0,0],[u,c]];t.setViewportConstrained({x:S.x,y:S.y,zoom:w[2]},q,o)},b=vy().on("start",y).on("zoom",d?p:null).on("zoom.wheel",f?v:null);i.call(b,{})}function s(){i.on("zoom",null)}return{update:a,destroy:s,pointer:ze}}const Bn=e=>({x:e.x,y:e.y,zoom:e.k}),Mi=({x:e,y:t,zoom:r})=>Fn.translate(e,t).scale(r),Bt=(e,t)=>e.target.closest(`.${t}`),Vy=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),aE=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Ti=(e,t=0,r=aE,n=()=>{})=>{const i=typeof t=="number"&&t>0;return i||n(),i?e.transition().duration(t).ease(r).on("end",n):e},Gy=e=>{const t=e.ctrlKey&&Mr()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function sE({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:n,panOnScrollMode:i,panOnScrollSpeed:a,zoomOnPinch:s,onPanZoomStart:o,onPanZoom:u,onPanZoomEnd:c}){return l=>{if(Bt(l,t))return l.ctrlKey&&l.preventDefault(),!1;l.preventDefault(),l.stopImmediatePropagation();const d=r.property("__zoom").k||1;if(l.ctrlKey&&s){const y=ze(l),p=Gy(l),b=d*Math.pow(2,p);n.scaleTo(r,b,y,l);return}const f=l.deltaMode===1?20:1;let h=i===Rt.Vertical?0:l.deltaX*f,v=i===Rt.Horizontal?0:l.deltaY*f;!Mr()&&l.shiftKey&&i!==Rt.Vertical&&(h=l.deltaY*f,v=0),n.translateBy(r,-(h/d)*a,-(v/d)*a,{internal:!0});const x=Bn(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(u==null||u(l,x),e.panScrollTimeout=setTimeout(()=>{c==null||c(l,x),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,o==null||o(l,x))}}function oE({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(n,i){const a=n.type==="wheel",s=!t&&a&&!n.ctrlKey,o=Bt(n,e);if(n.ctrlKey&&a&&o&&n.preventDefault(),s||o)return null;n.preventDefault(),r.call(this,n,i)}}function uE({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return n=>{var a,s,o;if((a=n.sourceEvent)!=null&&a.internal)return;const i=Bn(n.transform);e.mouseButton=((s=n.sourceEvent)==null?void 0:s.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=i,((o=n.sourceEvent)==null?void 0:o.type)==="mousedown"&&t(!0),r&&(r==null||r(n.sourceEvent,i))}}function cE({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:n,onPanZoom:i}){return a=>{var s,o;e.usedRightMouseButton=!!(r&&Vy(t,e.mouseButton??0)),(s=a.sourceEvent)!=null&&s.sync||n([a.transform.x,a.transform.y,a.transform.k]),i&&!((o=a.sourceEvent)!=null&&o.internal)&&(i==null||i(a.sourceEvent,Bn(a.transform)))}}function lE({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:i,onPaneContextMenu:a}){return s=>{var o;if(!((o=s.sourceEvent)!=null&&o.internal)&&(e.isZoomingOrPanning=!1,a&&Vy(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&a(s.sourceEvent),e.usedRightMouseButton=!1,n(!1),i)){const u=Bn(s.transform);e.prevViewport=u,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i==null||i(s.sourceEvent,u)},r?150:0)}}}function dE({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:n,panOnScroll:i,zoomOnDoubleClick:a,userSelectionActive:s,noWheelClassName:o,noPanClassName:u,lib:c,connectionInProgress:l}){return d=>{var y;const f=e||t,h=r&&d.ctrlKey,v=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Bt(d,`${c}-flow__node`)||Bt(d,`${c}-flow__edge`)))return!0;if(!n&&!f&&!i&&!a&&!r||s||l&&!v||Bt(d,o)&&v||Bt(d,u)&&(!v||i&&v&&!e)||!r&&d.ctrlKey&&v)return!1;if(!r&&d.type==="touchstart"&&((y=d.touches)==null?void 0:y.length)>1)return d.preventDefault(),!1;if(!f&&!i&&!h&&v||!n&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(n)&&!n.includes(d.button)&&d.type==="mousedown")return!1;const x=Array.isArray(n)&&n.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||v)&&x}}function fE({domNode:e,minZoom:t,maxZoom:r,translateExtent:n,viewport:i,onPanZoom:a,onPanZoomStart:s,onPanZoomEnd:o,onDraggingChange:u}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},l=e.getBoundingClientRect(),d=vy().scaleExtent([t,r]).translateExtent(n),f=qe(e).call(d);b({x:i.x,y:i.y,zoom:Zt(i.zoom,t,r)},[[0,0],[l.width,l.height]],n);const h=f.on("wheel.zoom"),v=f.on("dblclick.zoom");d.wheelDelta(Gy);function x(R,A){return f?new Promise($=>{d==null||d.interpolate((A==null?void 0:A.interpolate)==="linear"?_r:pn).transform(Ti(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>$(!0)),R)}):Promise.resolve(!1)}function y({noWheelClassName:R,noPanClassName:A,onPaneContextMenu:$,userSelectionActive:N,panOnScroll:I,panOnDrag:k,panOnScrollMode:L,panOnScrollSpeed:P,preventScrolling:D,zoomOnPinch:B,zoomOnScroll:K,zoomOnDoubleClick:H,zoomActivationKeyPressed:Q,lib:T,onTransformChange:F,connectionInProgress:z,paneClickDistance:V,selectionOnDrag:G}){N&&!c.isZoomingOrPanning&&p();const W=I&&!Q&&!N;d.clickDistance(G?1/0:!Ve(V)||V<0?0:V);const te=W?sE({zoomPanValues:c,noWheelClassName:R,d3Selection:f,d3Zoom:d,panOnScrollMode:L,panOnScrollSpeed:P,zoomOnPinch:B,onPanZoomStart:s,onPanZoom:a,onPanZoomEnd:o}):oE({noWheelClassName:R,preventScrolling:D,d3ZoomHandler:h});if(f.on("wheel.zoom",te,{passive:!1}),!N){const ie=uE({zoomPanValues:c,onDraggingChange:u,onPanZoomStart:s});d.on("start",ie);const J=cE({zoomPanValues:c,panOnDrag:k,onPaneContextMenu:!!$,onPanZoom:a,onTransformChange:F});d.on("zoom",J);const se=lE({zoomPanValues:c,panOnDrag:k,panOnScroll:I,onPaneContextMenu:$,onPanZoomEnd:o,onDraggingChange:u});d.on("end",se)}const ne=dE({zoomActivationKeyPressed:Q,panOnDrag:k,zoomOnScroll:K,panOnScroll:I,zoomOnDoubleClick:H,zoomOnPinch:B,userSelectionActive:N,noPanClassName:A,noWheelClassName:R,lib:T,connectionInProgress:z});d.filter(ne),H?f.on("dblclick.zoom",v):f.on("dblclick.zoom",null)}function p(){d.on("zoom",null)}async function b(R,A,$){const N=Mi(R),I=d==null?void 0:d.constrain()(N,A,$);return I&&await x(I),new Promise(k=>k(I))}async function g(R,A){const $=Mi(R);return await x($,A),new Promise(N=>N($))}function w(R){if(f){const A=Mi(R),$=f.property("__zoom");($.k!==R.zoom||$.x!==R.x||$.y!==R.y)&&(d==null||d.transform(f,A,null,{sync:!0}))}}function _(){const R=f?my(f.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function E(R,A){return f?new Promise($=>{d==null||d.interpolate((A==null?void 0:A.interpolate)==="linear"?_r:pn).scaleTo(Ti(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>$(!0)),R)}):Promise.resolve(!1)}function C(R,A){return f?new Promise($=>{d==null||d.interpolate((A==null?void 0:A.interpolate)==="linear"?_r:pn).scaleBy(Ti(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>$(!0)),R)}):Promise.resolve(!1)}function S(R){d==null||d.scaleExtent(R)}function q(R){d==null||d.translateExtent(R)}function M(R){const A=!Ve(R)||R<0?0:R;d==null||d.clickDistance(A)}return{update:y,destroy:p,setViewport:g,setViewportConstrained:b,getViewport:_,scaleTo:E,scaleBy:C,setScaleExtent:S,setTranslateExtent:q,syncViewport:w,setClickDistance:M}}var er;(function(e){e.Line="line",e.Handle="handle"})(er||(er={}));function hE({width:e,prevWidth:t,height:r,prevHeight:n,affectsX:i,affectsY:a}){const s=e-t,o=r-n,u=[s>0?1:s<0?-1:0,o>0?1:o<0?-1:0];return s&&i&&(u[0]=u[0]*-1),o&&a&&(u[1]=u[1]*-1),u}function Hd(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),n=e.includes("left"),i=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:n,affectsY:i}}function yt(e,t){return Math.max(0,t-e)}function xt(e,t){return Math.max(0,e-t)}function ln(e,t,r){return Math.max(0,t-e,e-r)}function Vd(e,t){return e?!t:t}function pE(e,t,r,n,i,a,s,o){let{affectsX:u,affectsY:c}=t;const{isHorizontal:l,isVertical:d}=t,f=l&&d,{xSnapped:h,ySnapped:v}=r,{minWidth:x,maxWidth:y,minHeight:p,maxHeight:b}=n,{x:g,y:w,width:_,height:E,aspectRatio:C}=e;let S=Math.floor(l?h-e.pointerX:0),q=Math.floor(d?v-e.pointerY:0);const M=_+(u?-S:S),R=E+(c?-q:q),A=-a[0]*_,$=-a[1]*E;let N=ln(M,x,y),I=ln(R,p,b);if(s){let P=0,D=0;u&&S<0?P=yt(g+S+A,s[0][0]):!u&&S>0&&(P=xt(g+M+A,s[1][0])),c&&q<0?D=yt(w+q+$,s[0][1]):!c&&q>0&&(D=xt(w+R+$,s[1][1])),N=Math.max(N,P),I=Math.max(I,D)}if(o){let P=0,D=0;u&&S>0?P=xt(g+S,o[0][0]):!u&&S<0&&(P=yt(g+M,o[1][0])),c&&q>0?D=xt(w+q,o[0][1]):!c&&q<0&&(D=yt(w+R,o[1][1])),N=Math.max(N,P),I=Math.max(I,D)}if(i){if(l){const P=ln(M/C,p,b)*C;if(N=Math.max(N,P),s){let D=0;!u&&!c||u&&!c&&f?D=xt(w+$+M/C,s[1][1])*C:D=yt(w+$+(u?S:-S)/C,s[0][1])*C,N=Math.max(N,D)}if(o){let D=0;!u&&!c||u&&!c&&f?D=yt(w+M/C,o[1][1])*C:D=xt(w+(u?S:-S)/C,o[0][1])*C,N=Math.max(N,D)}}if(d){const P=ln(R*C,x,y)/C;if(I=Math.max(I,P),s){let D=0;!u&&!c||c&&!u&&f?D=xt(g+R*C+A,s[1][0])/C:D=yt(g+(c?q:-q)*C+A,s[0][0])/C,I=Math.max(I,D)}if(o){let D=0;!u&&!c||c&&!u&&f?D=yt(g+R*C,o[1][0])/C:D=xt(g+(c?q:-q)*C,o[0][0])/C,I=Math.max(I,D)}}}q=q+(q<0?I:-I),S=S+(S<0?N:-N),i&&(f?M>R*C?q=(Vd(u,c)?-S:S)/C:S=(Vd(u,c)?-q:q)*C:l?(q=S/C,c=u):(S=q*C,u=c));const k=u?g+S:g,L=c?w+q:w;return{width:_+(u?-S:S),height:E+(c?-q:q),x:a[0]*S*(u?-1:1)+k,y:a[1]*q*(c?-1:1)+L}}const Uy={width:0,height:0,x:0,y:0},gE={...Uy,pointerX:0,pointerY:0,aspectRatio:1};function mE(e){return[[0,0],[e.measured.width,e.measured.height]]}function vE(e,t,r){const n=t.position.x+e.position.x,i=t.position.y+e.position.y,a=e.measured.width??0,s=e.measured.height??0,o=r[0]*a,u=r[1]*s;return[[n-o,i-u],[n+a-o,i+s-u]]}function yE({domNode:e,nodeId:t,getStoreItems:r,onChange:n,onEnd:i}){const a=qe(e);let s={controlDirection:Hd("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function o({controlPosition:c,boundaries:l,keepAspectRatio:d,resizeDirection:f,onResizeStart:h,onResize:v,onResizeEnd:x,shouldResize:y}){let p={...Uy},b={...gE};s={boundaries:l,resizeDirection:f,keepAspectRatio:d,controlDirection:Hd(c)};let g,w=null,_=[],E,C,S,q=!1;const M=ry().on("start",R=>{const{nodeLookup:A,transform:$,snapGrid:N,snapToGrid:I,nodeOrigin:k,paneDomNode:L}=r();if(g=A.get(t),!g)return;w=(L==null?void 0:L.getBoundingClientRect())??null;const{xSnapped:P,ySnapped:D}=Nr(R.sourceEvent,{transform:$,snapGrid:N,snapToGrid:I,containerBounds:w});p={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},b={...p,pointerX:P,pointerY:D,aspectRatio:p.width/p.height},E=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(E=A.get(g.parentId),C=E&&g.extent==="parent"?mE(E):void 0),_=[],S=void 0;for(const[B,K]of A)if(K.parentId===t&&(_.push({id:B,position:{...K.position},extent:K.extent}),K.extent==="parent"||K.expandParent)){const H=vE(K,g,K.origin??k);S?S=[[Math.min(H[0][0],S[0][0]),Math.min(H[0][1],S[0][1])],[Math.max(H[1][0],S[1][0]),Math.max(H[1][1],S[1][1])]]:S=H}h==null||h(R,{...p})}).on("drag",R=>{const{transform:A,snapGrid:$,snapToGrid:N,nodeOrigin:I}=r(),k=Nr(R.sourceEvent,{transform:A,snapGrid:$,snapToGrid:N,containerBounds:w}),L=[];if(!g)return;const{x:P,y:D,width:B,height:K}=p,H={},Q=g.origin??I,{width:T,height:F,x:z,y:V}=pE(b,s.controlDirection,k,s.boundaries,s.keepAspectRatio,Q,C,S),G=T!==B,W=F!==K,te=z!==P&&G,ne=V!==D&&W;if(!te&&!ne&&!G&&!W)return;if((te||ne||Q[0]===1||Q[1]===1)&&(H.x=te?z:p.x,H.y=ne?V:p.y,p.x=H.x,p.y=H.y,_.length>0)){const re=z-P,ue=V-D;for(const oe of _)oe.position={x:oe.position.x-re+Q[0]*(T-B),y:oe.position.y-ue+Q[1]*(F-K)},L.push(oe)}if((G||W)&&(H.width=G&&(!s.resizeDirection||s.resizeDirection==="horizontal")?T:p.width,H.height=W&&(!s.resizeDirection||s.resizeDirection==="vertical")?F:p.height,p.width=H.width,p.height=H.height),E&&g.expandParent){const re=Q[0]*(H.width??0);H.x&&H.x<re&&(p.x=re,b.x=b.x-(H.x-re));const ue=Q[1]*(H.height??0);H.y&&H.y<ue&&(p.y=ue,b.y=b.y-(H.y-ue))}const ie=hE({width:p.width,prevWidth:B,height:p.height,prevHeight:K,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),J={...p,direction:ie};(y==null?void 0:y(R,J))!==!1&&(q=!0,v==null||v(R,J),n(H,L))}).on("end",R=>{q&&(x==null||x(R,{...p}),i==null||i({...p}),q=!1)});a.call(M)}function u(){a.on(".drag",null)}return{update:o,destroy:u}}const xE={},Gd=e=>{let t;const r=new Set,n=(l,d)=>{const f=typeof l=="function"?l(t):l;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(v=>v(t,h))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>c,subscribe:l=>(r.add(l),()=>r.delete(l)),destroy:()=>{(xE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,i,u);return u},bE=e=>e?Gd(e):Gd,{useDebugValue:wE}=Vx,{useSyncExternalStoreWithSelector:_E}=Hx,NE=e=>e;function Ky(e,t=NE,r){const n=_E(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return wE(n),n}const Ud=(e,t)=>{const r=bE(e),n=(i,a=t)=>Ky(r,i,a);return Object.assign(n,r),n},EE=(e,t)=>e?Ud(e,t):Ud;function he(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}const Hn=j.createContext(null),CE=Hn.Provider,Yy=et.error001();function le(e,t){const r=j.useContext(Hn);if(r===null)throw new Error(Yy);return Ky(r,e,t)}function pe(){const e=j.useContext(Hn);if(e===null)throw new Error(Yy);return j.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Kd={display:"none"},SE={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Wy="react-flow__node-desc",Xy="react-flow__edge-desc",IE="react-flow__aria-live",RE=e=>e.ariaLiveMessage,qE=e=>e.ariaLabelConfig;function kE({rfId:e}){const t=le(RE);return m.jsx("div",{id:`${IE}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:SE,children:t})}function AE({rfId:e,disableKeyboardA11y:t}){const r=le(qE);return m.jsxs(m.Fragment,{children:[m.jsx("div",{id:`${Wy}-${e}`,style:Kd,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),m.jsx("div",{id:`${Xy}-${e}`,style:Kd,children:r["edge.a11yDescription.default"]}),!t&&m.jsx(kE,{rfId:e})]})}const zr=j.forwardRef(({position:e="top-left",children:t,className:r,style:n,...i},a)=>{const s=`${e}`.split("-");return m.jsx("div",{className:we(["react-flow__panel",r,...s]),style:n,ref:a,...i,children:t})});zr.displayName="Panel";function jE({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:m.jsx(zr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:m.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const ME=e=>{const t=[],r=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,n]of e.edgeLookup)n.selected&&r.push(n);return{selectedNodes:t,selectedEdges:r}},dn=e=>e.id;function TE(e,t){return he(e.selectedNodes.map(dn),t.selectedNodes.map(dn))&&he(e.selectedEdges.map(dn),t.selectedEdges.map(dn))}function PE({onSelectionChange:e}){const t=pe(),{selectedNodes:r,selectedEdges:n}=le(ME,TE);return j.useEffect(()=>{const i={nodes:r,edges:n};e==null||e(i),t.getState().onSelectionChangeHandlers.forEach(a=>a(i))},[r,n,e]),null}const DE=e=>!!e.onSelectionChangeHandlers;function LE({onSelectionChange:e}){const t=le(DE);return e||t?m.jsx(PE,{onSelectionChange:e}):null}const Zy=[0,0],OE={x:0,y:0,zoom:1},FE=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Yd=[...FE,"rfId"],$E=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Wd={translateExtent:kr,nodeOrigin:Zy,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function zE(e){const{setNodes:t,setEdges:r,setMinZoom:n,setMaxZoom:i,setTranslateExtent:a,setNodeExtent:s,reset:o,setDefaultNodesAndEdges:u}=le($E,he),c=pe();j.useEffect(()=>(u(e.defaultNodes,e.defaultEdges),()=>{l.current=Wd,o()}),[]);const l=j.useRef(Wd);return j.useEffect(()=>{for(const d of Yd){const f=e[d],h=l.current[d];f!==h&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?r(f):d==="minZoom"?n(f):d==="maxZoom"?i(f):d==="translateExtent"?a(f):d==="nodeExtent"?s(f):d==="ariaLabelConfig"?c.setState({ariaLabelConfig:AN(f)}):d==="fitView"?c.setState({fitViewQueued:f}):d==="fitViewOptions"?c.setState({fitViewOptions:f}):c.setState({[d]:f})))}l.current=e},Yd.map(d=>e[d])),null}function Xd(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function BE(e){var n;const[t,r]=j.useState(e==="system"?null:e);return j.useEffect(()=>{if(e!=="system"){r(e);return}const i=Xd(),a=()=>r(i!=null&&i.matches?"dark":"light");return a(),i==null||i.addEventListener("change",a),()=>{i==null||i.removeEventListener("change",a)}},[e]),t!==null?t:(n=Xd())!=null&&n.matches?"dark":"light"}const Zd=typeof document<"u"?document:null;function Tr(e=null,t={target:Zd,actInsideInputWithModifier:!0}){const[r,n]=j.useState(!1),i=j.useRef(!1),a=j.useRef(new Set([])),[s,o]=j.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),l=c.reduce((d,f)=>d.concat(...f),[]);return[c,l]}return[[],[]]},[e]);return j.useEffect(()=>{const u=(t==null?void 0:t.target)??Zd,c=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const l=h=>{var y,p;if(i.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!i.current||i.current&&!c)&&ky(h))return!1;const x=Jd(h.code,o);if(a.current.add(h[x]),Qd(s,a.current,!1)){const b=((p=(y=h.composedPath)==null?void 0:y.call(h))==null?void 0:p[0])||h.target,g=(b==null?void 0:b.nodeName)==="BUTTON"||(b==null?void 0:b.nodeName)==="A";t.preventDefault!==!1&&(i.current||!g)&&h.preventDefault(),n(!0)}},d=h=>{const v=Jd(h.code,o);Qd(s,a.current,!0)?(n(!1),a.current.clear()):a.current.delete(h[v]),h.key==="Meta"&&a.current.clear(),i.current=!1},f=()=>{a.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",l),u==null||u.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{u==null||u.removeEventListener("keydown",l),u==null||u.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,n]),r}function Qd(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(i=>t.has(i)))}function Jd(e,t){return t.includes(e)?"code":"key"}const HE=()=>{const e=pe();return j.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:n}=e.getState();return n?n.scaleTo(t,{duration:r==null?void 0:r.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[n,i,a],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??n,y:t.y??i,zoom:t.zoom??a},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,n]=e.getState().transform;return{x:t,y:r,zoom:n}},setCenter:async(t,r,n)=>e.getState().setCenter(t,r,n),fitBounds:async(t,r)=>{const{width:n,height:i,minZoom:a,maxZoom:s,panZoom:o}=e.getState(),u=Ol(t,n,i,a,s,(r==null?void 0:r.padding)??.1);return o?(await o.setViewport(u,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:n,snapGrid:i,snapToGrid:a,domNode:s}=e.getState();if(!s)return t;const{x:o,y:u}=s.getBoundingClientRect(),c={x:t.x-o,y:t.y-u},l=r.snapGrid??i,d=r.snapToGrid??a;return $r(c,n,d,l)},flowToScreenPosition:t=>{const{transform:r,domNode:n}=e.getState();if(!n)return t;const{x:i,y:a}=n.getBoundingClientRect(),s=kn(t,r);return{x:s.x+i,y:s.y+a}}}),[])};function Qy(e,t){const r=[],n=new Map,i=[];for(const a of e)if(a.type==="add"){i.push(a);continue}else if(a.type==="remove"||a.type==="replace")n.set(a.id,[a]);else{const s=n.get(a.id);s?s.push(a):n.set(a.id,[a])}for(const a of t){const s=n.get(a.id);if(!s){r.push(a);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){r.push({...s[0].item});continue}const o={...a};for(const u of s)VE(u,o);r.push(o)}return i.length&&i.forEach(a=>{a.index!==void 0?r.splice(a.index,0,{...a.item}):r.push({...a.item})}),r}function VE(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Jy(e,t){return Qy(e,t)}function e0(e,t){return Qy(e,t)}function Ct(e,t){return{id:e,type:"select",selected:t}}function Ht(e,t=new Set,r=!1){const n=[];for(const[i,a]of e){const s=t.has(i);!(a.selected===void 0&&!s)&&a.selected!==s&&(r&&(a.selected=s),n.push(Ct(a.id,s)))}return n}function ef({items:e=[],lookup:t}){var i;const r=[],n=new Map(e.map(a=>[a.id,a]));for(const[a,s]of e.entries()){const o=t.get(s.id),u=((i=o==null?void 0:o.internals)==null?void 0:i.userNode)??o;u!==void 0&&u!==s&&r.push({id:s.id,item:s,type:"replace"}),u===void 0&&r.push({item:s,type:"add",index:a})}for(const[a]of t)n.get(a)===void 0&&r.push({id:a,type:"remove"});return r}function tf(e){return{id:e.id,type:"remove"}}const rf=e=>wN(e),GE=e=>_y(e);function t0(e){return j.forwardRef(e)}const UE=typeof window<"u"?j.useLayoutEffect:j.useEffect;function nf(e){const[t,r]=j.useState(BigInt(0)),[n]=j.useState(()=>KE(()=>r(i=>i+BigInt(1))));return UE(()=>{const i=n.get();i.length&&(e(i),n.reset())},[t]),n}function KE(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const r0=j.createContext(null);function YE({children:e}){const t=pe(),r=j.useCallback(o=>{const{nodes:u=[],setNodes:c,hasDefaultNodes:l,onNodesChange:d,nodeLookup:f,fitViewQueued:h,onNodesChangeMiddlewareMap:v}=t.getState();let x=u;for(const p of o)x=typeof p=="function"?p(x):p;let y=ef({items:x,lookup:f});for(const p of v.values())y=p(y);l&&c(x),y.length>0?d==null||d(y):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:p,nodes:b,setNodes:g}=t.getState();p&&g(b)})},[]),n=nf(r),i=j.useCallback(o=>{const{edges:u=[],setEdges:c,hasDefaultEdges:l,onEdgesChange:d,edgeLookup:f}=t.getState();let h=u;for(const v of o)h=typeof v=="function"?v(h):v;l?c(h):d&&d(ef({items:h,lookup:f}))},[]),a=nf(i),s=j.useMemo(()=>({nodeQueue:n,edgeQueue:a}),[]);return m.jsx(r0.Provider,{value:s,children:e})}function WE(){const e=j.useContext(r0);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const XE=e=>!!e.panZoom;function Br(){const e=HE(),t=pe(),r=WE(),n=le(XE),i=j.useMemo(()=>{const a=d=>t.getState().nodeLookup.get(d),s=d=>{r.nodeQueue.push(d)},o=d=>{r.edgeQueue.push(d)},u=d=>{var p,b;const{nodeLookup:f,nodeOrigin:h}=t.getState(),v=rf(d)?d:f.get(d.id),x=v.parentId?Ry(v.position,v.measured,v.parentId,f,h):v.position,y={...v,position:x,width:((p=v.measured)==null?void 0:p.width)??v.width,height:((b=v.measured)==null?void 0:b.height)??v.height};return Qt(y)},c=(d,f,h={replace:!1})=>{s(v=>v.map(x=>{if(x.id===d){const y=typeof f=="function"?f(x):f;return h.replace&&rf(y)?y:{...x,...y}}return x}))},l=(d,f,h={replace:!1})=>{o(v=>v.map(x=>{if(x.id===d){const y=typeof f=="function"?f(x):f;return h.replace&&GE(y)?y:{...x,...y}}return x}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=a(d))==null?void 0:f.internals.userNode},getInternalNode:a,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:o,addNodes:d=>{const f=Array.isArray(d)?d:[d];r.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];r.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[v,x,y]=h;return{nodes:d.map(p=>({...p})),edges:f.map(p=>({...p})),viewport:{x:v,y:x,zoom:y}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:v,onNodesDelete:x,onEdgesDelete:y,triggerNodeChanges:p,triggerEdgeChanges:b,onDelete:g,onBeforeDelete:w}=t.getState(),{nodes:_,edges:E}=await SN({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:v,onBeforeDelete:w}),C=E.length>0,S=_.length>0;if(C){const q=E.map(tf);y==null||y(E),b(q)}if(S){const q=_.map(tf);x==null||x(_),p(q)}return(S||C)&&(g==null||g({nodes:_,edges:E})),{deletedNodes:_,deletedEdges:E}},getIntersectingNodes:(d,f=!0,h)=>{const v=jd(d),x=v?d:u(d),y=h!==void 0;return x?(h||t.getState().nodes).filter(p=>{const b=t.getState().nodeLookup.get(p.id);if(b&&!v&&(p.id===d.id||!b.internals.positionAbsolute))return!1;const g=Qt(y?p:b),w=jr(g,x);return f&&w>0||w>=g.width*g.height||w>=x.width*x.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const x=jd(d)?d:u(d);if(!x)return!1;const y=jr(x,f);return h&&y>0||y>=f.width*f.height||y>=x.width*x.height},updateNode:c,updateNodeData:(d,f,h={replace:!1})=>{c(d,v=>{const x=typeof f=="function"?f(v):f;return h.replace?{...v,data:x}:{...v,data:{...v.data,...x}}},h)},updateEdge:l,updateEdgeData:(d,f,h={replace:!1})=>{l(d,v=>{const x=typeof f=="function"?f(v):f;return h.replace?{...v,data:x}:{...v,data:{...v.data,...x}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return _N(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:v.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:v.values())??[])},fitView:async d=>{const f=t.getState().fitViewResolver??kN();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),r.nodeQueue.push(h=>[...h]),f.promise}}},[]);return j.useMemo(()=>({...i,...e,viewportInitialized:n}),[n])}const af=e=>e.selected,ZE=typeof window<"u"?window:void 0;function QE({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=pe(),{deleteElements:n}=Br(),i=Tr(e,{actInsideInputWithModifier:!1}),a=Tr(t,{target:ZE});j.useEffect(()=>{if(i){const{edges:s,nodes:o}=r.getState();n({nodes:o.filter(af),edges:s.filter(af)}),r.setState({nodesSelectionActive:!1})}},[i]),j.useEffect(()=>{r.setState({multiSelectionActive:a})},[a])}function JE(e){const t=pe();j.useEffect(()=>{const r=()=>{var i,a,s,o;if(!e.current||!(((a=(i=e.current).checkVisibility)==null?void 0:a.call(i))??!0))return!1;const n=Fl(e.current);(n.height===0||n.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",et.error004())),t.setState({width:n.width||500,height:n.height||500})};if(e.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}},[])}const Vn={position:"absolute",width:"100%",height:"100%",top:0,left:0},eC=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function tC({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:i=.5,panOnScrollMode:a=Rt.Free,zoomOnDoubleClick:s=!0,panOnDrag:o=!0,defaultViewport:u,translateExtent:c,minZoom:l,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:v,noWheelClassName:x,noPanClassName:y,onViewportChange:p,isControlledViewport:b,paneClickDistance:g,selectionOnDrag:w}){const _=pe(),E=j.useRef(null),{userSelectionActive:C,lib:S,connectionInProgress:q}=le(eC,he),M=Tr(f),R=j.useRef();JE(E);const A=j.useCallback($=>{p==null||p({x:$[0],y:$[1],zoom:$[2]}),b||_.setState({transform:$})},[p,b]);return j.useEffect(()=>{if(E.current){R.current=fE({domNode:E.current,minZoom:l,maxZoom:d,translateExtent:c,viewport:u,onDraggingChange:k=>_.setState({paneDragging:k}),onPanZoomStart:(k,L)=>{const{onViewportChangeStart:P,onMoveStart:D}=_.getState();D==null||D(k,L),P==null||P(L)},onPanZoom:(k,L)=>{const{onViewportChange:P,onMove:D}=_.getState();D==null||D(k,L),P==null||P(L)},onPanZoomEnd:(k,L)=>{const{onViewportChangeEnd:P,onMoveEnd:D}=_.getState();D==null||D(k,L),P==null||P(L)}});const{x:$,y:N,zoom:I}=R.current.getViewport();return _.setState({panZoom:R.current,transform:[$,N,I],domNode:E.current.closest(".react-flow")}),()=>{var k;(k=R.current)==null||k.destroy()}}},[]),j.useEffect(()=>{var $;($=R.current)==null||$.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:i,panOnScrollMode:a,zoomOnDoubleClick:s,panOnDrag:o,zoomActivationKeyPressed:M,preventScrolling:h,noPanClassName:y,userSelectionActive:C,noWheelClassName:x,lib:S,onTransformChange:A,connectionInProgress:q,selectionOnDrag:w,paneClickDistance:g})},[e,t,r,n,i,a,s,o,M,h,y,C,x,S,A,q,w,g]),m.jsx("div",{className:"react-flow__renderer",ref:E,style:Vn,children:v})}const rC=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function nC(){const{userSelectionActive:e,userSelectionRect:t}=le(rC,he);return e&&t?m.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Pi=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},iC=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function aC({isSelecting:e,selectionKeyPressed:t,selectionMode:r=Ar.Full,panOnDrag:n,paneClickDistance:i,selectionOnDrag:a,onSelectionStart:s,onSelectionEnd:o,onPaneClick:u,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:h,children:v}){const x=pe(),{userSelectionActive:y,elementsSelectable:p,dragging:b,connectionInProgress:g}=le(iC,he),w=p&&(e||y),_=j.useRef(null),E=j.useRef(),C=j.useRef(new Set),S=j.useRef(new Set),q=j.useRef(!1),M=P=>{if(q.current||g){q.current=!1;return}u==null||u(P),x.getState().resetSelectedElements(),x.setState({nodesSelectionActive:!1})},R=P=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){P.preventDefault();return}c==null||c(P)},A=l?P=>l(P):void 0,$=P=>{q.current&&(P.stopPropagation(),q.current=!1)},N=P=>{var F,z;const{domNode:D}=x.getState();if(E.current=D==null?void 0:D.getBoundingClientRect(),!E.current)return;const B=P.target===_.current;if(!B&&!!P.target.closest(".nokey")||!e||!(a&&B||t)||P.button!==0||!P.isPrimary)return;(z=(F=P.target)==null?void 0:F.setPointerCapture)==null||z.call(F,P.pointerId),q.current=!1;const{x:Q,y:T}=Ge(P.nativeEvent,E.current);x.setState({userSelectionRect:{width:0,height:0,startX:Q,startY:T,x:Q,y:T}}),B||(P.stopPropagation(),P.preventDefault())},I=P=>{const{userSelectionRect:D,transform:B,nodeLookup:K,edgeLookup:H,connectionLookup:Q,triggerNodeChanges:T,triggerEdgeChanges:F,defaultEdgeOptions:z,resetSelectedElements:V}=x.getState();if(!E.current||!D)return;const{x:G,y:W}=Ge(P.nativeEvent,E.current),{startX:te,startY:ne}=D;if(!q.current){const ue=t?0:i;if(Math.hypot(G-te,W-ne)<=ue)return;V(),s==null||s(P)}q.current=!0;const ie={startX:te,startY:ne,x:G<te?G:te,y:W<ne?W:ne,width:Math.abs(G-te),height:Math.abs(W-ne)},J=C.current,se=S.current;C.current=new Set(Ll(K,ie,B,r===Ar.Partial,!0).map(ue=>ue.id)),S.current=new Set;const re=(z==null?void 0:z.selectable)??!0;for(const ue of C.current){const oe=Q.get(ue);if(oe)for(const{edgeId:Ne}of oe.values()){const me=H.get(Ne);me&&(me.selectable??re)&&S.current.add(Ne)}}if(!Md(J,C.current)){const ue=Ht(K,C.current,!0);T(ue)}if(!Md(se,S.current)){const ue=Ht(H,S.current);F(ue)}x.setState({userSelectionRect:ie,userSelectionActive:!0,nodesSelectionActive:!1})},k=P=>{var D,B;P.button===0&&((B=(D=P.target)==null?void 0:D.releasePointerCapture)==null||B.call(D,P.pointerId),!y&&P.target===_.current&&x.getState().userSelectionRect&&(M==null||M(P)),x.setState({userSelectionActive:!1,userSelectionRect:null}),q.current&&(o==null||o(P),x.setState({nodesSelectionActive:C.current.size>0})))},L=n===!0||Array.isArray(n)&&n.includes(0);return m.jsxs("div",{className:we(["react-flow__pane",{draggable:L,dragging:b,selection:e}]),onClick:w?void 0:Pi(M,_),onContextMenu:Pi(R,_),onWheel:Pi(A,_),onPointerEnter:w?void 0:d,onPointerMove:w?I:f,onPointerUp:w?k:void 0,onPointerDownCapture:w?N:void 0,onClickCapture:w?$:void 0,onPointerLeave:h,ref:_,style:Vn,children:[v,m.jsx(nC,{})]})}function xl({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:s,nodeLookup:o,onError:u}=t.getState(),c=o.get(e);if(!c){u==null||u("012",et.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(r||c.selected&&s)&&(a({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var l;return(l=n==null?void 0:n.current)==null?void 0:l.blur()})):i([e])}function n0({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:i,isSelectable:a,nodeClickDistance:s}){const o=pe(),[u,c]=j.useState(!1),l=j.useRef();return j.useEffect(()=>{l.current=QN({getStoreItems:()=>o.getState(),onNodeMouseDown:d=>{xl({id:d,store:o,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),j.useEffect(()=>{var d,f;if(t)(d=l.current)==null||d.destroy();else if(e.current)return(f=l.current)==null||f.update({noDragClassName:r,handleSelector:n,domNode:e.current,isSelectable:a,nodeId:i,nodeClickDistance:s}),()=>{var h;(h=l.current)==null||h.destroy()}},[r,n,t,a,e,i]),u}const sC=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function i0(){const e=pe();return j.useCallback(r=>{const{nodeExtent:n,snapToGrid:i,snapGrid:a,nodesDraggable:s,onError:o,updateNodePositions:u,nodeLookup:c,nodeOrigin:l}=e.getState(),d=new Map,f=sC(s),h=i?a[0]:5,v=i?a[1]:5,x=r.direction.x*h*r.factor,y=r.direction.y*v*r.factor;for(const[,p]of c){if(!f(p))continue;let b={x:p.internals.positionAbsolute.x+x,y:p.internals.positionAbsolute.y+y};i&&(b=Fr(b,a));const{position:g,positionAbsolute:w}=Ny({nodeId:p.id,nextPosition:b,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:o});p.position=g,p.internals.positionAbsolute=w,d.set(p.id,p)}u(d)},[])}const Gl=j.createContext(null),oC=Gl.Provider;Gl.Consumer;const a0=()=>j.useContext(Gl),uC=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),cC=(e,t,r)=>n=>{const{connectionClickStartHandle:i,connectionMode:a,connection:s}=n,{fromHandle:o,toHandle:u,isValid:c}=s,l=(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.id)===t&&(u==null?void 0:u.type)===r;return{connectingFrom:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===r,connectingTo:l,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===r,isPossibleEndHandle:a===Wt.Strict?(o==null?void 0:o.type)!==r:e!==(o==null?void 0:o.nodeId)||t!==(o==null?void 0:o.id),connectionInProcess:!!o,clickConnectionInProcess:!!i,valid:l&&c}};function lC({type:e="source",position:t=ee.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:i=!0,isConnectableEnd:a=!0,id:s,onConnect:o,children:u,className:c,onMouseDown:l,onTouchStart:d,...f},h){var I,k;const v=s||null,x=e==="target",y=pe(),p=a0(),{connectOnClick:b,noPanClassName:g,rfId:w}=le(uC,he),{connectingFrom:_,connectingTo:E,clickConnecting:C,isPossibleEndHandle:S,connectionInProcess:q,clickConnectionInProcess:M,valid:R}=le(cC(p,v,e),he);p||(k=(I=y.getState()).onError)==null||k.call(I,"010",et.error010());const A=L=>{const{defaultEdgeOptions:P,onConnect:D,hasDefaultEdges:B}=y.getState(),K={...P,...L};if(B){const{edges:H,setEdges:Q}=y.getState();Q(pl(K,H))}D==null||D(K),o==null||o(K)},$=L=>{if(!p)return;const P=Ay(L.nativeEvent);if(i&&(P&&L.button===0||!P)){const D=y.getState();yl.onPointerDown(L.nativeEvent,{handleDomNode:L.currentTarget,autoPanOnConnect:D.autoPanOnConnect,connectionMode:D.connectionMode,connectionRadius:D.connectionRadius,domNode:D.domNode,nodeLookup:D.nodeLookup,lib:D.lib,isTarget:x,handleId:v,nodeId:p,flowId:D.rfId,panBy:D.panBy,cancelConnection:D.cancelConnection,onConnectStart:D.onConnectStart,onConnectEnd:D.onConnectEnd,updateConnection:D.updateConnection,onConnect:A,isValidConnection:r||D.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:D.autoPanSpeed,dragThreshold:D.connectionDragThreshold})}P?l==null||l(L):d==null||d(L)},N=L=>{const{onClickConnectStart:P,onClickConnectEnd:D,connectionClickStartHandle:B,connectionMode:K,isValidConnection:H,lib:Q,rfId:T,nodeLookup:F,connection:z}=y.getState();if(!p||!B&&!i)return;if(!B){P==null||P(L.nativeEvent,{nodeId:p,handleId:v,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:p,type:e,id:v}});return}const V=qy(L.target),G=r||H,{connection:W,isValid:te}=yl.isValid(L.nativeEvent,{handle:{nodeId:p,id:v,type:e},connectionMode:K,fromNodeId:B.nodeId,fromHandleId:B.id||null,fromType:B.type,isValidConnection:G,flowId:T,doc:V,lib:Q,nodeLookup:F});te&&W&&A(W);const ne=structuredClone(z);delete ne.inProgress,ne.toPosition=ne.toHandle?ne.toHandle.position:null,D==null||D(L,ne),y.setState({connectionClickStartHandle:null})};return m.jsx("div",{"data-handleid":v,"data-nodeid":p,"data-handlepos":t,"data-id":`${w}-${p}-${v}-${e}`,className:we(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,c,{source:!x,target:x,connectable:n,connectablestart:i,connectableend:a,clickconnecting:C,connectingfrom:_,connectingto:E,valid:R,connectionindicator:n&&(!q||S)&&(q||M?a:i)}]),onMouseDown:$,onTouchStart:$,onClick:b?N:void 0,ref:h,...f,children:u})}const Ee=j.memo(t0(lC));function dC({data:e,isConnectable:t,sourcePosition:r=ee.Bottom}){return m.jsxs(m.Fragment,{children:[e==null?void 0:e.label,m.jsx(Ee,{type:"source",position:r,isConnectable:t})]})}function fC({data:e,isConnectable:t,targetPosition:r=ee.Top,sourcePosition:n=ee.Bottom}){return m.jsxs(m.Fragment,{children:[m.jsx(Ee,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,m.jsx(Ee,{type:"source",position:n,isConnectable:t})]})}function hC(){return null}function pC({data:e,isConnectable:t,targetPosition:r=ee.Top}){return m.jsxs(m.Fragment,{children:[m.jsx(Ee,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label]})}const An={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},sf={input:dC,default:fC,output:pC,group:hC};function gC(e){var t,r,n,i;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((r=e.style)==null?void 0:r.height)}:{width:e.width??((n=e.style)==null?void 0:n.width),height:e.height??((i=e.style)==null?void 0:i.height)}}const mC=e=>{const{width:t,height:r,x:n,y:i}=Or(e.nodeLookup,{filter:a=>!!a.selected});return{width:Ve(t)?t:null,height:Ve(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${n}px,${i}px)`}};function vC({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=pe(),{width:i,height:a,transformString:s,userSelectionActive:o}=le(mC,he),u=i0(),c=j.useRef(null);if(j.useEffect(()=>{var f;r||(f=c.current)==null||f.focus({preventScroll:!0})},[r]),n0({nodeRef:c}),o||!i||!a)return null;const l=e?f=>{const h=n.getState().nodes.filter(v=>v.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(An,f.key)&&(f.preventDefault(),u({direction:An[f.key],factor:f.shiftKey?4:1}))};return m.jsx("div",{className:we(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:m.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:l,tabIndex:r?void 0:-1,onKeyDown:r?void 0:d,style:{width:i,height:a}})})}const of=typeof window<"u"?window:void 0,yC=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function s0({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:s,paneClickDistance:o,deleteKeyCode:u,selectionKeyCode:c,selectionOnDrag:l,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:v,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:p,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:w,panOnScrollSpeed:_,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:S,defaultViewport:q,translateExtent:M,minZoom:R,maxZoom:A,preventScrolling:$,onSelectionContextMenu:N,noWheelClassName:I,noPanClassName:k,disableKeyboardA11y:L,onViewportChange:P,isControlledViewport:D}){const{nodesSelectionActive:B,userSelectionActive:K}=le(yC,he),H=Tr(c,{target:of}),Q=Tr(x,{target:of}),T=Q||S,F=Q||w,z=l&&T!==!0,V=H||K||z;return QE({deleteKeyCode:u,multiSelectionKeyCode:v}),m.jsx(tC,{onPaneContextMenu:a,elementsSelectable:p,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:F,panOnScrollSpeed:_,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:!H&&T,defaultViewport:q,translateExtent:M,minZoom:R,maxZoom:A,zoomActivationKeyCode:y,preventScrolling:$,noWheelClassName:I,noPanClassName:k,onViewportChange:P,isControlledViewport:D,paneClickDistance:o,selectionOnDrag:z,children:m.jsxs(aC,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:s,panOnDrag:T,isSelecting:!!V,selectionMode:d,selectionKeyPressed:H,paneClickDistance:o,selectionOnDrag:z,children:[e,B&&m.jsx(vC,{onSelectionContextMenu:N,noPanClassName:k,disableKeyboardA11y:L})]})})}s0.displayName="FlowRenderer";const xC=j.memo(s0),bC=e=>t=>e?Ll(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function wC(e){return le(j.useCallback(bC(e),[e]),he)}const _C=e=>e.updateNodeInternals;function NC(){const e=le(_C),[t]=j.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(i=>{const a=i.target.getAttribute("data-id");n.set(a,{id:a,nodeElement:i.target,force:!0})}),e(n)}));return j.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function EC({node:e,nodeType:t,hasDimensions:r,resizeObserver:n}){const i=pe(),a=j.useRef(null),s=j.useRef(null),o=j.useRef(e.sourcePosition),u=j.useRef(e.targetPosition),c=j.useRef(t),l=r&&!!e.internals.handleBounds;return j.useEffect(()=>{a.current&&!e.hidden&&(!l||s.current!==a.current)&&(s.current&&(n==null||n.unobserve(s.current)),n==null||n.observe(a.current),s.current=a.current)},[l,e.hidden]),j.useEffect(()=>()=>{s.current&&(n==null||n.unobserve(s.current),s.current=null)},[]),j.useEffect(()=>{if(a.current){const d=c.current!==t,f=o.current!==e.sourcePosition,h=u.current!==e.targetPosition;(d||f||h)&&(c.current=t,o.current=e.sourcePosition,u.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}function CC({id:e,onClick:t,onMouseEnter:r,onMouseMove:n,onMouseLeave:i,onContextMenu:a,onDoubleClick:s,nodesDraggable:o,elementsSelectable:u,nodesConnectable:c,nodesFocusable:l,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:v,rfId:x,nodeTypes:y,nodeClickDistance:p,onError:b}){const{node:g,internals:w,isParent:_}=le(G=>{const W=G.nodeLookup.get(e),te=G.parentLookup.has(e);return{node:W,internals:W.internals,isParent:te}},he);let E=g.type||"default",C=(y==null?void 0:y[E])||sf[E];C===void 0&&(b==null||b("003",et.error003(E)),E="default",C=(y==null?void 0:y.default)||sf.default);const S=!!(g.draggable||o&&typeof g.draggable>"u"),q=!!(g.selectable||u&&typeof g.selectable>"u"),M=!!(g.connectable||c&&typeof g.connectable>"u"),R=!!(g.focusable||l&&typeof g.focusable>"u"),A=pe(),$=Iy(g),N=EC({node:g,nodeType:E,hasDimensions:$,resizeObserver:d}),I=n0({nodeRef:N,disabled:g.hidden||!S,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:q,nodeClickDistance:p}),k=i0();if(g.hidden)return null;const L=dt(g),P=gC(g),D=q||S||t||r||n||i,B=r?G=>r(G,{...w.userNode}):void 0,K=n?G=>n(G,{...w.userNode}):void 0,H=i?G=>i(G,{...w.userNode}):void 0,Q=a?G=>a(G,{...w.userNode}):void 0,T=s?G=>s(G,{...w.userNode}):void 0,F=G=>{const{selectNodesOnDrag:W,nodeDragThreshold:te}=A.getState();q&&(!W||!S||te>0)&&xl({id:e,store:A,nodeRef:N}),t&&t(G,{...w.userNode})},z=G=>{if(!(ky(G.nativeEvent)||v)){if(yy.includes(G.key)&&q){const W=G.key==="Escape";xl({id:e,store:A,unselect:W,nodeRef:N})}else if(S&&g.selected&&Object.prototype.hasOwnProperty.call(An,G.key)){G.preventDefault();const{ariaLabelConfig:W}=A.getState();A.setState({ariaLiveMessage:W["node.a11yDescription.ariaLiveMessage"]({direction:G.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),k({direction:An[G.key],factor:G.shiftKey?4:1})}}},V=()=>{var se;if(v||!((se=N.current)!=null&&se.matches(":focus-visible")))return;const{transform:G,width:W,height:te,autoPanOnNodeFocus:ne,setCenter:ie}=A.getState();if(!ne)return;Ll(new Map([[e,g]]),{x:0,y:0,width:W,height:te},G,!0).length>0||ie(g.position.x+L.width/2,g.position.y+L.height/2,{zoom:G[2]})};return m.jsx("div",{className:we(["react-flow__node",`react-flow__node-${E}`,{[h]:S},g.className,{selected:g.selected,selectable:q,parent:_,draggable:S,dragging:I}]),ref:N,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:D?"all":"none",visibility:$?"visible":"hidden",...g.style,...P},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:B,onMouseMove:K,onMouseLeave:H,onContextMenu:Q,onClick:F,onDoubleClick:T,onKeyDown:R?z:void 0,tabIndex:R?0:void 0,onFocus:R?V:void 0,role:g.ariaRole??(R?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${Wy}-${x}`,"aria-label":g.ariaLabel,...g.domAttributes,children:m.jsx(oC,{value:e,children:m.jsx(C,{id:e,data:g.data,type:E,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:g.selected??!1,selectable:q,draggable:S,deletable:g.deletable??!0,isConnectable:M,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:I,dragHandle:g.dragHandle,zIndex:w.z,parentId:g.parentId,...L})})})}var SC=j.memo(CC);const IC=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function o0(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,onError:a}=le(IC,he),s=wC(e.onlyRenderVisibleElements),o=NC();return m.jsx("div",{className:"react-flow__nodes",style:Vn,children:s.map(u=>m.jsx(SC,{id:u,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:o,nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:a},u))})}o0.displayName="NodeRenderer";const RC=j.memo(o0);function qC(e){return le(j.useCallback(r=>{if(!e)return r.edges.map(i=>i.id);const n=[];if(r.width&&r.height)for(const i of r.edges){const a=r.nodeLookup.get(i.source),s=r.nodeLookup.get(i.target);a&&s&&TN({sourceNode:a,targetNode:s,width:r.width,height:r.height,transform:r.transform})&&n.push(i.id)}return n},[e]),he)}const kC=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return m.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},AC=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return m.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},uf={[Xt.Arrow]:kC,[Xt.ArrowClosed]:AC};function jC(e){const t=pe();return j.useMemo(()=>{var i,a;return Object.prototype.hasOwnProperty.call(uf,e)?uf[e]:((a=(i=t.getState()).onError)==null||a.call(i,"009",et.error009(e)),null)},[e])}const MC=({id:e,type:t,color:r,width:n=12.5,height:i=12.5,markerUnits:a="strokeWidth",strokeWidth:s,orient:o="auto-start-reverse"})=>{const u=jC(t);return u?m.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:o,refX:"0",refY:"0",children:m.jsx(u,{color:r,strokeWidth:s})}):null},u0=({defaultColor:e,rfId:t})=>{const r=le(a=>a.edges),n=le(a=>a.defaultEdgeOptions),i=j.useMemo(()=>zN(r,{id:t,defaultColor:e,defaultMarkerStart:n==null?void 0:n.markerStart,defaultMarkerEnd:n==null?void 0:n.markerEnd}),[r,n,t,e]);return i.length?m.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:m.jsx("defs",{children:i.map(a=>m.jsx(MC,{id:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient},a.id))})}):null};u0.displayName="MarkerDefinitions";var TC=j.memo(u0);function c0({x:e,y:t,label:r,labelStyle:n,labelShowBg:i=!0,labelBgStyle:a,labelBgPadding:s=[2,4],labelBgBorderRadius:o=2,children:u,className:c,...l}){const[d,f]=j.useState({x:1,y:0,width:0,height:0}),h=we(["react-flow__edge-textwrapper",c]),v=j.useRef(null);return j.useEffect(()=>{if(v.current){const x=v.current.getBBox();f({x:x.x,y:x.y,width:x.width,height:x.height})}},[r]),r?m.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...l,children:[i&&m.jsx("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:a,rx:o,ry:o}),m.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:v,style:n,children:r}),u]}):null}c0.displayName="EdgeText";const PC=j.memo(c0);function Gn({path:e,labelX:t,labelY:r,label:n,labelStyle:i,labelShowBg:a,labelBgStyle:s,labelBgPadding:o,labelBgBorderRadius:u,interactionWidth:c=20,...l}){return m.jsxs(m.Fragment,{children:[m.jsx("path",{...l,d:e,fill:"none",className:we(["react-flow__edge-path",l.className])}),c?m.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}):null,n&&Ve(t)&&Ve(r)?m.jsx(PC,{x:t,y:r,label:n,labelStyle:i,labelShowBg:a,labelBgStyle:s,labelBgPadding:o,labelBgBorderRadius:u}):null]})}function cf({pos:e,x1:t,y1:r,x2:n,y2:i}){return e===ee.Left||e===ee.Right?[.5*(t+n),r]:[t,.5*(r+i)]}function l0({sourceX:e,sourceY:t,sourcePosition:r=ee.Bottom,targetX:n,targetY:i,targetPosition:a=ee.Top}){const[s,o]=cf({pos:r,x1:e,y1:t,x2:n,y2:i}),[u,c]=cf({pos:a,x1:n,y1:i,x2:e,y2:t}),[l,d,f,h]=jy({sourceX:e,sourceY:t,targetX:n,targetY:i,sourceControlX:s,sourceControlY:o,targetControlX:u,targetControlY:c});return[`M${e},${t} C${s},${o} ${u},${c} ${n},${i}`,l,d,f,h]}function d0(e){return j.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:a,sourcePosition:s,targetPosition:o,label:u,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:v,markerEnd:x,markerStart:y,interactionWidth:p})=>{const[b,g,w]=l0({sourceX:r,sourceY:n,sourcePosition:s,targetX:i,targetY:a,targetPosition:o}),_=e.isInternal?void 0:t;return m.jsx(Gn,{id:_,path:b,labelX:g,labelY:w,label:u,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:v,markerEnd:x,markerStart:y,interactionWidth:p})})}const DC=d0({isInternal:!1}),f0=d0({isInternal:!0});DC.displayName="SimpleBezierEdge";f0.displayName="SimpleBezierEdgeInternal";function h0(e){return j.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:a,label:s,labelStyle:o,labelShowBg:u,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:f,sourcePosition:h=ee.Bottom,targetPosition:v=ee.Top,markerEnd:x,markerStart:y,pathOptions:p,interactionWidth:b})=>{const[g,w,_]=gl({sourceX:r,sourceY:n,sourcePosition:h,targetX:i,targetY:a,targetPosition:v,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset,stepPosition:p==null?void 0:p.stepPosition}),E=e.isInternal?void 0:t;return m.jsx(Gn,{id:E,path:g,labelX:w,labelY:_,label:s,labelStyle:o,labelShowBg:u,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:x,markerStart:y,interactionWidth:b})})}const p0=h0({isInternal:!1}),g0=h0({isInternal:!0});p0.displayName="SmoothStepEdge";g0.displayName="SmoothStepEdgeInternal";function m0(e){return j.memo(({id:t,...r})=>{var i;const n=e.isInternal?void 0:t;return m.jsx(p0,{...r,id:n,pathOptions:j.useMemo(()=>{var a;return{borderRadius:0,offset:(a=r.pathOptions)==null?void 0:a.offset}},[(i=r.pathOptions)==null?void 0:i.offset])})})}const LC=m0({isInternal:!1}),v0=m0({isInternal:!0});LC.displayName="StepEdge";v0.displayName="StepEdgeInternal";function y0(e){return j.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:a,label:s,labelStyle:o,labelShowBg:u,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:v,interactionWidth:x})=>{const[y,p,b]=Py({sourceX:r,sourceY:n,targetX:i,targetY:a}),g=e.isInternal?void 0:t;return m.jsx(Gn,{id:g,path:y,labelX:p,labelY:b,label:s,labelStyle:o,labelShowBg:u,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:v,interactionWidth:x})})}const OC=y0({isInternal:!1}),x0=y0({isInternal:!0});OC.displayName="StraightEdge";x0.displayName="StraightEdgeInternal";function b0(e){return j.memo(({id:t,sourceX:r,sourceY:n,targetX:i,targetY:a,sourcePosition:s=ee.Bottom,targetPosition:o=ee.Top,label:u,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:v,markerEnd:x,markerStart:y,pathOptions:p,interactionWidth:b})=>{const[g,w,_]=My({sourceX:r,sourceY:n,sourcePosition:s,targetX:i,targetY:a,targetPosition:o,curvature:p==null?void 0:p.curvature}),E=e.isInternal?void 0:t;return m.jsx(Gn,{id:E,path:g,labelX:w,labelY:_,label:u,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:v,markerEnd:x,markerStart:y,interactionWidth:b})})}const FC=b0({isInternal:!1}),w0=b0({isInternal:!0});FC.displayName="BezierEdge";w0.displayName="BezierEdgeInternal";const lf={default:w0,straight:x0,step:v0,smoothstep:g0,simplebezier:f0},df={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},$C=(e,t,r)=>r===ee.Left?e-t:r===ee.Right?e+t:e,zC=(e,t,r)=>r===ee.Top?e-t:r===ee.Bottom?e+t:e,ff="react-flow__edgeupdater";function hf({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:i,onMouseEnter:a,onMouseOut:s,type:o}){return m.jsx("circle",{onMouseDown:i,onMouseEnter:a,onMouseOut:s,className:we([ff,`${ff}-${o}`]),cx:$C(t,n,e),cy:zC(r,n,e),r:n,stroke:"transparent",fill:"transparent"})}function BC({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:n,sourceY:i,targetX:a,targetY:s,sourcePosition:o,targetPosition:u,onReconnect:c,onReconnectStart:l,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const v=pe(),x=(w,_)=>{if(w.button!==0)return;const{autoPanOnConnect:E,domNode:C,isValidConnection:S,connectionMode:q,connectionRadius:M,lib:R,onConnectStart:A,onConnectEnd:$,cancelConnection:N,nodeLookup:I,rfId:k,panBy:L,updateConnection:P}=v.getState(),D=_.type==="target",B=(Q,T)=>{f(!1),d==null||d(Q,r,_.type,T)},K=Q=>c==null?void 0:c(r,Q),H=(Q,T)=>{f(!0),l==null||l(w,r,_.type),A==null||A(Q,T)};yl.onPointerDown(w.nativeEvent,{autoPanOnConnect:E,connectionMode:q,connectionRadius:M,domNode:C,handleId:_.id,nodeId:_.nodeId,nodeLookup:I,isTarget:D,edgeUpdaterType:_.type,lib:R,flowId:k,cancelConnection:N,panBy:L,isValidConnection:S,onConnect:K,onConnectStart:H,onConnectEnd:$,onReconnectEnd:B,updateConnection:P,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,dragThreshold:v.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},y=w=>x(w,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),p=w=>x(w,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),b=()=>h(!0),g=()=>h(!1);return m.jsxs(m.Fragment,{children:[(e===!0||e==="source")&&m.jsx(hf,{position:o,centerX:n,centerY:i,radius:t,onMouseDown:y,onMouseEnter:b,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&m.jsx(hf,{position:u,centerX:a,centerY:s,radius:t,onMouseDown:p,onMouseEnter:b,onMouseOut:g,type:"target"})]})}function HC({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:n,onClick:i,onDoubleClick:a,onContextMenu:s,onMouseEnter:o,onMouseMove:u,onMouseLeave:c,reconnectRadius:l,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:v,edgeTypes:x,noPanClassName:y,onError:p,disableKeyboardA11y:b}){let g=le(ie=>ie.edgeLookup.get(e));const w=le(ie=>ie.defaultEdgeOptions);g=w?{...w,...g}:g;let _=g.type||"default",E=(x==null?void 0:x[_])||lf[_];E===void 0&&(p==null||p("011",et.error011(_)),_="default",E=(x==null?void 0:x.default)||lf.default);const C=!!(g.focusable||t&&typeof g.focusable>"u"),S=typeof d<"u"&&(g.reconnectable||r&&typeof g.reconnectable>"u"),q=!!(g.selectable||n&&typeof g.selectable>"u"),M=j.useRef(null),[R,A]=j.useState(!1),[$,N]=j.useState(!1),I=pe(),{zIndex:k,sourceX:L,sourceY:P,targetX:D,targetY:B,sourcePosition:K,targetPosition:H}=le(j.useCallback(ie=>{const J=ie.nodeLookup.get(g.source),se=ie.nodeLookup.get(g.target);if(!J||!se)return{zIndex:g.zIndex,...df};const re=$N({id:e,sourceNode:J,targetNode:se,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:ie.connectionMode,onError:p});return{zIndex:MN({selected:g.selected,zIndex:g.zIndex,sourceNode:J,targetNode:se,elevateOnSelect:ie.elevateEdgesOnSelect,zIndexMode:ie.zIndexMode}),...re||df}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),he),Q=j.useMemo(()=>g.markerStart?`url('#${ml(g.markerStart,v)}')`:void 0,[g.markerStart,v]),T=j.useMemo(()=>g.markerEnd?`url('#${ml(g.markerEnd,v)}')`:void 0,[g.markerEnd,v]);if(g.hidden||L===null||P===null||D===null||B===null)return null;const F=ie=>{var ue;const{addSelectedEdges:J,unselectNodesAndEdges:se,multiSelectionActive:re}=I.getState();q&&(I.setState({nodesSelectionActive:!1}),g.selected&&re?(se({nodes:[],edges:[g]}),(ue=M.current)==null||ue.blur()):J([e])),i&&i(ie,g)},z=a?ie=>{a(ie,{...g})}:void 0,V=s?ie=>{s(ie,{...g})}:void 0,G=o?ie=>{o(ie,{...g})}:void 0,W=u?ie=>{u(ie,{...g})}:void 0,te=c?ie=>{c(ie,{...g})}:void 0,ne=ie=>{var J;if(!b&&yy.includes(ie.key)&&q){const{unselectNodesAndEdges:se,addSelectedEdges:re}=I.getState();ie.key==="Escape"?((J=M.current)==null||J.blur(),se({edges:[g]})):re([e])}};return m.jsx("svg",{style:{zIndex:k},children:m.jsxs("g",{className:we(["react-flow__edge",`react-flow__edge-${_}`,g.className,y,{selected:g.selected,animated:g.animated,inactive:!q&&!i,updating:R,selectable:q}]),onClick:F,onDoubleClick:z,onContextMenu:V,onMouseEnter:G,onMouseMove:W,onMouseLeave:te,onKeyDown:C?ne:void 0,tabIndex:C?0:void 0,role:g.ariaRole??(C?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":C?`${Xy}-${v}`:void 0,ref:M,...g.domAttributes,children:[!$&&m.jsx(E,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:q,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:L,sourceY:P,targetX:D,targetY:B,sourcePosition:K,targetPosition:H,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:Q,markerEnd:T,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),S&&m.jsx(BC,{edge:g,isReconnectable:S,reconnectRadius:l,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:L,sourceY:P,targetX:D,targetY:B,sourcePosition:K,targetPosition:H,setUpdateHover:A,setReconnecting:N})]})})}var VC=j.memo(HC);const GC=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function _0({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:n,noPanClassName:i,onReconnect:a,onEdgeContextMenu:s,onEdgeMouseEnter:o,onEdgeMouseMove:u,onEdgeMouseLeave:c,onEdgeClick:l,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:v,disableKeyboardA11y:x}){const{edgesFocusable:y,edgesReconnectable:p,elementsSelectable:b,onError:g}=le(GC,he),w=qC(t);return m.jsxs("div",{className:"react-flow__edges",children:[m.jsx(TC,{defaultColor:e,rfId:r}),w.map(_=>m.jsx(VC,{id:_,edgesFocusable:y,edgesReconnectable:p,elementsSelectable:b,noPanClassName:i,onReconnect:a,onContextMenu:s,onMouseEnter:o,onMouseMove:u,onMouseLeave:c,onClick:l,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:v,rfId:r,onError:g,edgeTypes:n,disableKeyboardA11y:x},_))]})}_0.displayName="EdgeRenderer";const UC=j.memo(_0),KC=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function YC({children:e}){const t=le(KC);return m.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function WC(e){const t=Br(),r=j.useRef(!1);j.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const XC=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function ZC(e){const t=le(XC),r=pe();return j.useEffect(()=>{e&&(t==null||t(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function QC(e){return e.connection.inProgress?{...e.connection,to:$r(e.connection.to,e.transform)}:{...e.connection}}function JC(e){return QC}function eS(e){const t=JC();return le(t,he)}const tS=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function rS({containerStyle:e,style:t,type:r,component:n}){const{nodesConnectable:i,width:a,height:s,isValid:o,inProgress:u}=le(tS,he);return!(a&&i&&u)?null:m.jsx("svg",{style:e,width:a,height:s,className:"react-flow__connectionline react-flow__container",children:m.jsx("g",{className:we(["react-flow__connection",wy(o)]),children:m.jsx(N0,{style:t,type:r,CustomComponent:n,isValid:o})})})}const N0=({style:e,type:t=bt.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:i,from:a,fromNode:s,fromHandle:o,fromPosition:u,to:c,toNode:l,toHandle:d,toPosition:f,pointer:h}=eS();if(!i)return;if(r)return m.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:o,fromX:a.x,fromY:a.y,toX:c.x,toY:c.y,fromPosition:u,toPosition:f,connectionStatus:wy(n),toNode:l,toHandle:d,pointer:h});let v="";const x={sourceX:a.x,sourceY:a.y,sourcePosition:u,targetX:c.x,targetY:c.y,targetPosition:f};switch(t){case bt.Bezier:[v]=My(x);break;case bt.SimpleBezier:[v]=l0(x);break;case bt.Step:[v]=gl({...x,borderRadius:0});break;case bt.SmoothStep:[v]=gl(x);break;default:[v]=Py(x)}return m.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:e})};N0.displayName="ConnectionLine";const nS={};function pf(e=nS){j.useRef(e),pe(),j.useEffect(()=>{},[e])}function iS(){pe(),j.useRef(!1),j.useEffect(()=>{},[])}function E0({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:n,onEdgeClick:i,onNodeDoubleClick:a,onEdgeDoubleClick:s,onNodeMouseEnter:o,onNodeMouseMove:u,onNodeMouseLeave:c,onNodeContextMenu:l,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:v,connectionLineStyle:x,connectionLineComponent:y,connectionLineContainerStyle:p,selectionKeyCode:b,selectionOnDrag:g,selectionMode:w,multiSelectionKeyCode:_,panActivationKeyCode:E,zoomActivationKeyCode:C,deleteKeyCode:S,onlyRenderVisibleElements:q,elementsSelectable:M,defaultViewport:R,translateExtent:A,minZoom:$,maxZoom:N,preventScrolling:I,defaultMarkerColor:k,zoomOnScroll:L,zoomOnPinch:P,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:K,zoomOnDoubleClick:H,panOnDrag:Q,onPaneClick:T,onPaneMouseEnter:F,onPaneMouseMove:z,onPaneMouseLeave:V,onPaneScroll:G,onPaneContextMenu:W,paneClickDistance:te,nodeClickDistance:ne,onEdgeContextMenu:ie,onEdgeMouseEnter:J,onEdgeMouseMove:se,onEdgeMouseLeave:re,reconnectRadius:ue,onReconnect:oe,onReconnectStart:Ne,onReconnectEnd:me,noDragClassName:Ae,noWheelClassName:ye,noPanClassName:xe,disableKeyboardA11y:ve,nodeExtent:We,rfId:je,viewport:Xe,onViewportChange:de}){return pf(e),pf(t),iS(),WC(r),ZC(Xe),m.jsx(xC,{onPaneClick:T,onPaneMouseEnter:F,onPaneMouseMove:z,onPaneMouseLeave:V,onPaneContextMenu:W,onPaneScroll:G,paneClickDistance:te,deleteKeyCode:S,selectionKeyCode:b,selectionOnDrag:g,selectionMode:w,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:_,panActivationKeyCode:E,zoomActivationKeyCode:C,elementsSelectable:M,zoomOnScroll:L,zoomOnPinch:P,zoomOnDoubleClick:H,panOnScroll:D,panOnScrollSpeed:B,panOnScrollMode:K,panOnDrag:Q,defaultViewport:R,translateExtent:A,minZoom:$,maxZoom:N,onSelectionContextMenu:d,preventScrolling:I,noDragClassName:Ae,noWheelClassName:ye,noPanClassName:xe,disableKeyboardA11y:ve,onViewportChange:de,isControlledViewport:!!Xe,children:m.jsxs(YC,{children:[m.jsx(UC,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:s,onReconnect:oe,onReconnectStart:Ne,onReconnectEnd:me,onlyRenderVisibleElements:q,onEdgeContextMenu:ie,onEdgeMouseEnter:J,onEdgeMouseMove:se,onEdgeMouseLeave:re,reconnectRadius:ue,defaultMarkerColor:k,noPanClassName:xe,disableKeyboardA11y:ve,rfId:je}),m.jsx(rS,{style:x,type:v,component:y,containerStyle:p}),m.jsx("div",{className:"react-flow__edgelabel-renderer"}),m.jsx(RC,{nodeTypes:e,onNodeClick:n,onNodeDoubleClick:a,onNodeMouseEnter:o,onNodeMouseMove:u,onNodeMouseLeave:c,onNodeContextMenu:l,nodeClickDistance:ne,onlyRenderVisibleElements:q,noPanClassName:xe,noDragClassName:Ae,disableKeyboardA11y:ve,nodeExtent:We,rfId:je}),m.jsx("div",{className:"react-flow__viewport-portal"})]})})}E0.displayName="GraphView";const aS=j.memo(E0),gf=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:a,fitView:s,fitViewOptions:o,minZoom:u=.5,maxZoom:c=2,nodeOrigin:l,nodeExtent:d,zIndexMode:f="basic"}={})=>{const h=new Map,v=new Map,x=new Map,y=new Map,p=n??t??[],b=r??e??[],g=l??[0,0],w=d??kr;Oy(x,y,p);const _=vl(b,h,v,{nodeOrigin:g,nodeExtent:w,zIndexMode:f});let E=[0,0,1];if(s&&i&&a){const C=Or(h,{filter:R=>!!((R.width||R.initialWidth)&&(R.height||R.initialHeight))}),{x:S,y:q,zoom:M}=Ol(C,i,a,u,c,(o==null?void 0:o.padding)??.1);E=[S,q,M]}return{rfId:"1",width:i??0,height:a??0,transform:E,nodes:b,nodesInitialized:_,nodeLookup:h,parentLookup:v,edges:p,edgeLookup:y,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:u,maxZoom:c,translateExtent:kr,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Wt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:o,fitViewResolver:null,connection:{...by},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:IN,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:xy,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},sS=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:a,fitView:s,fitViewOptions:o,minZoom:u,maxZoom:c,nodeOrigin:l,nodeExtent:d,zIndexMode:f})=>EE((h,v)=>{async function x(){const{nodeLookup:y,panZoom:p,fitViewOptions:b,fitViewResolver:g,width:w,height:_,minZoom:E,maxZoom:C}=v();p&&(await CN({nodes:y,width:w,height:_,panZoom:p,minZoom:E,maxZoom:C},b),g==null||g.resolve(!0),h({fitViewResolver:null}))}return{...gf({nodes:e,edges:t,width:i,height:a,fitView:s,fitViewOptions:o,minZoom:u,maxZoom:c,nodeOrigin:l,nodeExtent:d,defaultNodes:r,defaultEdges:n,zIndexMode:f}),setNodes:y=>{const{nodeLookup:p,parentLookup:b,nodeOrigin:g,elevateNodesOnSelect:w,fitViewQueued:_,zIndexMode:E}=v(),C=vl(y,p,b,{nodeOrigin:g,nodeExtent:d,elevateNodesOnSelect:w,checkEquality:!0,zIndexMode:E});_&&C?(x(),h({nodes:y,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:y,nodesInitialized:C})},setEdges:y=>{const{connectionLookup:p,edgeLookup:b}=v();Oy(p,b,y),h({edges:y})},setDefaultNodesAndEdges:(y,p)=>{if(y){const{setNodes:b}=v();b(y),h({hasDefaultNodes:!0})}if(p){const{setEdges:b}=v();b(p),h({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:p,nodeLookup:b,parentLookup:g,domNode:w,nodeOrigin:_,nodeExtent:E,debug:C,fitViewQueued:S,zIndexMode:q}=v(),{changes:M,updatedInternals:R}=YN(y,b,g,w,_,E,q);R&&(VN(b,g,{nodeOrigin:_,nodeExtent:E,zIndexMode:q}),S?(x(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),(M==null?void 0:M.length)>0&&(C&&console.log("React Flow: trigger node changes",M),p==null||p(M)))},updateNodePositions:(y,p=!1)=>{const b=[];let g=[];const{nodeLookup:w,triggerNodeChanges:_,connection:E,updateConnection:C,onNodesChangeMiddlewareMap:S}=v();for(const[q,M]of y){const R=w.get(q),A=!!(R!=null&&R.expandParent&&(R!=null&&R.parentId)&&(M!=null&&M.position)),$={id:q,type:"position",position:A?{x:Math.max(0,M.position.x),y:Math.max(0,M.position.y)}:M.position,dragging:p};if(R&&E.inProgress&&E.fromNode.id===R.id){const N=jt(R,E.fromHandle,ee.Left,!0);C({...E,from:N})}A&&R.parentId&&b.push({id:q,parentId:R.parentId,rect:{...M.internals.positionAbsolute,width:M.measured.width??0,height:M.measured.height??0}}),g.push($)}if(b.length>0){const{parentLookup:q,nodeOrigin:M}=v(),R=Vl(b,w,q,M);g.push(...R)}for(const q of S.values())g=q(g);_(g)},triggerNodeChanges:y=>{const{onNodesChange:p,setNodes:b,nodes:g,hasDefaultNodes:w,debug:_}=v();if(y!=null&&y.length){if(w){const E=Jy(y,g);b(E)}_&&console.log("React Flow: trigger node changes",y),p==null||p(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:p,setEdges:b,edges:g,hasDefaultEdges:w,debug:_}=v();if(y!=null&&y.length){if(w){const E=e0(y,g);b(E)}_&&console.log("React Flow: trigger edge changes",y),p==null||p(y)}},addSelectedNodes:y=>{const{multiSelectionActive:p,edgeLookup:b,nodeLookup:g,triggerNodeChanges:w,triggerEdgeChanges:_}=v();if(p){const E=y.map(C=>Ct(C,!0));w(E);return}w(Ht(g,new Set([...y]),!0)),_(Ht(b))},addSelectedEdges:y=>{const{multiSelectionActive:p,edgeLookup:b,nodeLookup:g,triggerNodeChanges:w,triggerEdgeChanges:_}=v();if(p){const E=y.map(C=>Ct(C,!0));_(E);return}_(Ht(b,new Set([...y]))),w(Ht(g,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:p}={})=>{const{edges:b,nodes:g,nodeLookup:w,triggerNodeChanges:_,triggerEdgeChanges:E}=v(),C=y||g,S=p||b,q=C.map(R=>{const A=w.get(R.id);return A&&(A.selected=!1),Ct(R.id,!1)}),M=S.map(R=>Ct(R.id,!1));_(q),E(M)},setMinZoom:y=>{const{panZoom:p,maxZoom:b}=v();p==null||p.setScaleExtent([y,b]),h({minZoom:y})},setMaxZoom:y=>{const{panZoom:p,minZoom:b}=v();p==null||p.setScaleExtent([b,y]),h({maxZoom:y})},setTranslateExtent:y=>{var p;(p=v().panZoom)==null||p.setTranslateExtent(y),h({translateExtent:y})},resetSelectedElements:()=>{const{edges:y,nodes:p,triggerNodeChanges:b,triggerEdgeChanges:g,elementsSelectable:w}=v();if(!w)return;const _=p.reduce((C,S)=>S.selected?[...C,Ct(S.id,!1)]:C,[]),E=y.reduce((C,S)=>S.selected?[...C,Ct(S.id,!1)]:C,[]);b(_),g(E)},setNodeExtent:y=>{const{nodes:p,nodeLookup:b,parentLookup:g,nodeOrigin:w,elevateNodesOnSelect:_,nodeExtent:E,zIndexMode:C}=v();y[0][0]===E[0][0]&&y[0][1]===E[0][1]&&y[1][0]===E[1][0]&&y[1][1]===E[1][1]||(vl(p,b,g,{nodeOrigin:w,nodeExtent:y,elevateNodesOnSelect:_,checkEquality:!1,zIndexMode:C}),h({nodeExtent:y}))},panBy:y=>{const{transform:p,width:b,height:g,panZoom:w,translateExtent:_}=v();return WN({delta:y,panZoom:w,transform:p,translateExtent:_,width:b,height:g})},setCenter:async(y,p,b)=>{const{width:g,height:w,maxZoom:_,panZoom:E}=v();if(!E)return Promise.resolve(!1);const C=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:_;return await E.setViewport({x:g/2-y*C,y:w/2-p*C,zoom:C},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...by}})},updateConnection:y=>{h({connection:y})},reset:()=>h({...gf()})}},Object.is);function oS({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:n,initialWidth:i,initialHeight:a,initialMinZoom:s,initialMaxZoom:o,initialFitViewOptions:u,fitView:c,nodeOrigin:l,nodeExtent:d,zIndexMode:f,children:h}){const[v]=j.useState(()=>sS({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:i,height:a,fitView:c,minZoom:s,maxZoom:o,fitViewOptions:u,nodeOrigin:l,nodeExtent:d,zIndexMode:f}));return m.jsx(CE,{value:v,children:m.jsx(YE,{children:h})})}function uS({children:e,nodes:t,edges:r,defaultNodes:n,defaultEdges:i,width:a,height:s,fitView:o,fitViewOptions:u,minZoom:c,maxZoom:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h}){return j.useContext(Hn)?m.jsx(m.Fragment,{children:e}):m.jsx(oS,{initialNodes:t,initialEdges:r,defaultNodes:n,defaultEdges:i,initialWidth:a,initialHeight:s,fitView:o,initialFitViewOptions:u,initialMinZoom:c,initialMaxZoom:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h,children:e})}const cS={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function lS({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:i,nodeTypes:a,edgeTypes:s,onNodeClick:o,onEdgeClick:u,onInit:c,onMove:l,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:y,onClickConnectEnd:p,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:_,onNodeDoubleClick:E,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:q,onNodesDelete:M,onEdgesDelete:R,onDelete:A,onSelectionChange:$,onSelectionDragStart:N,onSelectionDrag:I,onSelectionDragStop:k,onSelectionContextMenu:L,onSelectionStart:P,onSelectionEnd:D,onBeforeDelete:B,connectionMode:K,connectionLineType:H=bt.Bezier,connectionLineStyle:Q,connectionLineComponent:T,connectionLineContainerStyle:F,deleteKeyCode:z="Backspace",selectionKeyCode:V="Shift",selectionOnDrag:G=!1,selectionMode:W=Ar.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:ne=Mr()?"Meta":"Control",zoomActivationKeyCode:ie=Mr()?"Meta":"Control",snapToGrid:J,snapGrid:se,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ue,nodesDraggable:oe,autoPanOnNodeFocus:Ne,nodesConnectable:me,nodesFocusable:Ae,nodeOrigin:ye=Zy,edgesFocusable:xe,edgesReconnectable:ve,elementsSelectable:We=!0,defaultViewport:je=OE,minZoom:Xe=.5,maxZoom:de=2,translateExtent:Me=kr,preventScrolling:nt=!0,nodeExtent:it,defaultMarkerColor:Lt="#b1b1b7",zoomOnScroll:Oe=!0,zoomOnPinch:Te=!0,panOnScroll:Fe=!1,panOnScrollSpeed:ci=.5,panOnScrollMode:li=Rt.Free,zoomOnDoubleClick:di=!0,panOnDrag:Yr=!0,onPaneClick:fi,onPaneMouseEnter:Ze,onPaneMouseMove:pt,onPaneMouseLeave:gt,onPaneScroll:sr,onPaneContextMenu:mt,paneClickDistance:hi=1,nodeClickDistance:pi=0,children:at,onReconnect:Nt,onReconnectStart:gi,onReconnectEnd:mi,onEdgeContextMenu:vi,onEdgeDoubleClick:Wr,onEdgeMouseEnter:Xr,onEdgeMouseMove:yi,onEdgeMouseLeave:or,reconnectRadius:ur=10,onNodesChange:xi,onEdgesChange:bi,noDragClassName:Et="nodrag",noWheelClassName:wi="nowheel",noPanClassName:Zr="nopan",fitView:Qr,fitViewOptions:cr,connectOnClick:Jr,attributionPosition:O,proOptions:U,defaultEdgeOptions:X,elevateNodesOnSelect:Y=!0,elevateEdgesOnSelect:Z=!1,disableKeyboardA11y:ae=!1,autoPanOnConnect:ce,autoPanOnNodeDrag:fe,autoPanSpeed:Pe,connectionRadius:$e,isValidConnection:st,onError:en,style:lr,id:Ot,nodeDragThreshold:_i,connectionDragThreshold:dr,viewport:Ce,onViewportChange:fr,width:Ni,height:Tx,colorMode:Px="light",debug:Dx,onScroll:tn,ariaLabelConfig:Lx,zIndexMode:ld="basic",...Ox},Fx){const Ei=Ot||"1",$x=BE(Px),zx=j.useCallback(dd=>{dd.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),tn==null||tn(dd)},[tn]);return m.jsx("div",{"data-testid":"rf__wrapper",...Ox,onScroll:zx,style:{...lr,...cS},ref:Fx,className:we(["react-flow",i,$x]),id:Ot,role:"application",children:m.jsxs(uS,{nodes:e,edges:t,width:Ni,height:Tx,fitView:Qr,fitViewOptions:cr,minZoom:Xe,maxZoom:de,nodeOrigin:ye,nodeExtent:it,zIndexMode:ld,children:[m.jsx(aS,{onInit:c,onNodeClick:o,onEdgeClick:u,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:_,onNodeDoubleClick:E,nodeTypes:a,edgeTypes:s,connectionLineType:H,connectionLineStyle:Q,connectionLineComponent:T,connectionLineContainerStyle:F,selectionKeyCode:V,selectionOnDrag:G,selectionMode:W,deleteKeyCode:z,multiSelectionKeyCode:ne,panActivationKeyCode:te,zoomActivationKeyCode:ie,onlyRenderVisibleElements:re,defaultViewport:je,translateExtent:Me,minZoom:Xe,maxZoom:de,preventScrolling:nt,zoomOnScroll:Oe,zoomOnPinch:Te,zoomOnDoubleClick:di,panOnScroll:Fe,panOnScrollSpeed:ci,panOnScrollMode:li,panOnDrag:Yr,onPaneClick:fi,onPaneMouseEnter:Ze,onPaneMouseMove:pt,onPaneMouseLeave:gt,onPaneScroll:sr,onPaneContextMenu:mt,paneClickDistance:hi,nodeClickDistance:pi,onSelectionContextMenu:L,onSelectionStart:P,onSelectionEnd:D,onReconnect:Nt,onReconnectStart:gi,onReconnectEnd:mi,onEdgeContextMenu:vi,onEdgeDoubleClick:Wr,onEdgeMouseEnter:Xr,onEdgeMouseMove:yi,onEdgeMouseLeave:or,reconnectRadius:ur,defaultMarkerColor:Lt,noDragClassName:Et,noWheelClassName:wi,noPanClassName:Zr,rfId:Ei,disableKeyboardA11y:ae,nodeExtent:it,viewport:Ce,onViewportChange:fr}),m.jsx(zE,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:y,onClickConnectEnd:p,nodesDraggable:oe,autoPanOnNodeFocus:Ne,nodesConnectable:me,nodesFocusable:Ae,edgesFocusable:xe,edgesReconnectable:ve,elementsSelectable:We,elevateNodesOnSelect:Y,elevateEdgesOnSelect:Z,minZoom:Xe,maxZoom:de,nodeExtent:it,onNodesChange:xi,onEdgesChange:bi,snapToGrid:J,snapGrid:se,connectionMode:K,translateExtent:Me,connectOnClick:Jr,defaultEdgeOptions:X,fitView:Qr,fitViewOptions:cr,onNodesDelete:M,onEdgesDelete:R,onDelete:A,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:q,onSelectionDrag:I,onSelectionDragStart:N,onSelectionDragStop:k,onMove:l,onMoveStart:d,onMoveEnd:f,noPanClassName:Zr,nodeOrigin:ye,rfId:Ei,autoPanOnConnect:ce,autoPanOnNodeDrag:fe,autoPanSpeed:Pe,onError:en,connectionRadius:$e,isValidConnection:st,selectNodesOnDrag:ue,nodeDragThreshold:_i,connectionDragThreshold:dr,onBeforeDelete:B,debug:Dx,ariaLabelConfig:Lx,zIndexMode:ld}),m.jsx(LE,{onSelectionChange:$}),at,m.jsx(jE,{proOptions:U,position:O}),m.jsx(AE,{rfId:Ei,disableKeyboardA11y:ae})]})})}var dS=t0(lS);function fS(e){const[t,r]=j.useState(e),n=j.useCallback(i=>r(a=>Jy(i,a)),[]);return[t,r,n]}function hS(e){const[t,r]=j.useState(e),n=j.useCallback(i=>r(a=>e0(i,a)),[]);return[t,r,n]}function pS({dimensions:e,lineWidth:t,variant:r,className:n}){return m.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:we(["react-flow__background-pattern",r,n])})}function gS({radius:e,className:t}){return m.jsx("circle",{cx:e,cy:e,r:e,className:we(["react-flow__background-pattern","dots",t])})}var wt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(wt||(wt={}));const mS={[wt.Dots]:1,[wt.Lines]:1,[wt.Cross]:6},vS=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function C0({id:e,variant:t=wt.Dots,gap:r=20,size:n,lineWidth:i=1,offset:a=0,color:s,bgColor:o,style:u,className:c,patternClassName:l}){const d=j.useRef(null),{transform:f,patternId:h}=le(vS,he),v=n||mS[t],x=t===wt.Dots,y=t===wt.Cross,p=Array.isArray(r)?r:[r,r],b=[p[0]*f[2]||1,p[1]*f[2]||1],g=v*f[2],w=Array.isArray(a)?a:[a,a],_=y?[g,g]:b,E=[w[0]*f[2]||1+_[0]/2,w[1]*f[2]||1+_[1]/2],C=`${h}${e||""}`;return m.jsxs("svg",{className:we(["react-flow__background",c]),style:{...u,...Vn,"--xy-background-color-props":o,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[m.jsx("pattern",{id:C,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:x?m.jsx(gS,{radius:g/2,className:l}):m.jsx(pS,{dimensions:_,lineWidth:i,variant:t,className:l})}),m.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}C0.displayName="Background";const yS=j.memo(C0);function xS(){return m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:m.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function bS(){return m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:m.jsx("path",{d:"M0 0h32v4.2H0z"})})}function wS(){return m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:m.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function _S(){return m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:m.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function NS(){return m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:m.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function fn({children:e,className:t,...r}){return m.jsx("button",{type:"button",className:we(["react-flow__controls-button",t]),...r,children:e})}const ES=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function S0({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:s,onFitView:o,onInteractiveChange:u,className:c,children:l,position:d="bottom-left",orientation:f="vertical","aria-label":h}){const v=pe(),{isInteractive:x,minZoomReached:y,maxZoomReached:p,ariaLabelConfig:b}=le(ES,he),{zoomIn:g,zoomOut:w,fitView:_}=Br(),E=()=>{g(),a==null||a()},C=()=>{w(),s==null||s()},S=()=>{_(i),o==null||o()},q=()=>{v.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),u==null||u(!x)},M=f==="horizontal"?"horizontal":"vertical";return m.jsxs(zr,{className:we(["react-flow__controls",M,c]),position:d,style:e,"data-testid":"rf__controls","aria-label":h??b["controls.ariaLabel"],children:[t&&m.jsxs(m.Fragment,{children:[m.jsx(fn,{onClick:E,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:p,children:m.jsx(xS,{})}),m.jsx(fn,{onClick:C,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:y,children:m.jsx(bS,{})})]}),r&&m.jsx(fn,{className:"react-flow__controls-fitview",onClick:S,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:m.jsx(wS,{})}),n&&m.jsx(fn,{className:"react-flow__controls-interactive",onClick:q,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:x?m.jsx(NS,{}):m.jsx(_S,{})}),l]})}S0.displayName="Controls";j.memo(S0);function CS({id:e,x:t,y:r,width:n,height:i,style:a,color:s,strokeColor:o,strokeWidth:u,className:c,borderRadius:l,shapeRendering:d,selected:f,onClick:h}){const{background:v,backgroundColor:x}=a||{},y=s||v||x;return m.jsx("rect",{className:we(["react-flow__minimap-node",{selected:f},c]),x:t,y:r,rx:l,ry:l,width:n,height:i,style:{fill:y,stroke:o,strokeWidth:u},shapeRendering:d,onClick:h?p=>h(p,e):void 0})}const SS=j.memo(CS),IS=e=>e.nodes.map(t=>t.id),Di=e=>e instanceof Function?e:()=>e;function RS({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i,nodeComponent:a=SS,onClick:s}){const o=le(IS,he),u=Di(t),c=Di(e),l=Di(r),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return m.jsx(m.Fragment,{children:o.map(f=>m.jsx(kS,{id:f,nodeColorFunc:u,nodeStrokeColorFunc:c,nodeClassNameFunc:l,nodeBorderRadius:n,nodeStrokeWidth:i,NodeComponent:a,onClick:s,shapeRendering:d},f))})}function qS({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:i,nodeStrokeWidth:a,shapeRendering:s,NodeComponent:o,onClick:u}){const{node:c,x:l,y:d,width:f,height:h}=le(v=>{const{internals:x}=v.nodeLookup.get(e),y=x.userNode,{x:p,y:b}=x.positionAbsolute,{width:g,height:w}=dt(y);return{node:y,x:p,y:b,width:g,height:w}},he);return!c||c.hidden||!Iy(c)?null:m.jsx(o,{x:l,y:d,width:f,height:h,style:c.style,selected:!!c.selected,className:n(c),color:t(c),borderRadius:i,strokeColor:r(c),strokeWidth:a,shapeRendering:s,onClick:u,id:c.id})}const kS=j.memo(qS);var AS=j.memo(RS);const jS=200,MS=150,TS=e=>!e.hidden,PS=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Sy(Or(e.nodeLookup,{filter:TS}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},DS="react-flow__minimap-desc";function I0({style:e,className:t,nodeStrokeColor:r,nodeColor:n,nodeClassName:i="",nodeBorderRadius:a=5,nodeStrokeWidth:s,nodeComponent:o,bgColor:u,maskColor:c,maskStrokeColor:l,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:v,pannable:x=!1,zoomable:y=!1,ariaLabel:p,inversePan:b,zoomStep:g=1,offsetScale:w=5}){const _=pe(),E=j.useRef(null),{boundingRect:C,viewBB:S,rfId:q,panZoom:M,translateExtent:R,flowWidth:A,flowHeight:$,ariaLabelConfig:N}=le(PS,he),I=(e==null?void 0:e.width)??jS,k=(e==null?void 0:e.height)??MS,L=C.width/I,P=C.height/k,D=Math.max(L,P),B=D*I,K=D*k,H=w*D,Q=C.x-(B-C.width)/2-H,T=C.y-(K-C.height)/2-H,F=B+H*2,z=K+H*2,V=`${DS}-${q}`,G=j.useRef(0),W=j.useRef();G.current=D,j.useEffect(()=>{if(E.current&&M)return W.current=iE({domNode:E.current,panZoom:M,getTransform:()=>_.getState().transform,getViewScale:()=>G.current}),()=>{var J;(J=W.current)==null||J.destroy()}},[M]),j.useEffect(()=>{var J;(J=W.current)==null||J.update({translateExtent:R,width:A,height:$,inversePan:b,pannable:x,zoomStep:g,zoomable:y})},[x,y,b,g,R,A,$]);const te=h?J=>{var ue;const[se,re]=((ue=W.current)==null?void 0:ue.pointer(J))||[0,0];h(J,{x:se,y:re})}:void 0,ne=v?j.useCallback((J,se)=>{const re=_.getState().nodeLookup.get(se).internals.userNode;v(J,re)},[]):void 0,ie=p??N["minimap.ariaLabel"];return m.jsx(zr,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*D:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:we(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:m.jsxs("svg",{width:I,height:k,viewBox:`${Q} ${T} ${F} ${z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":V,ref:E,onClick:te,children:[ie&&m.jsx("title",{id:V,children:ie}),m.jsx(AS,{onClick:ne,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:a,nodeClassName:i,nodeStrokeWidth:s,nodeComponent:o}),m.jsx("path",{className:"react-flow__minimap-mask",d:`M${Q-H},${T-H}h${F+H*2}v${z+H*2}h${-F-H*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}I0.displayName="MiniMap";const LS=j.memo(I0),OS=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,FS={[er.Line]:"right",[er.Handle]:"bottom-right"};function $S({nodeId:e,position:t,variant:r=er.Handle,className:n,style:i=void 0,children:a,color:s,minWidth:o=10,minHeight:u=10,maxWidth:c=Number.MAX_VALUE,maxHeight:l=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:h=!0,shouldResize:v,onResizeStart:x,onResize:y,onResizeEnd:p}){const b=a0(),g=typeof e=="string"?e:b,w=pe(),_=j.useRef(null),E=r===er.Handle,C=le(j.useCallback(OS(E&&h),[E,h]),he),S=j.useRef(null),q=t??FS[r];j.useEffect(()=>{if(!(!_.current||!g))return S.current||(S.current=yE({domNode:_.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:R,transform:A,snapGrid:$,snapToGrid:N,nodeOrigin:I,domNode:k}=w.getState();return{nodeLookup:R,transform:A,snapGrid:$,snapToGrid:N,nodeOrigin:I,paneDomNode:k}},onChange:(R,A)=>{const{triggerNodeChanges:$,nodeLookup:N,parentLookup:I,nodeOrigin:k}=w.getState(),L=[],P={x:R.x,y:R.y},D=N.get(g);if(D&&D.expandParent&&D.parentId){const B=D.origin??k,K=R.width??D.measured.width??0,H=R.height??D.measured.height??0,Q={id:D.id,parentId:D.parentId,rect:{width:K,height:H,...Ry({x:R.x??D.position.x,y:R.y??D.position.y},{width:K,height:H},D.parentId,N,B)}},T=Vl([Q],N,I,k);L.push(...T),P.x=R.x?Math.max(B[0]*K,R.x):void 0,P.y=R.y?Math.max(B[1]*H,R.y):void 0}if(P.x!==void 0&&P.y!==void 0){const B={id:g,type:"position",position:{...P}};L.push(B)}if(R.width!==void 0&&R.height!==void 0){const K={id:g,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:R.width,height:R.height}};L.push(K)}for(const B of A){const K={...B,type:"position"};L.push(K)}$(L)},onEnd:({width:R,height:A})=>{const $={id:g,type:"dimensions",resizing:!1,dimensions:{width:R,height:A}};w.getState().triggerNodeChanges([$])}})),S.current.update({controlPosition:q,boundaries:{minWidth:o,minHeight:u,maxWidth:c,maxHeight:l},keepAspectRatio:d,resizeDirection:f,onResizeStart:x,onResize:y,onResizeEnd:p,shouldResize:v}),()=>{var R;(R=S.current)==null||R.destroy()}},[q,o,u,c,l,d,x,y,p,v]);const M=q.split("-");return m.jsx("div",{className:we(["react-flow__resize-control","nodrag",...M,r,n]),ref:_,style:{...i,scale:C,...s&&{[E?"backgroundColor":"borderColor"]:s}},children:a})}j.memo($S);var Li,mf;function zS(){if(mf)return Li;mf=1;function e(){this.__data__=[],this.size=0}return Li=e,Li}var Oi,vf;function tr(){if(vf)return Oi;vf=1;function e(t,r){return t===r||t!==t&&r!==r}return Oi=e,Oi}var Fi,yf;function Un(){if(yf)return Fi;yf=1;var e=tr();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return Fi=t,Fi}var $i,xf;function BS(){if(xf)return $i;xf=1;var e=Un(),t=Array.prototype,r=t.splice;function n(i){var a=this.__data__,s=e(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return $i=n,$i}var zi,bf;function HS(){if(bf)return zi;bf=1;var e=Un();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return zi=t,zi}var Bi,wf;function VS(){if(wf)return Bi;wf=1;var e=Un();function t(r){return e(this.__data__,r)>-1}return Bi=t,Bi}var Hi,_f;function GS(){if(_f)return Hi;_f=1;var e=Un();function t(r,n){var i=this.__data__,a=e(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return Hi=t,Hi}var Vi,Nf;function Kn(){if(Nf)return Vi;Nf=1;var e=zS(),t=BS(),r=HS(),n=VS(),i=GS();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Vi=a,Vi}var Gi,Ef;function US(){if(Ef)return Gi;Ef=1;var e=Kn();function t(){this.__data__=new e,this.size=0}return Gi=t,Gi}var Ui,Cf;function KS(){if(Cf)return Ui;Cf=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Ui=e,Ui}var Ki,Sf;function YS(){if(Sf)return Ki;Sf=1;function e(t){return this.__data__.get(t)}return Ki=e,Ki}var Yi,If;function WS(){if(If)return Yi;If=1;function e(t){return this.__data__.has(t)}return Yi=e,Yi}var Wi,Rf;function R0(){if(Rf)return Wi;Rf=1;var e=typeof rn=="object"&&rn&&rn.Object===Object&&rn;return Wi=e,Wi}var Xi,qf;function Ye(){if(qf)return Xi;qf=1;var e=R0(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Xi=r,Xi}var Zi,kf;function rr(){if(kf)return Zi;kf=1;var e=Ye(),t=e.Symbol;return Zi=t,Zi}var Qi,Af;function XS(){if(Af)return Qi;Af=1;var e=rr(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function a(s){var o=r.call(s,i),u=s[i];try{s[i]=void 0;var c=!0}catch{}var l=n.call(s);return c&&(o?s[i]=u:delete s[i]),l}return Qi=a,Qi}var Ji,jf;function ZS(){if(jf)return Ji;jf=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Ji=r,Ji}var ea,Mf;function Mt(){if(Mf)return ea;Mf=1;var e=rr(),t=XS(),r=ZS(),n="[object Null]",i="[object Undefined]",a=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?t(o):r(o)}return ea=s,ea}var ta,Tf;function De(){if(Tf)return ta;Tf=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return ta=e,ta}var ra,Pf;function Hr(){if(Pf)return ra;Pf=1;var e=Mt(),t=De(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!t(o))return!1;var u=e(o);return u==n||u==i||u==r||u==a}return ra=s,ra}var na,Df;function QS(){if(Df)return na;Df=1;var e=Ye(),t=e["__core-js_shared__"];return na=t,na}var ia,Lf;function JS(){if(Lf)return ia;Lf=1;var e=QS(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return ia=r,ia}var aa,Of;function q0(){if(Of)return aa;Of=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return aa=r,aa}var sa,Ff;function eI(){if(Ff)return sa;Ff=1;var e=Hr(),t=JS(),r=De(),n=q0(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,u=s.toString,c=o.hasOwnProperty,l=RegExp("^"+u.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(f){if(!r(f)||t(f))return!1;var h=e(f)?l:a;return h.test(n(f))}return sa=d,sa}var oa,$f;function tI(){if($f)return oa;$f=1;function e(t,r){return t==null?void 0:t[r]}return oa=e,oa}var ua,zf;function Tt(){if(zf)return ua;zf=1;var e=eI(),t=tI();function r(n,i){var a=t(n,i);return e(a)?a:void 0}return ua=r,ua}var ca,Bf;function Ul(){if(Bf)return ca;Bf=1;var e=Tt(),t=Ye(),r=e(t,"Map");return ca=r,ca}var la,Hf;function Yn(){if(Hf)return la;Hf=1;var e=Tt(),t=e(Object,"create");return la=t,la}var da,Vf;function rI(){if(Vf)return da;Vf=1;var e=Yn();function t(){this.__data__=e?e(null):{},this.size=0}return da=t,da}var fa,Gf;function nI(){if(Gf)return fa;Gf=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return fa=e,fa}var ha,Uf;function iI(){if(Uf)return ha;Uf=1;var e=Yn(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(e){var o=s[a];return o===t?void 0:o}return n.call(s,a)?s[a]:void 0}return ha=i,ha}var pa,Kf;function aI(){if(Kf)return pa;Kf=1;var e=Yn(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var a=this.__data__;return e?a[i]!==void 0:r.call(a,i)}return pa=n,pa}var ga,Yf;function sI(){if(Yf)return ga;Yf=1;var e=Yn(),t="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=e&&i===void 0?t:i,this}return ga=r,ga}var ma,Wf;function oI(){if(Wf)return ma;Wf=1;var e=rI(),t=nI(),r=iI(),n=aI(),i=sI();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,ma=a,ma}var va,Xf;function uI(){if(Xf)return va;Xf=1;var e=oI(),t=Kn(),r=Ul();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return va=n,va}var ya,Zf;function cI(){if(Zf)return ya;Zf=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return ya=e,ya}var xa,Qf;function Wn(){if(Qf)return xa;Qf=1;var e=cI();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return xa=t,xa}var ba,Jf;function lI(){if(Jf)return ba;Jf=1;var e=Wn();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return ba=t,ba}var wa,eh;function dI(){if(eh)return wa;eh=1;var e=Wn();function t(r){return e(this,r).get(r)}return wa=t,wa}var _a,th;function fI(){if(th)return _a;th=1;var e=Wn();function t(r){return e(this,r).has(r)}return _a=t,_a}var Na,rh;function hI(){if(rh)return Na;rh=1;var e=Wn();function t(r,n){var i=e(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return Na=t,Na}var Ea,nh;function Kl(){if(nh)return Ea;nh=1;var e=uI(),t=lI(),r=dI(),n=fI(),i=hI();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Ea=a,Ea}var Ca,ih;function pI(){if(ih)return Ca;ih=1;var e=Kn(),t=Ul(),r=Kl(),n=200;function i(a,s){var o=this.__data__;if(o instanceof e){var u=o.__data__;if(!t||u.length<n-1)return u.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(u)}return o.set(a,s),this.size=o.size,this}return Ca=i,Ca}var Sa,ah;function Xn(){if(ah)return Sa;ah=1;var e=Kn(),t=US(),r=KS(),n=YS(),i=WS(),a=pI();function s(o){var u=this.__data__=new e(o);this.size=u.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,Sa=s,Sa}var Ia,sh;function Yl(){if(sh)return Ia;sh=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return Ia=e,Ia}var Ra,oh;function k0(){if(oh)return Ra;oh=1;var e=Tt(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return Ra=t,Ra}var qa,uh;function Zn(){if(uh)return qa;uh=1;var e=k0();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return qa=t,qa}var ka,ch;function Qn(){if(ch)return ka;ch=1;var e=Zn(),t=tr(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var u=a[s];(!(n.call(a,s)&&t(u,o))||o===void 0&&!(s in a))&&e(a,s,o)}return ka=i,ka}var Aa,lh;function Vr(){if(lh)return Aa;lh=1;var e=Qn(),t=Zn();function r(n,i,a,s){var o=!a;a||(a={});for(var u=-1,c=i.length;++u<c;){var l=i[u],d=s?s(a[l],n[l],l,a,n):void 0;d===void 0&&(d=n[l]),o?t(a,l,d):e(a,l,d)}return a}return Aa=r,Aa}var ja,dh;function gI(){if(dh)return ja;dh=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return ja=e,ja}var Ma,fh;function rt(){if(fh)return Ma;fh=1;function e(t){return t!=null&&typeof t=="object"}return Ma=e,Ma}var Ta,hh;function mI(){if(hh)return Ta;hh=1;var e=Mt(),t=rt(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return Ta=n,Ta}var Pa,ph;function Gr(){if(ph)return Pa;ph=1;var e=mI(),t=rt(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return Pa=a,Pa}var Da,gh;function _e(){if(gh)return Da;gh=1;var e=Array.isArray;return Da=e,Da}var yr={exports:{}},La,mh;function vI(){if(mh)return La;mh=1;function e(){return!1}return La=e,La}yr.exports;var vh;function nr(){return vh||(vh=1,(function(e,t){var r=Ye(),n=vI(),i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===i,o=s?r.Buffer:void 0,u=o?o.isBuffer:void 0,c=u||n;e.exports=c})(yr,yr.exports)),yr.exports}var Oa,yh;function Jn(){if(yh)return Oa;yh=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??e,!!i&&(a=="number"||a!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return Oa=r,Oa}var Fa,xh;function Wl(){if(xh)return Fa;xh=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Fa=t,Fa}var $a,bh;function yI(){if(bh)return $a;bh=1;var e=Mt(),t=Wl(),r=rt(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",c="[object Map]",l="[object Number]",d="[object Object]",f="[object RegExp]",h="[object Set]",v="[object String]",x="[object WeakMap]",y="[object ArrayBuffer]",p="[object DataView]",b="[object Float32Array]",g="[object Float64Array]",w="[object Int8Array]",_="[object Int16Array]",E="[object Int32Array]",C="[object Uint8Array]",S="[object Uint8ClampedArray]",q="[object Uint16Array]",M="[object Uint32Array]",R={};R[b]=R[g]=R[w]=R[_]=R[E]=R[C]=R[S]=R[q]=R[M]=!0,R[n]=R[i]=R[y]=R[a]=R[p]=R[s]=R[o]=R[u]=R[c]=R[l]=R[d]=R[f]=R[h]=R[v]=R[x]=!1;function A($){return r($)&&t($.length)&&!!R[e($)]}return $a=A,$a}var za,wh;function ei(){if(wh)return za;wh=1;function e(t){return function(r){return t(r)}}return za=e,za}var xr={exports:{}};xr.exports;var _h;function Xl(){return _h||(_h=1,(function(e,t){var r=R0(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();e.exports=o})(xr,xr.exports)),xr.exports}var Ba,Nh;function Ur(){if(Nh)return Ba;Nh=1;var e=yI(),t=ei(),r=Xl(),n=r&&r.isTypedArray,i=n?t(n):e;return Ba=i,Ba}var Ha,Eh;function A0(){if(Eh)return Ha;Eh=1;var e=gI(),t=Gr(),r=_e(),n=nr(),i=Jn(),a=Ur(),s=Object.prototype,o=s.hasOwnProperty;function u(c,l){var d=r(c),f=!d&&t(c),h=!d&&!f&&n(c),v=!d&&!f&&!h&&a(c),x=d||f||h||v,y=x?e(c.length,String):[],p=y.length;for(var b in c)(l||o.call(c,b))&&!(x&&(b=="length"||h&&(b=="offset"||b=="parent")||v&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,p)))&&y.push(b);return y}return Ha=u,Ha}var Va,Ch;function ti(){if(Ch)return Va;Ch=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return Va=t,Va}var Ga,Sh;function j0(){if(Sh)return Ga;Sh=1;function e(t,r){return function(n){return t(r(n))}}return Ga=e,Ga}var Ua,Ih;function xI(){if(Ih)return Ua;Ih=1;var e=j0(),t=e(Object.keys,Object);return Ua=t,Ua}var Ka,Rh;function Zl(){if(Rh)return Ka;Rh=1;var e=ti(),t=xI(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!e(a))return t(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return Ka=i,Ka}var Ya,qh;function ft(){if(qh)return Ya;qh=1;var e=Hr(),t=Wl();function r(n){return n!=null&&t(n.length)&&!e(n)}return Ya=r,Ya}var Wa,kh;function _t(){if(kh)return Wa;kh=1;var e=A0(),t=Zl(),r=ft();function n(i){return r(i)?e(i):t(i)}return Wa=n,Wa}var Xa,Ah;function bI(){if(Ah)return Xa;Ah=1;var e=Vr(),t=_t();function r(n,i){return n&&e(i,t(i),n)}return Xa=r,Xa}var Za,jh;function wI(){if(jh)return Za;jh=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Za=e,Za}var Qa,Mh;function _I(){if(Mh)return Qa;Mh=1;var e=De(),t=ti(),r=wI(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!e(s))return r(s);var o=t(s),u=[];for(var c in s)c=="constructor"&&(o||!i.call(s,c))||u.push(c);return u}return Qa=a,Qa}var Ja,Th;function Pt(){if(Th)return Ja;Th=1;var e=A0(),t=_I(),r=ft();function n(i){return r(i)?e(i,!0):t(i)}return Ja=n,Ja}var es,Ph;function NI(){if(Ph)return es;Ph=1;var e=Vr(),t=Pt();function r(n,i){return n&&e(i,t(i),n)}return es=r,es}var br={exports:{}};br.exports;var Dh;function M0(){return Dh||(Dh=1,(function(e,t){var r=Ye(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function u(c,l){if(l)return c.slice();var d=c.length,f=o?o(d):new c.constructor(d);return c.copy(f),f}e.exports=u})(br,br.exports)),br.exports}var ts,Lh;function T0(){if(Lh)return ts;Lh=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return ts=e,ts}var rs,Oh;function P0(){if(Oh)return rs;Oh=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=0,s=[];++n<i;){var o=t[n];r(o,n,t)&&(s[a++]=o)}return s}return rs=e,rs}var ns,Fh;function D0(){if(Fh)return ns;Fh=1;function e(){return[]}return ns=e,ns}var is,$h;function Ql(){if($h)return is;$h=1;var e=P0(),t=D0(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),e(i(s),function(o){return n.call(s,o)}))}:t;return is=a,is}var as,zh;function EI(){if(zh)return as;zh=1;var e=Vr(),t=Ql();function r(n,i){return e(n,t(n),i)}return as=r,as}var ss,Bh;function Jl(){if(Bh)return ss;Bh=1;function e(t,r){for(var n=-1,i=r.length,a=t.length;++n<i;)t[a+n]=r[n];return t}return ss=e,ss}var os,Hh;function ri(){if(Hh)return os;Hh=1;var e=j0(),t=e(Object.getPrototypeOf,Object);return os=t,os}var us,Vh;function L0(){if(Vh)return us;Vh=1;var e=Jl(),t=ri(),r=Ql(),n=D0(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)e(o,r(s)),s=t(s);return o}:n;return us=a,us}var cs,Gh;function CI(){if(Gh)return cs;Gh=1;var e=Vr(),t=L0();function r(n,i){return e(n,t(n),i)}return cs=r,cs}var ls,Uh;function O0(){if(Uh)return ls;Uh=1;var e=Jl(),t=_e();function r(n,i,a){var s=i(n);return t(n)?s:e(s,a(n))}return ls=r,ls}var ds,Kh;function F0(){if(Kh)return ds;Kh=1;var e=O0(),t=Ql(),r=_t();function n(i){return e(i,r,t)}return ds=n,ds}var fs,Yh;function SI(){if(Yh)return fs;Yh=1;var e=O0(),t=L0(),r=Pt();function n(i){return e(i,r,t)}return fs=n,fs}var hs,Wh;function II(){if(Wh)return hs;Wh=1;var e=Tt(),t=Ye(),r=e(t,"DataView");return hs=r,hs}var ps,Xh;function RI(){if(Xh)return ps;Xh=1;var e=Tt(),t=Ye(),r=e(t,"Promise");return ps=r,ps}var gs,Zh;function $0(){if(Zh)return gs;Zh=1;var e=Tt(),t=Ye(),r=e(t,"Set");return gs=r,gs}var ms,Qh;function qI(){if(Qh)return ms;Qh=1;var e=Tt(),t=Ye(),r=e(t,"WeakMap");return ms=r,ms}var vs,Jh;function ir(){if(Jh)return vs;Jh=1;var e=II(),t=Ul(),r=RI(),n=$0(),i=qI(),a=Mt(),s=q0(),o="[object Map]",u="[object Object]",c="[object Promise]",l="[object Set]",d="[object WeakMap]",f="[object DataView]",h=s(e),v=s(t),x=s(r),y=s(n),p=s(i),b=a;return(e&&b(new e(new ArrayBuffer(1)))!=f||t&&b(new t)!=o||r&&b(r.resolve())!=c||n&&b(new n)!=l||i&&b(new i)!=d)&&(b=function(g){var w=a(g),_=w==u?g.constructor:void 0,E=_?s(_):"";if(E)switch(E){case h:return f;case v:return o;case x:return c;case y:return l;case p:return d}return w}),vs=b,vs}var ys,ep;function kI(){if(ep)return ys;ep=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return ys=r,ys}var xs,tp;function z0(){if(tp)return xs;tp=1;var e=Ye(),t=e.Uint8Array;return xs=t,xs}var bs,rp;function ed(){if(rp)return bs;rp=1;var e=z0();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return bs=t,bs}var ws,np;function AI(){if(np)return ws;np=1;var e=ed();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return ws=t,ws}var _s,ip;function jI(){if(ip)return _s;ip=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return _s=t,_s}var Ns,ap;function MI(){if(ap)return Ns;ap=1;var e=rr(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return Ns=n,Ns}var Es,sp;function B0(){if(sp)return Es;sp=1;var e=ed();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return Es=t,Es}var Cs,op;function TI(){if(op)return Cs;op=1;var e=ed(),t=AI(),r=jI(),n=MI(),i=B0(),a="[object Boolean]",s="[object Date]",o="[object Map]",u="[object Number]",c="[object RegExp]",l="[object Set]",d="[object String]",f="[object Symbol]",h="[object ArrayBuffer]",v="[object DataView]",x="[object Float32Array]",y="[object Float64Array]",p="[object Int8Array]",b="[object Int16Array]",g="[object Int32Array]",w="[object Uint8Array]",_="[object Uint8ClampedArray]",E="[object Uint16Array]",C="[object Uint32Array]";function S(q,M,R){var A=q.constructor;switch(M){case h:return e(q);case a:case s:return new A(+q);case v:return t(q,R);case x:case y:case p:case b:case g:case w:case _:case E:case C:return i(q,R);case o:return new A;case u:case d:return new A(q);case c:return r(q);case l:return new A;case f:return n(q)}}return Cs=S,Cs}var Ss,up;function H0(){if(up)return Ss;up=1;var e=De(),t=Object.create,r=(function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return Ss=r,Ss}var Is,cp;function V0(){if(cp)return Is;cp=1;var e=H0(),t=ri(),r=ti();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return Is=n,Is}var Rs,lp;function PI(){if(lp)return Rs;lp=1;var e=ir(),t=rt(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return Rs=n,Rs}var qs,dp;function DI(){if(dp)return qs;dp=1;var e=PI(),t=ei(),r=Xl(),n=r&&r.isMap,i=n?t(n):e;return qs=i,qs}var ks,fp;function LI(){if(fp)return ks;fp=1;var e=ir(),t=rt(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return ks=n,ks}var As,hp;function OI(){if(hp)return As;hp=1;var e=LI(),t=ei(),r=Xl(),n=r&&r.isSet,i=n?t(n):e;return As=i,As}var js,pp;function G0(){if(pp)return js;pp=1;var e=Xn(),t=Yl(),r=Qn(),n=bI(),i=NI(),a=M0(),s=T0(),o=EI(),u=CI(),c=F0(),l=SI(),d=ir(),f=kI(),h=TI(),v=V0(),x=_e(),y=nr(),p=DI(),b=De(),g=OI(),w=_t(),_=Pt(),E=1,C=2,S=4,q="[object Arguments]",M="[object Array]",R="[object Boolean]",A="[object Date]",$="[object Error]",N="[object Function]",I="[object GeneratorFunction]",k="[object Map]",L="[object Number]",P="[object Object]",D="[object RegExp]",B="[object Set]",K="[object String]",H="[object Symbol]",Q="[object WeakMap]",T="[object ArrayBuffer]",F="[object DataView]",z="[object Float32Array]",V="[object Float64Array]",G="[object Int8Array]",W="[object Int16Array]",te="[object Int32Array]",ne="[object Uint8Array]",ie="[object Uint8ClampedArray]",J="[object Uint16Array]",se="[object Uint32Array]",re={};re[q]=re[M]=re[T]=re[F]=re[R]=re[A]=re[z]=re[V]=re[G]=re[W]=re[te]=re[k]=re[L]=re[P]=re[D]=re[B]=re[K]=re[H]=re[ne]=re[ie]=re[J]=re[se]=!0,re[$]=re[N]=re[Q]=!1;function ue(oe,Ne,me,Ae,ye,xe){var ve,We=Ne&E,je=Ne&C,Xe=Ne&S;if(me&&(ve=ye?me(oe,Ae,ye,xe):me(oe)),ve!==void 0)return ve;if(!b(oe))return oe;var de=x(oe);if(de){if(ve=f(oe),!We)return s(oe,ve)}else{var Me=d(oe),nt=Me==N||Me==I;if(y(oe))return a(oe,We);if(Me==P||Me==q||nt&&!ye){if(ve=je||nt?{}:v(oe),!We)return je?u(oe,i(ve,oe)):o(oe,n(ve,oe))}else{if(!re[Me])return ye?oe:{};ve=h(oe,Me,We)}}xe||(xe=new e);var it=xe.get(oe);if(it)return it;xe.set(oe,ve),g(oe)?oe.forEach(function(Te){ve.add(ue(Te,Ne,me,Te,oe,xe))}):p(oe)&&oe.forEach(function(Te,Fe){ve.set(Fe,ue(Te,Ne,me,Fe,oe,xe))});var Lt=Xe?je?l:c:je?_:w,Oe=de?void 0:Lt(oe);return t(Oe||oe,function(Te,Fe){Oe&&(Fe=Te,Te=oe[Fe]),r(ve,Fe,ue(Te,Ne,me,Fe,oe,xe))}),ve}return js=ue,js}var Ms,gp;function FI(){if(gp)return Ms;gp=1;var e=G0(),t=4;function r(n){return e(n,t)}return Ms=r,Ms}var Ts,mp;function td(){if(mp)return Ts;mp=1;function e(t){return function(){return t}}return Ts=e,Ts}var Ps,vp;function $I(){if(vp)return Ps;vp=1;function e(t){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),u=o.length;u--;){var c=o[t?u:++a];if(n(s[c],c,s)===!1)break}return r}}return Ps=e,Ps}var Ds,yp;function rd(){if(yp)return Ds;yp=1;var e=$I(),t=e();return Ds=t,Ds}var Ls,xp;function nd(){if(xp)return Ls;xp=1;var e=rd(),t=_t();function r(n,i){return n&&e(n,i,t)}return Ls=r,Ls}var Os,bp;function zI(){if(bp)return Os;bp=1;var e=ft();function t(r,n){return function(i,a){if(i==null)return i;if(!e(i))return r(i,a);for(var s=i.length,o=n?s:-1,u=Object(i);(n?o--:++o<s)&&a(u[o],o,u)!==!1;);return i}}return Os=t,Os}var Fs,wp;function ni(){if(wp)return Fs;wp=1;var e=nd(),t=zI(),r=t(e);return Fs=r,Fs}var $s,_p;function Dt(){if(_p)return $s;_p=1;function e(t){return t}return $s=e,$s}var zs,Np;function U0(){if(Np)return zs;Np=1;var e=Dt();function t(r){return typeof r=="function"?r:e}return zs=t,zs}var Bs,Ep;function K0(){if(Ep)return Bs;Ep=1;var e=Yl(),t=ni(),r=U0(),n=_e();function i(a,s){var o=n(a)?e:t;return o(a,r(s))}return Bs=i,Bs}var Hs,Cp;function Y0(){return Cp||(Cp=1,Hs=K0()),Hs}var Vs,Sp;function BI(){if(Sp)return Vs;Sp=1;var e=ni();function t(r,n){var i=[];return e(r,function(a,s,o){n(a,s,o)&&i.push(a)}),i}return Vs=t,Vs}var Gs,Ip;function HI(){if(Ip)return Gs;Ip=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Gs=t,Gs}var Us,Rp;function VI(){if(Rp)return Us;Rp=1;function e(t){return this.__data__.has(t)}return Us=e,Us}var Ks,qp;function W0(){if(qp)return Ks;qp=1;var e=Kl(),t=HI(),r=VI();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new e;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,Ks=n,Ks}var Ys,kp;function GI(){if(kp)return Ys;kp=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return Ys=e,Ys}var Ws,Ap;function X0(){if(Ap)return Ws;Ap=1;function e(t,r){return t.has(r)}return Ws=e,Ws}var Xs,jp;function Z0(){if(jp)return Xs;jp=1;var e=W0(),t=GI(),r=X0(),n=1,i=2;function a(s,o,u,c,l,d){var f=u&n,h=s.length,v=o.length;if(h!=v&&!(f&&v>h))return!1;var x=d.get(s),y=d.get(o);if(x&&y)return x==o&&y==s;var p=-1,b=!0,g=u&i?new e:void 0;for(d.set(s,o),d.set(o,s);++p<h;){var w=s[p],_=o[p];if(c)var E=f?c(_,w,p,o,s,d):c(w,_,p,s,o,d);if(E!==void 0){if(E)continue;b=!1;break}if(g){if(!t(o,function(C,S){if(!r(g,S)&&(w===C||l(w,C,u,c,d)))return g.push(S)})){b=!1;break}}else if(!(w===_||l(w,_,u,c,d))){b=!1;break}}return d.delete(s),d.delete(o),b}return Xs=a,Xs}var Zs,Mp;function UI(){if(Mp)return Zs;Mp=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,a){n[++r]=[a,i]}),n}return Zs=e,Zs}var Qs,Tp;function id(){if(Tp)return Qs;Tp=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return Qs=e,Qs}var Js,Pp;function KI(){if(Pp)return Js;Pp=1;var e=rr(),t=z0(),r=tr(),n=Z0(),i=UI(),a=id(),s=1,o=2,u="[object Boolean]",c="[object Date]",l="[object Error]",d="[object Map]",f="[object Number]",h="[object RegExp]",v="[object Set]",x="[object String]",y="[object Symbol]",p="[object ArrayBuffer]",b="[object DataView]",g=e?e.prototype:void 0,w=g?g.valueOf:void 0;function _(E,C,S,q,M,R,A){switch(S){case b:if(E.byteLength!=C.byteLength||E.byteOffset!=C.byteOffset)return!1;E=E.buffer,C=C.buffer;case p:return!(E.byteLength!=C.byteLength||!R(new t(E),new t(C)));case u:case c:case f:return r(+E,+C);case l:return E.name==C.name&&E.message==C.message;case h:case x:return E==C+"";case d:var $=i;case v:var N=q&s;if($||($=a),E.size!=C.size&&!N)return!1;var I=A.get(E);if(I)return I==C;q|=o,A.set(E,C);var k=n($(E),$(C),q,M,R,A);return A.delete(E),k;case y:if(w)return w.call(E)==w.call(C)}return!1}return Js=_,Js}var eo,Dp;function YI(){if(Dp)return eo;Dp=1;var e=F0(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,u,c,l){var d=o&t,f=e(a),h=f.length,v=e(s),x=v.length;if(h!=x&&!d)return!1;for(var y=h;y--;){var p=f[y];if(!(d?p in s:n.call(s,p)))return!1}var b=l.get(a),g=l.get(s);if(b&&g)return b==s&&g==a;var w=!0;l.set(a,s),l.set(s,a);for(var _=d;++y<h;){p=f[y];var E=a[p],C=s[p];if(u)var S=d?u(C,E,p,s,a,l):u(E,C,p,a,s,l);if(!(S===void 0?E===C||c(E,C,o,u,l):S)){w=!1;break}_||(_=p=="constructor")}if(w&&!_){var q=a.constructor,M=s.constructor;q!=M&&"constructor"in a&&"constructor"in s&&!(typeof q=="function"&&q instanceof q&&typeof M=="function"&&M instanceof M)&&(w=!1)}return l.delete(a),l.delete(s),w}return eo=i,eo}var to,Lp;function WI(){if(Lp)return to;Lp=1;var e=Xn(),t=Z0(),r=KI(),n=YI(),i=ir(),a=_e(),s=nr(),o=Ur(),u=1,c="[object Arguments]",l="[object Array]",d="[object Object]",f=Object.prototype,h=f.hasOwnProperty;function v(x,y,p,b,g,w){var _=a(x),E=a(y),C=_?l:i(x),S=E?l:i(y);C=C==c?d:C,S=S==c?d:S;var q=C==d,M=S==d,R=C==S;if(R&&s(x)){if(!s(y))return!1;_=!0,q=!1}if(R&&!q)return w||(w=new e),_||o(x)?t(x,y,p,b,g,w):r(x,y,C,p,b,g,w);if(!(p&u)){var A=q&&h.call(x,"__wrapped__"),$=M&&h.call(y,"__wrapped__");if(A||$){var N=A?x.value():x,I=$?y.value():y;return w||(w=new e),g(N,I,p,b,w)}}return R?(w||(w=new e),n(x,y,p,b,g,w)):!1}return to=v,to}var ro,Op;function Q0(){if(Op)return ro;Op=1;var e=WI(),t=rt();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,a,s,r,o)}return ro=r,ro}var no,Fp;function XI(){if(Fp)return no;Fp=1;var e=Xn(),t=Q0(),r=1,n=2;function i(a,s,o,u){var c=o.length,l=c,d=!u;if(a==null)return!l;for(a=Object(a);c--;){var f=o[c];if(d&&f[2]?f[1]!==a[f[0]]:!(f[0]in a))return!1}for(;++c<l;){f=o[c];var h=f[0],v=a[h],x=f[1];if(d&&f[2]){if(v===void 0&&!(h in a))return!1}else{var y=new e;if(u)var p=u(v,x,h,a,s,y);if(!(p===void 0?t(x,v,r|n,u,y):p))return!1}}return!0}return no=i,no}var io,$p;function J0(){if($p)return io;$p=1;var e=De();function t(r){return r===r&&!e(r)}return io=t,io}var ao,zp;function ZI(){if(zp)return ao;zp=1;var e=J0(),t=_t();function r(n){for(var i=t(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,e(o)]}return i}return ao=r,ao}var so,Bp;function ex(){if(Bp)return so;Bp=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return so=e,so}var oo,Hp;function QI(){if(Hp)return oo;Hp=1;var e=XI(),t=ZI(),r=ex();function n(i){var a=t(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||e(s,i,a)}}return oo=n,oo}var uo,Vp;function ar(){if(Vp)return uo;Vp=1;var e=Mt(),t=rt(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return uo=n,uo}var co,Gp;function ad(){if(Gp)return co;Gp=1;var e=_e(),t=ar(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(e(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||t(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return co=i,co}var lo,Up;function JI(){if(Up)return lo;Up=1;var e=Kl(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],u=a.cache;if(u.has(o))return u.get(o);var c=n.apply(this,s);return a.cache=u.set(o,c)||u,c};return a.cache=new(r.Cache||e),a}return r.Cache=e,lo=r,lo}var fo,Kp;function eR(){if(Kp)return fo;Kp=1;var e=JI(),t=500;function r(n){var i=e(n,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return fo=r,fo}var ho,Yp;function tR(){if(Yp)return ho;Yp=1;var e=eR(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,o,u,c){a.push(u?c.replace(r,"$1"):o||s)}),a});return ho=n,ho}var po,Wp;function ii(){if(Wp)return po;Wp=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=Array(i);++n<i;)a[n]=r(t[n],n,t);return a}return po=e,po}var go,Xp;function rR(){if(Xp)return go;Xp=1;var e=rr(),t=ii(),r=_e(),n=ar(),i=e?e.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return t(o,s)+"";if(n(o))return a?a.call(o):"";var u=o+"";return u=="0"&&1/o==-1/0?"-0":u}return go=s,go}var mo,Zp;function tx(){if(Zp)return mo;Zp=1;var e=rR();function t(r){return r==null?"":e(r)}return mo=t,mo}var vo,Qp;function ai(){if(Qp)return vo;Qp=1;var e=_e(),t=ad(),r=tR(),n=tx();function i(a,s){return e(a)?a:t(a,s)?[a]:r(n(a))}return vo=i,vo}var yo,Jp;function Kr(){if(Jp)return yo;Jp=1;var e=ar();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return yo=t,yo}var xo,eg;function si(){if(eg)return xo;eg=1;var e=ai(),t=Kr();function r(n,i){i=e(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[t(i[a++])];return a&&a==s?n:void 0}return xo=r,xo}var bo,tg;function nR(){if(tg)return bo;tg=1;var e=si();function t(r,n,i){var a=r==null?void 0:e(r,n);return a===void 0?i:a}return bo=t,bo}var wo,rg;function iR(){if(rg)return wo;rg=1;function e(t,r){return t!=null&&r in Object(t)}return wo=e,wo}var _o,ng;function rx(){if(ng)return _o;ng=1;var e=ai(),t=Gr(),r=_e(),n=Jn(),i=Wl(),a=Kr();function s(o,u,c){u=e(u,o);for(var l=-1,d=u.length,f=!1;++l<d;){var h=a(u[l]);if(!(f=o!=null&&c(o,h)))break;o=o[h]}return f||++l!=d?f:(d=o==null?0:o.length,!!d&&i(d)&&n(h,d)&&(r(o)||t(o)))}return _o=s,_o}var No,ig;function nx(){if(ig)return No;ig=1;var e=iR(),t=rx();function r(n,i){return n!=null&&t(n,i,e)}return No=r,No}var Eo,ag;function aR(){if(ag)return Eo;ag=1;var e=Q0(),t=nR(),r=nx(),n=ad(),i=J0(),a=ex(),s=Kr(),o=1,u=2;function c(l,d){return n(l)&&i(d)?a(s(l),d):function(f){var h=t(f,l);return h===void 0&&h===d?r(f,l):e(d,h,o|u)}}return Eo=c,Eo}var Co,sg;function ix(){if(sg)return Co;sg=1;function e(t){return function(r){return r==null?void 0:r[t]}}return Co=e,Co}var So,og;function sR(){if(og)return So;og=1;var e=si();function t(r){return function(n){return e(n,r)}}return So=t,So}var Io,ug;function oR(){if(ug)return Io;ug=1;var e=ix(),t=sR(),r=ad(),n=Kr();function i(a){return r(a)?e(n(a)):t(a)}return Io=i,Io}var Ro,cg;function ht(){if(cg)return Ro;cg=1;var e=QI(),t=aR(),r=Dt(),n=_e(),i=oR();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):i(s)}return Ro=a,Ro}var qo,lg;function ax(){if(lg)return qo;lg=1;var e=P0(),t=BI(),r=ht(),n=_e();function i(a,s){var o=n(a)?e:t;return o(a,r(s,3))}return qo=i,qo}var ko,dg;function uR(){if(dg)return ko;dg=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,i){return n!=null&&t.call(n,i)}return ko=r,ko}var Ao,fg;function sx(){if(fg)return Ao;fg=1;var e=uR(),t=rx();function r(n,i){return n!=null&&t(n,i,e)}return Ao=r,Ao}var jo,hg;function cR(){if(hg)return jo;hg=1;var e=Zl(),t=ir(),r=Gr(),n=_e(),i=ft(),a=nr(),s=ti(),o=Ur(),u="[object Map]",c="[object Set]",l=Object.prototype,d=l.hasOwnProperty;function f(h){if(h==null)return!0;if(i(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||a(h)||o(h)||r(h)))return!h.length;var v=t(h);if(v==u||v==c)return!h.size;if(s(h))return!e(h).length;for(var x in h)if(d.call(h,x))return!1;return!0}return jo=f,jo}var Mo,pg;function ox(){if(pg)return Mo;pg=1;function e(t){return t===void 0}return Mo=e,Mo}var To,gg;function ux(){if(gg)return To;gg=1;var e=ni(),t=ft();function r(n,i){var a=-1,s=t(n)?Array(n.length):[];return e(n,function(o,u,c){s[++a]=i(o,u,c)}),s}return To=r,To}var Po,mg;function cx(){if(mg)return Po;mg=1;var e=ii(),t=ht(),r=ux(),n=_e();function i(a,s){var o=n(a)?e:r;return o(a,t(s,3))}return Po=i,Po}var Do,vg;function lR(){if(vg)return Do;vg=1;function e(t,r,n,i){var a=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++a]);++a<s;)n=r(n,t[a],a,t);return n}return Do=e,Do}var Lo,yg;function dR(){if(yg)return Lo;yg=1;function e(t,r,n,i,a){return a(t,function(s,o,u){n=i?(i=!1,s):r(n,s,o,u)}),n}return Lo=e,Lo}var Oo,xg;function lx(){if(xg)return Oo;xg=1;var e=lR(),t=ni(),r=ht(),n=dR(),i=_e();function a(s,o,u){var c=i(s)?e:n,l=arguments.length<3;return c(s,r(o,4),u,l,t)}return Oo=a,Oo}var Fo,bg;function fR(){if(bg)return Fo;bg=1;var e=Mt(),t=_e(),r=rt(),n="[object String]";function i(a){return typeof a=="string"||!t(a)&&r(a)&&e(a)==n}return Fo=i,Fo}var $o,wg;function hR(){if(wg)return $o;wg=1;var e=ix(),t=e("length");return $o=t,$o}var zo,_g;function pR(){if(_g)return zo;_g=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+i+a+"]");function u(c){return o.test(c)}return zo=u,zo}var Bo,Ng;function gR(){if(Ng)return Bo;Ng=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="["+e+"]",o="["+i+"]",u="\\ud83c[\\udffb-\\udfff]",c="(?:"+o+"|"+u+")",l="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",v=c+"?",x="["+a+"]?",y="(?:"+h+"(?:"+[l,d,f].join("|")+")"+x+v+")*",p=x+v+y,b="(?:"+[l+o+"?",o,d,f,s].join("|")+")",g=RegExp(u+"(?="+u+")|"+b+p,"g");function w(_){for(var E=g.lastIndex=0;g.test(_);)++E;return E}return Bo=w,Bo}var Ho,Eg;function mR(){if(Eg)return Ho;Eg=1;var e=hR(),t=pR(),r=gR();function n(i){return t(i)?r(i):e(i)}return Ho=n,Ho}var Vo,Cg;function vR(){if(Cg)return Vo;Cg=1;var e=Zl(),t=ir(),r=ft(),n=fR(),i=mR(),a="[object Map]",s="[object Set]";function o(u){if(u==null)return 0;if(r(u))return n(u)?i(u):u.length;var c=t(u);return c==a||c==s?u.size:e(u).length}return Vo=o,Vo}var Go,Sg;function yR(){if(Sg)return Go;Sg=1;var e=Yl(),t=H0(),r=nd(),n=ht(),i=ri(),a=_e(),s=nr(),o=Hr(),u=De(),c=Ur();function l(d,f,h){var v=a(d),x=v||s(d)||c(d);if(f=n(f,4),h==null){var y=d&&d.constructor;x?h=v?new y:[]:u(d)?h=o(y)?t(i(d)):{}:h={}}return(x?e:r)(d,function(p,b,g){return f(h,p,b,g)}),h}return Go=l,Go}var Uo,Ig;function xR(){if(Ig)return Uo;Ig=1;var e=rr(),t=Gr(),r=_e(),n=e?e.isConcatSpreadable:void 0;function i(a){return r(a)||t(a)||!!(n&&a&&a[n])}return Uo=i,Uo}var Ko,Rg;function sd(){if(Rg)return Ko;Rg=1;var e=Jl(),t=xR();function r(n,i,a,s,o){var u=-1,c=n.length;for(a||(a=t),o||(o=[]);++u<c;){var l=n[u];i>0&&a(l)?i>1?r(l,i-1,a,s,o):e(o,l):s||(o[o.length]=l)}return o}return Ko=r,Ko}var Yo,qg;function bR(){if(qg)return Yo;qg=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return Yo=e,Yo}var Wo,kg;function dx(){if(kg)return Wo;kg=1;var e=bR(),t=Math.max;function r(n,i,a){return i=t(i===void 0?n.length-1:i,0),function(){for(var s=arguments,o=-1,u=t(s.length-i,0),c=Array(u);++o<u;)c[o]=s[i+o];o=-1;for(var l=Array(i+1);++o<i;)l[o]=s[o];return l[i]=a(c),e(n,this,l)}}return Wo=r,Wo}var Xo,Ag;function wR(){if(Ag)return Xo;Ag=1;var e=td(),t=k0(),r=Dt(),n=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:r;return Xo=n,Xo}var Zo,jg;function _R(){if(jg)return Zo;jg=1;var e=800,t=16,r=Date.now;function n(i){var a=0,s=0;return function(){var o=r(),u=t-(o-s);if(s=o,u>0){if(++a>=e)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return Zo=n,Zo}var Qo,Mg;function fx(){if(Mg)return Qo;Mg=1;var e=wR(),t=_R(),r=t(e);return Qo=r,Qo}var Jo,Tg;function oi(){if(Tg)return Jo;Tg=1;var e=Dt(),t=dx(),r=fx();function n(i,a){return r(t(i,a,e),i+"")}return Jo=n,Jo}var eu,Pg;function hx(){if(Pg)return eu;Pg=1;function e(t,r,n,i){for(var a=t.length,s=n+(i?1:-1);i?s--:++s<a;)if(r(t[s],s,t))return s;return-1}return eu=e,eu}var tu,Dg;function NR(){if(Dg)return tu;Dg=1;function e(t){return t!==t}return tu=e,tu}var ru,Lg;function ER(){if(Lg)return ru;Lg=1;function e(t,r,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===r)return i;return-1}return ru=e,ru}var nu,Og;function CR(){if(Og)return nu;Og=1;var e=hx(),t=NR(),r=ER();function n(i,a,s){return a===a?r(i,a,s):e(i,t,s)}return nu=n,nu}var iu,Fg;function SR(){if(Fg)return iu;Fg=1;var e=CR();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return iu=t,iu}var au,$g;function IR(){if($g)return au;$g=1;function e(t,r,n){for(var i=-1,a=t==null?0:t.length;++i<a;)if(n(r,t[i]))return!0;return!1}return au=e,au}var su,zg;function RR(){if(zg)return su;zg=1;function e(){}return su=e,su}var ou,Bg;function qR(){if(Bg)return ou;Bg=1;var e=$0(),t=RR(),r=id(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(a){return new e(a)}:t;return ou=i,ou}var uu,Hg;function kR(){if(Hg)return uu;Hg=1;var e=W0(),t=SR(),r=IR(),n=X0(),i=qR(),a=id(),s=200;function o(u,c,l){var d=-1,f=t,h=u.length,v=!0,x=[],y=x;if(l)v=!1,f=r;else if(h>=s){var p=c?null:i(u);if(p)return a(p);v=!1,f=n,y=new e}else y=c?[]:x;e:for(;++d<h;){var b=u[d],g=c?c(b):b;if(b=l||b!==0?b:0,v&&g===g){for(var w=y.length;w--;)if(y[w]===g)continue e;c&&y.push(g),x.push(b)}else f(y,g,l)||(y!==x&&y.push(g),x.push(b))}return x}return uu=o,uu}var cu,Vg;function px(){if(Vg)return cu;Vg=1;var e=ft(),t=rt();function r(n){return t(n)&&e(n)}return cu=r,cu}var lu,Gg;function AR(){if(Gg)return lu;Gg=1;var e=sd(),t=oi(),r=kR(),n=px(),i=t(function(a){return r(e(a,1,n,!0))});return lu=i,lu}var du,Ug;function jR(){if(Ug)return du;Ug=1;var e=ii();function t(r,n){return e(n,function(i){return r[i]})}return du=t,du}var fu,Kg;function gx(){if(Kg)return fu;Kg=1;var e=jR(),t=_t();function r(n){return n==null?[]:e(n,t(n))}return fu=r,fu}var hu,Yg;function Le(){if(Yg)return hu;Yg=1;var e;if(typeof Nl=="function")try{e={clone:FI(),constant:td(),each:Y0(),filter:ax(),has:sx(),isArray:_e(),isEmpty:cR(),isFunction:Hr(),isUndefined:ox(),keys:_t(),map:cx(),reduce:lx(),size:vR(),transform:yR(),union:AR(),values:gx()}}catch{}return e||(e=window._),hu=e,hu}var pu,Wg;function od(){if(Wg)return pu;Wg=1;var e=Le();pu=i;var t="\0",r="\0",n="";function i(l){this._isDirected=e.has(l,"directed")?l.directed:!0,this._isMultigraph=e.has(l,"multigraph")?l.multigraph:!1,this._isCompound=e.has(l,"compound")?l.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(l){return this._label=l,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(l){return e.isFunction(l)||(l=e.constant(l)),this._defaultNodeLabelFn=l,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var l=this;return e.filter(this.nodes(),function(d){return e.isEmpty(l._in[d])})},i.prototype.sinks=function(){var l=this;return e.filter(this.nodes(),function(d){return e.isEmpty(l._out[d])})},i.prototype.setNodes=function(l,d){var f=arguments,h=this;return e.each(l,function(v){f.length>1?h.setNode(v,d):h.setNode(v)}),this},i.prototype.setNode=function(l,d){return e.has(this._nodes,l)?(arguments.length>1&&(this._nodes[l]=d),this):(this._nodes[l]=arguments.length>1?d:this._defaultNodeLabelFn(l),this._isCompound&&(this._parent[l]=r,this._children[l]={},this._children[r][l]=!0),this._in[l]={},this._preds[l]={},this._out[l]={},this._sucs[l]={},++this._nodeCount,this)},i.prototype.node=function(l){return this._nodes[l]},i.prototype.hasNode=function(l){return e.has(this._nodes,l)},i.prototype.removeNode=function(l){var d=this;if(e.has(this._nodes,l)){var f=function(h){d.removeEdge(d._edgeObjs[h])};delete this._nodes[l],this._isCompound&&(this._removeFromParentsChildList(l),delete this._parent[l],e.each(this.children(l),function(h){d.setParent(h)}),delete this._children[l]),e.each(e.keys(this._in[l]),f),delete this._in[l],delete this._preds[l],e.each(e.keys(this._out[l]),f),delete this._out[l],delete this._sucs[l],--this._nodeCount}return this},i.prototype.setParent=function(l,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(d))d=r;else{d+="";for(var f=d;!e.isUndefined(f);f=this.parent(f))if(f===l)throw new Error("Setting "+d+" as parent of "+l+" would create a cycle");this.setNode(d)}return this.setNode(l),this._removeFromParentsChildList(l),this._parent[l]=d,this._children[d][l]=!0,this},i.prototype._removeFromParentsChildList=function(l){delete this._children[this._parent[l]][l]},i.prototype.parent=function(l){if(this._isCompound){var d=this._parent[l];if(d!==r)return d}},i.prototype.children=function(l){if(e.isUndefined(l)&&(l=r),this._isCompound){var d=this._children[l];if(d)return e.keys(d)}else{if(l===r)return this.nodes();if(this.hasNode(l))return[]}},i.prototype.predecessors=function(l){var d=this._preds[l];if(d)return e.keys(d)},i.prototype.successors=function(l){var d=this._sucs[l];if(d)return e.keys(d)},i.prototype.neighbors=function(l){var d=this.predecessors(l);if(d)return e.union(d,this.successors(l))},i.prototype.isLeaf=function(l){var d;return this.isDirected()?d=this.successors(l):d=this.neighbors(l),d.length===0},i.prototype.filterNodes=function(l){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;e.each(this._nodes,function(x,y){l(y)&&d.setNode(y,x)}),e.each(this._edgeObjs,function(x){d.hasNode(x.v)&&d.hasNode(x.w)&&d.setEdge(x,f.edge(x))});var h={};function v(x){var y=f.parent(x);return y===void 0||d.hasNode(y)?(h[x]=y,y):y in h?h[y]:v(y)}return this._isCompound&&e.each(d.nodes(),function(x){d.setParent(x,v(x))}),d},i.prototype.setDefaultEdgeLabel=function(l){return e.isFunction(l)||(l=e.constant(l)),this._defaultEdgeLabelFn=l,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(l,d){var f=this,h=arguments;return e.reduce(l,function(v,x){return h.length>1?f.setEdge(v,x,d):f.setEdge(v,x),x}),this},i.prototype.setEdge=function(){var l,d,f,h,v=!1,x=arguments[0];typeof x=="object"&&x!==null&&"v"in x?(l=x.v,d=x.w,f=x.name,arguments.length===2&&(h=arguments[1],v=!0)):(l=x,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],v=!0)),l=""+l,d=""+d,e.isUndefined(f)||(f=""+f);var y=o(this._isDirected,l,d,f);if(e.has(this._edgeLabels,y))return v&&(this._edgeLabels[y]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(l),this.setNode(d),this._edgeLabels[y]=v?h:this._defaultEdgeLabelFn(l,d,f);var p=u(this._isDirected,l,d,f);return l=p.v,d=p.w,Object.freeze(p),this._edgeObjs[y]=p,a(this._preds[d],l),a(this._sucs[l],d),this._in[d][y]=p,this._out[l][y]=p,this._edgeCount++,this},i.prototype.edge=function(l,d,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,l,d,f);return this._edgeLabels[h]},i.prototype.hasEdge=function(l,d,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,l,d,f);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(l,d,f){var h=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,l,d,f),v=this._edgeObjs[h];return v&&(l=v.v,d=v.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[d],l),s(this._sucs[l],d),delete this._in[d][h],delete this._out[l][h],this._edgeCount--),this},i.prototype.inEdges=function(l,d){var f=this._in[l];if(f){var h=e.values(f);return d?e.filter(h,function(v){return v.v===d}):h}},i.prototype.outEdges=function(l,d){var f=this._out[l];if(f){var h=e.values(f);return d?e.filter(h,function(v){return v.w===d}):h}},i.prototype.nodeEdges=function(l,d){var f=this.inEdges(l,d);if(f)return f.concat(this.outEdges(l,d))};function a(l,d){l[d]?l[d]++:l[d]=1}function s(l,d){--l[d]||delete l[d]}function o(l,d,f,h){var v=""+d,x=""+f;if(!l&&v>x){var y=v;v=x,x=y}return v+n+x+n+(e.isUndefined(h)?t:h)}function u(l,d,f,h){var v=""+d,x=""+f;if(!l&&v>x){var y=v;v=x,x=y}var p={v,w:x};return h&&(p.name=h),p}function c(l,d){return o(l,d.v,d.w,d.name)}return pu}var gu,Xg;function MR(){return Xg||(Xg=1,gu="2.1.8"),gu}var mu,Zg;function TR(){return Zg||(Zg=1,mu={Graph:od(),version:MR()}),mu}var vu,Qg;function PR(){if(Qg)return vu;Qg=1;var e=Le(),t=od();vu={write:r,read:a};function r(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:i(s)};return e.isUndefined(s.graph())||(o.value=e.clone(s.graph())),o}function n(s){return e.map(s.nodes(),function(o){var u=s.node(o),c=s.parent(o),l={v:o};return e.isUndefined(u)||(l.value=u),e.isUndefined(c)||(l.parent=c),l})}function i(s){return e.map(s.edges(),function(o){var u=s.edge(o),c={v:o.v,w:o.w};return e.isUndefined(o.name)||(c.name=o.name),e.isUndefined(u)||(c.value=u),c})}function a(s){var o=new t(s.options).setGraph(s.value);return e.each(s.nodes,function(u){o.setNode(u.v,u.value),u.parent&&o.setParent(u.v,u.parent)}),e.each(s.edges,function(u){o.setEdge({v:u.v,w:u.w,name:u.name},u.value)}),o}return vu}var yu,Jg;function DR(){if(Jg)return yu;Jg=1;var e=Le();yu=t;function t(r){var n={},i=[],a;function s(o){e.has(n,o)||(n[o]=!0,a.push(o),e.each(r.successors(o),s),e.each(r.predecessors(o),s))}return e.each(r.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return yu}var xu,em;function mx(){if(em)return xu;em=1;var e=Le();xu=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var i=this._keyIndices;if(r=String(r),!e.has(i,r)){var a=this._arr,s=a.length;return i[r]=s,a.push({key:r,priority:n}),this._decrease(s),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var i=this._keyIndices[r];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},t.prototype._heapify=function(r){var n=this._arr,i=2*r,a=i+1,s=r;i<n.length&&(s=n[i].priority<n[s].priority?i:s,a<n.length&&(s=n[a].priority<n[s].priority?a:s),s!==r&&(this._swap(r,s),this._heapify(s)))},t.prototype._decrease=function(r){for(var n=this._arr,i=n[r].priority,a;r!==0&&(a=r>>1,!(n[a].priority<i));)this._swap(r,a),r=a},t.prototype._swap=function(r,n){var i=this._arr,a=this._keyIndices,s=i[r],o=i[n];i[r]=o,i[n]=s,a[o.key]=r,a[s.key]=n},xu}var bu,tm;function vx(){if(tm)return bu;tm=1;var e=Le(),t=mx();bu=n;var r=e.constant(1);function n(a,s,o,u){return i(a,String(s),o||r,u||function(c){return a.outEdges(c)})}function i(a,s,o,u){var c={},l=new t,d,f,h=function(v){var x=v.v!==d?v.v:v.w,y=c[x],p=o(v),b=f.distance+p;if(p<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+p);b<y.distance&&(y.distance=b,y.predecessor=d,l.decrease(x,b))};for(a.nodes().forEach(function(v){var x=v===s?0:Number.POSITIVE_INFINITY;c[v]={distance:x},l.add(v,x)});l.size()>0&&(d=l.removeMin(),f=c[d],f.distance!==Number.POSITIVE_INFINITY);)u(d).forEach(h);return c}return bu}var wu,rm;function LR(){if(rm)return wu;rm=1;var e=vx(),t=Le();wu=r;function r(n,i,a){return t.transform(n.nodes(),function(s,o){s[o]=e(n,o,i,a)},{})}return wu}var _u,nm;function yx(){if(nm)return _u;nm=1;var e=Le();_u=t;function t(r){var n=0,i=[],a={},s=[];function o(u){var c=a[u]={onStack:!0,lowlink:n,index:n++};if(i.push(u),r.successors(u).forEach(function(f){e.has(a,f)?a[f].onStack&&(c.lowlink=Math.min(c.lowlink,a[f].index)):(o(f),c.lowlink=Math.min(c.lowlink,a[f].lowlink))}),c.lowlink===c.index){var l=[],d;do d=i.pop(),a[d].onStack=!1,l.push(d);while(u!==d);s.push(l)}}return r.nodes().forEach(function(u){e.has(a,u)||o(u)}),s}return _u}var Nu,im;function OR(){if(im)return Nu;im=1;var e=Le(),t=yx();Nu=r;function r(n){return e.filter(t(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Nu}var Eu,am;function FR(){if(am)return Eu;am=1;var e=Le();Eu=r;var t=e.constant(1);function r(i,a,s){return n(i,a||t,s||function(o){return i.outEdges(o)})}function n(i,a,s){var o={},u=i.nodes();return u.forEach(function(c){o[c]={},o[c][c]={distance:0},u.forEach(function(l){c!==l&&(o[c][l]={distance:Number.POSITIVE_INFINITY})}),s(c).forEach(function(l){var d=l.v===c?l.w:l.v,f=a(l);o[c][d]={distance:f,predecessor:c}})}),u.forEach(function(c){var l=o[c];u.forEach(function(d){var f=o[d];u.forEach(function(h){var v=f[c],x=l[h],y=f[h],p=v.distance+x.distance;p<y.distance&&(y.distance=p,y.predecessor=x.predecessor)})})}),o}return Eu}var Cu,sm;function xx(){if(sm)return Cu;sm=1;var e=Le();Cu=t,t.CycleException=r;function t(n){var i={},a={},s=[];function o(u){if(e.has(a,u))throw new r;e.has(i,u)||(a[u]=!0,i[u]=!0,e.each(n.predecessors(u),o),delete a[u],s.push(u))}if(e.each(n.sinks(),o),e.size(i)!==n.nodeCount())throw new r;return s}function r(){}return r.prototype=new Error,Cu}var Su,om;function $R(){if(om)return Su;om=1;var e=xx();Su=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return Su}var Iu,um;function bx(){if(um)return Iu;um=1;var e=Le();Iu=t;function t(n,i,a){e.isArray(i)||(i=[i]);var s=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],u={};return e.each(i,function(c){if(!n.hasNode(c))throw new Error("Graph does not have node: "+c);r(n,c,a==="post",u,s,o)}),o}function r(n,i,a,s,o,u){e.has(s,i)||(s[i]=!0,a||u.push(i),e.each(o(i),function(c){r(n,c,a,s,o,u)}),a&&u.push(i))}return Iu}var Ru,cm;function zR(){if(cm)return Ru;cm=1;var e=bx();Ru=t;function t(r,n){return e(r,n,"post")}return Ru}var qu,lm;function BR(){if(lm)return qu;lm=1;var e=bx();qu=t;function t(r,n){return e(r,n,"pre")}return qu}var ku,dm;function HR(){if(dm)return ku;dm=1;var e=Le(),t=od(),r=mx();ku=n;function n(i,a){var s=new t,o={},u=new r,c;function l(f){var h=f.v===c?f.w:f.v,v=u.priority(h);if(v!==void 0){var x=a(f);x<v&&(o[h]=c,u.decrease(h,x))}}if(i.nodeCount()===0)return s;e.each(i.nodes(),function(f){u.add(f,Number.POSITIVE_INFINITY),s.setNode(f)}),u.decrease(i.nodes()[0],0);for(var d=!1;u.size()>0;){if(c=u.removeMin(),e.has(o,c))s.setEdge(c,o[c]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(c).forEach(l)}return s}return ku}var Au,fm;function VR(){return fm||(fm=1,Au={components:DR(),dijkstra:vx(),dijkstraAll:LR(),findCycles:OR(),floydWarshall:FR(),isAcyclic:$R(),postorder:zR(),preorder:BR(),prim:HR(),tarjan:yx(),topsort:xx()}),Au}var ju,hm;function GR(){if(hm)return ju;hm=1;var e=TR();return ju={Graph:e.Graph,json:PR(),alg:VR(),version:e.version},ju}var Mu,pm;function Ue(){if(pm)return Mu;pm=1;var e;if(typeof Nl=="function")try{e=GR()}catch{}return e||(e=window.graphlib),Mu=e,Mu}var Tu,gm;function UR(){if(gm)return Tu;gm=1;var e=G0(),t=1,r=4;function n(i){return e(i,t|r)}return Tu=n,Tu}var Pu,mm;function ui(){if(mm)return Pu;mm=1;var e=tr(),t=ft(),r=Jn(),n=De();function i(a,s,o){if(!n(o))return!1;var u=typeof s;return(u=="number"?t(o)&&r(s,o.length):u=="string"&&s in o)?e(o[s],a):!1}return Pu=i,Pu}var Du,vm;function KR(){if(vm)return Du;vm=1;var e=oi(),t=tr(),r=ui(),n=Pt(),i=Object.prototype,a=i.hasOwnProperty,s=e(function(o,u){o=Object(o);var c=-1,l=u.length,d=l>2?u[2]:void 0;for(d&&r(u[0],u[1],d)&&(l=1);++c<l;)for(var f=u[c],h=n(f),v=-1,x=h.length;++v<x;){var y=h[v],p=o[y];(p===void 0||t(p,i[y])&&!a.call(o,y))&&(o[y]=f[y])}return o});return Du=s,Du}var Lu,ym;function YR(){if(ym)return Lu;ym=1;var e=ht(),t=ft(),r=_t();function n(i){return function(a,s,o){var u=Object(a);if(!t(a)){var c=e(s,3);a=r(a),s=function(d){return c(u[d],d,u)}}var l=i(a,s,o);return l>-1?u[c?a[l]:l]:void 0}}return Lu=n,Lu}var Ou,xm;function WR(){if(xm)return Ou;xm=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Ou=t,Ou}var Fu,bm;function XR(){if(bm)return Fu;bm=1;var e=WR(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return Fu=r,Fu}var $u,wm;function ZR(){if(wm)return $u;wm=1;var e=XR(),t=De(),r=ar(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function u(c){if(typeof c=="number")return c;if(r(c))return n;if(t(c)){var l=typeof c.valueOf=="function"?c.valueOf():c;c=t(l)?l+"":l}if(typeof c!="string")return c===0?c:+c;c=e(c);var d=a.test(c);return d||s.test(c)?o(c.slice(2),d?2:8):i.test(c)?n:+c}return $u=u,$u}var zu,_m;function wx(){if(_m)return zu;_m=1;var e=ZR(),t=1/0,r=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-t){var a=i<0?-1:1;return a*r}return i===i?i:0}return zu=n,zu}var Bu,Nm;function QR(){if(Nm)return Bu;Nm=1;var e=wx();function t(r){var n=e(r),i=n%1;return n===n?i?n-i:n:0}return Bu=t,Bu}var Hu,Em;function JR(){if(Em)return Hu;Em=1;var e=hx(),t=ht(),r=QR(),n=Math.max;function i(a,s,o){var u=a==null?0:a.length;if(!u)return-1;var c=o==null?0:r(o);return c<0&&(c=n(u+c,0)),e(a,t(s,3),c)}return Hu=i,Hu}var Vu,Cm;function eq(){if(Cm)return Vu;Cm=1;var e=YR(),t=JR(),r=e(t);return Vu=r,Vu}var Gu,Sm;function _x(){if(Sm)return Gu;Sm=1;var e=sd();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Gu=t,Gu}var Uu,Im;function tq(){if(Im)return Uu;Im=1;var e=rd(),t=U0(),r=Pt();function n(i,a){return i==null?i:e(i,t(a),r)}return Uu=n,Uu}var Ku,Rm;function rq(){if(Rm)return Ku;Rm=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Ku=e,Ku}var Yu,qm;function nq(){if(qm)return Yu;qm=1;var e=Zn(),t=nd(),r=ht();function n(i,a){var s={};return a=r(a,3),t(i,function(o,u,c){e(s,u,a(o,u,c))}),s}return Yu=n,Yu}var Wu,km;function ud(){if(km)return Wu;km=1;var e=ar();function t(r,n,i){for(var a=-1,s=r.length;++a<s;){var o=r[a],u=n(o);if(u!=null&&(c===void 0?u===u&&!e(u):i(u,c)))var c=u,l=o}return l}return Wu=t,Wu}var Xu,Am;function iq(){if(Am)return Xu;Am=1;function e(t,r){return t>r}return Xu=e,Xu}var Zu,jm;function aq(){if(jm)return Zu;jm=1;var e=ud(),t=iq(),r=Dt();function n(i){return i&&i.length?e(i,r,t):void 0}return Zu=n,Zu}var Qu,Mm;function Nx(){if(Mm)return Qu;Mm=1;var e=Zn(),t=tr();function r(n,i,a){(a!==void 0&&!t(n[i],a)||a===void 0&&!(i in n))&&e(n,i,a)}return Qu=r,Qu}var Ju,Tm;function sq(){if(Tm)return Ju;Tm=1;var e=Mt(),t=ri(),r=rt(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,u=s.call(Object);function c(l){if(!r(l)||e(l)!=n)return!1;var d=t(l);if(d===null)return!0;var f=o.call(d,"constructor")&&d.constructor;return typeof f=="function"&&f instanceof f&&s.call(f)==u}return Ju=c,Ju}var ec,Pm;function Ex(){if(Pm)return ec;Pm=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return ec=e,ec}var tc,Dm;function oq(){if(Dm)return tc;Dm=1;var e=Vr(),t=Pt();function r(n){return e(n,t(n))}return tc=r,tc}var rc,Lm;function uq(){if(Lm)return rc;Lm=1;var e=Nx(),t=M0(),r=B0(),n=T0(),i=V0(),a=Gr(),s=_e(),o=px(),u=nr(),c=Hr(),l=De(),d=sq(),f=Ur(),h=Ex(),v=oq();function x(y,p,b,g,w,_,E){var C=h(y,b),S=h(p,b),q=E.get(S);if(q){e(y,b,q);return}var M=_?_(C,S,b+"",y,p,E):void 0,R=M===void 0;if(R){var A=s(S),$=!A&&u(S),N=!A&&!$&&f(S);M=S,A||$||N?s(C)?M=C:o(C)?M=n(C):$?(R=!1,M=t(S,!0)):N?(R=!1,M=r(S,!0)):M=[]:d(S)||a(S)?(M=C,a(C)?M=v(C):(!l(C)||c(C))&&(M=i(S))):R=!1}R&&(E.set(S,M),w(M,S,g,_,E),E.delete(S)),e(y,b,M)}return rc=x,rc}var nc,Om;function cq(){if(Om)return nc;Om=1;var e=Xn(),t=Nx(),r=rd(),n=uq(),i=De(),a=Pt(),s=Ex();function o(u,c,l,d,f){u!==c&&r(c,function(h,v){if(f||(f=new e),i(h))n(u,c,v,l,o,d,f);else{var x=d?d(s(u,v),h,v+"",u,c,f):void 0;x===void 0&&(x=h),t(u,v,x)}},a)}return nc=o,nc}var ic,Fm;function lq(){if(Fm)return ic;Fm=1;var e=oi(),t=ui();function r(n){return e(function(i,a){var s=-1,o=a.length,u=o>1?a[o-1]:void 0,c=o>2?a[2]:void 0;for(u=n.length>3&&typeof u=="function"?(o--,u):void 0,c&&t(a[0],a[1],c)&&(u=o<3?void 0:u,o=1),i=Object(i);++s<o;){var l=a[s];l&&n(i,l,s,u)}return i})}return ic=r,ic}var ac,$m;function dq(){if($m)return ac;$m=1;var e=cq(),t=lq(),r=t(function(n,i,a){e(n,i,a)});return ac=r,ac}var sc,zm;function Cx(){if(zm)return sc;zm=1;function e(t,r){return t<r}return sc=e,sc}var oc,Bm;function fq(){if(Bm)return oc;Bm=1;var e=ud(),t=Cx(),r=Dt();function n(i){return i&&i.length?e(i,r,t):void 0}return oc=n,oc}var uc,Hm;function hq(){if(Hm)return uc;Hm=1;var e=ud(),t=ht(),r=Cx();function n(i,a){return i&&i.length?e(i,t(a,2),r):void 0}return uc=n,uc}var cc,Vm;function pq(){if(Vm)return cc;Vm=1;var e=Ye(),t=function(){return e.Date.now()};return cc=t,cc}var lc,Gm;function gq(){if(Gm)return lc;Gm=1;var e=Qn(),t=ai(),r=Jn(),n=De(),i=Kr();function a(s,o,u,c){if(!n(s))return s;o=t(o,s);for(var l=-1,d=o.length,f=d-1,h=s;h!=null&&++l<d;){var v=i(o[l]),x=u;if(v==="__proto__"||v==="constructor"||v==="prototype")return s;if(l!=f){var y=h[v];x=c?c(y,v,h):void 0,x===void 0&&(x=n(y)?y:r(o[l+1])?[]:{})}e(h,v,x),h=h[v]}return s}return lc=a,lc}var dc,Um;function mq(){if(Um)return dc;Um=1;var e=si(),t=gq(),r=ai();function n(i,a,s){for(var o=-1,u=a.length,c={};++o<u;){var l=a[o],d=e(i,l);s(d,l)&&t(c,r(l,i),d)}return c}return dc=n,dc}var fc,Km;function vq(){if(Km)return fc;Km=1;var e=mq(),t=nx();function r(n,i){return e(n,i,function(a,s){return t(n,s)})}return fc=r,fc}var hc,Ym;function yq(){if(Ym)return hc;Ym=1;var e=_x(),t=dx(),r=fx();function n(i){return r(t(i,void 0,e),i+"")}return hc=n,hc}var pc,Wm;function xq(){if(Wm)return pc;Wm=1;var e=vq(),t=yq(),r=t(function(n,i){return n==null?{}:e(n,i)});return pc=r,pc}var gc,Xm;function bq(){if(Xm)return gc;Xm=1;var e=Math.ceil,t=Math.max;function r(n,i,a,s){for(var o=-1,u=t(e((i-n)/(a||1)),0),c=Array(u);u--;)c[s?u:++o]=n,n+=a;return c}return gc=r,gc}var mc,Zm;function wq(){if(Zm)return mc;Zm=1;var e=bq(),t=ui(),r=wx();function n(i){return function(a,s,o){return o&&typeof o!="number"&&t(a,s,o)&&(s=o=void 0),a=r(a),s===void 0?(s=a,a=0):s=r(s),o=o===void 0?a<s?1:-1:r(o),e(a,s,o,i)}}return mc=n,mc}var vc,Qm;function _q(){if(Qm)return vc;Qm=1;var e=wq(),t=e();return vc=t,vc}var yc,Jm;function Nq(){if(Jm)return yc;Jm=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return yc=e,yc}var xc,ev;function Eq(){if(ev)return xc;ev=1;var e=ar();function t(r,n){if(r!==n){var i=r!==void 0,a=r===null,s=r===r,o=e(r),u=n!==void 0,c=n===null,l=n===n,d=e(n);if(!c&&!d&&!o&&r>n||o&&u&&l&&!c&&!d||a&&u&&l||!i&&l||!s)return 1;if(!a&&!o&&!d&&r<n||d&&i&&s&&!a&&!o||c&&i&&s||!u&&s||!l)return-1}return 0}return xc=t,xc}var bc,tv;function Cq(){if(tv)return bc;tv=1;var e=Eq();function t(r,n,i){for(var a=-1,s=r.criteria,o=n.criteria,u=s.length,c=i.length;++a<u;){var l=e(s[a],o[a]);if(l){if(a>=c)return l;var d=i[a];return l*(d=="desc"?-1:1)}}return r.index-n.index}return bc=t,bc}var wc,rv;function Sq(){if(rv)return wc;rv=1;var e=ii(),t=si(),r=ht(),n=ux(),i=Nq(),a=ei(),s=Cq(),o=Dt(),u=_e();function c(l,d,f){d.length?d=e(d,function(x){return u(x)?function(y){return t(y,x.length===1?x[0]:x)}:x}):d=[o];var h=-1;d=e(d,a(r));var v=n(l,function(x,y,p){var b=e(d,function(g){return g(x)});return{criteria:b,index:++h,value:x}});return i(v,function(x,y){return s(x,y,f)})}return wc=c,wc}var _c,nv;function Iq(){if(nv)return _c;nv=1;var e=sd(),t=Sq(),r=oi(),n=ui(),i=r(function(a,s){if(a==null)return[];var o=s.length;return o>1&&n(a,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(a,e(s,1),[])});return _c=i,_c}var Nc,iv;function Rq(){if(iv)return Nc;iv=1;var e=tx(),t=0;function r(n){var i=++t;return e(n)+i}return Nc=r,Nc}var Ec,av;function qq(){if(av)return Ec;av=1;function e(t,r,n){for(var i=-1,a=t.length,s=r.length,o={};++i<a;){var u=i<s?r[i]:void 0;n(o,t[i],u)}return o}return Ec=e,Ec}var Cc,sv;function kq(){if(sv)return Cc;sv=1;var e=Qn(),t=qq();function r(n,i){return t(n||[],i||[],e)}return Cc=r,Cc}var Sc,ov;function ge(){if(ov)return Sc;ov=1;var e;if(typeof Nl=="function")try{e={cloneDeep:UR(),constant:td(),defaults:KR(),each:Y0(),filter:ax(),find:eq(),flatten:_x(),forEach:K0(),forIn:tq(),has:sx(),isUndefined:ox(),last:rq(),map:cx(),mapValues:nq(),max:aq(),merge:dq(),min:fq(),minBy:hq(),now:pq(),pick:xq(),range:_q(),reduce:lx(),sortBy:Iq(),uniqueId:Rq(),values:gx(),zipObject:kq()}}catch{}return e||(e=window._),Sc=e,Sc}var Ic,uv;function Aq(){if(uv)return Ic;uv=1,Ic=e;function e(){var n={};n._next=n._prev=n,this._sentinel=n}e.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return t(i),i},e.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&t(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},e.prototype.toString=function(){for(var n=[],i=this._sentinel,a=i._prev;a!==i;)n.push(JSON.stringify(a,r)),a=a._prev;return"["+n.join(", ")+"]"};function t(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function r(n,i){if(n!=="_next"&&n!=="_prev")return i}return Ic}var Rc,cv;function jq(){if(cv)return Rc;cv=1;var e=ge(),t=Ue().Graph,r=Aq();Rc=i;var n=e.constant(1);function i(c,l){if(c.nodeCount()<=1)return[];var d=o(c,l||n),f=a(d.graph,d.buckets,d.zeroIdx);return e.flatten(e.map(f,function(h){return c.outEdges(h.v,h.w)}),!0)}function a(c,l,d){for(var f=[],h=l[l.length-1],v=l[0],x;c.nodeCount();){for(;x=v.dequeue();)s(c,l,d,x);for(;x=h.dequeue();)s(c,l,d,x);if(c.nodeCount()){for(var y=l.length-2;y>0;--y)if(x=l[y].dequeue(),x){f=f.concat(s(c,l,d,x,!0));break}}}return f}function s(c,l,d,f,h){var v=h?[]:void 0;return e.forEach(c.inEdges(f.v),function(x){var y=c.edge(x),p=c.node(x.v);h&&v.push({v:x.v,w:x.w}),p.out-=y,u(l,d,p)}),e.forEach(c.outEdges(f.v),function(x){var y=c.edge(x),p=x.w,b=c.node(p);b.in-=y,u(l,d,b)}),c.removeNode(f.v),v}function o(c,l){var d=new t,f=0,h=0;e.forEach(c.nodes(),function(y){d.setNode(y,{v:y,in:0,out:0})}),e.forEach(c.edges(),function(y){var p=d.edge(y.v,y.w)||0,b=l(y),g=p+b;d.setEdge(y.v,y.w,g),h=Math.max(h,d.node(y.v).out+=b),f=Math.max(f,d.node(y.w).in+=b)});var v=e.range(h+f+3).map(function(){return new r}),x=f+1;return e.forEach(d.nodes(),function(y){u(v,x,d.node(y))}),{graph:d,buckets:v,zeroIdx:x}}function u(c,l,d){d.out?d.in?c[d.out-d.in+l].enqueue(d):c[c.length-1].enqueue(d):c[0].enqueue(d)}return Rc}var qc,lv;function Mq(){if(lv)return qc;lv=1;var e=ge(),t=jq();qc={run:r,undo:i};function r(a){var s=a.graph().acyclicer==="greedy"?t(a,o(a)):n(a);e.forEach(s,function(u){var c=a.edge(u);a.removeEdge(u),c.forwardName=u.name,c.reversed=!0,a.setEdge(u.w,u.v,c,e.uniqueId("rev"))});function o(u){return function(c){return u.edge(c).weight}}}function n(a){var s=[],o={},u={};function c(l){e.has(u,l)||(u[l]=!0,o[l]=!0,e.forEach(a.outEdges(l),function(d){e.has(o,d.w)?s.push(d):c(d.w)}),delete o[l])}return e.forEach(a.nodes(),c),s}function i(a){e.forEach(a.edges(),function(s){var o=a.edge(s);if(o.reversed){a.removeEdge(s);var u=o.forwardName;delete o.reversed,delete o.forwardName,a.setEdge(s.w,s.v,o,u)}})}return qc}var kc,dv;function Ie(){if(dv)return kc;dv=1;var e=ge(),t=Ue().Graph;kc={addDummyNode:r,simplify:n,asNonCompoundGraph:i,successorWeights:a,predecessorWeights:s,intersectRect:o,buildLayerMatrix:u,normalizeRanks:c,removeEmptyRanks:l,addBorderNode:d,maxRank:f,partition:h,time:v,notime:x};function r(y,p,b,g){var w;do w=e.uniqueId(g);while(y.hasNode(w));return b.dummy=p,y.setNode(w,b),w}function n(y){var p=new t().setGraph(y.graph());return e.forEach(y.nodes(),function(b){p.setNode(b,y.node(b))}),e.forEach(y.edges(),function(b){var g=p.edge(b.v,b.w)||{weight:0,minlen:1},w=y.edge(b);p.setEdge(b.v,b.w,{weight:g.weight+w.weight,minlen:Math.max(g.minlen,w.minlen)})}),p}function i(y){var p=new t({multigraph:y.isMultigraph()}).setGraph(y.graph());return e.forEach(y.nodes(),function(b){y.children(b).length||p.setNode(b,y.node(b))}),e.forEach(y.edges(),function(b){p.setEdge(b,y.edge(b))}),p}function a(y){var p=e.map(y.nodes(),function(b){var g={};return e.forEach(y.outEdges(b),function(w){g[w.w]=(g[w.w]||0)+y.edge(w).weight}),g});return e.zipObject(y.nodes(),p)}function s(y){var p=e.map(y.nodes(),function(b){var g={};return e.forEach(y.inEdges(b),function(w){g[w.v]=(g[w.v]||0)+y.edge(w).weight}),g});return e.zipObject(y.nodes(),p)}function o(y,p){var b=y.x,g=y.y,w=p.x-b,_=p.y-g,E=y.width/2,C=y.height/2;if(!w&&!_)throw new Error("Not possible to find intersection inside of the rectangle");var S,q;return Math.abs(_)*E>Math.abs(w)*C?(_<0&&(C=-C),S=C*w/_,q=C):(w<0&&(E=-E),S=E,q=E*_/w),{x:b+S,y:g+q}}function u(y){var p=e.map(e.range(f(y)+1),function(){return[]});return e.forEach(y.nodes(),function(b){var g=y.node(b),w=g.rank;e.isUndefined(w)||(p[w][g.order]=b)}),p}function c(y){var p=e.min(e.map(y.nodes(),function(b){return y.node(b).rank}));e.forEach(y.nodes(),function(b){var g=y.node(b);e.has(g,"rank")&&(g.rank-=p)})}function l(y){var p=e.min(e.map(y.nodes(),function(_){return y.node(_).rank})),b=[];e.forEach(y.nodes(),function(_){var E=y.node(_).rank-p;b[E]||(b[E]=[]),b[E].push(_)});var g=0,w=y.graph().nodeRankFactor;e.forEach(b,function(_,E){e.isUndefined(_)&&E%w!==0?--g:g&&e.forEach(_,function(C){y.node(C).rank+=g})})}function d(y,p,b,g){var w={width:0,height:0};return arguments.length>=4&&(w.rank=b,w.order=g),r(y,"border",w,p)}function f(y){return e.max(e.map(y.nodes(),function(p){var b=y.node(p).rank;if(!e.isUndefined(b))return b}))}function h(y,p){var b={lhs:[],rhs:[]};return e.forEach(y,function(g){p(g)?b.lhs.push(g):b.rhs.push(g)}),b}function v(y,p){var b=e.now();try{return p()}finally{console.log(y+" time: "+(e.now()-b)+"ms")}}function x(y,p){return p()}return kc}var Ac,fv;function Tq(){if(fv)return Ac;fv=1;var e=ge(),t=Ie();Ac={run:r,undo:i};function r(a){a.graph().dummyChains=[],e.forEach(a.edges(),function(s){n(a,s)})}function n(a,s){var o=s.v,u=a.node(o).rank,c=s.w,l=a.node(c).rank,d=s.name,f=a.edge(s),h=f.labelRank;if(l!==u+1){a.removeEdge(s);var v,x,y;for(y=0,++u;u<l;++y,++u)f.points=[],x={width:0,height:0,edgeLabel:f,edgeObj:s,rank:u},v=t.addDummyNode(a,"edge",x,"_d"),u===h&&(x.width=f.width,x.height=f.height,x.dummy="edge-label",x.labelpos=f.labelpos),a.setEdge(o,v,{weight:f.weight},d),y===0&&a.graph().dummyChains.push(v),o=v;a.setEdge(o,c,{weight:f.weight},d)}}function i(a){e.forEach(a.graph().dummyChains,function(s){var o=a.node(s),u=o.edgeLabel,c;for(a.setEdge(o.edgeObj,u);o.dummy;)c=a.successors(s)[0],a.removeNode(s),u.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(u.x=o.x,u.y=o.y,u.width=o.width,u.height=o.height),s=c,o=a.node(s)})}return Ac}var jc,hv;function jn(){if(hv)return jc;hv=1;var e=ge();jc={longestPath:t,slack:r};function t(n){var i={};function a(s){var o=n.node(s);if(e.has(i,s))return o.rank;i[s]=!0;var u=e.min(e.map(n.outEdges(s),function(c){return a(c.w)-n.edge(c).minlen}));return(u===Number.POSITIVE_INFINITY||u===void 0||u===null)&&(u=0),o.rank=u}e.forEach(n.sources(),a)}function r(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return jc}var Mc,pv;function Sx(){if(pv)return Mc;pv=1;var e=ge(),t=Ue().Graph,r=jn().slack;Mc=n;function n(o){var u=new t({directed:!1}),c=o.nodes()[0],l=o.nodeCount();u.setNode(c,{});for(var d,f;i(u,o)<l;)d=a(u,o),f=u.hasNode(d.v)?r(o,d):-r(o,d),s(u,o,f);return u}function i(o,u){function c(l){e.forEach(u.nodeEdges(l),function(d){var f=d.v,h=l===f?d.w:f;!o.hasNode(h)&&!r(u,d)&&(o.setNode(h,{}),o.setEdge(l,h,{}),c(h))})}return e.forEach(o.nodes(),c),o.nodeCount()}function a(o,u){return e.minBy(u.edges(),function(c){if(o.hasNode(c.v)!==o.hasNode(c.w))return r(u,c)})}function s(o,u,c){e.forEach(o.nodes(),function(l){u.node(l).rank+=c})}return Mc}var Tc,gv;function Pq(){if(gv)return Tc;gv=1;var e=ge(),t=Sx(),r=jn().slack,n=jn().longestPath,i=Ue().alg.preorder,a=Ue().alg.postorder,s=Ie().simplify;Tc=o,o.initLowLimValues=d,o.initCutValues=u,o.calcCutValue=l,o.leaveEdge=h,o.enterEdge=v,o.exchangeEdges=x;function o(g){g=s(g),n(g);var w=t(g);d(w),u(w,g);for(var _,E;_=h(w);)E=v(w,g,_),x(w,g,_,E)}function u(g,w){var _=a(g,g.nodes());_=_.slice(0,_.length-1),e.forEach(_,function(E){c(g,w,E)})}function c(g,w,_){var E=g.node(_),C=E.parent;g.edge(_,C).cutvalue=l(g,w,_)}function l(g,w,_){var E=g.node(_),C=E.parent,S=!0,q=w.edge(_,C),M=0;return q||(S=!1,q=w.edge(C,_)),M=q.weight,e.forEach(w.nodeEdges(_),function(R){var A=R.v===_,$=A?R.w:R.v;if($!==C){var N=A===S,I=w.edge(R).weight;if(M+=N?I:-I,p(g,_,$)){var k=g.edge(_,$).cutvalue;M+=N?-k:k}}}),M}function d(g,w){arguments.length<2&&(w=g.nodes()[0]),f(g,{},1,w)}function f(g,w,_,E,C){var S=_,q=g.node(E);return w[E]=!0,e.forEach(g.neighbors(E),function(M){e.has(w,M)||(_=f(g,w,_,M,E))}),q.low=S,q.lim=_++,C?q.parent=C:delete q.parent,_}function h(g){return e.find(g.edges(),function(w){return g.edge(w).cutvalue<0})}function v(g,w,_){var E=_.v,C=_.w;w.hasEdge(E,C)||(E=_.w,C=_.v);var S=g.node(E),q=g.node(C),M=S,R=!1;S.lim>q.lim&&(M=q,R=!0);var A=e.filter(w.edges(),function($){return R===b(g,g.node($.v),M)&&R!==b(g,g.node($.w),M)});return e.minBy(A,function($){return r(w,$)})}function x(g,w,_,E){var C=_.v,S=_.w;g.removeEdge(C,S),g.setEdge(E.v,E.w,{}),d(g),u(g,w),y(g,w)}function y(g,w){var _=e.find(g.nodes(),function(C){return!w.node(C).parent}),E=i(g,_);E=E.slice(1),e.forEach(E,function(C){var S=g.node(C).parent,q=w.edge(C,S),M=!1;q||(q=w.edge(S,C),M=!0),w.node(C).rank=w.node(S).rank+(M?q.minlen:-q.minlen)})}function p(g,w,_){return g.hasEdge(w,_)}function b(g,w,_){return _.low<=w.lim&&w.lim<=_.lim}return Tc}var Pc,mv;function Dq(){if(mv)return Pc;mv=1;var e=jn(),t=e.longestPath,r=Sx(),n=Pq();Pc=i;function i(u){switch(u.graph().ranker){case"network-simplex":o(u);break;case"tight-tree":s(u);break;case"longest-path":a(u);break;default:o(u)}}var a=t;function s(u){t(u),r(u)}function o(u){n(u)}return Pc}var Dc,vv;function Lq(){if(vv)return Dc;vv=1;var e=ge();Dc=t;function t(i){var a=n(i);e.forEach(i.graph().dummyChains,function(s){for(var o=i.node(s),u=o.edgeObj,c=r(i,a,u.v,u.w),l=c.path,d=c.lca,f=0,h=l[f],v=!0;s!==u.w;){if(o=i.node(s),v){for(;(h=l[f])!==d&&i.node(h).maxRank<o.rank;)f++;h===d&&(v=!1)}if(!v){for(;f<l.length-1&&i.node(h=l[f+1]).minRank<=o.rank;)f++;h=l[f]}i.setParent(s,h),s=i.successors(s)[0]}})}function r(i,a,s,o){var u=[],c=[],l=Math.min(a[s].low,a[o].low),d=Math.max(a[s].lim,a[o].lim),f,h;f=s;do f=i.parent(f),u.push(f);while(f&&(a[f].low>l||d>a[f].lim));for(h=f,f=o;(f=i.parent(f))!==h;)c.push(f);return{path:u.concat(c.reverse()),lca:h}}function n(i){var a={},s=0;function o(u){var c=s;e.forEach(i.children(u),o),a[u]={low:c,lim:s++}}return e.forEach(i.children(),o),a}return Dc}var Lc,yv;function Oq(){if(yv)return Lc;yv=1;var e=ge(),t=Ie();Lc={run:r,cleanup:s};function r(o){var u=t.addDummyNode(o,"root",{},"_root"),c=i(o),l=e.max(e.values(c))-1,d=2*l+1;o.graph().nestingRoot=u,e.forEach(o.edges(),function(h){o.edge(h).minlen*=d});var f=a(o)+1;e.forEach(o.children(),function(h){n(o,u,d,f,l,c,h)}),o.graph().nodeRankFactor=d}function n(o,u,c,l,d,f,h){var v=o.children(h);if(!v.length){h!==u&&o.setEdge(u,h,{weight:0,minlen:c});return}var x=t.addBorderNode(o,"_bt"),y=t.addBorderNode(o,"_bb"),p=o.node(h);o.setParent(x,h),p.borderTop=x,o.setParent(y,h),p.borderBottom=y,e.forEach(v,function(b){n(o,u,c,l,d,f,b);var g=o.node(b),w=g.borderTop?g.borderTop:b,_=g.borderBottom?g.borderBottom:b,E=g.borderTop?l:2*l,C=w!==_?1:d-f[h]+1;o.setEdge(x,w,{weight:E,minlen:C,nestingEdge:!0}),o.setEdge(_,y,{weight:E,minlen:C,nestingEdge:!0})}),o.parent(h)||o.setEdge(u,x,{weight:0,minlen:d+f[h]})}function i(o){var u={};function c(l,d){var f=o.children(l);f&&f.length&&e.forEach(f,function(h){c(h,d+1)}),u[l]=d}return e.forEach(o.children(),function(l){c(l,1)}),u}function a(o){return e.reduce(o.edges(),function(u,c){return u+o.edge(c).weight},0)}function s(o){var u=o.graph();o.removeNode(u.nestingRoot),delete u.nestingRoot,e.forEach(o.edges(),function(c){var l=o.edge(c);l.nestingEdge&&o.removeEdge(c)})}return Lc}var Oc,xv;function Fq(){if(xv)return Oc;xv=1;var e=ge(),t=Ie();Oc=r;function r(i){function a(s){var o=i.children(s),u=i.node(s);if(o.length&&e.forEach(o,a),e.has(u,"minRank")){u.borderLeft=[],u.borderRight=[];for(var c=u.minRank,l=u.maxRank+1;c<l;++c)n(i,"borderLeft","_bl",s,u,c),n(i,"borderRight","_br",s,u,c)}}e.forEach(i.children(),a)}function n(i,a,s,o,u,c){var l={width:0,height:0,rank:c,borderType:a},d=u[a][c-1],f=t.addDummyNode(i,"border",l,s);u[a][c]=f,i.setParent(f,o),d&&i.setEdge(d,f,{weight:1})}return Oc}var Fc,bv;function $q(){if(bv)return Fc;bv=1;var e=ge();Fc={adjust:t,undo:r};function t(c){var l=c.graph().rankdir.toLowerCase();(l==="lr"||l==="rl")&&n(c)}function r(c){var l=c.graph().rankdir.toLowerCase();(l==="bt"||l==="rl")&&a(c),(l==="lr"||l==="rl")&&(o(c),n(c))}function n(c){e.forEach(c.nodes(),function(l){i(c.node(l))}),e.forEach(c.edges(),function(l){i(c.edge(l))})}function i(c){var l=c.width;c.width=c.height,c.height=l}function a(c){e.forEach(c.nodes(),function(l){s(c.node(l))}),e.forEach(c.edges(),function(l){var d=c.edge(l);e.forEach(d.points,s),e.has(d,"y")&&s(d)})}function s(c){c.y=-c.y}function o(c){e.forEach(c.nodes(),function(l){u(c.node(l))}),e.forEach(c.edges(),function(l){var d=c.edge(l);e.forEach(d.points,u),e.has(d,"x")&&u(d)})}function u(c){var l=c.x;c.x=c.y,c.y=l}return Fc}var $c,wv;function zq(){if(wv)return $c;wv=1;var e=ge();$c=t;function t(r){var n={},i=e.filter(r.nodes(),function(c){return!r.children(c).length}),a=e.max(e.map(i,function(c){return r.node(c).rank})),s=e.map(e.range(a+1),function(){return[]});function o(c){if(!e.has(n,c)){n[c]=!0;var l=r.node(c);s[l.rank].push(c),e.forEach(r.successors(c),o)}}var u=e.sortBy(i,function(c){return r.node(c).rank});return e.forEach(u,o),s}return $c}var zc,_v;function Bq(){if(_v)return zc;_v=1;var e=ge();zc=t;function t(n,i){for(var a=0,s=1;s<i.length;++s)a+=r(n,i[s-1],i[s]);return a}function r(n,i,a){for(var s=e.zipObject(a,e.map(a,function(f,h){return h})),o=e.flatten(e.map(i,function(f){return e.sortBy(e.map(n.outEdges(f),function(h){return{pos:s[h.w],weight:n.edge(h).weight}}),"pos")}),!0),u=1;u<a.length;)u<<=1;var c=2*u-1;u-=1;var l=e.map(new Array(c),function(){return 0}),d=0;return e.forEach(o.forEach(function(f){var h=f.pos+u;l[h]+=f.weight;for(var v=0;h>0;)h%2&&(v+=l[h+1]),h=h-1>>1,l[h]+=f.weight;d+=f.weight*v})),d}return zc}var Bc,Nv;function Hq(){if(Nv)return Bc;Nv=1;var e=ge();Bc=t;function t(r,n){return e.map(n,function(i){var a=r.inEdges(i);if(a.length){var s=e.reduce(a,function(o,u){var c=r.edge(u),l=r.node(u.v);return{sum:o.sum+c.weight*l.order,weight:o.weight+c.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return Bc}var Hc,Ev;function Vq(){if(Ev)return Hc;Ev=1;var e=ge();Hc=t;function t(i,a){var s={};e.forEach(i,function(u,c){var l=s[u.v]={indegree:0,in:[],out:[],vs:[u.v],i:c};e.isUndefined(u.barycenter)||(l.barycenter=u.barycenter,l.weight=u.weight)}),e.forEach(a.edges(),function(u){var c=s[u.v],l=s[u.w];!e.isUndefined(c)&&!e.isUndefined(l)&&(l.indegree++,c.out.push(s[u.w]))});var o=e.filter(s,function(u){return!u.indegree});return r(o)}function r(i){var a=[];function s(c){return function(l){l.merged||(e.isUndefined(l.barycenter)||e.isUndefined(c.barycenter)||l.barycenter>=c.barycenter)&&n(c,l)}}function o(c){return function(l){l.in.push(c),--l.indegree===0&&i.push(l)}}for(;i.length;){var u=i.pop();a.push(u),e.forEach(u.in.reverse(),s(u)),e.forEach(u.out,o(u))}return e.map(e.filter(a,function(c){return!c.merged}),function(c){return e.pick(c,["vs","i","barycenter","weight"])})}function n(i,a){var s=0,o=0;i.weight&&(s+=i.barycenter*i.weight,o+=i.weight),a.weight&&(s+=a.barycenter*a.weight,o+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=s/o,i.weight=o,i.i=Math.min(a.i,i.i),a.merged=!0}return Hc}var Vc,Cv;function Gq(){if(Cv)return Vc;Cv=1;var e=ge(),t=Ie();Vc=r;function r(a,s){var o=t.partition(a,function(x){return e.has(x,"barycenter")}),u=o.lhs,c=e.sortBy(o.rhs,function(x){return-x.i}),l=[],d=0,f=0,h=0;u.sort(i(!!s)),h=n(l,c,h),e.forEach(u,function(x){h+=x.vs.length,l.push(x.vs),d+=x.barycenter*x.weight,f+=x.weight,h=n(l,c,h)});var v={vs:e.flatten(l,!0)};return f&&(v.barycenter=d/f,v.weight=f),v}function n(a,s,o){for(var u;s.length&&(u=e.last(s)).i<=o;)s.pop(),a.push(u.vs),o++;return o}function i(a){return function(s,o){return s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:a?o.i-s.i:s.i-o.i}}return Vc}var Gc,Sv;function Uq(){if(Sv)return Gc;Sv=1;var e=ge(),t=Hq(),r=Vq(),n=Gq();Gc=i;function i(o,u,c,l){var d=o.children(u),f=o.node(u),h=f?f.borderLeft:void 0,v=f?f.borderRight:void 0,x={};h&&(d=e.filter(d,function(_){return _!==h&&_!==v}));var y=t(o,d);e.forEach(y,function(_){if(o.children(_.v).length){var E=i(o,_.v,c,l);x[_.v]=E,e.has(E,"barycenter")&&s(_,E)}});var p=r(y,c);a(p,x);var b=n(p,l);if(h&&(b.vs=e.flatten([h,b.vs,v],!0),o.predecessors(h).length)){var g=o.node(o.predecessors(h)[0]),w=o.node(o.predecessors(v)[0]);e.has(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+g.order+w.order)/(b.weight+2),b.weight+=2}return b}function a(o,u){e.forEach(o,function(c){c.vs=e.flatten(c.vs.map(function(l){return u[l]?u[l].vs:l}),!0)})}function s(o,u){e.isUndefined(o.barycenter)?(o.barycenter=u.barycenter,o.weight=u.weight):(o.barycenter=(o.barycenter*o.weight+u.barycenter*u.weight)/(o.weight+u.weight),o.weight+=u.weight)}return Gc}var Uc,Iv;function Kq(){if(Iv)return Uc;Iv=1;var e=ge(),t=Ue().Graph;Uc=r;function r(i,a,s){var o=n(i),u=new t({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(c){return i.node(c)});return e.forEach(i.nodes(),function(c){var l=i.node(c),d=i.parent(c);(l.rank===a||l.minRank<=a&&a<=l.maxRank)&&(u.setNode(c),u.setParent(c,d||o),e.forEach(i[s](c),function(f){var h=f.v===c?f.w:f.v,v=u.edge(h,c),x=e.isUndefined(v)?0:v.weight;u.setEdge(h,c,{weight:i.edge(f).weight+x})}),e.has(l,"minRank")&&u.setNode(c,{borderLeft:l.borderLeft[a],borderRight:l.borderRight[a]}))}),u}function n(i){for(var a;i.hasNode(a=e.uniqueId("_root")););return a}return Uc}var Kc,Rv;function Yq(){if(Rv)return Kc;Rv=1;var e=ge();Kc=t;function t(r,n,i){var a={},s;e.forEach(i,function(o){for(var u=r.parent(o),c,l;u;){if(c=r.parent(u),c?(l=a[c],a[c]=u):(l=s,s=u),l&&l!==u){n.setEdge(l,u);return}u=c}})}return Kc}var Yc,qv;function Wq(){if(qv)return Yc;qv=1;var e=ge(),t=zq(),r=Bq(),n=Uq(),i=Kq(),a=Yq(),s=Ue().Graph,o=Ie();Yc=u;function u(f){var h=o.maxRank(f),v=c(f,e.range(1,h+1),"inEdges"),x=c(f,e.range(h-1,-1,-1),"outEdges"),y=t(f);d(f,y);for(var p=Number.POSITIVE_INFINITY,b,g=0,w=0;w<4;++g,++w){l(g%2?v:x,g%4>=2),y=o.buildLayerMatrix(f);var _=r(f,y);_<p&&(w=0,b=e.cloneDeep(y),p=_)}d(f,b)}function c(f,h,v){return e.map(h,function(x){return i(f,x,v)})}function l(f,h){var v=new s;e.forEach(f,function(x){var y=x.graph().root,p=n(x,y,v,h);e.forEach(p.vs,function(b,g){x.node(b).order=g}),a(x,v,p.vs)})}function d(f,h){e.forEach(h,function(v){e.forEach(v,function(x,y){f.node(x).order=y})})}return Yc}var Wc,kv;function Xq(){if(kv)return Wc;kv=1;var e=ge(),t=Ue().Graph,r=Ie();Wc={positionX:v,findType1Conflicts:n,findType2Conflicts:i,addConflict:s,hasConflict:o,verticalAlignment:u,horizontalCompaction:c,alignCoordinates:f,findSmallestWidthAlignment:d,balance:h};function n(p,b){var g={};function w(_,E){var C=0,S=0,q=_.length,M=e.last(E);return e.forEach(E,function(R,A){var $=a(p,R),N=$?p.node($).order:q;($||R===M)&&(e.forEach(E.slice(S,A+1),function(I){e.forEach(p.predecessors(I),function(k){var L=p.node(k),P=L.order;(P<C||N<P)&&!(L.dummy&&p.node(I).dummy)&&s(g,k,I)})}),S=A+1,C=N)}),E}return e.reduce(b,w),g}function i(p,b){var g={};function w(E,C,S,q,M){var R;e.forEach(e.range(C,S),function(A){R=E[A],p.node(R).dummy&&e.forEach(p.predecessors(R),function($){var N=p.node($);N.dummy&&(N.order<q||N.order>M)&&s(g,$,R)})})}function _(E,C){var S=-1,q,M=0;return e.forEach(C,function(R,A){if(p.node(R).dummy==="border"){var $=p.predecessors(R);$.length&&(q=p.node($[0]).order,w(C,M,A,S,q),M=A,S=q)}w(C,M,C.length,q,E.length)}),C}return e.reduce(b,_),g}function a(p,b){if(p.node(b).dummy)return e.find(p.predecessors(b),function(g){return p.node(g).dummy})}function s(p,b,g){if(b>g){var w=b;b=g,g=w}var _=p[b];_||(p[b]=_={}),_[g]=!0}function o(p,b,g){if(b>g){var w=b;b=g,g=w}return e.has(p[b],g)}function u(p,b,g,w){var _={},E={},C={};return e.forEach(b,function(S){e.forEach(S,function(q,M){_[q]=q,E[q]=q,C[q]=M})}),e.forEach(b,function(S){var q=-1;e.forEach(S,function(M){var R=w(M);if(R.length){R=e.sortBy(R,function(k){return C[k]});for(var A=(R.length-1)/2,$=Math.floor(A),N=Math.ceil(A);$<=N;++$){var I=R[$];E[M]===M&&q<C[I]&&!o(g,M,I)&&(E[I]=M,E[M]=_[M]=_[I],q=C[I])}}})}),{root:_,align:E}}function c(p,b,g,w,_){var E={},C=l(p,b,g,_),S=_?"borderLeft":"borderRight";function q(A,$){for(var N=C.nodes(),I=N.pop(),k={};I;)k[I]?A(I):(k[I]=!0,N.push(I),N=N.concat($(I))),I=N.pop()}function M(A){E[A]=C.inEdges(A).reduce(function($,N){return Math.max($,E[N.v]+C.edge(N))},0)}function R(A){var $=C.outEdges(A).reduce(function(I,k){return Math.min(I,E[k.w]-C.edge(k))},Number.POSITIVE_INFINITY),N=p.node(A);$!==Number.POSITIVE_INFINITY&&N.borderType!==S&&(E[A]=Math.max(E[A],$))}return q(M,C.predecessors.bind(C)),q(R,C.successors.bind(C)),e.forEach(w,function(A){E[A]=E[g[A]]}),E}function l(p,b,g,w){var _=new t,E=p.graph(),C=x(E.nodesep,E.edgesep,w);return e.forEach(b,function(S){var q;e.forEach(S,function(M){var R=g[M];if(_.setNode(R),q){var A=g[q],$=_.edge(A,R);_.setEdge(A,R,Math.max(C(p,M,q),$||0))}q=M})}),_}function d(p,b){return e.minBy(e.values(b),function(g){var w=Number.NEGATIVE_INFINITY,_=Number.POSITIVE_INFINITY;return e.forIn(g,function(E,C){var S=y(p,C)/2;w=Math.max(E+S,w),_=Math.min(E-S,_)}),w-_})}function f(p,b){var g=e.values(b),w=e.min(g),_=e.max(g);e.forEach(["u","d"],function(E){e.forEach(["l","r"],function(C){var S=E+C,q=p[S],M;if(q!==b){var R=e.values(q);M=C==="l"?w-e.min(R):_-e.max(R),M&&(p[S]=e.mapValues(q,function(A){return A+M}))}})})}function h(p,b){return e.mapValues(p.ul,function(g,w){if(b)return p[b.toLowerCase()][w];var _=e.sortBy(e.map(p,w));return(_[1]+_[2])/2})}function v(p){var b=r.buildLayerMatrix(p),g=e.merge(n(p,b),i(p,b)),w={},_;e.forEach(["u","d"],function(C){_=C==="u"?b:e.values(b).reverse(),e.forEach(["l","r"],function(S){S==="r"&&(_=e.map(_,function(A){return e.values(A).reverse()}));var q=(C==="u"?p.predecessors:p.successors).bind(p),M=u(p,_,g,q),R=c(p,_,M.root,M.align,S==="r");S==="r"&&(R=e.mapValues(R,function(A){return-A})),w[C+S]=R})});var E=d(p,w);return f(w,E),h(w,p.graph().align)}function x(p,b,g){return function(w,_,E){var C=w.node(_),S=w.node(E),q=0,M;if(q+=C.width/2,e.has(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":M=-C.width/2;break;case"r":M=C.width/2;break}if(M&&(q+=g?M:-M),M=0,q+=(C.dummy?b:p)/2,q+=(S.dummy?b:p)/2,q+=S.width/2,e.has(S,"labelpos"))switch(S.labelpos.toLowerCase()){case"l":M=S.width/2;break;case"r":M=-S.width/2;break}return M&&(q+=g?M:-M),M=0,q}}function y(p,b){return p.node(b).width}return Wc}var Xc,Av;function Zq(){if(Av)return Xc;Av=1;var e=ge(),t=Ie(),r=Xq().positionX;Xc=n;function n(a){a=t.asNonCompoundGraph(a),i(a),e.forEach(r(a),function(s,o){a.node(o).x=s})}function i(a){var s=t.buildLayerMatrix(a),o=a.graph().ranksep,u=0;e.forEach(s,function(c){var l=e.max(e.map(c,function(d){return a.node(d).height}));e.forEach(c,function(d){a.node(d).y=u+l/2}),u+=l+o})}return Xc}var Zc,jv;function Qq(){if(jv)return Zc;jv=1;var e=ge(),t=Mq(),r=Tq(),n=Dq(),i=Ie().normalizeRanks,a=Lq(),s=Ie().removeEmptyRanks,o=Oq(),u=Fq(),c=$q(),l=Wq(),d=Zq(),f=Ie(),h=Ue().Graph;Zc=v;function v(T,F){var z=F&&F.debugTiming?f.time:f.notime;z("layout",function(){var V=z("  buildLayoutGraph",function(){return q(T)});z("  runLayout",function(){x(V,z)}),z("  updateInputGraph",function(){y(T,V)})})}function x(T,F){F("    makeSpaceForEdgeLabels",function(){M(T)}),F("    removeSelfEdges",function(){D(T)}),F("    acyclic",function(){t.run(T)}),F("    nestingGraph.run",function(){o.run(T)}),F("    rank",function(){n(f.asNonCompoundGraph(T))}),F("    injectEdgeLabelProxies",function(){R(T)}),F("    removeEmptyRanks",function(){s(T)}),F("    nestingGraph.cleanup",function(){o.cleanup(T)}),F("    normalizeRanks",function(){i(T)}),F("    assignRankMinMax",function(){A(T)}),F("    removeEdgeLabelProxies",function(){$(T)}),F("    normalize.run",function(){r.run(T)}),F("    parentDummyChains",function(){a(T)}),F("    addBorderSegments",function(){u(T)}),F("    order",function(){l(T)}),F("    insertSelfEdges",function(){B(T)}),F("    adjustCoordinateSystem",function(){c.adjust(T)}),F("    position",function(){d(T)}),F("    positionSelfEdges",function(){K(T)}),F("    removeBorderNodes",function(){P(T)}),F("    normalize.undo",function(){r.undo(T)}),F("    fixupEdgeLabelCoords",function(){k(T)}),F("    undoCoordinateSystem",function(){c.undo(T)}),F("    translateGraph",function(){N(T)}),F("    assignNodeIntersects",function(){I(T)}),F("    reversePoints",function(){L(T)}),F("    acyclic.undo",function(){t.undo(T)})}function y(T,F){e.forEach(T.nodes(),function(z){var V=T.node(z),G=F.node(z);V&&(V.x=G.x,V.y=G.y,F.children(z).length&&(V.width=G.width,V.height=G.height))}),e.forEach(T.edges(),function(z){var V=T.edge(z),G=F.edge(z);V.points=G.points,e.has(G,"x")&&(V.x=G.x,V.y=G.y)}),T.graph().width=F.graph().width,T.graph().height=F.graph().height}var p=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},g=["acyclicer","ranker","rankdir","align"],w=["width","height"],_={width:0,height:0},E=["minlen","weight","width","height","labeloffset"],C={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function q(T){var F=new h({multigraph:!0,compound:!0}),z=Q(T.graph());return F.setGraph(e.merge({},b,H(z,p),e.pick(z,g))),e.forEach(T.nodes(),function(V){var G=Q(T.node(V));F.setNode(V,e.defaults(H(G,w),_)),F.setParent(V,T.parent(V))}),e.forEach(T.edges(),function(V){var G=Q(T.edge(V));F.setEdge(V,e.merge({},C,H(G,E),e.pick(G,S)))}),F}function M(T){var F=T.graph();F.ranksep/=2,e.forEach(T.edges(),function(z){var V=T.edge(z);V.minlen*=2,V.labelpos.toLowerCase()!=="c"&&(F.rankdir==="TB"||F.rankdir==="BT"?V.width+=V.labeloffset:V.height+=V.labeloffset)})}function R(T){e.forEach(T.edges(),function(F){var z=T.edge(F);if(z.width&&z.height){var V=T.node(F.v),G=T.node(F.w),W={rank:(G.rank-V.rank)/2+V.rank,e:F};f.addDummyNode(T,"edge-proxy",W,"_ep")}})}function A(T){var F=0;e.forEach(T.nodes(),function(z){var V=T.node(z);V.borderTop&&(V.minRank=T.node(V.borderTop).rank,V.maxRank=T.node(V.borderBottom).rank,F=e.max(F,V.maxRank))}),T.graph().maxRank=F}function $(T){e.forEach(T.nodes(),function(F){var z=T.node(F);z.dummy==="edge-proxy"&&(T.edge(z.e).labelRank=z.rank,T.removeNode(F))})}function N(T){var F=Number.POSITIVE_INFINITY,z=0,V=Number.POSITIVE_INFINITY,G=0,W=T.graph(),te=W.marginx||0,ne=W.marginy||0;function ie(J){var se=J.x,re=J.y,ue=J.width,oe=J.height;F=Math.min(F,se-ue/2),z=Math.max(z,se+ue/2),V=Math.min(V,re-oe/2),G=Math.max(G,re+oe/2)}e.forEach(T.nodes(),function(J){ie(T.node(J))}),e.forEach(T.edges(),function(J){var se=T.edge(J);e.has(se,"x")&&ie(se)}),F-=te,V-=ne,e.forEach(T.nodes(),function(J){var se=T.node(J);se.x-=F,se.y-=V}),e.forEach(T.edges(),function(J){var se=T.edge(J);e.forEach(se.points,function(re){re.x-=F,re.y-=V}),e.has(se,"x")&&(se.x-=F),e.has(se,"y")&&(se.y-=V)}),W.width=z-F+te,W.height=G-V+ne}function I(T){e.forEach(T.edges(),function(F){var z=T.edge(F),V=T.node(F.v),G=T.node(F.w),W,te;z.points?(W=z.points[0],te=z.points[z.points.length-1]):(z.points=[],W=G,te=V),z.points.unshift(f.intersectRect(V,W)),z.points.push(f.intersectRect(G,te))})}function k(T){e.forEach(T.edges(),function(F){var z=T.edge(F);if(e.has(z,"x"))switch((z.labelpos==="l"||z.labelpos==="r")&&(z.width-=z.labeloffset),z.labelpos){case"l":z.x-=z.width/2+z.labeloffset;break;case"r":z.x+=z.width/2+z.labeloffset;break}})}function L(T){e.forEach(T.edges(),function(F){var z=T.edge(F);z.reversed&&z.points.reverse()})}function P(T){e.forEach(T.nodes(),function(F){if(T.children(F).length){var z=T.node(F),V=T.node(z.borderTop),G=T.node(z.borderBottom),W=T.node(e.last(z.borderLeft)),te=T.node(e.last(z.borderRight));z.width=Math.abs(te.x-W.x),z.height=Math.abs(G.y-V.y),z.x=W.x+z.width/2,z.y=V.y+z.height/2}}),e.forEach(T.nodes(),function(F){T.node(F).dummy==="border"&&T.removeNode(F)})}function D(T){e.forEach(T.edges(),function(F){if(F.v===F.w){var z=T.node(F.v);z.selfEdges||(z.selfEdges=[]),z.selfEdges.push({e:F,label:T.edge(F)}),T.removeEdge(F)}})}function B(T){var F=f.buildLayerMatrix(T);e.forEach(F,function(z){var V=0;e.forEach(z,function(G,W){var te=T.node(G);te.order=W+V,e.forEach(te.selfEdges,function(ne){f.addDummyNode(T,"selfedge",{width:ne.label.width,height:ne.label.height,rank:te.rank,order:W+ ++V,e:ne.e,label:ne.label},"_se")}),delete te.selfEdges})})}function K(T){e.forEach(T.nodes(),function(F){var z=T.node(F);if(z.dummy==="selfedge"){var V=T.node(z.e.v),G=V.x+V.width/2,W=V.y,te=z.x-G,ne=V.height/2;T.setEdge(z.e,z.label),T.removeNode(F),z.label.points=[{x:G+2*te/3,y:W-ne},{x:G+5*te/6,y:W-ne},{x:G+te,y:W},{x:G+5*te/6,y:W+ne},{x:G+2*te/3,y:W+ne}],z.label.x=z.x,z.label.y=z.y}})}function H(T,F){return e.mapValues(e.pick(T,F),Number)}function Q(T){var F={};return e.forEach(T,function(z,V){F[V.toLowerCase()]=z}),F}return Zc}var Qc,Mv;function Jq(){if(Mv)return Qc;Mv=1;var e=ge(),t=Ie(),r=Ue().Graph;Qc={debugOrdering:n};function n(i){var a=t.buildLayerMatrix(i),s=new r({compound:!0,multigraph:!0}).setGraph({});return e.forEach(i.nodes(),function(o){s.setNode(o,{label:o}),s.setParent(o,"layer"+i.node(o).rank)}),e.forEach(i.edges(),function(o){s.setEdge(o.v,o.w,{},o.name)}),e.forEach(a,function(o,u){var c="layer"+u;s.setNode(c,{rank:"same"}),e.reduce(o,function(l,d){return s.setEdge(l,d,{style:"invis"}),d})}),s}return Qc}var Jc,Tv;function ek(){return Tv||(Tv=1,Jc="0.8.5"),Jc}var el,Pv;function tk(){return Pv||(Pv=1,el={graphlib:Ue(),layout:Qq(),debug:Jq(),util:{time:Ie().time,notime:Ie().notime},version:ek()}),el}var rk=tk();const Dv=Gx(rk);function nk({className:e="",minZoom:t=.5,maxZoom:r=2,step:n=.1}){const{setViewport:i,getZoom:a,getViewport:s}=Br(),o=a(),c=(Math.min(Math.max(o,t),r)-t)/(r-t)*100,l=h=>Math.min(Math.max(h,t),r),d=h=>{const{x:v,y:x}=s();i({x:v,y:x,zoom:l(h)},{duration:200})},f=h=>{const v=parseFloat(h.target.value),x=t+v/100*(r-t);d(x)};return m.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 ${e}`,children:[m.jsx("button",{onClick:()=>d(o+n),className:"w-6 h-6 flex items-center justify-center rounded border border-border bg-background hover:bg-accent transition-colors",title:"Zoom In",children:m.jsx(Er,{className:"w-4 h-4"})}),m.jsx("input",{type:"range",min:"0",max:"100",value:c,onChange:f,className:"slider-vertical h-24 w-1.5",style:{writingMode:"vertical-lr",direction:"rtl"},title:`Zoom: ${Math.round(o*100)}%`}),m.jsx("button",{onClick:()=>d(o-n),className:"w-6 h-6 flex items-center justify-center rounded border border-border bg-background hover:bg-accent transition-colors",title:"Zoom Out",children:m.jsx(Db,{className:"w-4 h-4"})})]})}const Ix=j.memo(({data:e,selected:t})=>m.jsxs("div",{className:`
				min-w-[200px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-green-500"}
			`,children:[m.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-t-md flex items-center gap-2",children:[m.jsx(zv,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||"Start"})]}),m.jsx("div",{className:"p-4",children:m.jsx("p",{className:"text-xs text-muted-foreground",children:"Dialogue entry point"})}),m.jsx(Ee,{type:"source",position:ee.Bottom,className:"!bg-green-500 !w-3 !h-3 !border-2 !border-white"})]}));Ix.displayName="StartNode";const Rx=j.memo(({data:e,selected:t})=>{const r=e.dialogueRows||(e.text?[{text:e.text}]:[]),n=r[0],i=r.length>1,a=n!=null&&n.text?n.text.length>50?n.text.substring(0,50)+"...":n.text:"NPC dialogue text...",s=[];e.participant&&s.push(`Participant: ${e.participant}`),e.decorators&&e.decorators.length>0&&s.push(`Decorators: ${e.decorators.length}`),r.length>0&&s.push(`Dialogue rows: ${r.length}`);const o=s.join(`
`);return m.jsxs("div",{className:`
				min-w-[250px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-blue-500"}
			`,title:o,children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"!bg-blue-500 !w-3 !h-3 !border-2 !border-white"}),m.jsxs("div",{className:"bg-blue-500 text-white px-4 py-2 rounded-t-md flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(wl,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||"NPC"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[i&&m.jsxs("span",{className:"text-xs opacity-80",children:[r.length," rows"]}),e.hasAudio&&m.jsx(Tn,{className:"h-3 w-3"})]})]}),m.jsxs("div",{className:"p-4 space-y-2",children:[m.jsx("p",{className:"text-sm text-foreground",children:a}),e.participant&&m.jsx("div",{className:"flex items-center gap-2 pt-1",children:m.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",children:[m.jsx(Ut,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((u,c)=>m.jsxs("div",{className:"flex items-center gap-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-0.5 rounded-full text-xs",title:u.values&&Object.keys(u.values).length>0?Object.entries(u.values).map(([l,d])=>`${l}: ${d}`).join(", "):void 0,children:[m.jsx(Mn,{className:"h-3 w-3"}),u.name||u]},c))})]}),m.jsx(Ee,{type:"source",position:ee.Bottom,className:"!bg-blue-500 !w-3 !h-3 !border-2 !border-white"})]})});Rx.displayName="LeadNode";const qx=j.memo(({data:e,selected:t})=>{const r=e.dialogueRows||(e.text?[{text:e.text}]:[]),n=r[0],i=r.length>1,a=n!=null&&n.text?n.text.length>50?n.text.substring(0,50)+"...":n.text:"Player response text...",s=[];e.participant&&s.push(`Participant: ${e.participant}`),e.decorators&&e.decorators.length>0&&s.push(`Decorators: ${e.decorators.length}`),r.length>0&&s.push(`Dialogue rows: ${r.length}`);const o=s.join(`
`);return m.jsxs("div",{className:`
				min-w-[250px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-purple-500"}
			`,title:o,children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"!bg-purple-500 !w-3 !h-3 !border-2 !border-white"}),m.jsxs("div",{className:"bg-purple-500 text-white px-4 py-2 rounded-t-md flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Ut,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||"Player"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[i&&m.jsxs("span",{className:"text-xs opacity-80",children:[r.length," rows"]}),e.hasAudio&&m.jsx(Tn,{className:"h-3 w-3"})]})]}),m.jsxs("div",{className:"p-4 space-y-2",children:[m.jsx("p",{className:"text-sm text-foreground",children:a}),e.participant&&m.jsx("div",{className:"flex items-center gap-2 pt-1",children:m.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",children:[m.jsx(Ut,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((u,c)=>m.jsxs("div",{className:"flex items-center gap-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-0.5 rounded-full text-xs",title:u.values&&Object.keys(u.values).length>0?Object.entries(u.values).map(([l,d])=>`${l}: ${d}`).join(", "):void 0,children:[m.jsx(Mn,{className:"h-3 w-3"}),u.name||u]},c))})]}),m.jsx(Ee,{type:"source",position:ee.Bottom,className:"!bg-purple-500 !w-3 !h-3 !border-2 !border-white"})]})});qx.displayName="AnswerNode";const kx=j.memo(({data:e,selected:t})=>{var o,u;const{getNodes:r}=Br(),i=r().find(c=>c.id===e.targetNode),a=((o=i==null?void 0:i.data)==null?void 0:o.displayName)||((u=i==null?void 0:i.data)==null?void 0:u.label)||"Select node...",s=e.targetNode?e.targetNode.substring(0,8):"";return m.jsxs("div",{className:`
				min-w-[220px] rounded-lg border-2 bg-card shadow-lg
				${t?"border-primary ring-2 ring-primary/20":"border-orange-500"}
			`,children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"!bg-orange-500 !w-3 !h-3 !border-2 !border-white"}),m.jsxs("div",{className:"bg-orange-500 text-white px-4 py-2 rounded-t-md flex items-center gap-2",children:[m.jsx(Rl,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||"Return To"})]}),m.jsxs("div",{className:"p-4 space-y-2",children:[m.jsx("div",{className:"text-xs text-muted-foreground",children:"Target:"}),m.jsx("div",{className:"font-medium text-sm text-foreground",children:a}),s&&m.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[m.jsx(Tb,{className:"h-3 w-3"}),m.jsx("code",{children:s})]})]})]})});kx.displayName="ReturnNode";const Ax=j.memo(({data:e,selected:t})=>{const r="#CC2100",n="rgba(204, 33, 0, 0.12)",i=e.dialogueRows||(e.text?[{text:e.text}]:[]),a=i[0],s=i.length>1,o=a!=null&&a.text?a.text.length>50?a.text.substring(0,50)+"...":a.text:"Dialogue completion text...",u=[];e.participant&&u.push(`Participant: ${e.participant}`),e.decorators&&e.decorators.length>0&&u.push(`Decorators: ${e.decorators.length}`),i.length>0&&u.push(`Dialogue rows: ${i.length}`);const c=u.join(`
`);return m.jsxs("div",{className:"min-w-[250px] rounded-lg border-2 bg-card shadow-lg",style:{borderColor:r,boxShadow:t?`0 0 0 4px ${n}`:void 0},title:c,children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:r}}),m.jsxs("div",{className:"text-white px-4 py-2 rounded-t-md flex items-center justify-between",style:{backgroundColor:r},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(_l,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||e.participant||"Complete"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[s&&m.jsxs("span",{className:"text-xs opacity-80",children:[i.length," rows"]}),e.hasAudio&&m.jsx(Tn,{className:"h-3 w-3"})]})]}),m.jsxs("div",{className:"p-4 space-y-2",children:[m.jsx("p",{className:"text-sm text-foreground",children:o}),e.participant&&m.jsx("div",{className:"flex items-center gap-2 pt-1",children:m.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:n,color:r},children:[m.jsx(Ut,{className:"h-3 w-3"}),e.participant]})}),e.decorators&&e.decorators.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:e.decorators.map((l,d)=>m.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:n,color:r},title:l.values&&Object.keys(l.values).length>0?Object.entries(l.values).map(([f,h])=>`${f}: ${h}`).join(", "):void 0,children:[m.jsx(Mn,{className:"h-3 w-3"}),l.name||l]},d))})]})]})});Ax.displayName="CompleteNode";function ik({id:e,data:t,selected:r,positionAbsoluteX:n,positionAbsoluteY:i}){const a=()=>{if(t.onClick){const s={x:n,y:i};t.onClick(e,s,t.parentNodeId)}};return m.jsxs("div",{className:`
				relative bg-card border-2 border-dashed rounded-lg p-4 min-w-[180px]
				transition-all cursor-pointer hover:border-primary hover:bg-accent
				${r?"border-primary shadow-lg":"border-border"}
			`,onClick:a,children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"w-3 h-3 !bg-muted-foreground"}),m.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-muted-foreground",children:[m.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:m.jsx(Er,{className:"h-5 w-5"})}),m.jsx("span",{className:"text-sm font-medium",children:"Add Node"})]}),m.jsx(Ee,{type:"source",position:ee.Bottom,className:"w-3 h-3 !bg-muted-foreground"})]})}const ak=j.memo(ik),jx=j.memo(({data:e,selected:t})=>{const r="#7dd3fc",n="rgba(125, 211, 252, 0.18)",i=typeof e.duration=="number"?e.duration:1;return m.jsxs("div",{className:"min-w-[230px] rounded-lg border-2 bg-card shadow-lg",style:{borderColor:r,boxShadow:t?`0 0 0 4px ${n}`:void 0},children:[m.jsx(Ee,{type:"target",position:ee.Top,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:r}}),m.jsxs("div",{className:"text-slate-900 px-4 py-2 rounded-t-md flex items-center justify-between",style:{backgroundColor:r},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Cl,{className:"h-4 w-4"}),m.jsx("span",{className:"font-semibold text-sm",children:e.displayName||"Delay"})]}),m.jsxs("span",{className:"text-xs font-medium",children:[i,"s"]})]}),m.jsx("div",{className:"p-4",children:m.jsxs("p",{className:"text-sm text-foreground",children:["Wait for ",i," second",i===1?"":"s","."]})}),m.jsx(Ee,{type:"source",position:ee.Bottom,className:"!w-3 !h-3 !border-2 !border-white",style:{backgroundColor:r}})]})});jx.displayName="DelayNode";const Mx=j.forwardRef(({className:e,min:t=0,max:r=100,step:n=1,value:i=[50],onValueChange:a,...s},o)=>{const u=c=>{const l=parseFloat(c.target.value);a&&a([l])};return m.jsx("input",{ref:o,type:"range",min:t,max:r,step:n,value:i[0],onChange:u,className:nl("w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer","[&::-webkit-slider-thumb]:appearance-none","[&::-webkit-slider-thumb]:w-5","[&::-webkit-slider-thumb]:h-5","[&::-webkit-slider-thumb]:rounded-full","[&::-webkit-slider-thumb]:bg-primary","[&::-webkit-slider-thumb]:cursor-pointer","[&::-webkit-slider-thumb]:border-2","[&::-webkit-slider-thumb]:border-background","[&::-webkit-slider-thumb]:shadow-sm","[&::-moz-range-thumb]:w-5","[&::-moz-range-thumb]:h-5","[&::-moz-range-thumb]:rounded-full","[&::-moz-range-thumb]:bg-primary","[&::-moz-range-thumb]:cursor-pointer","[&::-moz-range-thumb]:border-2","[&::-moz-range-thumb]:border-background","[&::-moz-range-thumb]:shadow-sm","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",e),...s})});Mx.displayName="Slider";async function sk(e){try{const t=await e.arrayBuffer(),r={id:crypto.randomUUID(),name:e.name,type:e.type,size:e.size,data:t,createdAt:new Date().toISOString()};return{id:r.id,name:r.name,type:r.type,size:r.size,blob:new Blob([t],{type:e.type}),dataUrl:await ok(e)}}catch(t){throw console.error("Error storing audio file:",t),t}}function ok(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)})}function uk(e){return new Promise((t,r)=>{const n=new Audio,i=URL.createObjectURL(e);n.addEventListener("loadedmetadata",()=>{URL.revokeObjectURL(i),t(n.duration)}),n.addEventListener("error",()=>{URL.revokeObjectURL(i),r(new Error("Failed to load audio"))}),n.src=i})}function ck(e){return["audio/wav","audio/mpeg","audio/mp3"].includes(e.type)?e.size>10485760?{valid:!1,error:"File too large. Maximum size is 10MB."}:{valid:!0}:{valid:!1,error:"Invalid file type. Please upload WAV or MP3 files."}}function lk({dialogueRows:e=[],onChange:t,participants:r=[]}){const{toast:n}=Fv(),[i,a]=j.useState(new Set([0])),[s,o]=j.useState(null),u=j.useRef({}),c=j.useRef({});j.useEffect(()=>{const N=new Set;e.forEach(I=>{if(I.audioFile){N.add(I.id);let k=null;if(I.audioFile.url)k=I.audioFile.url;else if(I.audioFile.dataUrl)try{const L=I.audioFile.dataUrl.split(","),P=L[0].match(/:(.*?);/)[1],D=atob(L[1]);let B=D.length;const K=new Uint8Array(B);for(;B--;)K[B]=D.charCodeAt(B);const H=new Blob([K],{type:P});k=URL.createObjectURL(H)}catch(L){console.error("Error creating audio URL:",L)}else I.audioFile.blob&&(k=URL.createObjectURL(I.audioFile.blob));k&&c.current[I.id]!==k&&(c.current[I.id]&&c.current[I.id].startsWith("blob:")&&c.current[I.id]!==k&&URL.revokeObjectURL(c.current[I.id]),c.current[I.id]=k)}}),Object.keys(c.current).forEach(I=>{N.has(I)||(c.current[I]&&c.current[I].startsWith("blob:")&&URL.revokeObjectURL(c.current[I]),delete c.current[I])})},[e]),j.useEffect(()=>()=>{Object.values(c.current).forEach(N=>{N&&N.startsWith("blob:")&&URL.revokeObjectURL(N)})},[]);const l=N=>{const I=new Set(i);I.has(N)?I.delete(N):I.add(N),a(I)},d=()=>{const N={id:gr(),text:"",audioFile:null,duration:3},I=[...e,N];t(I),a(new Set([...i,e.length]))},f=N=>{const I=e.filter((L,P)=>P!==N);t(I);const k=new Set(i);k.delete(N),a(k)},h=(N,I)=>{const k=e.map((L,P)=>P===N?{...L,...I}:L);t(k)},[v,x]=j.useState(null),[y,p]=j.useState(!1),[b,g]=j.useState({top:0,left:0}),[w,_]=j.useState(""),E=j.useRef({}),C=(N,I,k)=>{h(N,{text:I});const L=k.target.selectionStart,P=I.substring(0,L),D=P.lastIndexOf("$");if(D!==-1&&L-D<=20){const B=P.substring(D+1);if(!B.includes("}")&&!B.includes(" ")&&!B.includes(`
`)){x(N),_(B.toLowerCase()),p(!0);const H=k.target.getBoundingClientRect();g({top:H.top-150,left:H.left+10})}else p(!1)}else p(!1)},S=N=>{if(v===null)return;const I=e[v],k=E.current[v];if(!k)return;const L=k.selectionStart,D=I.text.substring(0,L).lastIndexOf("$"),B=I.text.substring(0,D)+`\${${N}}`+I.text.substring(L);h(v,{text:B}),p(!1),setTimeout(()=>{k.focus();const K=D+N.length+3;k.setSelectionRange(K,K)},0)},q=r.filter(N=>N.name.toLowerCase().includes(w)),M=async(N,I)=>{if(!I)return;const k=ck(I);if(!k.valid){n({variant:"error",title:"Invalid Audio File",description:k.error});return}try{const L=await sk(I),P=await uk(I);h(N,{audioFile:L,duration:P||3}),n({variant:"success",title:"Audio Uploaded",description:`${I.name} uploaded successfully`})}catch(L){console.error("Error uploading audio:",L),n({variant:"error",title:"Upload Failed",description:"Failed to upload audio file. Please try again."})}},R=N=>{const I=u.current[N];I&&(s===N?(I.pause(),o(null)):(s!==null&&u.current[s]&&u.current[s].pause(),I.play(),o(N)))},A=N=>{s===N&&o(null)},$=N=>{const I=e[N];I&&(c.current[I.id]&&c.current[I.id].startsWith("blob:")&&URL.revokeObjectURL(c.current[I.id]),delete c.current[I.id]),h(N,{audioFile:null}),s===N&&o(null)};return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Be,{className:"text-sm font-bold",children:"Dialogue Rows"}),m.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.length," ",e.length===1?"row":"rows"]})]}),e.length===0?m.jsxs("div",{className:"text-center py-6 border border-dashed border-border rounded-lg",children:[m.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No dialogue rows yet"}),m.jsxs(be,{variant:"outline",size:"sm",onClick:d,className:"gap-2",children:[m.jsx(Er,{className:"h-3.5 w-3.5"}),"Add First Row"]})]}):m.jsx("div",{className:"space-y-2",children:e.map((N,I)=>{const k=i.has(I),L=N.text?N.text.length>40?N.text.substring(0,40)+"...":N.text:"Empty dialogue...";return m.jsxs("div",{className:"border border-border rounded-lg overflow-hidden bg-card",children:[m.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>l(I),children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[k?m.jsx(Sl,{className:"h-4 w-4 text-muted-foreground shrink-0"}):m.jsx(Il,{className:"h-4 w-4 text-muted-foreground shrink-0"}),m.jsxs("span",{className:"text-xs font-medium text-muted-foreground shrink-0",children:["[",I,"]"]}),m.jsx("span",{className:"text-sm flex-1 truncate",children:L})]}),m.jsx(be,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:P=>{P.stopPropagation(),f(I)},children:m.jsx(El,{className:"h-3.5 w-3.5 text-destructive"})})]}),k&&m.jsxs("div",{className:"p-4 pt-0 space-y-4 border-t border-border",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs(Be,{htmlFor:`text-${N.id}`,children:["Dialogue Text",m.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Type $ for participants)"})]}),m.jsx(Ux,{id:`text-${N.id}`,ref:P=>E.current[I]=P,value:N.text||"",onChange:P=>C(I,P.target.value,P),placeholder:"Enter dialogue text... Type $ to insert participant names",className:"min-h-[100px] font-mono text-sm"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Be,{htmlFor:`audio-${N.id}`,children:"Audio Clip"}),N.audioFile?m.jsxs("div",{className:"flex items-center gap-2 p-3 bg-accent/50 rounded-lg border border-border",children:[m.jsx(be,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>R(I),children:s===I?m.jsx(Fb,{className:"h-4 w-4"}):m.jsx(zv,{className:"h-4 w-4"})}),m.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Tn,{className:"h-3 w-3 text-muted-foreground"}),m.jsx("span",{className:"text-sm font-medium truncate",children:N.audioFile.name})]}),m.jsxs("span",{className:"text-xs text-muted-foreground",children:[(N.audioFile.size/1024).toFixed(1)," KB"]})]}),m.jsx(be,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:()=>$(I),children:m.jsx(il,{className:"h-3.5 w-3.5 text-destructive"})}),m.jsx("audio",{ref:P=>u.current[I]=P,src:c.current[N.id]||"",onEnded:()=>A(I),className:"hidden"})]}):m.jsx(Cr,{id:`audio-${N.id}`,type:"file",accept:".wav,.mp3,audio/wav,audio/mpeg",onChange:P=>{var B;const D=(B=P.target.files)==null?void 0:B[0];D&&M(I,D),P.target.value=""},className:"cursor-pointer"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Be,{htmlFor:`duration-${N.id}`,children:"Duration (seconds)"}),m.jsxs("span",{className:"text-sm font-medium",children:[N.duration.toFixed(1),"s"]})]}),m.jsx(Mx,{id:`duration-${N.id}`,value:[N.duration],onValueChange:([P])=>h(I,{duration:P}),min:.5,max:30,step:.1,className:"w-full"})]})]})]},N.id)})}),e.length>0&&m.jsxs(be,{variant:"outline",size:"sm",onClick:d,className:"w-full gap-2",children:[m.jsx(Er,{className:"h-3.5 w-3.5"}),"Add Dialogue Row"]}),y&&q.length>0&&m.jsx("div",{className:"fixed z-50 bg-popover border border-border rounded-lg shadow-lg max-h-48 overflow-y-auto",style:{top:`${b.top}px`,left:`${b.left}px`,minWidth:"200px"},children:q.map(N=>m.jsxs("button",{onClick:()=>S(N.name),className:"w-full px-3 py-2 text-left text-sm hover:bg-accent transition-colors flex items-center gap-2",children:[m.jsx("span",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-bold",children:N.name.charAt(0).toUpperCase()}),m.jsx("span",{children:N.name})]},N.id))})]})}function dk({decorators:e=[],availableDecorators:t=[],onAddDecorator:r,onRemoveDecorator:n,onUpdateDecorator:i}){const[a,s]=j.useState(new Set([0])),[o,u]=j.useState(""),c=f=>{const h=new Set(a);h.has(f)?h.delete(f):h.add(f),s(h)},l=()=>{if(!o)return;const f=t.find(h=>h.id===o);f&&(r(f),u(""),s(new Set([...a,e.length])))},d=(f,h,v)=>{const y={...e[f].values,[h]:v};i(f,y)};return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Be,{className:"text-sm font-bold",children:"Decorators"}),m.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.length," ",e.length===1?"decorator":"decorators"]})]}),e.length===0?m.jsx("div",{className:"text-center py-6 border border-dashed border-border rounded-lg",children:m.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No decorators yet"})}):m.jsx("div",{className:"space-y-2",children:e.map((f,h)=>{const v=a.has(h),x=t.find(p=>p.id===f.id),y=(x==null?void 0:x.properties)&&x.properties.length>0;return m.jsxs("div",{className:"border border-border rounded-lg overflow-hidden bg-card",children:[m.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>c(h),children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[v?m.jsx(Sl,{className:"h-4 w-4 text-muted-foreground shrink-0"}):m.jsx(Il,{className:"h-4 w-4 text-muted-foreground shrink-0"}),m.jsxs("span",{className:"text-xs font-medium text-muted-foreground shrink-0",children:["[",h,"]"]}),m.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[m.jsx(Mn,{className:"h-3.5 w-3.5 text-primary shrink-0"}),m.jsx("span",{className:"text-sm font-medium truncate",children:f.name||"Unnamed Decorator"})]})]}),m.jsx(be,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:p=>{p.stopPropagation(),n(h)},children:m.jsx(El,{className:"h-3.5 w-3.5 text-destructive"})})]}),v&&y&&m.jsx("div",{className:"p-4 pt-0 space-y-4 border-t border-border",children:x.properties.map(p=>{var b;return m.jsxs("div",{className:"space-y-2",children:[m.jsxs(Be,{htmlFor:`${f.id}-${h}-${p.name}`,children:[p.name,m.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.type,")"]})]}),p.type==="string"&&m.jsx(Cr,{id:`${f.id}-${h}-${p.name}`,value:f.values[p.name]||"",onChange:g=>d(h,p.name,g.target.value),placeholder:`Enter ${p.name}...`}),p.type==="number"&&m.jsx(Cr,{id:`${f.id}-${h}-${p.name}`,type:"number",value:f.values[p.name]||0,onChange:g=>d(h,p.name,parseFloat(g.target.value)||0),placeholder:`Enter ${p.name}...`}),p.type==="boolean"&&m.jsxs(yn,{value:((b=f.values[p.name])==null?void 0:b.toString())||"false",onValueChange:g=>d(h,p.name,g==="true"),children:[m.jsx(xn,{children:m.jsx(bn,{})}),m.jsxs(wn,{children:[m.jsx(wr,{value:"true",children:"True"}),m.jsx(wr,{value:"false",children:"False"})]})]})]},p.name)})})]},`${f.id}-${h}`)})}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(yn,{value:o,onValueChange:u,children:[m.jsx(xn,{className:"flex-1",children:m.jsx(bn,{placeholder:"Select decorator to add..."})}),m.jsx(wn,{children:t.map(f=>m.jsx(wr,{value:f.id,children:f.name},f.id))})]}),m.jsxs(be,{variant:"outline",size:"sm",onClick:l,disabled:!o,className:"gap-2 shrink-0",children:[m.jsx(Er,{className:"h-3.5 w-3.5"}),"Add"]})]})]})}function fk({title:e,defaultOpen:t=!0,children:r}){const[n,i]=j.useState(t);return m.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[m.jsxs("button",{onClick:()=>i(!n),className:"w-full px-4 py-3 flex items-center justify-between bg-muted/50 hover:bg-muted transition-colors",children:[m.jsx("h4",{className:"text-sm font-semibold",children:e}),n?m.jsx(Sl,{className:"h-4 w-4 text-muted-foreground"}):m.jsx(Il,{className:"h-4 w-4 text-muted-foreground"})]}),n&&m.jsx("div",{className:"p-4 space-y-3",children:r})]})}function hk({status:e="saved",lastSaved:t,className:r}){const n={saved:{icon:wb,iconClass:"text-green-500",text:"All changes saved",dotClass:"bg-green-500"},saving:{icon:Yx,iconClass:"text-blue-500 animate-spin",text:"Saving...",dotClass:"bg-blue-500"},unsaved:{icon:Mb,iconClass:"text-orange-500",text:"Unsaved changes",dotClass:"bg-orange-500 animate-pulse"},error:{icon:Kx,iconClass:"text-red-500",text:"Failed to save",dotClass:"bg-red-500"}},i=n[e]||n.saved,a=i.icon,s=o=>{if(!o)return"";const c=new Date-o;return c<6e4?"just now":c<36e5?`${Math.floor(c/6e4)}m ago`:c<864e5?`${Math.floor(c/36e5)}h ago`:o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return m.jsxs("div",{className:nl("flex items-center gap-2 text-sm text-muted-foreground",r),children:[m.jsxs("div",{className:"flex items-center gap-1.5",children:[m.jsx(a,{className:nl("h-3.5 w-3.5",i.iconClass)}),m.jsx("span",{className:"font-medium",children:i.text})]}),t&&e==="saved"&&m.jsxs("span",{className:"text-xs opacity-70",children:["(",s(t),")"]})]})}const pk={type:"startNode",label:"Start",description:"Dialogue entry point",section:"system",creatable:!1,canHaveOutputs:!0,minimapColor:"#22c55e",defaultData:{label:"Dialogue entry point",displayName:"Start",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]}]},gk={type:"leadNode",label:"NPC",description:"Add an NPC dialogue node",section:"dialogue",creatable:!0,canHaveOutputs:!0,icon:"messageCircle",colorClass:"text-blue-500",minimapColor:"#3b82f6",defaultData:{label:"New NPC",displayName:"NPC",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},mk={type:"answerNode",label:"Player",description:"Add a player response node",section:"dialogue",creatable:!0,canHaveOutputs:!0,icon:"user",colorClass:"text-purple-500",minimapColor:"#8b5cf6",defaultData:{label:"New Player",displayName:"Player",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},vk={type:"returnNode",label:"Return",description:"Return to a previous node",section:"flow",creatable:!0,canHaveOutputs:!1,icon:"cornerUpLeft",colorClass:"text-orange-500",minimapColor:"#f97316",defaultData:{label:"New Return",displayName:"Return",targetNode:""},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"returnTarget",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"targetNode",type:"select",labelKey:"editor.sections.targetNode",placeholderKey:"editor.sections.targetNodePlaceholder",options:"nodes"}]}]},yk={type:"completeNode",label:"Complete",description:"Mark dialogue as complete",section:"flow",creatable:!0,canHaveOutputs:!1,icon:"checkCircle2",colorClass:"text-[#CC2100]",minimapColor:"#CC2100",defaultData:{label:"New Complete",displayName:"Complete",text:"",participant:"",decorators:[],dialogueRows:[],selectionTitle:"",hasAudio:!1},sections:[{id:"nodeData",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"displayName",type:"text",labelKey:"editor.sections.displayName",placeholderKey:"editor.sections.displayNamePlaceholder",required:!0,maxLength:64},{id:"participant",type:"select",labelKey:"editor.sections.participant",placeholderKey:"editor.sections.participantPlaceholder",required:!0,options:"participants"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]},{id:"dialogueDetails",titleKey:"editor.sections.dialogueDetails",defaultOpen:!0,fields:[{id:"selectionTitle",type:"text",labelKey:"editor.sections.selectionTitle",placeholderKey:"editor.sections.selectionTitlePlaceholder"},{id:"dialogueRows",type:"dialogueRows",labelKey:"editor.sections.dialogueRows"}]},{id:"nodeDecorators",titleKey:"editor.sections.nodeDecorators",defaultOpen:!1,fields:[{id:"decorators",type:"decorators"}]}]},xk={type:"delayNode",label:"Delay",description:"Pause the dialogue for a set duration",section:"flow",creatable:!0,canHaveOutputs:!0,icon:"clock",colorClass:"text-sky-400",minimapColor:"#7dd3fc",defaultData:{label:"New Delay",displayName:"Delay",duration:1},sections:[{id:"delaySettings",titleKey:"editor.sections.nodeData",defaultOpen:!0,fields:[{id:"duration",type:"slider",label:"Duration (seconds)",min:.1,max:30,step:.1,unit:"s"},{id:"nodeId",type:"nodeId",labelKey:"editor.sections.nodeId"}]}]},bk={startNode:pk,leadNode:gk,answerNode:mk,returnNode:vk,completeNode:yk,delayNode:xk},cd=bk,ut=e=>cd[e],wk=()=>Object.values(cd).filter(e=>e.creatable),bl=e=>{var t;return((t=cd[e])==null?void 0:t.defaultData)||{}};function _k({open:e,onOpenChange:t,onSelectType:r}){const{t:n}=$v(),i={messageCircle:wl,user:Ut,cornerUpLeft:Rl,checkCircle2:_l,clock:Cl},a=wk(),s=o=>{r(o),t(!1)};return m.jsx(_b,{open:e,onOpenChange:t,children:m.jsxs(Nb,{className:"sm:max-w-md",children:[m.jsxs(Eb,{children:[m.jsx(Cb,{children:"Select Node Type"}),m.jsx(Sb,{children:"Choose the type of node you want to add to the dialogue"})]}),m.jsx("div",{className:"grid gap-2 py-4",children:a.map(o=>{const u=i[o.icon];return m.jsxs(be,{variant:"outline",className:"h-auto p-4 justify-start gap-4",onClick:()=>s(o.type),children:[m.jsx("div",{className:`w-10 h-10 rounded-lg bg-muted flex items-center justify-center ${o.colorClass||""}`,children:u?m.jsx(u,{className:"h-5 w-5"}):null}),m.jsxs("div",{className:"flex flex-col items-start gap-1 text-left",children:[m.jsx("span",{className:"font-semibold",children:o.label}),m.jsx("span",{className:"text-xs text-muted-foreground",children:o.description})]})]},o.type)})})]})})}const zt=ut("startNode"),tl=bl("startNode"),Lv=[{id:"00000000-0000-0000-0000-000000000001",type:"startNode",data:{...tl,label:tl.label||(zt==null?void 0:zt.description)||"Dialogue entry point",displayName:tl.displayName||(zt==null?void 0:zt.label)||"Start"},position:{x:250,y:100},deletable:!1}],Ov=[],Nk={startNode:Ix,leadNode:Rx,answerNode:qx,returnNode:kx,completeNode:Ax,delayNode:jx,placeholderNode:ak},rl=(e,t,r="TB")=>{const n=new Dv.graphlib.Graph;n.setDefaultEdgeLabel(()=>({}));const i=250,a=100;return n.setGraph({rankdir:r,nodesep:50,ranksep:100}),e.forEach(o=>{n.setNode(o.id,{width:i,height:a})}),t.forEach(o=>{n.setEdge(o.source,o.target)}),Dv.layout(n),{nodes:e.map(o=>{const u=n.node(o.id);return{...o,position:{x:u.x-i/2,y:u.y-a/2}}}),edges:t}};function jk(){var cr,Jr;const{t:e}=$v(),{theme:t,resolvedTheme:r,setTheme:n}=Wx(),{projectId:i,dialogueId:a}=Xx.useParams(),{projects:s,loadProjects:o}=fb(),{dialogues:u,loadDialogues:c,saveDialogueGraph:l,loadDialogueGraph:d,exportDialogue:f}=hb(),{participants:h,loadParticipants:v}=pb(),{decorators:x,loadDecorators:y}=gb(),[p,b,g]=fS(Lv),[w,_,E]=hS(Ov),C=j.useCallback(O=>{const U=O.filter(X=>!(X.type==="remove"&&X.id==="00000000-0000-0000-0000-000000000001"));g(U)},[g]),[S,q]=j.useState(null),[M,R]=j.useState(null),[A,$]=j.useState(!1),[N,I]=j.useState(!1),[k,L]=j.useState("saved"),[P,D]=j.useState(null),[B,K]=j.useState({x:0,y:0,zoom:1}),[H,Q]=j.useState(null),[T,F]=j.useState(!1),{runTour:z,finishTour:V,resetTour:G}=Rb("dialogue-editor");Fv();const[W,te]=j.useState("desktop"),[ne,ie]=j.useState(!1),[J,se]=j.useState(null),[re,ue]=j.useState(!1),[oe,Ne]=j.useState(!1);j.useEffect(()=>{const O=()=>{te(Ib())};return O(),window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]);const[me,Ae]=j.useState([{nodes:Lv,edges:Ov}]),[ye,xe]=j.useState(0);j.useEffect(()=>{o(),c(i),v(i),y(i)},[o,c,v,y,i]);const[ve,We]=j.useState(!1);j.useEffect(()=>{(async()=>{if(a)try{const U=await d(a),{nodes:X,edges:Y,viewport:Z}=U;(X.length>0||Y.length>0)&&(b(X),_(Y),Ae([{nodes:X,edges:Y}]),xe(0)),Z&&H&&(H.setViewport(Z,{duration:0}),We(!0))}catch(U){console.error("Failed to load dialogue graph:",U)}})()},[a,d,b,_,H]),j.useEffect(()=>{if(S){const O=p.find(U=>U.id===S.id);O&&q(O)}},[p]);const[je,Xe]=j.useState(!1);j.useEffect(()=>{if(H&&p.length>0&&!je&&!ve){const O=p.find(U=>U.id==="00000000-0000-0000-0000-000000000001");O&&setTimeout(()=>{H.setCenter(O.position.x+100,O.position.y+50,{zoom:1,duration:300}),Xe(!0)},100)}},[H,p.length,je,ve]);const de=j.useCallback((O,U)=>{Ae(X=>{const Y=X.slice(0,ye+1);return Y.push({nodes:O,edges:U}),Y.length>50?(Y.shift(),xe(Y.length-1),Y):(xe(Y.length-1),Y)})},[ye]),Me=j.useRef(S);j.useEffect(()=>{const O=Me.current;O&&O!==S&&(de(p,w),F(!0),L("unsaved")),Me.current=S},[S,p,w,de]),j.useEffect(()=>{const O=U=>{if(T)return U.preventDefault(),U.returnValue="",""};return window.addEventListener("beforeunload",O),()=>window.removeEventListener("beforeunload",O)},[T]);const nt=jb({shouldBlockFn:()=>T,enableBeforeUnload:!0,withResolver:!0});j.useEffect(()=>{if(nt.status!=="blocked")return;window.confirm(`${e("editor.validation.unsavedLeaveTitle")}
${e("editor.validation.unsavedLeaveDescription")}`)?nt.proceed():nt.reset()},[nt,e]),j.useEffect(()=>()=>{Ci()},[]);const it=s.find(O=>O.id===i),Lt=u.find(O=>O.id===a),Oe=S?ut(S.type):null,Te=O=>{if(!S)return null;const U=O.labelKey?e(O.labelKey):O.label||"",X=O.required?`${U} *`:U;switch(O.type){case"text":return m.jsxs("div",{className:"grid gap-2",children:[m.jsx(Be,{htmlFor:O.id,children:X}),m.jsx(Cr,{id:O.id,value:S.data[O.id]||"",onChange:Y=>mt(S.id,{[O.id]:Y.target.value}),placeholder:O.placeholderKey?e(O.placeholderKey):void 0,maxLength:O.maxLength})]},O.id);case"select":return O.options==="participants"?m.jsxs("div",{className:"space-y-2",children:[m.jsx(Be,{htmlFor:O.id,children:X}),m.jsxs(yn,{value:S.data[O.id]||"",onValueChange:Y=>mt(S.id,{[O.id]:Y}),children:[m.jsx(xn,{children:m.jsx(bn,{placeholder:O.placeholderKey?e(O.placeholderKey):void 0})}),m.jsx(wn,{children:h.map(Y=>m.jsx(wr,{value:Y.name,children:Y.name},Y.id))})]})]},O.id):O.options==="nodes"?m.jsxs("div",{className:"space-y-2",children:[m.jsx(Be,{htmlFor:O.id,children:X}),m.jsxs(yn,{value:S.data[O.id]||"",onValueChange:Y=>mt(S.id,{[O.id]:Y}),children:[m.jsx(xn,{children:m.jsx(bn,{placeholder:O.placeholderKey?e(O.placeholderKey):void 0})}),m.jsx(wn,{children:p.filter(Y=>Y.id!==S.id).map(Y=>m.jsx(wr,{value:Y.id,children:Y.data.displayName||Y.data.label||Y.id},Y.id))})]})]},O.id):null;case"dialogueRows":return m.jsx("div",{className:"space-y-2",children:m.jsx(lk,{dialogueRows:S.data.dialogueRows||[],onChange:Y=>mt(S.id,{dialogueRows:Y}),participants:h})},O.id);case"decorators":return m.jsx(dk,{decorators:S.data.decorators||[],availableDecorators:x,onAddDecorator:Y=>hi(S.id,Y),onRemoveDecorator:Y=>pi(S.id,Y),onUpdateDecorator:(Y,Z)=>{const ae=[...S.data.decorators];ae[Y]={...ae[Y],values:Z},mt(S.id,{decorators:ae})}},O.id);case"slider":return m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Be,{htmlFor:O.id,children:X}),m.jsxs("span",{className:"text-xs text-muted-foreground",children:[S.data[O.id]??O.min,O.unit?` ${O.unit}`:""]})]}),m.jsx(Cr,{id:O.id,type:"range",min:O.min,max:O.max,step:O.step,value:S.data[O.id]??O.min,onChange:Y=>mt(S.id,{[O.id]:parseFloat(Y.target.value)})})]},O.id);case"nodeId":return m.jsxs("div",{children:[m.jsx(Be,{className:"text-xs text-muted-foreground",children:X}),m.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded block mt-1",children:S.id})]},O.id);default:return null}},Fe=j.useCallback(O=>{const U={...O,markerEnd:{type:Xt.ArrowClosed}};_(X=>{const Y=pl(U,X);return de(p,Y),Y})},[_,p,de]),ci=j.useCallback((O,U)=>{U.type!=="placeholderNode"&&(q(U),R(null))},[]),li=j.useCallback((O,U)=>{R(U),q(null)},[]),di=j.useCallback(()=>{q(null),R(null)},[]),Yr=j.useCallback(()=>{S&&S.id!=="00000000-0000-0000-0000-000000000001"&&(b(O=>{const U=O.filter(Y=>{var Z;return Y.type==="placeholderNode"&&((Z=Y.data)==null?void 0:Z.parentNodeId)===S.id}).map(Y=>Y.id),X=O.filter(Y=>Y.id!==S.id&&!U.includes(Y.id));return _(Y=>{const Z=Y.filter(ae=>ae.source!==S.id&&ae.target!==S.id&&!U.includes(ae.source)&&!U.includes(ae.target));return de(X,Z),Z}),X}),q(null))},[S,b,_,de]),fi=j.useCallback(()=>{if(!S||S.id==="00000000-0000-0000-0000-000000000001")return;const O=new Set([S.id]),U=[S.id];for(;U.length>0;){const X=U.shift();w.forEach(Y=>{Y.source===X&&!O.has(Y.target)&&(O.add(Y.target),U.push(Y.target))})}b(X=>{X.filter(ae=>{var ce;return ae.type==="placeholderNode"&&O.has((ce=ae.data)==null?void 0:ce.parentNodeId)}).map(ae=>ae.id).forEach(ae=>O.add(ae));const Z=X.filter(ae=>!O.has(ae.id));return _(ae=>{const ce=ae.filter(fe=>!O.has(fe.source)&&!O.has(fe.target));return de(Z,ce),ce}),Z}),q(null)},[S,w,b,_,de]),Ze=j.useCallback(()=>{const O=new Map;return p.forEach(U=>{if(U.type==="placeholderNode")return;const X=ut(U.type);if(!(X!=null&&X.sections))return;const Y=[];X.sections.forEach(Z=>{var ae;(ae=Z.fields)==null||ae.forEach(ce=>{var $e;if(!ce.required)return;const fe=($e=U.data)==null?void 0:$e[ce.id];(fe==null||typeof fe=="string"&&fe.trim()==="")&&Y.push(ce.id)})}),Y.length>0&&O.set(U.id,{node:U,missingFields:Y})}),O},[p]),pt=j.useCallback(()=>{var U,X,Y;const O=Ze();if(O.size===0){console.info("[validation] No missing required fields.");return}console.warn("[validation] Missing required fields:");for(const[Z,ae]of O.entries()){const ce=ae.node,fe=((U=ce.data)==null?void 0:U.displayName)||((X=ce.data)==null?void 0:X.label)||((Y=ut(ce.type))==null?void 0:Y.label)||ce.type;console.warn(`- ${fe} (${Z})`,ae.missingFields)}},[Ze]),gt=j.useCallback(O=>{var U,X,Y;if(O.size!==0)for(const[Z,ae]of O.entries()){const ce=ae.node,fe=((U=ce.data)==null?void 0:U.displayName)||((X=ce.data)==null?void 0:X.label)||((Y=ut(ce.type))==null?void 0:Y.label)||ce.type,Pe=Zx({variant:"warning",title:e("editor.validation.nodeMissingTitle"),description:e("editor.validation.nodeMissingDescription",{name:fe}),duration:8e3,action:{label:e("editor.validation.focusNode"),onClick:()=>{q(ce),R(null),W==="mobile"&&ue(!0)}}});console.log("[validation] toast",Pe,Z)}},[e,W]),sr=j.useCallback(async()=>{$(!0),I(!1),L("saving");try{Ci();const O=p.filter(Z=>Z.type!=="placeholderNode"),U=w.filter(Z=>{var ae;return!((ae=Z.data)!=null&&ae.isPlaceholder)}),X=Ze();pt(),gt(X),await l(a,O,U,B),D(new Date),I(!0),L("saved"),F(!1),mb(),setTimeout(()=>I(!1),2e3)}catch(O){console.error("Failed to save dialogue:",O),L("error"),setTimeout(()=>L("unsaved"),3e3)}finally{$(!1)}},[w,p,B,a,l,Ze,pt,gt,Ci,$,I,L,F,D,W]),mt=j.useCallback((O,U)=>{b(X=>X.map(Y=>Y.id===O?{...Y,data:{...Y.data,...U}}:Y))},[b]),hi=j.useCallback((O,U)=>{b(X=>{const Y=X.map(Z=>{if(Z.id===O){const ae={id:U.id,name:U.name,values:{}};return U.properties&&U.properties.length>0&&U.properties.forEach(ce=>{ae.values[ce.name]=ce.defaultValue||""}),{...Z,data:{...Z.data,decorators:[...Z.data.decorators||[],ae]}}}return Z});return de(Y,w),Y})},[b,w,de]),pi=j.useCallback((O,U)=>{b(X=>{const Y=X.map(Z=>Z.id===O?{...Z,data:{...Z.data,decorators:Z.data.decorators.filter((ae,ce)=>ce!==U)}}:Z);return de(Y,w),Y})},[b,w,de]),at=j.useCallback((O,U)=>{const X=ut(O),Y=bl(O),Z=(X==null?void 0:X.label)||"Node",ae=Y.label||`New ${Z}`,ce=Y.displayName||Z,fe={id:gr(),type:O,data:{...Y,label:ae,displayName:ce},position:U||{x:Math.random()*400+100,y:Math.random()*400+100}};b($e=>{const st=[...$e,fe];return de(st,w),st}),F(!0),L("unsaved");const Pe=Ze();pt(),gt(Pe)},[b,w,de,F,L,pt,Ze,gt]),Nt=j.useCallback((O,U,X)=>{se({placeholderId:O,position:U,parentNodeId:X}),ie(!0)},[]),gi=j.useCallback(O=>{if(!J)return;const{placeholderId:U,position:X,parentNodeId:Y}=J,Z=gr(),ae=ut(O),ce=bl(O),fe=(ae==null?void 0:ae.label)||"Node",Pe=ce.label||`New ${fe}`,$e=ce.displayName||fe,st={id:Z,type:O,position:X,data:{...ce,label:Pe,displayName:$e}},en=Y==="00000000-0000-0000-0000-000000000001",lr=(ae==null?void 0:ae.canHaveOutputs)??!0,Ot=lr?gr():null;b(dr=>{let Ce=[...dr];return en&&(Ce=Ce.filter(fr=>fr.id!==U)),Ce.push(st),lr&&Ce.push({id:Ot,type:"placeholderNode",data:{label:"Add Node",onClick:Nt,parentNodeId:Z},position:{x:X.x,y:X.y+250}}),Ce}),F(!0),L("unsaved");const _i=Ze();pt(),gt(_i),_(dr=>{let Ce=[...dr];en&&(Ce=Ce.filter(Ni=>Ni.id!==`${Y}-${U}`));const fr={id:`${Y}-${Z}`,source:Y,target:Z,type:"default",markerEnd:{type:Xt.ArrowClosed}};return Ce=pl(fr,Ce),lr&&Ce.push({id:`${Z}-${Ot}`,source:Z,target:Ot,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}}),Ce}),ie(!1),se(null)},[J,b,_,Nt,F,L,pt,Ze,gt]);j.useEffect(()=>{if(W!=="mobile"||p.length===0)return;const O=p.filter(Z=>Z.type!=="placeholderNode"),U=p.filter(Z=>Z.type==="placeholderNode"),X=[],Y=[];O.forEach(Z=>{const ae=ut(Z.type);if(ae&&ae.canHaveOutputs===!1)return;if(!U.some(fe=>{var Pe;return((Pe=fe.data)==null?void 0:Pe.parentNodeId)===Z.id})){const fe=gr();Z.id==="00000000-0000-0000-0000-000000000001"?w.some($e=>{var st;return $e.source===Z.id&&!((st=$e.data)!=null&&st.isPlaceholder)})||(X.push({id:fe,type:"placeholderNode",data:{label:"Add Node",onClick:Nt,parentNodeId:Z.id},position:{x:Z.position.x,y:Z.position.y+250}}),Y.push({id:`${Z.id}-${fe}`,source:Z.id,target:fe,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}})):(X.push({id:fe,type:"placeholderNode",data:{label:"Add Node",onClick:Nt,parentNodeId:Z.id},position:{x:Z.position.x,y:Z.position.y+250}}),Y.push({id:`${Z.id}-${fe}`,source:Z.id,target:fe,type:"default",style:{strokeWidth:1,stroke:"#94a3b8",strokeDasharray:"5,5"},data:{isPlaceholder:!0}}))}}),X.length>0&&(b(Z=>[...Z,...X]),_(Z=>[...Z,...Y]))},[W,p,w,Nt,b,_]);const mi=j.useCallback(()=>{const{nodes:O,edges:U}=rl(p,w);b(O),_(U),de(O,U),F(!0)},[p,w,b,_,de]),[vi,Wr]=j.useState(0),[Xr,yi]=j.useState(!1);j.useEffect(()=>{if(W!=="mobile")return;const O=p.filter(U=>U.type!=="placeholderNode").length;if(!Xr&&p.length>0&&O>0){const{nodes:U,edges:X}=rl(p,w);b(U),_(X),Wr(O),yi(!0);return}if(Xr&&O>0&&O!==vi){const{nodes:U,edges:X}=rl(p,w);b(U),_(X),Wr(O)}},[W,p.length,w.length]);const or=j.useCallback(()=>{if(ye>0){const O=ye-1,{nodes:U,edges:X}=me[O];b(U),_(X),xe(O)}},[ye,me,b,_]),ur=j.useCallback(()=>{if(ye<me.length-1){const O=ye+1,{nodes:U,edges:X}=me[O];b(U),_(X),xe(O)}},[ye,me,b,_]);j.useEffect(()=>{const O=U=>{if((U.ctrlKey||U.metaKey)&&U.key.toLowerCase()==="s"){U.preventDefault(),sr();return}const X=U.target,Y=X.tagName==="INPUT"||X.tagName==="TEXTAREA"||X.isContentEditable;if(!Y&&(U.ctrlKey||U.metaKey)){const Z=U.key.toLowerCase();if(Z==="z"&&!U.shiftKey){U.preventDefault(),or();return}if(Z==="y"||Z==="z"&&U.shiftKey){U.preventDefault(),ur();return}}(U.key==="Delete"||U.key==="Backspace")&&!Y&&(U.preventDefault(),S&&S.id!=="00000000-0000-0000-0000-000000000001"?Yr():M&&(_(Z=>{const ae=Z.filter(ce=>ce.id!==M.id);return de(p,ae),ae}),R(null)))};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[S,M,Yr,_,p,de,sr,or,ur]);const xi=j.useCallback((O,U)=>{K(U)},[]),bi=j.useCallback(O=>{var U;return((U=ut(O.type))==null?void 0:U.minimapColor)||"#6b7280"},[]),Et=j.useCallback((O,U)=>{O.dataTransfer.setData("application/reactflow",U),O.dataTransfer.effectAllowed="move"},[]),wi=j.useCallback(O=>{O.preventDefault();const U=O.dataTransfer.getData("application/reactflow");if(!U||!H)return;const X=H.screenToFlowPosition({x:O.clientX,y:O.clientY});at(U,X)},[H,at]),Zr=j.useCallback(O=>{O.preventDefault(),O.dataTransfer.dropEffect="move"},[]),Qr=async()=>{try{const O=p.filter(X=>X.type!=="placeholderNode"),U=w.filter(X=>{var Y;return!((Y=X.data)!=null&&Y.isPlaceholder)});await l(a,O,U,B),await f(a)}catch(O){console.error("Failed to export dialogue:",O)}};return!Lt||!it?m.jsx("div",{className:"h-screen flex items-center justify-center",children:m.jsx("p",{className:"text-muted-foreground",children:e("common.loading")})}):m.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[W!=="mobile"&&m.jsx(qb,{run:z,onFinish:V,tourType:"editor"}),m.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b px-4 md:px-12 py-3 md:py-4 flex items-center justify-between","data-tour":"editor-header",children:[m.jsxs("div",{className:"flex items-center gap-2 md:gap-4 min-w-0",children:[m.jsx(fd,{to:"/projects/$projectId",params:{projectId:i},children:m.jsx(be,{variant:"ghost",size:"icon",className:"rounded-full shrink-0",children:m.jsx(tb,{className:"h-5 w-5"})})}),m.jsxs("div",{className:"min-w-0",children:[m.jsx("h1",{className:"text-sm md:text-2xl font-bold tracking-tight truncate",children:Lt.name}),m.jsx("p",{className:"text-xs md:text-sm text-muted-foreground truncate",children:it.name})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(hk,{status:k,lastSaved:P,className:"hidden md:flex"}),m.jsxs(vb,{children:[m.jsx(yb,{asChild:!0,children:m.jsx(be,{variant:"outline",size:"icon",className:"rounded-full","data-tour":"save-button",children:m.jsx(xb,{className:"h-4 w-4"})})}),m.jsxs(bb,{align:"end",className:"w-56",children:[m.jsx(Si,{children:"File"}),m.jsxs(vt,{onClick:sr,disabled:A,children:[m.jsx(Qx,{className:"h-4 w-4 mr-2"}),e(A?"common.saving":"common.save"),m.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:"Ctrl+S"})]}),m.jsxs(vt,{onClick:Qr,children:[m.jsx(Jx,{className:"h-4 w-4 mr-2"}),"Export"]}),m.jsx(Ii,{}),m.jsx(Si,{children:"Edit"}),m.jsxs(vt,{onClick:or,disabled:ye===0,children:[m.jsx(zb,{className:"h-4 w-4 mr-2"}),"Undo",m.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:"Ctrl+Z"})]}),m.jsxs(vt,{onClick:ur,disabled:ye===me.length-1,children:[m.jsx($b,{className:"h-4 w-4 mr-2"}),"Redo",m.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:"Ctrl+Y"})]}),m.jsx(Ii,{}),m.jsx(Si,{children:"View"}),m.jsxs(vt,{onClick:()=>n(r==="dark"?"light":"dark"),children:[r==="dark"?m.jsx(rb,{className:"h-4 w-4 mr-2"}):m.jsx(nb,{className:"h-4 w-4 mr-2"}),r==="dark"?"Light Mode":"Dark Mode"]}),W!=="mobile"&&m.jsxs(vt,{onClick:G,children:[m.jsx(kb,{className:"h-4 w-4 mr-2"}),"Show Tour"]}),m.jsx(Ii,{}),m.jsx(fd,{to:"/projects/$projectId/dialogue/$dialogueId/settings",params:{projectId:i,dialogueId:a},children:m.jsxs(vt,{children:[m.jsx(eb,{className:"h-4 w-4 mr-2"}),"Settings"]})}),m.jsxs(vt,{onClick:()=>window.open("https://github.com/sponsors/Mountea-Framework","_blank"),children:[m.jsx(Pb,{className:"h-4 w-4 mr-2"}),"Support Mountea"]})]})]})]})]}),m.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[m.jsx("div",{className:"flex-1 relative",onDrop:W!=="mobile"?wi:void 0,onDragOver:W!=="mobile"?Zr:void 0,"data-tour":"canvas",children:m.jsxs(dS,{nodes:p,edges:w.map(O=>({...O,animated:(M==null?void 0:M.id)===O.id,style:{...O.style,stroke:(M==null?void 0:M.id)===O.id?"#3b82f6":void 0,strokeWidth:(M==null?void 0:M.id)===O.id?3:2}})),onNodesChange:C,onEdgesChange:E,onConnect:Fe,onNodeClick:ci,onEdgeClick:li,onPaneClick:di,onMove:xi,onInit:Q,nodeTypes:Nk,className:"bg-grid",proOptions:{hideAttribution:!0},nodesDraggable:W!=="mobile",panOnDrag:!0,panOnScroll:!1,zoomOnScroll:!1,zoomOnPinch:!1,zoomOnDoubleClick:!1,nodesConnectable:W!=="mobile",elementsSelectable:!0,minZoom:.5,maxZoom:2,children:[m.jsx(yS,{}),m.jsx(zr,{position:"bottom-left",children:m.jsx(nk,{className:"!bg-card !border !border-border !rounded-lg !shadow-lg"})}),W!=="mobile"&&m.jsx(LS,{nodeColor:bi,className:"!bg-card !border !border-border !rounded-lg !shadow-lg",maskColor:"rgb(0, 0, 0, 0.1)","data-tour":"minimap"})]})}),W==="mobile"&&S&&m.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex items-center gap-2 bg-card border rounded-full shadow-lg px-4 py-2",children:[m.jsx("span",{className:"text-sm font-medium truncate max-w-32",children:S.data.displayName||((cr=S.type)==null?void 0:cr.replace("Node",""))}),m.jsx("div",{className:"h-4 w-px bg-border"}),m.jsx(be,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ue(!0),children:m.jsx(Ob,{className:"h-4 w-4"})}),S.id!=="00000000-0000-0000-0000-000000000001"&&m.jsx(be,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>Ne(!0),children:m.jsx(El,{className:"h-4 w-4"})}),m.jsx(be,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>q(null),children:m.jsx(il,{className:"h-4 w-4"})})]}),W==="mobile"&&m.jsx(ib,{open:oe,onOpenChange:Ne,children:m.jsxs(ab,{children:[m.jsxs(sb,{children:[m.jsx(ob,{children:e("editor.deleteCascadeTitle")}),m.jsx(ub,{children:e("editor.deleteCascadeDescription")})]}),m.jsxs(cb,{children:[m.jsx(lb,{children:e("common.cancel")}),m.jsx(db,{onClick:()=>{Ne(!1),fi()},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:e("editor.deleteCascadeConfirm")})]})]})}),W==="mobile"&&re&&m.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:()=>ue(!1)}),S&&(W!=="mobile"||re)&&m.jsx("div",{className:`${W==="mobile"?"fixed inset-y-0 right-0 z-40 w-80":"w-96"} border-l bg-card overflow-y-auto`,children:m.jsxs("div",{className:"p-6 space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h3",{className:"text-lg font-bold",children:((Oe==null?void 0:Oe.label)||"Node")+" "+e("editor.nodeDetails")}),m.jsx(be,{variant:"ghost",size:"icon",onClick:()=>{W==="mobile"?ue(!1):q(null)},className:"h-8 w-8",children:m.jsx(il,{className:"h-4 w-4"})})]}),(Jr=Oe==null?void 0:Oe.sections)==null?void 0:Jr.map(O=>m.jsx(fk,{title:e(O.titleKey),defaultOpen:O.defaultOpen??!0,children:m.jsx("div",{className:"space-y-4",children:O.fields.map(U=>Te(U))})},O.id))]})})]}),W!=="mobile"&&m.jsxs("div",{className:"border-t bg-card px-6 py-3 flex items-center justify-between","data-tour":"node-toolbar",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Ft,{content:"Auto-layout nodes using dagre algorithm",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2",onClick:mi,children:[m.jsx(Lb,{className:"h-4 w-4"}),"Auto Layout"]})}),m.jsx("div",{className:"h-6 w-px bg-border mx-1"}),m.jsx(Ft,{content:"Add NPC node - drag to canvas or click",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:O=>Et(O,"leadNode"),onClick:()=>at("leadNode"),children:[m.jsx(wl,{className:"h-4 w-4"}),"NPC"]})}),m.jsx(Ft,{content:"Add Player node - drag to canvas or click",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:O=>Et(O,"answerNode"),onClick:()=>at("answerNode"),children:[m.jsx(Ut,{className:"h-4 w-4"}),"Player"]})}),m.jsx(Ft,{content:"Add Return node - drag to canvas or click",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:O=>Et(O,"returnNode"),onClick:()=>at("returnNode"),children:[m.jsx(Rl,{className:"h-4 w-4"}),"Return"]})}),m.jsx(Ft,{content:"Add Complete node - drag to canvas or click",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:O=>Et(O,"completeNode"),onClick:()=>at("completeNode"),children:[m.jsx(_l,{className:"h-4 w-4"}),"Complete"]})}),m.jsx(Ft,{content:"Add Delay node - drag to canvas or click",side:"top",children:m.jsxs(be,{variant:"outline",size:"sm",className:"gap-2 cursor-move",draggable:!0,onDragStart:O=>Et(O,"delayNode"),onClick:()=>at("delayNode"),children:[m.jsx(Cl,{className:"h-4 w-4"}),"Delay"]})})]}),m.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[m.jsxs("span",{children:[p.length," ",e("dialogues.nodes"),"  ",w.length," ",e("dialogues.edges")]}),m.jsxs("span",{className:"text-xs hidden md:block",children:["Powered by"," ",m.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition-colors",children:"React Flow"})]})]})]}),m.jsx(_k,{open:ne,onOpenChange:ie,onSelectType:gi})]})}export{jk as component};
