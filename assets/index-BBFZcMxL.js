import{c as H,u as N,a as O,b as F,r as u,j as e,D as M,d as B,e as q,f as _,g as Q,L as P,I as $,T as G,h as R,B as p,i as h,k as I,l as L,F as z,S as V,C as J,m as y,M as E,n as v,o as w,p as K,q as W,s as X}from"./index-x4qPgHOs.js";import{A as Y,L as Z}from"./app-header-C77Pa2hV.js";import{u as ee,O as se,C as te}from"./onboarding-tour-tES3LRyh.js";import{E as ae,C as re}from"./empty-state-BIQ0dupx.js";import{P as k}from"./plus-DgdcaNRh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=H("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);function oe({open:s,onOpenChange:i}){const{t}=N(),c=O(),{createProject:a}=F(),[r,l]=u.useState({name:"",description:"",version:""}),[n,d]=u.useState({}),[x,j]=u.useState(!1),f=(o,m)=>{l(g=>({...g,[o]:m})),n[o]&&d(g=>({...g,[o]:null}))},C=()=>{const o={};return r.name.trim()?/\s/.test(r.name)&&(o.name="Name cannot contain whitespace"):o.name=t("validation.required"),d(o),Object.keys(o).length===0},D=async o=>{if(o.preventDefault(),!!C()){j(!0);try{const m=await a({name:r.name.trim(),description:r.description.trim(),version:r.version.trim()||"1.0.0"});l({name:"",description:"",version:""}),d({}),i(!1),c({to:"/projects/$projectId",params:{projectId:m.id}})}catch(m){console.error("Error creating project:",m),d({submit:t("common.error")})}finally{j(!1)}}},S=()=>{l({name:"",description:"",version:""}),d({}),i(!1)};return e.jsx(M,{open:s,onOpenChange:i,children:e.jsxs(B,{className:"sm:max-w-[500px]",children:[e.jsxs(q,{children:[e.jsx(_,{children:t("projects.createNew")}),e.jsx(Q,{children:t("projects.createFirst")})]}),e.jsxs("form",{onSubmit:D,children:[e.jsx("div",{className:"no-scrollbar -mx-4 max-h-[50vh] overflow-y-auto px-4 sm:-mx-6 sm:px-6",children:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{htmlFor:"name",children:[t("projects.projectName")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx($,{id:"name",placeholder:"My Awesome Game",value:r.name,onChange:o=>f("name",o.target.value),className:n.name?"border-destructive":"",autoFocus:!0}),n.name&&e.jsx("p",{className:"text-xs text-destructive",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"description",children:t("projects.projectDescription")}),e.jsx(G,{id:"description",placeholder:"A brief description of your project...",value:r.description,onChange:o=>f("description",o.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"version",children:"Version"}),e.jsx($,{id:"version",placeholder:"1.0.0",value:r.version,onChange:o=>f("version",o.target.value)})]}),n.submit&&e.jsx("p",{className:"text-sm text-destructive",children:n.submit})]})}),e.jsxs(R,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:S,disabled:x,children:t("common.cancel")}),e.jsx(p,{type:"submit",disabled:x,children:t(x?"common.loading":"common.create")})]})]})]})})}async function ie(){try{return"storage"in navigator&&"estimate"in navigator.storage?(await navigator.storage.estimate()).usage||0:await ce()}catch(s){return console.error("Error calculating disk usage:",s),0}}async function ce(){try{const[s,i,t,c,a,r,l]=await Promise.all([h.projects.count(),h.dialogues.count(),h.nodes.count(),h.edges.count(),h.participants.count(),h.categories.count(),h.decorators.count()]);return s*500+i*300+t*200+c*100+(a+r+l)*150}catch(s){return console.error("Error estimating data size:",s),0}}function le({onNewProject:s,onSearch:i,searchQuery:t,onShowTour:c}){const{t:a}=N(),{status:r,setLoginDialogOpen:l}=L(),n=a(r==="connected"?"sync.status.connected":r==="syncing"?"sync.status.syncing":"sync.status.disconnected"),d=r==="connected"?"text-emerald-500":r==="syncing"?"text-amber-500":r==="error"?"text-red-500":"text-muted-foreground";return e.jsx(Y,{containerClassName:"max-w-7xl mx-auto",leftClassName:"hidden md:flex items-center gap-3 justify-between md:justify-start min-w-0",rightClassName:`${y()?"justify-between":""}`,left:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{className:"hidden sm:block min-w-0",children:[e.jsx("h1",{className:"text-base lg:text-lg font-bold tracking-tight truncate",children:a("app.title")}),e.jsx("p",{className:"hidden xl:block text-xs text-muted-foreground",children:a("app.subtitle")})]})]}),right:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative flex-1 md:w-44 lg:w-64 md:flex-none hidden md:block","data-tour":"search","data-header-mobile-hidden":!0,children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx($,{type:"text",placeholder:a("common.search"),value:t,onChange:x=>i(x.target.value),className:"pl-9 h-9"})]}),e.jsx(Z,{}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>l(!0),className:"rounded-full","aria-label":`${a("sync.title")} - ${n}`,title:`${a("sync.title")} - ${n}`,children:e.jsx(J,{className:`h-4 w-4 ${d}`})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:c,className:"rounded-full shrink-0 hidden lg:inline-flex","data-header-mobile-hidden":!0,children:e.jsx(te,{className:"h-4 w-4"})}),e.jsxs(p,{onClick:s,size:"sm",className:`gap-1 md:inline-flex whitespace-nowrap ${y()?"hidden":""}`,"data-tour":`${y()?"":"create-project"}`,"aria-label":a("projects.createNew"),"data-header-mobile-hidden":!0,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden lg:inline",children:a("projects.createNew")})]}),e.jsxs(p,{onClick:s,size:"sm",className:`shrink-0 md:hidden ${y()?"":"hidden"}`,"data-tour":"","aria-label":a("projects.createNew"),children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden [@media(min-width:400px)]:inline",children:a("projects.createNew")})]})]})})}function de({projectCount:s,dialogueCount:i,diskUsage:t}){const{t:c}=N();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(v,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("projects.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:s})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-primary"})})]})})}),e.jsx(v,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("dialogues.title")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:i})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-50 dark:bg-purple-900/20 flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})})}),e.jsx(v,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:c("dashboard.diskUsage")}),e.jsx("h3",{className:"text-3xl font-bold mt-2",children:t})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center",children:e.jsx(ne,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})})]})}function me({project:s}){const{t:i}=N(),{dialogues:t}=I(),c=t.filter(d=>d.projectId===s.id),a=["from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20","from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20","from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20","from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20"],r=["text-blue-500 dark:text-blue-400","text-purple-500 dark:text-purple-400","text-orange-500 dark:text-orange-400","text-green-500 dark:text-green-400"],l=["#3b82f6","#9333ea","#f97316","#22c55e"],n=parseInt(s.id.substring(0,8),16)%a.length;return e.jsx(W,{to:"/projects/$projectId",params:{projectId:s.id},children:e.jsxs(v,{className:"group cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all h-full min-h-[280px] flex flex-col overflow-hidden rounded-lg",children:[e.jsxs("div",{className:`h-32 bg-gradient-to-br ${a[n]} flex items-center justify-center relative overflow-hidden rounded-t-lg`,children:[e.jsx("div",{className:"absolute inset-0 opacity-30 dark:opacity-20 bg-[radial-gradient(circle,currentColor_1px,transparent_1px)] [background-size:16px_16px]",style:{color:l[n]}}),e.jsx(z,{className:`h-12 w-12 ${r[n]} opacity-80 group-hover:scale-110 group-hover:rotate-6 transition-all duration-300 relative z-10`}),e.jsxs("div",{className:"absolute top-3 right-3 text-xs text-muted-foreground flex items-center gap-1 bg-background/90 backdrop-blur-sm px-2 py-1 rounded-full",children:[e.jsx(re,{className:"h-3 w-3"}),X(s.createdAt)]})]}),e.jsxs(w,{className:"p-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-base group-hover:text-primary transition-colors line-clamp-1",children:s.name}),s.version&&e.jsxs("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded",children:["v",s.version]})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2 leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-auto pt-3 border-t flex items-center justify-center text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(E,{className:`h-3.5 w-3.5 group-hover:${r[n].replace("text-","text-")} transition-colors`}),e.jsxs("span",{className:"font-medium",children:[c.length," ",c.length===1?i("dialogues.title").slice(0,-1):i("dialogues.title")]})]})})]})]})})}function je(){const{t:s}=N(),{projects:i,loadProjects:t,isLoading:c}=F(),{dialogues:a,loadDialogues:r}=I(),{lastSyncedAt:l}=L(),[n,d]=u.useState(""),[x,j]=u.useState(!1),[f,C]=u.useState(0),{runTour:D,finishTour:S,resetTour:o}=ee("dashboard");u.useEffect(()=>{t()},[t]),u.useEffect(()=>{l&&(t(),r())},[l,t,r]),u.useEffect(()=>{(async()=>{const A=await ie();C(A)})()},[i,a]);const m=()=>{j(!0)},g=i.filter(b=>b.name.toLowerCase().includes(n.toLowerCase())),T=a.length,U=K(f);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted/20 overflow-x-clip",children:[e.jsx(se,{run:D,onFinish:S,tourType:"dashboard"}),e.jsx(oe,{open:x,onOpenChange:j}),e.jsx(le,{onNewProject:m,onSearch:d,searchQuery:n,onShowTour:o}),e.jsxs("main",{className:"flex-1 p-6 md:p-12 max-w-7xl mx-auto w-full",children:[e.jsx(de,{projectCount:i.length,dialogueCount:T,diskUsage:U}),e.jsxs("div",{className:"mt-10",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:s("projects.recentProjects")})}),c?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):g.length===0?e.jsx(ae,{icon:z,title:s("projects.noProjects"),description:s("projects.createFirst"),action:e.jsxs(p,{onClick:m,children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),s("projects.createNew")]}),tips:["Projects help organize your dialogues by game or story","Each project can contain multiple dialogues","Use the search bar to quickly find projects"]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6","data-tour":"projects-grid",children:[g.map(b=>e.jsx(me,{project:b},b.id)),e.jsxs("button",{onClick:m,className:"border-2 border-dashed rounded-2xl flex flex-col items-center justify-center min-h-[280px] hover:border-primary hover:bg-primary/5 transition-all group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(k,{className:"h-8 w-8 text-primary"})}),e.jsx("span",{className:"font-bold text-lg",children:s("projects.createNew")}),e.jsx("span",{className:"text-sm text-muted-foreground mt-2",children:s("projects.createNewDescription")})]})]})]})]})]})}export{je as component};
