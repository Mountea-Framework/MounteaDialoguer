import{u as B,V as G,aD as J,b as O,k as R,r as l,j as e,B as n,q as V,n as m,aE as x,aF as h,aG as q,aH as u,o as j,L as C,I as K,T as Q,ax as Z,aI as N,s as b,x as U,aJ as W,y as A,E as X,G as Y,H as _,J as ee,K as se,N as ae,O as te,P as ie,Q as ne}from"./index-x4qPgHOs.js";import{A as le,L as re}from"./app-header-C77Pa2hV.js";import{S as de,M as oe,A as ce}from"./sun-D3EmF3OK.js";function je(){const{t:s}=B(),{theme:me,resolvedTheme:v,setTheme:S}=G(),{projectId:r,dialogueId:d}=J.useParams(),{projects:k,loadProjects:D}=O(),{dialogues:E,loadDialogues:w,updateDialogue:I,deleteDialogue:F,exportDialogue:T}=R(),[o,g]=l.useState(!1),[p,y]=l.useState(!1),[L,f]=l.useState(!1),[i,c]=l.useState({name:"",description:""});l.useEffect(()=>{D(),w(r)},[D,w,r]);const P=k.find(t=>t.id===r),a=E.find(t=>t.id===d);l.useEffect(()=>{a&&c({name:a.name||"",description:a.description||""})},[a]);const H=async()=>{if(i.name.trim()){y(!0);try{await I(d,{name:i.name,description:i.description}),g(!1)}catch(t){console.error("Failed to update dialogue:",t)}finally{y(!1)}}},M=()=>{c({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||""}),g(!1)},z=async()=>{try{await T(d)}catch(t){console.error("Failed to export dialogue:",t)}},$=async()=>{try{await F(d),f(!1),window.location.href=`#/projects/${r}`}catch(t){console.error("Failed to delete dialogue:",t)}};return!a||!P?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):e.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[e.jsx(le,{left:e.jsxs(e.Fragment,{children:[e.jsx(V,{to:"/projects/$projectId/dialogue/$dialogueId",params:{projectId:r,dialogueId:d},children:e.jsx(n,{variant:"ghost",size:"icon",className:"rounded-full",children:e.jsx(ce,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.name})]})})]}),menuItems:e.jsxs(e.Fragment,{children:[e.jsx(re,{}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>S(v==="dark"?"light":"dark"),className:"justify-start",children:v==="dark"?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),s("settings.lightMode")]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),s("settings.darkMode")]})})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-8 md:p-12 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s("dialogues.dialogueSettings")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure dialogue properties and behavior"})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-primary"}),s("settings.projectInfo")]}),e.jsx(u,{className:"mt-1.5",children:"Edit dialogue name and description"})]}),!o&&e.jsx(n,{onClick:()=>g(!0),variant:"outline",children:s("common.edit")})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"name",children:s("dialogues.dialogueName")}),e.jsx(K,{id:"name",value:i.name,onChange:t=>c({...i,name:t.target.value}),disabled:!o,placeholder:s("dialogues.dialogueName")})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(Q,{id:"description",value:i.description,onChange:t=>c({...i,description:t.target.value}),disabled:!o,placeholder:"Enter dialogue description",rows:3})]})]}),o&&e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(n,{variant:"outline",onClick:M,disabled:p,children:s("common.cancel")}),e.jsxs(n,{onClick:H,disabled:p||!i.name.trim(),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),s(p?"common.saving":"common.save")]})]})]})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:s("settings.metadata")}),e.jsx(u,{children:"View dialogue metadata and timestamps"})]}),e.jsx(j,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Dialogue ID"}),e.jsx("code",{className:"text-sm font-mono bg-muted px-2 py-1 rounded",children:a.id})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.created")}),e.jsx("span",{className:"text-sm font-medium",children:b(a.createdAt)})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("projects.modified")}),e.jsx("span",{className:"text-sm font-medium",children:b(a.modifiedAt)})]}),e.jsx(N,{}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s("dialogues.nodes")}),e.jsx("span",{className:"text-sm font-medium",children:a.nodeCount||0})]})]})})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Export Dialogue"}),e.jsx(u,{children:"Download this dialogue as a standalone file"})]}),e.jsx(j,{children:e.jsxs(n,{onClick:z,variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Export Dialogue"]})})]}),e.jsxs(m,{className:"border-destructive",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(W,{className:"h-5 w-5"}),s("settings.dangerZone")]}),e.jsx(u,{children:"Permanently delete this dialogue and all its nodes"})]}),e.jsx(j,{children:e.jsxs(n,{variant:"destructive",onClick:()=>f(!0),className:"w-full justify-start gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Delete Dialogue"]})})]})]})}),e.jsx(X,{open:L,onOpenChange:f,children:e.jsxs(Y,{variant:"destructive",size:"sm",children:[e.jsxs(_,{children:[e.jsx(ee,{className:"bg-destructive/10 text-destructive dark:bg-destructive/20 dark:text-destructive",children:e.jsx(A,{className:"h-6 w-6"})}),e.jsx(se,{children:"Delete Dialogue"}),e.jsxs(ae,{children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone and will delete all nodes and connections.']})]}),e.jsxs(te,{children:[e.jsx(ie,{variant:"outline",children:s("common.cancel")}),e.jsx(ne,{variant:"destructive",onClick:$,children:s("common.delete")})]})]})})]})}export{je as component};
